let e,t,i;import"./mced.4ec3b53e.js";var s,o,n,r=globalThis;function l(e){return e&&e.__esModule?e.default:e}var a={},c={},h=r.parcelRequirea483;null==h&&((h=function(e){if(e in a)return a[e].exports;if(e in c){var t=c[e];delete c[e];var i={id:e,exports:{}};return a[e]=i,t.call(i.exports,i,i.exports),i.exports}var s=Error("Cannot find module '"+e+"'");throw s.code="MODULE_NOT_FOUND",s}).register=function(e,t){c[e]=t},r.parcelRequirea483=h);var u=h.register;u("ca2Ll",function(e,t){e.exports=h("97Mr6")}),u("97Mr6",function(e,t){var i,s;e.exports,s=function(){var e,t,i,s,o,n,l,a,c,h,u,d,E,_,T,p,g,I,R,m,O,A,S,C,f,L,N={};ea=function(e,t,i,s){if(!(e instanceof M)&&"string"!=typeof e||""===`${e}`.trim())throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=`${e}`.toLowerCase(),"string"!=typeof t||""===t.trim())throw Error('Invalid name "'+t+'". The name must be a non-empty string.');let o=t.toLowerCase();if(!i)throw Error("Can not register a null value");let n=b[e],r=$[e];if(n||(n=b[e]=Object.create(null),r=$[e]=Object.create(null)),ec(e,i),!s&&n[o]&&n[o]!==i)throw Error('Name "'+o+'" with type "'+e+'" already registered.');n[o]=i,r[o]=t},ec=function(e,t){if(e===String(M.FIELD)&&"function"!=typeof t.fromJson)throw Error('Type "'+e+'" must have a fromJson function')},eh=function(e,t){e=`${e}`.toLowerCase(),t=t.toLowerCase();let i=b[e];i&&i[t]?(delete b[e][t],delete $[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},eu=function(e,t,i){e=`${e}`.toLowerCase(),t=t.toLowerCase();let s=b[e];if(!s||!s[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",i)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return s[t]},ed=function(e,t){return e=`${e}`.toLowerCase(),t=t.toLowerCase(),!!(e=b[e])&&!!e[t]},eE=function(e,t,i){return eu(e,t,i)},e_=function(e,t,i){return eu(e,t,i)},eT=function(e,t,i){var s=b[e=`${e}`.toLowerCase()];if(!s){if(s=`Unable to find [${e}] in the registry.`,i)throw Error(`${s} You must require or register a ${e} plugin.`);return console.warn(s),null}if(!t)return s;for(let t of(e=$[e],i=Object.create(null),Object.keys(s)))i[e[t]]=s[t];return i},ep=function(e,t,i){return"function"==typeof(t=t.plugins[String(e)]||D)?t:eE(e,t,i)},eg=function(e,t){eI(),G=setTimeout(function(){t&&t.handleRightClick(e)},k)},eI=function(){G&&(clearTimeout(G),G=0)},eR=function(){v=null},em=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&eA(e)},eO=function(e){return`${e.pointerId}`},eA=function(e){let t=eO(e);return v?v===t:"pointerdown"===e.type&&(v=t,!0)},eS=function(e,t,i,s,o){function n(e){(o||em(e))&&(i?s.call(i,e):s(e))}let r=[];if(t in B)for(let i=0;i<B[t].length;i++){let s=B[t][i];e.addEventListener(s,n,!1),r.push([e,s,n])}else e.addEventListener(t,n,!1),r.push([e,t,n]);return r},eC=function(e,t,i,s){function o(e){i?s.call(i,e):s(e)}let n=[];if(t in B)for(let i=0;i<B[t].length;i++){let s=B[t][i];e.addEventListener(s,o,!1),n.push([e,s,o])}else e.addEventListener(t,o,!1),n.push([e,t,o]);return n},ef=function(e){let t=e[e.length-1][2];for(;e.length;){let[t,i,s]=e.pop();t.removeEventListener(i,s,!1)}return t},eL=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||"true"===e.target.getAttribute("data-is-text-input"))return!0;if(e.target instanceof HTMLInputElement)return"text"===(e=e.target).type||"number"===e.type||"email"===e.type||"password"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type;if(e.target instanceof HTMLTextAreaElement)return!0}return!1},eN=function(e){return!!e.ctrlKey&&!!V||2===e.button},eb=function(e,t,i){let s=t.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,i||(i=t.getScreenCTM().inverse()),s.matrixTransform(i)},e$=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*K,y:e.deltaY*K};case 2:return{x:e.deltaX*X,y:e.deltaY*X}}},eD=function(){return"blockly-"+(Z++).toString(36)},eM=function(){return J.genUid()},eP=function(e){return e.type===rC.BLOCK_CREATE},ey=function(e){return e.type===rC.BLOCK_DELETE},ek=function(e){return e.type===rC.BLOCK_CHANGE},ew=function(e){return e.type===rC.BLOCK_FIELD_INTERMEDIATE_CHANGE},ev=function(e){return e.type===rC.BLOCK_MOVE},eB=function(e){return e.type===rC.CLICK},eG=function(e){return e.type===rC.BUBBLE_OPEN},eF=function(e){return e.type===rC.VIEWPORT_CHANGE},N.setRecordUndo$$module$build$src$core$events$utils=function(e){et=e},ex=function(){return et},eU=function(e){en.fireInternal(e)},eH=function(){let e=eV(eo);for(let t of(eo.length=0,e)){let e;t.workspaceId&&(null==(e=ts(t.workspaceId))||e.fireChangeListener(t))}},eW=function(e){if(ek(e)&&"mutation"===e.element){let t;for(t=eo.length;0<t;t--){let i=eo[t-1];if(i.group!==e.group||i.workspaceId!==e.workspaceId||!ev(i)||i.newParentId!==e.blockId)break}eo.splice(t,0,e)}else eo.push(e)},eV=function(e){let t=[];for(let i of e)if(e=t[t.length-1],!i.isNull())if(e&&e.workspaceId===i.workspaceId&&e.group===i.group)if(ev(i)&&ev(e)&&i.blockId===e.blockId){if(e.newParentId=i.newParentId,e.newInputName=i.newInputName,e.newCoordinate=i.newCoordinate,e.reason||i.reason){let t,s;e.reason=Array.from(new Set((null!=(t=e.reason)?t:[]).concat(null!=(s=i.reason)?s:[])))}}else ek(i)&&ek(e)&&i.blockId===e.blockId&&i.element===e.element&&i.name===e.name?e.newValue=i.newValue:eF(i)&&eF(e)?(e.viewTop=i.viewTop,e.viewLeft=i.viewLeft,e.scale=i.scale,e.oldScale=i.oldScale):eB(i)&&eG(e)||t.push(i);else t.push(i);return e=t.filter(e=>!e.isNull())},eK=function(){for(let e=0,t;t=eo[e];e++)t.recordUndo=!1},N.disable$$module$build$src$core$events$utils=function(){ei++},N.enable$$module$build$src$core$events$utils=function(){ei--},eX=function(){return 0===ei},N.getGroup$$module$build$src$core$events$utils=function(){return ee},N.setGroup$$module$build$src$core$events$utils=function(e){en.setGroupInternal(e)},eY=function(e){let t=[];e=e.getDescendants(!1);for(let i=0,s;s=e[i];i++)t[i]=s.id;return t},ez=function(e,t){let i=ej(e.type);if(!i)throw Error("Unknown event type.");return i.fromJson(e,t)},ej=function(e){let t=eE(M.EVENT,e);if(!t)throw Error(`Event type ${e} not found in registry.`);return t},eJ=function(e){if((ev(e)||eP(e))&&e.workspaceId){var t=ts(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){let i=et;try{et=!1;let i=e.getParent();if(i&&!i.hasDisabledReason(es)){let t=e.getDescendants(!1);for(let e=0,i;i=t[e];e++)i.setDisabledReason(!1,es)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do e.setDisabledReason(!0,es),e=e.getNextBlock();while(e)}finally{et=i}}}},eZ=function(e,t,i){for(let i in e=document.createElementNS(rL,`${e}`),t)e.setAttribute(i,`${t[i]}`);return i&&i.appendChild(e),e},eq=function(e,t){return!(t=t.split(" ")).every(t=>e.classList.contains(t))&&(e.classList.add(...t),!0)},eQ=function(e,t){e.classList.remove(...t.split(" "))},e0=function(e,t){return!(t=t.split(" ")).every(t=>!e.classList.contains(t))&&(e.classList.remove(...t),!0)},e1=function(e,t){return e.classList.contains(t)},e2=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},e3=function(e,t){let i=t.nextSibling;if(!(t=t.parentNode))throw Error("Reference node has no parent.");i?t.insertBefore(e,i):t.appendChild(e)},e5=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},e6=function(){rD++,r$||(r$=Object.create(null))},e4=function(){--rD||(r$=null)},e8=function(e){var t;let i=e.textContent+"\n"+e.className.baseVal;return r$&&(t=r$[i])||(t=window.getComputedStyle(e),t=e9(e,t.fontSize,t.fontWeight,t.fontFamily),r$&&(r$[i]=t)),t},e9=function(e,t,i,s){var o;let n=e.textContent;return e=n+"\n"+e.className.baseVal,r$&&(o=r$[e])||(rM||((o=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(o),rM=o.getContext("2d")),n&&rM?(rM.font=i+" "+t+" "+s,o=rM.measureText(n).width):o=0,r$&&(r$[e]=o)),o},e7=function(e,t,i,s){let o=document.createElement("span");o.style.font=i+" "+t+" "+s,o.textContent=e,(e=document.createElement("div")).style.width="1px",e.style.height="0",(t=document.createElement("div")).style.display="flex",t.style.position="fixed",t.style.top="0",t.style.left="0",t.appendChild(o),t.appendChild(e),document.body.appendChild(t),i={height:0,baseline:0};try{t.style.alignItems="baseline",i.baseline=e.offsetTop-o.offsetTop,t.style.alignItems="flex-end",i.height=e.offsetTop-o.offsetTop}finally{document.body.removeChild(t)}return i},N.getFocusManager$$module$build$src$core$focus_manager=function(){return rw.getFocusManager()},te=function(e){return e&&"getFocusableElement"in e&&"getFocusableTree"in e&&"onNodeFocus"in e&&"onNodeBlur"in e&&"canBeFocused"in e},tt=function(e){return"string"==typeof e.id&&void 0!==e.workspace&&void 0!==e.select&&void 0!==e.unselect&&te(e)},ti=function(e,t){for(let i in t)null!==t[i]&&Array.isArray(t[i])?e[i]=ti(e[i]||[],t[i]):e[i]=null!==t[i]&&"object"==typeof t[i]?ti(e[i]||Object.create(null),t[i]):t[i];return e},ts=function(e){return rW[e]||null},to=function(){let e=[];for(let t in rW)e.push(rW[t]);return e},tn=function(e){rW[e.id]=e},tr=function(e){delete rW[e.id]},tl=function(){return rU},ta=function(e){rU=e},tc=function(){let e=N.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();return e&&tt(e)?e:null},th=function(e){let t,i,s,o,n=tc();eU(new(ej(rC.SELECTED))(null!=(t=null==n?void 0:n.id)?t:null,null!=(i=null==e?void 0:e.id)?i:null,null!=(o=null!=(s=null==e?void 0:e.workspace.id)?s:null==n?void 0:n.workspace.id)?o:""))},tu=function(){return rH},td=function(e){rH=e},tE=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;let t=e.getParentSvg(),i=e.getCachedParentSvgSize();var s=t.parentElement;if(s instanceof HTMLElement){var o=s.offsetWidth;s=s.offsetHeight,i.width!==o&&(t.setAttribute("width",o+"px"),e.setCachedParentSvgSize(o,null)),i.height!==s&&(t.setAttribute("height",s+"px"),e.setCachedParentSvgSize(null,s)),e.resize()}},t_=function(e,t){let i=Object.create(null),s=e.getDescendants(!0);t&&(e=e.getNextBlock())&&(e=s.indexOf(e),s.splice(e,s.length-e));for(let e=0,t;t=s[e];e++)i[t.type]?i[t.type]++:i[t.type]=1;return i},tT=function(e){return function(){this.jsonInit(e)}},tp=function(e){rK.defineBlocksWithJsonArrayInternal(e)},N.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(e){let t={};for(let i=0;i<e.length;i++){let s=e[i];if(!s){console.warn(`Block definition #${i} in JSON array is ${s}. Skipping`);continue}let o=s.type;o?t[o]={init:tT(s)}:console.warn(`Block definition #${i} in JSON array is missing a type attribute. Skipping.`)}return t},N.defineBlocks$$module$build$src$core$common=function(e){for(let t of Object.keys(e)){let i=e[t];t in y&&console.warn(`Block definition "${t}" overwrites previous definition.`),y[t]=i}},tg=function(e){let t=tl();t&&!(eL(e)||t.rendered&&!t.isVisible())&&rG.registry.onKeyDown(t,e)},tI=function(e,t){return -1!==(t=e.indexOf(t))&&(e.splice(t,1),!0)},tR=function(e){if(r3)throw Error("CSS already injected");r5+="\n"+e},tm=function(e,t){r3||(r3=!0,e&&(e=t.replace(/[\\/]$/,""),t=r5.replace(/<<<PATH>>>/g,e),r5="",(e=document.createElement("style")).id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},tO=function(e){return le.getSizeInternal(e)},tA=function(e){return new r7(e.offsetWidth,e.offsetHeight)},tS=function(e,t){return(e=window.getComputedStyle(e))[t]||e.getPropertyValue(t)},tC=function(e){let t=new r4(0,0);e=e.getBoundingClientRect();var i=document.documentElement;return i=new r4(window.pageXOffset||i.scrollLeft,window.pageYOffset||i.scrollTop),t.x=e.left+i.x,t.y=e.top+i.y,t},tf=function(){let e=document.body,t=document.documentElement;return new r4(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},tL=function(e){let t=parseFloat(tS(e,"borderLeftWidth")),i=parseFloat(tS(e,"borderRightWidth"));return new r9(parseFloat(tS(e,"borderTopWidth")),e=parseFloat(tS(e,"borderBottomWidth")),t,i)},tN=function(e,t,i){e=tb(e,t,i),t.scrollLeft=e.x,t.scrollTop=e.y},tb=function(e,t,i){var s=tC(e),o=tC(t),n=tL(t);let r=s.x-o.x-n.left;return s=s.y-o.y-n.top,o=tA(e),e=t.clientWidth-o.width,o=t.clientHeight-o.height,n=t.scrollLeft,t=t.scrollTop,i?(n+=r-e/2,t+=s-o/2):(n+=Math.min(r,Math.max(r-e,0)),t+=Math.min(s,Math.max(s-o,0))),new r4(n,t)},t$=function(e){let t=new r4(0,0);var i=e.x&&e.getAttribute("x");let s=e.y&&e.getAttribute("y");return i&&(t.x=parseInt(i)),s&&(t.y=parseInt(s)),(i=(i=e.getAttribute("transform"))&&i.match(li))&&(t.x+=Number(i[1]),i[3]&&(t.y+=Number(i[3]))),(e=e.getAttribute("style"))&&e.includes("translate")&&(e=e.match(ls))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},tD=function(e){let t=0,i=0;for(;e;){let s=t$(e);if(t+=s.x,i+=s.y,(" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;e=e.parentNode}return new r4(t,i)},tM=function(){let e=tf();return new r9(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},tP=function(){let e=document.documentElement,t=window;return new r4(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},ty=function(e,t){var i=t.x;t=t.y;let s=e.getInjectionDiv().getBoundingClientRect();return i=new r4(i-s.left,t-s.top),t=e.getOriginOffsetInPixels(),r4.difference(i,t).scale(1/e.scale)},tk=function(e,t){var i=t.scale(e.scale);t=i.x,i=i.y;let s=e.getInjectionDiv().getBoundingClientRect();return e=e.getOriginOffsetInPixels(),new r4(t+s.left+e.x,i+s.top+e.y)},N.createElement$$module$build$src$core$utils$xml=function(e){return la.createElementNS(lu,e)},N.createTextNode$$module$build$src$core$utils$xml=function(e){return la.createTextNode(e)},N.textToDom$$module$build$src$core$utils$xml=function(e){let t=lr.parseFromString(e,"text/xml");if(t&&t.documentElement&&!t.getElementsByTagName("parsererror").length)return t.documentElement;if((t=lr.parseFromString(e,"text/html"))&&t.body.firstChild&&"xml"===t.body.firstChild.nodeName.toLowerCase())return t.body.firstChild;throw Error(`DOMParser was unable to parse: ${e}`)},tw=function(e){return tv(ll.serializeToString(e))},tv=function(e){return e.replace(ld,e=>`&#${e.charCodeAt(0)};`)},tB=function(e){return e?((e instanceof Element||"string"==typeof e)&&(e=tK(e),e=tH(e)),tG(e),e):null},tG=function(e){let t=e.kind;if(e=e.contents,t&&t!==lI&&t!==lg)throw Error("Invalid toolbox kind "+t+". Please supply either "+lI+" or "+lg);if(!e)throw Error("Toolbox must have a contents attribute.")},tF=function(e){return e?e.contents?e.contents:Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:tW(e):[]},tx=function(e){return lR.hasCategoriesInternal(e)},tU=function(e){return!!e&&!!e.contents&&!!e.contents.filter(function(e){return"CATEGORY"===e.kind.toUpperCase()}).length},tH=function(e){let t={contents:tW(e)};return e instanceof Node&&tV(e,t),t},tW=function(e){let t=[],i=e.childNodes;i||(i=e);for(let s=0,o;o=i[s];s++){if(!o.tagName)continue;e={};let i=o.tagName.toUpperCase();e.kind=i,"BLOCK"===i?e.blockxml=o:o.childNodes&&0<o.childNodes.length&&(e.contents=tW(o)),tV(o,e),t.push(e)}return t},tV=function(e,t){for(let i=0;i<e.attributes.length;i++){let s=e.attributes[i];s.nodeName.includes("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[s.nodeName.replace("css-","")]=s.value):t[s.nodeName]=s.value}},tK=function(e){let t=null;if(e)if("string"==typeof e){if("xml"!==(t=N.textToDom$$module$build$src$core$utils$xml(e)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},tX=function(e,t,i,s,o,n){let r=n.scrollbar&&n.scrollbar.canScrollVertically();return e.horizontal===lk.LEFT?(i=o.absoluteMetrics.left+i,r&&n.RTL&&(i+=ln.scrollbarThickness)):(i=o.absoluteMetrics.left+o.viewMetrics.width-t.width-i,r&&!n.RTL&&(i-=ln.scrollbarThickness)),e.vertical===ly.TOP?e=o.absoluteMetrics.top+s:(e=o.absoluteMetrics.top+o.viewMetrics.height-t.height-s,n.scrollbar&&n.scrollbar.canScrollHorizontally()&&(e-=ln.scrollbarThickness)),new r9(e,e+t.height,i,i+t.width)},tY=function(e,t){return{horizontal:t.toolboxMetrics.position===lp.LEFT||e.horizontalLayout&&!e.RTL?lk.RIGHT:lk.LEFT,vertical:t.toolboxMetrics.position===lp.BOTTOM?ly.TOP:ly.BOTTOM}},tz=function(e,t,i,s){let o=e.left,n=e.right-e.left,r=e.bottom-e.top;for(let l=0;l<s.length;l++){let a=s[l];e.intersects(a)&&(e=new r9(e=i===lw.UP?a.top-r-t:a.bottom+t,e+r,o,o+n),l=-1)}return e},tj=function(e,t){ea(M.SERIALIZER,e,t)},tJ=function(e,{addCoordinates:t=!1,saveIds:i=!0}={}){let s=e.workspace,o=Object.create(null);return o.height=e.getSize().height,o.width=e.getSize().width,i&&(o.id=e.id),t&&(t=e.getRelativeToSurfaceXY(),o.x=s.RTL?s.getWidth()-t.x:t.x,o.y=t.y),e.getText()&&(o.text=e.getText()),e.isCollapsed()&&(o.collapsed=!0),e.isOwnEditable()||(o.editable=!1),e.isOwnMovable()||(o.movable=!1),e.isOwnDeletable()||(o.deletable=!1),o},tZ=function(e,t,{recordUndo:i=!1}={}){let s=ex();if(N.setRecordUndo$$module$build$src$core$events$utils(i),i=t.newComment(e.id),void 0!==e.text&&i.setText(e.text),void 0!==e.x||void 0!==e.y){var o;let s=i.getRelativeToSurfaceXY(),n,r=null!=(n=e.x)?n:s.x;r=t.RTL?t.getWidth()-r:r,t=null!=(o=e.y)?o:s.y,i.moveTo(new r4(r,t))}if(void 0!==e.width||e.height){let t,s;o=i.getSize(),i.setSize(new r7(null!=(t=e.width)?t:o.width,null!=(s=e.height)?s:o.height))}return void 0!==e.collapsed&&i.setCollapsed(e.collapsed),void 0!==e.editable&&i.setEditable(e.editable),void 0!==e.movable&&i.setMovable(e.movable),void 0!==e.deletable&&i.setDeletable(e.deletable),N.setRecordUndo$$module$build$src$core$events$utils(s),i},tq=function(e,t){ea(M.PASTER,e,t)},tQ=function(e){let t=e.workspace,i=e.getRelativeToSurfaceXY(),s=new r4(0,0),o=t.getTopComments(!1).filter(t=>t.id!==e.id).map(e=>e.getRelativeToSurfaceXY());for(;t0(r4.sum(i,s),o);)s.translate(t.RTL?-30:30,30);e.moveTo(r4.sum(i,s))},t0=function(e,t){return t.some(t=>1>=Math.abs(t.x-e.x)&&1>=Math.abs(t.y-e.y))},t1=function(e,t){e.setAttribute(lG,t)},t2=function(e,t,i){Array.isArray(i)&&(i=i.join(" ")),e.setAttribute(lB+t,`${i}`)},t3=function(e){return void 0!==e.saveState&&void 0!==e.loadState},t5=function(e){return(t9(e),t8())?(t7(),Promise.resolve()):(lj||(lj=new Promise(e=>{lJ=e,lZ=window.requestAnimationFrame(()=>{t7(),e()})})),lj)},t6=function(){return lj||Promise.resolve()},t4=function(e){e||window.cancelAnimationFrame(lZ),t7(e),!e&&lJ&&lJ()},t8=function(){return W},t9=function(e){lY.add(e),lz.set(e,N.getGroup$$module$build$src$core$events$utils());let t=e.getParent();t?t9(t):lX.add(e)},t7=function(e){let t=new Set(e?[e]:[...lX].map(e=>e.workspace)),i=[...lX].filter(it).filter(e=>t.has(e.workspace));for(var s of i)ii(s);for(let e of t)e.resizeContents();for(var o of i)s=o.getRelativeToSurfaceXY(),o.updateComponentLocations(s);for(let e of i)o=N.getGroup$$module$build$src$core$events$utils(),(s=lz.get(e))&&N.setGroup$$module$build$src$core$events$utils(s),e.bumpNeighbours(),N.setGroup$$module$build$src$core$events$utils(o);for(let e of i)ie(e);e||(lj=null)},ie=function(e){for(let t of(lX.delete(e),lY.delete(e),lz.delete(e),e.getChildren(!1)))ie(t)},it=function(e){return!e.isDisposed()&&!e.getParent()},ii=function(e){if(lY.has(e)&&e.initialized){for(let t of e.getChildren(!1))ii(t);e.renderEfficiently()}},is=function(e,t){l5(e,t)},io=function(e,t){l4(e,t)},ir=function(e,t,i){l9(e,t,i)},il=function(e){return void 0!==e.getProcedureDef},ia=function(e){return void 0!==e.getProcedureCall&&void 0!==e.renameProcedure},ic=function(e){return void 0!==e.getVariableModel},ih=function(e,t,i,s){e=e+" was deprecated in "+t+" and will be deleted in "+i+".",s&&(e+="\nUse "+s+" instead."),as.has(e)||(as.add(e),console.warn(e))},N.allUsedVarModels$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);let t=new Set;for(let i=0;i<e.length;i++){let s=e[i].getVarModels();if(s)for(let e=0;e<s.length;e++){let i=s[e];i.getId()&&t.add(i)}}return Array.from(t.values())},N.allDeveloperVariables$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);let t=new Set;for(let s=0,o;o=e[s];s++){var i=o.getDeveloperVariables;if(i){i=i();for(let e=0;e<i.length;e++)t.add(i[e])}}return Array.from(t.values())},iu=function(e){return id(e,!1)},id=function(e,t=!0){return(y.variables_set||y.variables_get||console.warn("There are no variable blocks, but there is a variable category."),t)?(ih("The XML return value of Blockly.Variables.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),iT(e)):(e.registerButtonCallback("CREATE_VARIABLE",function(e){iR(e.getTargetWorkspace())}),[{kind:"button",text:"%{BKY_NEW_VARIABLE}",callbackkey:"CREATE_VARIABLE"},...i_(e,e.getVariableMap().getVariablesOfType(""),!0)])},iE=function(e){return{VAR:{name:e.getName(),type:e.getType()}}},i_=function(e,t,i,s="variables_get",o="variables_set"){i&&(i=y.math_change),e=[];let n=t.slice(-1)[0];return n&&(y[o]&&e.push({kind:"block",type:o,gap:i?8:24,fields:iE(n)}),i&&e.push({kind:"block",type:"math_change",gap:y[s]?20:8,fields:iE(n),inputs:{DELTA:{shadow:{type:"math_number",fields:{NUM:1}}}}})),y[s]&&e.push(...t.sort(iD).map(e=>({kind:"block",type:s,gap:8,fields:iE(e)}))),e},iT=function(e){let t=[],i=document.createElement("button");return i.setAttribute("text","%{BKY_NEW_VARIABLE}"),i.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(e){iR(e.getTargetWorkspace())}),t.push(i),t.concat(e=ip(e))},ip=function(e){e=e.getVariableMap().getVariablesOfType("");let t=[];if(0<e.length){var i=e[e.length-1];if(y.variables_set){var s=N.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","variables_set"),s.setAttribute("gap",y.math_change?"8":"24"),s.appendChild(iN(i)),t.push(s)}if(y.math_change&&((s=N.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","math_change"),s.setAttribute("gap",y.variables_get?"20":"8"),s.appendChild(iN(i)),i=N.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),s.appendChild(i),t.push(s)),y.variables_get){e.sort(iD);for(let s=0,o;o=e[s];s++)(i=N.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get"),i.setAttribute("gap","8"),i.appendChild(iN(o)),t.push(i)}}return t},ig=function(e){return al.generateUniqueNameInternal(e)},iI=function(e,t){if(!t.length)return e;let i="",s=ar.indexOf(e);for(;;){let o=!1;for(let i=0;i<t.length;i++)if(t[i].toLowerCase()===e){o=!0;break}if(!o)break;++s===ar.length&&(s=0,i=`${Number(i)+1}`),e=ar.charAt(s)+i}return e},iR=function(e,t,i){let s=i||"";!function i(o){im(N.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,o,function(o){if(o){var n=iA(o,e);if(n){if(n.getType()===s)var r=N.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",n.getName());else r=(r=N.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",n.getName()).replace("%2",n.getType());is(r,function(){i(o)})}else e.getVariableMap().createVariable(o,s),t&&t(o)}else t&&t(null)})}("")},N.renameVariable$$module$build$src$core$variables=function(e,t,i){!function s(o){let n=N.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",t.getName());im(n,o,function(o){if(o){var n=iO(o,t.getType(),e),r=iS(t.getName(),o,e);if(n||r){var l="";n?l=N.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",n.getName()).replace("%2",n.getType()):r&&(l=N.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",o).replace("%2",r)),is(l,function(){s(o)})}else e.getVariableMap().renameVariable(t,o),i&&i(o)}else i&&i(null)})}("")},im=function(e,t,i){ir(e,t,function(e){e&&((e=e.replace(/[\s\xa0]+/g," ").trim())===N.Msg$$module$build$src$core$msg.RENAME_VARIABLE||e===N.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(e=null),i(e)})},iO=function(e,t,i){i=i.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let s=0,o;o=i[s];s++)if(o.getName().toLowerCase()===e&&o.getType()!==t)return o;return null},iA=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let i=0,s;s=t[i];i++)if(s.getName().toLowerCase()===e)return s;return null},iS=function(e,t,i){return i.getProcedureMap().getProcedures().length?iC(e,t,i):iL(e,t,i)},iC=function(e,t,i){for(let o of(e=e.toLowerCase(),t=t.toLowerCase(),i=i.getProcedureMap().getProcedures())){var s=o.getParameters().filter(ic).map(e=>e.getVariableModel().getName());if(s&&(i=s.some(t=>t.toLowerCase()===e),s=s.some(e=>e.toLowerCase()===t),i&&s))return o.getName()}return null},iL=function(e,t,i){for(let o of(e=e.toLowerCase(),t=t.toLowerCase(),i=i.getAllBlocks(!1))){if(!il(o))continue;var s=(i=o.getProcedureDef())[1];let n=s.some(t=>t.toLowerCase()===e);if(s=s.some(e=>e.toLowerCase()===t),n&&s)return i[0]}return null},iN=function(e){let t=N.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.getType()),e=N.createTextNode$$module$build$src$core$utils$xml(e.getName()),t.appendChild(e),t},N.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,t,i,s){let o=N.getVariable$$module$build$src$core$variables(e,t,i,s);return o||(o=ib(e,t,i,s)),o},N.getVariable$$module$build$src$core$variables=function(e,t,i,s){let o=e.getPotentialVariableMap(),n=null;if(t&&((n=e.getVariableById(t))||!o||(n=o.getVariableById(t)),n))return n;if(i){if(void 0===s)throw Error("Tried to look up a variable by name without a type");(n=e.getVariable(i,s))||!o||(n=o.getVariable(i,s))}return n},ib=function(e,t,i,s){let o=e.getVariableMap(),n=e.getPotentialVariableMap();return i||(i=ig(e.isFlyout?e.targetWorkspace:e)),n?n.createVariable(i,s,null!=t?t:void 0):o.createVariable(i,s,t)},i$=function(e,t){e=e.getAllVariables();let i=[];if(t.length!==e.length)for(let s=0;s<e.length;s++){let o=e[s];t.includes(o)||i.push(o)}return i},iD=function(e,t){return e.getName().localeCompare(t.getName(),void 0,{sensitivity:"base"})},iM=function(e,t){let i=[];e=e.getAllBlocks(!1);for(let s=0;s<e.length;s++){let o=e[s].getVarModels();if(o)for(let n=0;n<o.length;n++)o[n].getId()===t&&i.push(e[s])}return i},N.deleteVariable$$module$build$src$core$variables=function(e,t,i){var s=t.getName();let o=iM(e,t.getId());for(let e=o.length-1;0<=e;e--){let t=o[e];if("procedures_defnoreturn"===t.type||"procedures_defreturn"===t.type){i=String(t.getFieldValue("NAME")),is(s=N.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",s).replace("%2",i));return}t===i&&o.splice(e,1)}i&&o.length||1<o.length?io(s=N.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(o.length+(i&&!i.workspace.isFlyout?1:0))).replace("%2",s),i=>{i&&t&&e.getVariableMap().deleteVariable(t)}):e.getVariableMap().deleteVariable(t)},iP=function(e,{addCoordinates:t=!1,addInputBlocks:i=!0,addNextBlocks:s=!0,doFullSerialization:o=!0,saveIds:n=!0}={}){if(e.isInsertionMarker())return null;let r={type:e.type,id:n?e.id:void 0};return t&&ik(e,r),iy(e,r),iw(e,r,o),iv(e,r,o),iB(e,r,o),i&&iG(e,r,o,n),s&&iF(e,r,o,n),r},iy=function(e,t){e.isCollapsed()&&(t.collapsed=!0),e.isEnabled()||(t.disabledReasons=Array.from(e.getDisabledReasons())),e.isOwnDeletable()||(t.deletable=!1),e.isOwnMovable()||(t.movable=!1),e.isOwnEditable()||(t.editable=!1),void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},ik=function(e,t){let i=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(i.RTL?i.getWidth()-e.x:e.x),t.y=Math.round(e.y)},iw=function(e,t,i){e.saveExtraState?null!==(e=e.saveExtraState(i))&&(t.extraState=e):e.mutationToDom&&null!==(e=e.mutationToDom())&&(t.extraState=oT(e).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},iv=function(e,t,i){let s=Object.create(null);for(let t of e.getIcons())t3(t)&&(e=t.saveState(i))&&(s[t.getType().toString()]=e);Object.keys(s).length&&(t.icons=s)},iB=function(e,t,i){let s=Object.create(null);for(let t of e.getFields())t.isSerializable()&&(s[t.name]=t.saveState(i));Object.keys(s).length&&(t.fields=s)},iG=function(e,t,i,s){let o=Object.create(null);for(let t=0;t<e.inputList.length;t++){let n=e.inputList[t];if(!n.connection)continue;let r=ix(n.connection,i,s);r&&(o[n.name]=r)}Object.keys(o).length&&(t.inputs=o)},iF=function(e,t,i,s){e.nextConnection&&(e=ix(e.nextConnection,i,s))&&(t.next=e)},ix=function(e,t,i){let s=e.getShadowState(!0);if(e=e.targetBlock(),!s&&!e)return null;let o=Object.create(null);return s&&(o.shadow=s),e&&!e.isShadow()&&(o.block=iP(e,{doFullSerialization:t,saveIds:i})),o},iU=function(e,t,{recordUndo:i=!1}={}){return e=iH(e,t,{recordUndo:i}),t.rendered&&t4(),e},iH=function(e,t,{parentConnection:i,isShadow:s=!1,recordUndo:o=!1}={}){let n,r=ex();N.setRecordUndo$$module$build$src$core$events$utils(o),(o=N.getGroup$$module$build$src$core$events$utils())||N.setGroup$$module$build$src$core$events$utils(!0),N.disable$$module$build$src$core$events$utils();let l=t.getAllVariables();try{n=iW(e,t,{parentConnection:i,isShadow:s})}finally{N.enable$$module$build$src$core$events$utils()}if(iV(t,l),eX()&&eU(new(ej(rC.BLOCK_CREATE))(n)),N.setGroup$$module$build$src$core$events$utils(o),N.setRecordUndo$$module$build$src$core$events$utils(r),t.rendered){let e=n;setTimeout(()=>{e.disposed||e.setConnectionTracking(!0)},1)}return n},iW=function(e,t,{parentConnection:i,isShadow:s=!1}={}){if(!e.type)throw new ah(e);let o=t.newBlock(e.type,e.id);return o.setShadow(s),iK(o,e),iX(o,e),iY(o,e),iz(i,o,e),ij(o,e),iJ(o,e),iZ(o,e),iq(o,e),i0(o,t.rendered),o},iV=function(e,t){if(eX())for(e=i$(e,t),t=0;t<e.length;t++){let i=e[t];eU(new(ej(rC.VAR_CREATE))(i))}},iK=function(e,t){let i=void 0===t.x?0:t.x;t=void 0===t.y?0:t.y;let s=e.workspace;i=s.RTL?s.getWidth()-i:i,e.moveBy(i,t)},iX=function(e,t){if(t.collapsed&&e.setCollapsed(!0),!1===t.deletable&&e.setDeletable(!1),!1===t.movable&&e.setMovable(!1),!1===t.editable&&e.setEditable(!1),!1===t.enabled&&e.setDisabledReason(!0,lK),Array.isArray(t.disabledReasons))for(let i of t.disabledReasons)e.setDisabledReason(!0,i);void 0!==t.inline&&e.setInputsInline(t.inline),void 0!==t.data&&(e.data=t.data)},iY=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(N.textToDom$$module$build$src$core$utils$xml(t.extraState)))},iz=function(e,t,i){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new aE(i);if(e.type===N.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var s=t.outputConnection;if(!s)throw new au("output",t,i)}else if(!(s=t.previousConnection))throw new au("previous",t,i);if(!e.connect(s)){let o=t.workspace.connectionChecker;throw new ad(o.getErrorMessage(o.canConnectWithReason(s,e,!1),s,e),e.type===N.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",t,i)}}},ij=function(e,t){if(t.icons){var i=Object.keys(t.icons);for(let o of i){i=t.icons[o];var s=e.getIcon(o);if(!s){if(!(s=eE(M.ICON,o,!1)))throw new a_(o,e,t);s=new s(e),e.addIcon(s)}t3(s)&&s.loadState(i)}}},iJ=function(e,t){if(t.fields){var i=Object.keys(t.fields);for(let s=0;s<i.length;s++){let o=i[s],n=t.fields[o],r=e.getField(o);r?r.loadState(n):console.warn(`Ignoring non-existant field ${o} in block ${e.type}`)}}},iZ=function(e,t){if(t.inputs){var i=Object.keys(t.inputs);for(let s=0;s<i.length;s++){let o=i[s],n=e.getInput(o);if(!n||!n.connection)throw new au(o,e,t);iQ(n.connection,t.inputs[o])}}},iq=function(e,t){if(t.next){if(!e.nextConnection)throw new au("next",e,t);iQ(e.nextConnection,t.next)}},iQ=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&iW(t.block,e.getSourceBlock().workspace,{parentConnection:e})},i0=function(e,t){if(t)for(let t of(e.setConnectionTracking(!1),e.initSvg(),e.queueRender(),e.getIcons()))t.onLocationChange(e.getRelativeToSurfaceXY());else e.initModel()},i1=function(e){return void 0!==e.bubbleIsVisible&&void 0!==e.setBubbleVisible},i2=function(e){return e*Math.PI/180},i3=function(e,t,i){if(i<e){let t=i;i=e,e=t}return Math.max(e,Math.min(t,i))},i5=function(){document.querySelector(".blocklyDropDownDiv")||((a$=document.createElement("div")).className="blocklyDropDownDiv",a$.tabIndex=-1,(tu()||document.body).appendChild(a$),(aD=document.createElement("div")).className="blocklyDropDownContent",a$.appendChild(aD),aK=eS(aD,"keydown",null,tg),(aM=document.createElement("div")).className="blocklyDropDownArrow",a$.appendChild(aM),a$.style.opacity="0",a$.style.transition="transform "+av+"s, opacity "+av+"s")},i6=function(e){aU=e},i4=function(){return aH},i8=function(){return aD},i9=function(){aK&&(ef(aK),aK=null),a$.remove(),i5()},i7=function(e,t){a$.style.backgroundColor=e,a$.style.borderColor=t},se=function(e,t,i,s=!0){return aW=!0,ss(si(e),e,s,t,i)},st=function(e){var t=e.getSvgRoot();let i=e.workspace.scale,s=e.height*i;return e=e.width*i,new r9((t=tC(t)).y,t.y+s,t.x,t.x+e)},si=function(e){return new r9((e=e.getScaledBBox()).top,e.bottom,e.left,e.right)},ss=function(e,t,i,s,o){let n=e.left+(e.right-e.left)/2,r=e.bottom;e=e.top,o&&(e+=o);let l=(o=t.getSourceBlock()).workspace;for(;l.options.parentWorkspace;)l=l.options.parentWorkspace;return i6(l.getParentSvg().parentNode),so(t,o.RTL,n,r,n,e,i,s)},so=function(e,t,i,s,o,n,r,l){return aH=e,aG=l||null,a$.style.direction=t?"rtl":"ltr",aF=(e=tl()).getRenderer().getClassName(),ax=e.getTheme().getClassName(),eq(a$,aF),eq(a$,ax),i=sd(i,s,o,n),r&&(aV=N.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(a$)),i},sn=function(e,t,i,s){return{initialX:(e=sl(e,i.left,i.right,s.width)).divX,initialY:t,finalX:e.divX,finalY:t+aw,arrowX:e.arrowX,arrowY:-(aP/2+ay),arrowAtTop:!0,arrowVisible:!0}},sr=function(e,t,i,s){return{initialX:(e=sl(e,i.left,i.right,s.width)).divX,initialY:t-s.height,finalX:e.divX,finalY:t-s.height-aw,arrowX:e.arrowX,arrowY:s.height-2*ay-aP/2,arrowAtTop:!1,arrowVisible:!0}},sl=function(e,t,i,s){return t=i3(t,e-s/2,i-s),e=e-aP/2-t,{arrowX:e=i3(i=ak,e,s-i-aP),divX:t}},sa=function(){return!!aH},sc=function(e,t){return aH===e&&(t?su():sh(),!0)},sh=function(){a$.style.transform="translate(0, 0)",a$.style.opacity="0",aB=setTimeout(function(){su()},1e3*av),aG&&(aG(),aG=null)},su=function(){sa()&&(aB&&clearTimeout(aB),aG&&(aG(),aG=null),i9(),aH=null,tl().markFocused(),aV&&(aV(),aV=null))},sd=function(e,t,i,s){(e=aX.getPositionMetrics(e,t,i,s)).arrowVisible?(t=e.arrowX,i=e.arrowY,s=e.arrowAtTop?45:225,aM.style.display="",aM.style.transform=`translate(${t}px, ${i}px) rotate(${s}deg)`,aM.setAttribute("class","blocklyDropDownArrow")):aM.style.display="none",t=Math.floor(e.initialX),i=Math.floor(e.initialY),s=Math.floor(e.finalX);let o=Math.floor(e.finalY);return a$.style.left=t+"px",a$.style.top=i+"px",a$.style.display="block",a$.style.opacity="1",a$.style.transform="translate("+(s-t)+"px,"+(o-i)+"px)",!!e.arrowAtTop},sE=function(){if(aH){var e=aH.getSourceBlock();let t=(e=aW?si(aH):st(e)).left+(e.right-e.left)/2;sd(t,e.bottom,t,e.top)}else sh()},s_=function(e){return e.length?e.reduce(function(e,t){return e.length<t.length?e:t}).length:0},sT=function(e,t){let i;if(!e.length)return 0;if(1===e.length)return e[0].length;let s=0;for(i=0,t=t||s_(e);i<t;i++){for(var o=e[0][i],n=1;n<e.length;n++)if(o!==e[n][i])return s;" "===o&&(s=i+1)}for(o=1;o<e.length;o++)if((n=e[o][i])&&" "!==n)return s;return t},sp=function(e,t){let i;if(!e.length)return 0;if(1===e.length)return e[0].length;let s=0;for(i=0,t=t||s_(e);i<t;i++){for(var o=e[0].substr(-i-1,1),n=1;n<e.length;n++)if(o!==e[n].substr(-i-1,1))return s;" "===o&&(s=i+1)}for(o=1;o<e.length;o++)if((n=e[o].charAt(e[o].length-i-1))&&" "!==n)return s;return t},N.wrap$$module$build$src$core$utils$string=function(e,t){e=e.split("\n");for(let i=0;i<e.length;i++)e[i]=sg(e[i],t);return e.join("\n")},sg=function(e,t){if(e.length<=t)return e;let i=e.trim().split(/\s+/);for(var s=0;s<i.length;s++)i[s].length>t&&(t=i[s].length);var o=-1/0;let n,r=1;do{s=o,n=e,e=[],o=i.length/r;let l=1;for(let t=0;t<i.length-1;t++)l<(t+1.5)/o?(l++,e[t]=!0):e[t]=!1;e=sR(i,e,t),o=sI(i,e,t),e=sm(i,e),r++}while(o>s)return n},sI=function(e,t,i){let s=[0],o=[];for(var n=0;n<e.length;n++)s[s.length-1]+=e[n].length,!0===t[n]?(s.push(0),o.push(e[n].charAt(e[n].length-1))):!1===t[n]&&s[s.length-1]++;for(n=0,e=Math.max(...s),t=0;n<s.length;n++)t-=2*Math.pow(Math.abs(i-s[n]),1.5),t-=Math.pow(e-s[n],1.5),".?!".includes(o[n])?t+=i/3:",;)]}".includes(o[n])&&(t+=i/4);return 1<s.length&&s[s.length-1]<=s[s.length-2]&&(t+=.5),t},sR=function(e,t,i){let s=sI(e,t,i),o;for(let n=0;n<t.length-1;n++){if(t[n]===t[n+1])continue;let r=[].concat(t);r[n]=!r[n],r[n+1]=!r[n+1];let l=sI(e,r,i);l>s&&(s=l,o=r)}return o?sR(e,o,i):t},sm=function(e,t){let i=[];for(let s=0;s<e.length;s++)i.push(e[s]),void 0!==t[s]&&i.push(t[s]?"\n":" ");return i.join("")},N.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},sO=function(e){if(e=sA(e)){for(e=e.tooltip;"function"==typeof e;)e=e();if("string"!=typeof e)throw Error("Tooltip function must return a string.");return e}return""},sA=function(e){for(;e&&e.tooltip;){if("string"==typeof e.tooltip||"function"==typeof e.tooltip)return e;e=e.tooltip}return null},sS=function(){document.querySelector(".blocklyTooltipDiv")||((ce=document.createElement("div")).className="blocklyTooltipDiv",(tu()||document.body).appendChild(ce))},sC=function(e){e.mouseOverWrapper_=eC(e,"pointerover",null,sL),e.mouseOutWrapper_=eC(e,"pointerout",null,sN),e.addEventListener("pointermove",sb,!1)},sf=function(e){e&&(ef(e.mouseOverWrapper_),ef(e.mouseOutWrapper_),e.removeEventListener("pointermove",sb))},sL=function(e){aZ||(e=sA(e.currentTarget),a3!==e&&(sD(),a5=null,a3=e),clearTimeout(aQ))},sN=function(e){aZ||(aQ=setTimeout(function(){a5=a3=null,sD()},1),clearTimeout(a0),a0=0)},sb=function(e){if(a3&&a3.tooltip&&!aZ)if(aJ){let t=a1-e.pageX;Math.sqrt(t*t+(e=a2-e.pageY)*e)>a8&&sD()}else a5!==a3&&(clearTimeout(a0),a1=e.pageX,a2=e.pageY,a0=setTimeout(sv,a9))},s$=function(){a5=a3=null,sD()},sD=function(){aJ&&(aJ=!1,ce&&(ce.style.display="none")),a0&&(clearTimeout(a0),a0=0)},sM=function(){sD(),aZ=!0},sP=function(){aZ=!1},sy=function(){ce&&a3&&("function"==typeof aj?aj(ce,a3):sk())},sk=function(){var e=sO(a3);e=(e=N.wrap$$module$build$src$core$utils$string(e,aq)).split("\n");for(let t=0;t<e.length;t++){let i=document.createElement("div");i.appendChild(document.createTextNode(e[t])),ce.appendChild(i)}},sw=function(e){let t=document.documentElement.clientWidth,i=document.documentElement.clientHeight,s=a1;s=e?s-(a6+ce.offsetWidth):s+a6;let o=a2+a4;return o+ce.offsetHeight>i+window.scrollY&&(o-=ce.offsetHeight+2*a4),e?s=Math.max(a7-window.scrollX,s):s+ce.offsetWidth>t+window.scrollX-2*a7&&(s=t-ce.offsetWidth-2*a7),{x:s,y:o}},sv=function(){if(!aZ&&(a5=a3,ce)){ce.textContent="",sy();var e=a3.RTL;ce.style.direction=e?"rtl":"ltr",ce.style.display="block",aJ=!0;var{x:t,y:i}=sw(e);ce.style.left=t+"px",ce.style.top=i+"px"}},sB=function(){return ci},sG=function(){return cs},sF=function(e){var t=co[e=`${e}`.toLowerCase().trim()];if(t||(t="#"===(t="0x"===e.substring(0,2)?"#"+e.substring(2):e)[0]?t:"#"+t,/^#[0-9a-f]{6}$/.test(t)))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var i=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return i&&(e=Number(i[1]),t=Number(i[2]),i=Number(i[3]),0<=e&&256>e&&0<=t&&256>t&&0<=i&&256>i)?sx(e,t,i):null},sx=function(e,t,i){return t=e<<16|t<<8|i,16>e?"#"+(0x1000000|t).toString(16).substr(1):"#"+t.toString(16)},sU=function(e){return(e=sF(e))?[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]:[0,0,0]},sH=function(e,t,i){let s=0,o=0,n=0;if(0===t)n=o=s=i;else{let r=Math.floor(e/60),l=e/60-r;e=i*(1-t);let a=i*(1-t*l);switch(t=i*(1-t*(1-l)),r){case 1:s=a,o=i,n=e;break;case 2:s=e,o=i,n=t;break;case 3:s=e,o=a,n=i;break;case 4:s=t,o=e,n=i;break;case 5:s=i,o=e,n=a;break;case 6:case 0:s=i,o=t,n=e}}return sx(Math.floor(s),Math.floor(o),Math.floor(n))},sW=function(e,t,i){return(e=sF(e))&&(t=sF(t))?(e=sU(e),t=sU(t),sx(Math.round(t[0]+i*(e[0]-t[0])),Math.round(t[1]+i*(e[1]-t[1])),Math.round(t[2]+i*(e[2]-t[2])))):null},sV=function(e){return sH(e,ci,255*cs)},sK=function(e,t,i){let s=[];var o=e.split("");o.push("");var n=0;e=[];let r=null;for(let c=0;c<o.length;c++){var l=o[c];if(0===n)if("%"===l)(n=e.join(""))&&s.push(n),e.length=0,n=1;else if(i&&"\n"===l){let t=e.join("");t&&s.push(t),e.length=0,s.push(l)}else e.push(l);else if(1===n)"%"===l?(e.push(l),n=0):t&&"0"<=l&&"9">=l?(n=2,r=l,(l=e.join(""))&&s.push(l),e.length=0):"{"===l?n=3:(e.push("%",l),n=0);else if(2===n)if("0"<=l&&"9">=l)r+=l;else{var a=void 0;s.push(parseInt(null!=(a=r)?a:"",10)),c--,n=0}else 3===n&&(""===l?(e.splice(0,0,"%{"),c--,n=0):"}"!==l?e.push(l):(n=e.join(""),/[A-Z]\w*/i.test(n)&&(l=(l=n.toUpperCase()).startsWith("BKY_")?l.substring(4):null)&&l in N.Msg$$module$build$src$core$msg?"string"==typeof(n=N.Msg$$module$build$src$core$msg[l])?Array.prototype.push.apply(s,sK(n,t,i)):t?s.push(`${n}`):s.push(n):s.push("%{"+n+"}"),n=e.length=0))}for((t=e.join(""))&&s.push(t),a=[],e.length=0,o=0;o<s.length;o++)"string"!=typeof s[o]||i&&"\n"===s[o]?((t=e.join(""))&&a.push(t),e.length=0,a.push(s[o])):e.push(s[o]);return(t=e.join(""))&&a.push(t),e.length=0,a},sX=function(e){return sK(e,!0,!0)},sY=function(e){return"string"!=typeof e?e:(e=sK(e,!1,!1)).length?String(e[0]):""},sz=function(e){let t="string"==typeof e?sY(e):e;var i=Number(t);if(!isNaN(i)&&0<=i&&360>=i)return{hue:i,hex:sH(i,sB(),255*sG())};if(i=sF(t))return{hue:null,hex:i};throw i='Invalid colour: "'+t+'"',e!==t&&(i+=' (from "'+e+'")'),Error(i)},sj=function(){return ch},sJ=function(){let e=tu()||document.body,t=document.querySelector("div."+c_);t?ch=t:((ch=document.createElement("div")).className=c_,ch.tabIndex=-1),eS(ch,"keydown",null,tg),e.appendChild(ch)},sZ=function(e,t,i,s,o=!0){if(sq(),cu=e,cE=i,i=ch){var n,r;if(i.style.direction=t?"rtl":"ltr",i.style.display="block",!s&&e instanceof cl){let t;s=null==(t=e.getSourceBlock())?void 0:t.workspace}cd=null!=(n=s)?n:null,cT=(e=null!=(r=s)?r:tl()).getRenderer().getClassName(),cp=e.getTheme().getClassName(),cT&&eq(i,cT),cp&&eq(i,cp),o&&(cg=N.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(i))}},sq=function(){if(sQ()){cu=null;var e=ch;e&&(e.style.display="none",e.style.left="",e.style.top="",cE&&(cE(),cE=null),e.textContent="",cT&&(e0(e,cT),cT=""),cp&&(e0(e,cp),cp=""),tl().markFocused(),cg&&(cg(),cg=null))}},sQ=function(){return!!cu},s0=function(e){cu===e&&sq()},s1=function(e){let t=null===cd,i=e;for(;!t&&i;){if(i===e){t=!0;break}i=e.options.parentWorkspace}t&&sq()},s2=function(e,t,i){ch.style.left=e+"px",ch.style.top=t+"px",ch.style.height=i+"px"},s3=function(e,t,i,s){let o=s6(e,t,i);e=s5(e,t,i,s),0>o?s2(e,0,i.height+o):s2(e,o,i.height)},s5=function(e,t,i,s){return s?Math.min(Math.max(t.right-i.width,e.left),e.right-i.width):Math.max(Math.min(t.left,e.right-i.width),e.left)},s6=function(e,t,i){return t.bottom+i.height>=e.bottom?t.top-i.height:t.bottom},s4=function(){var e;!(null==(e=cu)||!e.repositionForWindowResize)&&cu.repositionForWindowResize()||sq()},s8=function(e){cR=e},s9=function(e,t,i,s,o){if(sZ(cm,i,oo,s),t.length){o||(e instanceof PointerEvent?o=new r4(e.clientX,e.clientY):(console.warn("Context menu opened with keyboard but no location given"),o=new r4(0,0)));var n=s7(t,i,e,o);cO=n,oe(n,i,o),setTimeout(function(){n.focus()},1),cR=null}else os()},s7=function(e,t,i,s){let o=new lU;o.setRole(lv.MENU);for(let n=0;n<e.length;n++){let r=e[n];if(r.separator){o.addChild(new lH);continue}let l=new lx(r.text);l.setRightToLeft(t),l.setRole(lv.MENUITEM),o.addChild(l),l.setEnabled(r.enabled),r.enabled&&l.onAction(function(e,t){os(),requestAnimationFrame(()=>{setTimeout(()=>{r.callback(r.scope,i,t,s)},0)})},{})}return o},oe=function(e,t,i){let s=tM();i=new r9(i.y+s.top,i.y+s.top,i.x+s.left,i.x+s.left),ot(e);let o=e.getSize();t&&(i.left+=o.width,i.right+=o.width,s.left+=o.width,s.right+=o.width),s3(s,i,o,t),e.focus()},ot=function(e){var t=sj();if(!t)throw Error("Attempting to create a context menu when widget div is null");eq(t=e.render(t),"blocklyContextMenu"),eS(t,"contextmenu",null,oi),e.focus()},oi=function(e){e.preventDefault(),e.stopPropagation()},os=function(){s0(cm),cR=null},oo=function(){cO&&(cO.dispose(),cO=null)},N.callbackFactory$$module$build$src$core$contextmenu=function(e,t){return()=>{let i;N.disable$$module$build$src$core$events$utils();try{i=t instanceof Element?og(t,e.workspace):iH(t,e.workspace);let s=e.getRelativeToSurfaceXY();s.x=e.RTL?s.x-N.config$$module$build$src$core$config.snapRadius:s.x+N.config$$module$build$src$core$config.snapRadius,s.y+=2*N.config$$module$build$src$core$config.snapRadius,i.moveBy(s.x,s.y)}finally{N.enable$$module$build$src$core$events$utils()}return eX()&&!i.isShadow()&&eU(new(ej(rC.BLOCK_CREATE))(i)),N.getFocusManager$$module$build$src$core$focus_manager().focusNode(i),i}},on=function(e,t){return t=eb(t,e.getParentSvg(),e.getInverseScreenCTM()),t.x/=e.scale,t.y/=e.scale,t},or=function(e,t,i){t=on(e,t),cN.set(e,r4.difference(i,t))},ol=function(e,t){if(t=on(e,t),!(e=cN.get(e)))throw Error("Drag not initialized");return r4.sum(e,t)},oa=function(e,t=!1){let i=N.createElement$$module$build$src$core$utils$xml("comment");t||i.setAttribute("id",e.id),t=e.workspace;let s=e.getRelativeToSurfaceXY();return s.x=t.RTL?t.getWidth()-s.x:s.x,i.setAttribute("x",`${s.x}`),i.setAttribute("y",`${s.y}`),i.setAttribute("w",`${e.getSize().width}`),i.setAttribute("h",`${e.getSize().height}`),e.getText()&&(i.textContent=e.getText()),e.isCollapsed()&&i.setAttribute("collapsed","true"),e.isOwnEditable()||i.setAttribute("editable","false"),e.isOwnMovable()||i.setAttribute("movable","false"),e.isOwnDeletable()||i.setAttribute("deletable","false"),i},oc=function(e){let t=N.createElement$$module$build$src$core$utils$xml("variables");for(let i=0;i<e.length;i++){let s=e[i],o=N.createElement$$module$build$src$core$utils$xml("variable");o.appendChild(N.createTextNode$$module$build$src$core$utils$xml(s.getName())),s.getType()&&o.setAttribute("type",s.getType()),o.id=s.getId(),t.appendChild(o)}return t},oh=function(e,t){if(e.isInsertionMarker()&&!(e=e.getChildren(!1)[0]))return new DocumentFragment;let i=0;if(e.workspace.RTL&&(i=e.workspace.getWidth()),t=oE(e,t),o$(t)){let s=e.getRelativeToSurfaceXY();t.setAttribute("x",String(Math.round(e.workspace.RTL?i-s.x:s.x))),t.setAttribute("y",String(Math.round(s.y)))}return t},ou=function(e){if(e.isSerializable()){let t=N.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},od=function(e,t){for(let i of e.getFields())(e=ou(i))&&t.appendChild(e)},oE=function(e,t){let i;if(e.isInsertionMarker())return(t=e.getChildren(!1)[0])?oE(t):new DocumentFragment;let s=N.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");if(s.setAttribute("type",e.type),t||(s.id=e.id),e.mutationToDom){var o=e.mutationToDom();o&&(o.hasChildNodes()||o.hasAttributes())&&s.appendChild(o)}if(od(e,s),o=e.getCommentText()){var n=e.getIcon(aI.COMMENT),r=n.getBubbleSize(),l=n.bubbleIsVisible();n=n.getBubbleLocation();var a=N.createElement$$module$build$src$core$utils$xml("comment");a.appendChild(N.createTextNode$$module$build$src$core$utils$xml(o)),a.setAttribute("pinned",`${l}`),a.setAttribute("h",`${r.height}`),a.setAttribute("w",`${r.width}`),n&&(a.setAttribute("x",`${e.workspace.RTL?e.workspace.getWidth()-(n.x+r.width):n.x}`),a.setAttribute("y",`${n.y}`)),s.appendChild(a)}for(e.data&&((o=N.createElement$$module$build$src$core$utils$xml("data")).appendChild(N.createTextNode$$module$build$src$core$utils$xml(e.data)),s.appendChild(o)),o=0;o<e.inputList.length;o++){r=e.inputList[o];var c=void 0;l=!0,r.type!==N.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&r.type!==N.inputTypes$$module$build$src$core$inputs$input_types.END_ROW&&(n=r.connection.targetBlock(),r.type===N.inputTypes$$module$build$src$core$inputs$input_types.VALUE?c=N.createElement$$module$build$src$core$utils$xml("value"):r.type===N.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(c=N.createElement$$module$build$src$core$utils$xml("statement")),!(a=r.connection.getShadowDom())||n&&n.isShadow()||c.appendChild(o_(a,t)),n&&(n=oE(n,t)).nodeType===rf.ELEMENT_NODE&&(c.appendChild(n),l=!1),c.setAttribute("name",r.name),l||s.appendChild(c))}return void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&s.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&s.setAttribute("collapsed","true"),e.isEnabled()||s.setAttribute("disabled-reasons",Array.from(e.getDisabledReasons()).map(encodeURIComponent).join(",")),e.isOwnDeletable()||s.setAttribute("deletable","false"),e.isOwnMovable()||s.setAttribute("movable","false"),e.isOwnEditable()||s.setAttribute("editable","false"),(c=e.getNextBlock())&&(o=oE(c,t)).nodeType===rf.ELEMENT_NODE&&((i=N.createElement$$module$build$src$core$utils$xml("next")).appendChild(o),s.appendChild(i)),!(e=e.nextConnection&&e.nextConnection.getShadowDom())||c&&c.isShadow()||i.appendChild(o_(e,t)),s},o_=function(e,t){let i=e=e.cloneNode(!0),s;for(;i;)if(t&&"shadow"===i.nodeName&&i.removeAttribute("id"),i.firstChild)i=i.firstChild;else{for(;i&&!i.nextSibling;){let e;s=i,i=i.parentNode,s.nodeType===rf.TEXT_NODE&&""===s.data.trim()&&(null==(e=i)?void 0:e.firstChild)!==s&&e2(s)}i&&(s=i,i=i.nextSibling,s.nodeType===rf.TEXT_NODE&&""===s.data.trim()&&e2(s))}return e},oT=function(e){return tw(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},N.domToWorkspace$$module$build$src$core$xml=function(e,t){let i=0;t.RTL&&(i=t.getWidth());let s=[];e6();let o=N.getGroup$$module$build$src$core$events$utils();o||N.setGroup$$module$build$src$core$events$utils(!0),t.setResizesEnabled&&t.setResizesEnabled(!1);let n=!0;try{for(let o=0,r;r=e.childNodes[o];o++){let e=r.nodeName.toLowerCase(),o=r;if("block"!==e&&("shadow"!==e||ex())){if("shadow"===e)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===e)op(o,t);else if("variables"===e){if(n)oI(o,t);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");n=!1}}else{let e,r,l=og(o,t);s.push(l.id);let a=parseInt(null!=(e=o.getAttribute("x"))?e:"10",10),c=parseInt(null!=(r=o.getAttribute("y"))?r:"10",10);isNaN(a)||isNaN(c)||l.moveBy(t.RTL?i-a:a,c,["create"]),n=!1}}}finally{N.setGroup$$module$build$src$core$events$utils(o),t.setResizesEnabled&&t.setResizesEnabled(!0),t.rendered&&t4(),e4()}return eU(new(ej(rC.FINISHED_LOADING))(t)),s},op=function(e,t){var i,s,o,n;let r,l,a=null!=(i=e.getAttribute("id"))?i:void 0;return(i=t.rendered?new cM(t,a):new cD(t,a)).setText(null!=(s=e.textContent)?s:""),s=parseInt(null!=(o=e.getAttribute("x"))?o:"",10),o=parseInt(null!=(r=e.getAttribute("y"))?r:"",10),isNaN(s)||isNaN(o)||(s=t.RTL?t.getWidth()-s:s,i.moveTo(new r4(s,o))),t=parseInt(null!=(n=e.getAttribute("w"))?n:"",10),n=parseInt(null!=(l=e.getAttribute("h"))?l:"",10),isNaN(t)||isNaN(n)||i.setSize(new r7(t,n)),"true"===e.getAttribute("collapsed")&&i.setCollapsed(!0),"false"===e.getAttribute("editable")&&i.setEditable(!1),"false"===e.getAttribute("movable")&&i.setMovable(!1),"false"===e.getAttribute("deletable")&&i.setDeletable(!1),i},N.domToBlock$$module$build$src$core$xml=function(e,t){return e=og(e,t),t.rendered&&t4(),e},og=function(e,t){let i;N.disable$$module$build$src$core$events$utils();var s=t.getAllVariables();try{if(i=oN(e,t),t.rendered){let e=i,s=i.getDescendants(!1);e.setConnectionTracking(!1);for(let e=s.length-1;0<=e;e--)s[e].initSvg();for(let e=s.length-1;0<=e;e--)s[e].queueRender();setTimeout(function(){e.disposed||e.setConnectionTracking(!0)},1),t.resizeContents()}else{let e=i.getDescendants(!1);for(let t=e.length-1;0<=t;t--)e[t].initModel()}}finally{N.enable$$module$build$src$core$events$utils()}if(eX()){for(e=i$(t,s),t=0;t<e.length;t++)s=e[t],eU(new(ej(rC.VAR_CREATE))(s));eU(new(ej(rC.BLOCK_CREATE))(i))}return i},oI=function(e,t){for(let s=0;s<e.children.length;s++){var i=e.children[s];let o=i.getAttribute("type"),n=i.getAttribute("id");if(!(i=i.textContent))break;t.getVariableMap().createVariable(i,null!=o?o:void 0,n)}},oR=function(e){let t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let i=0;i<e.children.length;i++){let s=e.children[i];if(s.nodeType!==rf.TEXT_NODE)switch(s.nodeName.toLowerCase()){case"mutation":t.mutation.push(s);break;case"comment":t.comment.push(s);break;case"data":t.data.push(s);break;case"title":case"field":t.field.push(s);break;case"value":case"statement":t.input.push(s);break;case"next":t.next.push(s);break;default:console.warn("Ignoring unknown tag: "+s.nodeName)}}return t},om=function(e,t){let i=!1;for(let s=0;s<e.length;s++){let o=e[s];t.domToMutation&&(t.domToMutation(o),t.initSvg&&(i=!0))}return i},oO=function(e,t){for(let i=0;i<e.length;i++){let s,o,n=e[i],r=n.textContent,l="true"===n.getAttribute("pinned"),a=parseInt(null!=(s=n.getAttribute("w"))?s:"50",10),c=parseInt(null!=(o=n.getAttribute("h"))?o:"50",10),h,u=parseInt(null!=(h=n.getAttribute("x"))?h:"",10),d,E=parseInt(null!=(d=n.getAttribute("y"))?d:"",10);t.setCommentText(r);let _=t.getIcon(aI.COMMENT);isNaN(a)||isNaN(c)||_.setBubbleSize(new r7(a,c)),_.setBubbleVisible(l),setTimeout(()=>{isNaN(u)||isNaN(E)||(u=t.workspace.RTL?t.workspace.getWidth()-(u+a):u,_.setBubbleLocation(new r4(u,E))),_.setBubbleVisible(l)},1)}},oA=function(e,t){for(let i=0;i<e.length;i++)t.data=e[i].textContent},oS=function(e,t){for(let i=0;i<e.length;i++){let s=e[i],o=s.getAttribute("name");o?ob(t,o,s):console.warn(`Ignoring unnamed field in block ${t.type}`)}},oC=function(e){let t=null,i=null;for(let s=0;s<e.childNodes.length;s++){let o=e.childNodes[s];o$(o)&&("block"===o.nodeName.toLowerCase()?t=o:"shadow"===o.nodeName.toLowerCase()&&(i=o))}return{childBlockElement:t,childShadowElement:i}},of=function(e,t,i,s){for(let n=0;n<e.length;n++){var o=e[n];let r=o.getAttribute("name"),l=r?i.getInput(r):null;if(!l){console.warn("Ignoring non-existent input "+r+" in block "+s);break}if((o=oC(o)).childBlockElement){if(!l.connection)throw TypeError("Input connection does not exist.");oN(o.childBlockElement,t,l.connection,!1)}if(o.childShadowElement){let e;null==(e=l.connection)||e.setShadowDom(o.childShadowElement)}}},oL=function(e,t,i){for(let s=0;s<e.length;s++){let o=oC(e[s]);if(o.childBlockElement){if(!i.nextConnection)throw TypeError("Next statement does not exist.");if(i.nextConnection.isConnected())throw TypeError("Next statement is already connected.");oN(o.childBlockElement,t,i.nextConnection,!0)}o.childShadowElement&&i.nextConnection&&i.nextConnection.setShadowDom(o.childShadowElement)}},oN=function(e,t,i,s){let o=e.getAttribute("type");if(!o)throw TypeError("Block type unspecified: "+e.outerHTML);var n,r=null!=(n=e.getAttribute("id"))?n:void 0;n=t.newBlock(o,r);let l=om((r=oR(e)).mutation,n);if(oO(r.comment,n),oA(r.data,n),i)if(s)if(n.previousConnection)i.connect(n.previousConnection);else throw TypeError("Next block does not have previous statement.");else if(n.outputConnection)i.connect(n.outputConnection);else if(n.previousConnection)i.connect(n.previousConnection);else throw TypeError("Child block does not have output or previous statement.");if(oS(r.field,n),of(r.input,t,n,o),oL(r.next,t,n),l&&n.initSvg(),(t=e.getAttribute("inline"))&&n.setInputsInline("true"===t),(t=e.getAttribute("disabled"))&&n.setDisabledReason("true"===t||"disabled"===t,lK),null!==(t=e.getAttribute("disabled-reasons")))for(var a of t.split(","))n.setDisabledReason(!0,decodeURIComponent(a));if((a=e.getAttribute("deletable"))&&n.setDeletable("true"===a),(a=e.getAttribute("movable"))&&n.setMovable("true"===a),(a=e.getAttribute("editable"))&&n.setEditable("true"===a),(a=e.getAttribute("collapsed"))&&n.setCollapsed("true"===a),"shadow"===e.nodeName.toLowerCase()){for(a=0,e=n.getChildren(!1);a<e.length;a++)if(!e[a].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");n.setShadow(!0)}return n},ob=function(e,t,i){let s=e.getField(t);s?s.fromXml(i):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},o$=function(e){return e.nodeType===rf.ELEMENT_NODE},oD=function(e,t){ea(M.FIELD,e,t)},N.fromJson$$module$build$src$core$field_registry=function(e){return cx.fromJsonInternal(e)},oM=function(e){return e&&"object"==typeof e&&"src"in e&&"string"==typeof e.src&&"alt"in e&&"string"==typeof e.alt&&"width"in e&&"number"==typeof e.width&&"height"in e&&"number"==typeof e.height},N.register$$module$build$src$core$extensions=function(e,t){if("string"!=typeof e||""===e.trim())throw Error('Error: Invalid extension name "'+e+'"');if(c1[e])throw Error('Error: Extension "'+e+'" is already registered.');if("function"!=typeof t)throw Error('Error: Extension "'+e+'" must be a function');c1[e]=t},N.registerMixin$$module$build$src$core$extensions=function(e,t){if(!t||"object"!=typeof t)throw Error('Error: Mixin "'+e+'" must be a object');N.register$$module$build$src$core$extensions(e,function(){this.mixin(t)})},N.registerMutator$$module$build$src$core$extensions=function(e,t,i,s){let o='Error when registering mutator "'+e+'": ';oB(o,t);let n=ow(t,o);if(i&&"function"!=typeof i)throw Error(o+'Extension "'+e+'" is not a function');N.register$$module$build$src$core$extensions(e,function(){n&&this.setMutator(new N.MutatorIcon$$module$build$src$core$icons$mutator_icon(s||[],this)),this.mixin(t),i&&i.apply(this)})},oP=function(e){return!!c1[e]},oy=function(e,t,i){let s,o=c1[e];if("function"!=typeof o)throw Error('Error: Extension "'+e+'" not found.');if(i?ok(e,t):s=oG(t),o.apply(t),i)oB('Error after applying mutator "'+e+'": ',t);else if(!oF(s,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},ok=function(e,t){if(oG(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},ow=function(e,t){return ov(e.compose,e.decompose,t+" compose/decompose")},ov=function(e,t,i){if(e&&t){if("function"!=typeof e||"function"!=typeof t)throw Error(i+" must be a function");return!0}if(!e&&!t)return!1;throw Error(i+"Must have both or neither functions")},oB=function(e,t){let i=ov(t.mutationToDom,t.domToMutation,e+" mutationToDom/domToMutation"),s=ov(t.saveExtraState,t.loadExtraState,e+" saveExtraState/loadExtraState");if(!i&&!s)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");ow(t,e)},oG=function(e){let t=[];return void 0!==e.domToMutation&&t.push(e.domToMutation),void 0!==e.mutationToDom&&t.push(e.mutationToDom),void 0!==e.saveExtraState&&t.push(e.saveExtraState),void 0!==e.loadExtraState&&t.push(e.loadExtraState),void 0!==e.compose&&t.push(e.compose),void 0!==e.decompose&&t.push(e.decompose),t},oF=function(e,t){if((t=oG(t)).length!==e.length)return!1;for(let i=0;i<t.length;i++)if(e[i]!==t[i])return!1;return!0},N.buildTooltipForDropdown$$module$build$src$core$extensions=function(e,t){let i=[];return function(){i.includes(this.type)||(ox(this,e,t),i.push(this.type)),this.setTooltip((function(){return sY(t[String(this.getFieldValue(e))])}).bind(this))}},ox=function(e,t,i){var s=e.getField(t);if(s instanceof cH&&!s.isOptionListDynamic())for(let o of s=s.getOptions())o!==cH.SEPARATOR&&([,s]=o,void 0===i[s]&&console.warn(`No tooltip mapping for value ${s} of field ${t} of block type ${e.type}.`))},N.buildTooltipWithFieldText$$module$build$src$core$extensions=function(e,t){return function(){this.setTooltip((function(){let i=this.getField(t);return sY(e).replace("%1",i?i.getText():"")}).bind(this))}},oU=function(e,t){return" "+e+","+t+" "},oH=function(e,t){return" "+e+t.join("")},oW=function(e,t){return" M "+e+","+t+" "},oV=function(e,t){return" m "+e+","+t+" "},oK=function(e,t){return" l "+e+","+t+" "},oX=function(e){return" l"+e.join("")},oY=function(e,t){return" "+e+" "+t+" "},oz=function(e,t,i,s){return e+" "+i+" "+i+" "+t+s},oj=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},oJ=function(e,t){let i=null,s=null==(t=t.outputConnection)?void 0:t.getConnectionChecker();for(let o=0,n;n=e.inputList[o];o++){let e=n.connection;if(e&&(null==s?0:s.canConnect(t,e,!1))){if(i)return null;i=e}}return i},oZ=function(e,t){let i;for(;i=oJ(e,t);)if(!(e=i.targetBlock())||e.isShadow())return i;return null},oq=function(e){return void 0!==e.getType&&void 0!==e.initView&&void 0!==e.dispose&&void 0!==e.getWeight&&void 0!==e.getSize&&void 0!==e.applyColour&&void 0!==e.hideForInsertionMarker&&void 0!==e.updateEditable&&void 0!==e.updateCollapsed&&void 0!==e.isShownWhenCollapsed&&void 0!==e.setOffsetInBlock&&void 0!==e.onLocationChange&&void 0!==e.onClick&&te(e)},oQ=function(e){if(!(100<e.getDescendants(!1).length)){var t,i=e.workspace,s=e.getSvgRoot();i.getAudioManager().play("delete");var o=e.getRelativeToSurfaceXY(),n=s.cloneNode(!0);n.setAttribute("transform","translate("+o.x+","+o.y+")"),null==(t=i.getLayerManager())||t.appendToAnimationLayer({getSvgRoot:()=>n}),o0(n,{x:o.x,y:o.y,width:e.width,height:e.height},i.RTL,new Date)}},o0=function(e,t,i,s){let o=((new Date).getTime()-s.getTime())/150;1<o?e2(e):(e.setAttribute("transform","translate("+(t.x+(i?-1:1)*t.width/2*o)+","+(t.y+t.height/2*o)+") scale("+(1-o)+")"),setTimeout(o0,10,e,t,i,s))},o1=function(e){var t=e.workspace;let i=t.scale;if(t.getAudioManager().play("click"),!(1>i)){var s=t.getSvgXY(e.getSvgRoot());e.outputConnection?(s.x+=(e.RTL?3:-3)*i,s.y+=13*i):e.previousConnection&&(s.x+=(e.RTL?-23:23)*i,s.y+=3*i);var o=eZ(r8.CIRCLE,{cx:s.x,cy:s.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg());e=eZ(r8.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*i},o),t=eZ(r8.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},o),e.beginElement(),t.beginElement(),setTimeout(()=>void e2(o),150)}},o2=function(e){if(o5(),e.workspace.getAudioManager().play("disconnect"),!(1>e.workspace.scale)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),hu=e,o3(e,t,new Date,0)}},o3=function(e,t,i,s){let o=[.66,1,.66,0,-.66,-1,-.66,0],n="";i.getTime()+200>(new Date).getTime()&&(n=`skewX(${Math.round(o[s%o.length]*t)})`,hh=setTimeout(o3,15,e,t,i,s+1)),e.getSvgRoot().setAttribute("transform",`${e.getTranslation()} ${n}`)},o5=function(){hu&&(hh&&(clearTimeout(hh),hh=null),hu.getSvgRoot().setAttribute("transform",hu.getTranslation()),hu=null)},o6=function(e,t){let i=e.workspace,s=N.config$$module$build$src$core$config.snapRadius,o=r4.difference(t,e.getRelativeToSurfaceXY()),n=new r4(0,0),r=i.getAllBlocks(!1).filter(t=>t.id!=e.id).map(e=>e.getRelativeToSurfaceXY());for(;o4(r4.sum(t,n),r)||o8(e,r4.sum(o,n),s);)i.RTL?n.translate(-s,2*s):n.translate(s,2*s);e.moveTo(r4.sum(t,n))},o4=function(e,t){return t.some(t=>1>=Math.abs(t.x-e.x)&&1>=Math.abs(t.y-e.y))},o8=function(e,t,i){return e.getConnections_(!1).some(e=>!!e.closest(i,t).connection)},o9=function(e,t,i){let s=i.getBoundingRectangle(),o=s.right-s.left,n=i3(t.top,s.top,t.top+t.height-(s.bottom-s.top))-s.top,r=t.left;return t=t.left+t.width-o,e.RTL?r=Math.min(t,r):t=Math.max(r,t),(!!(e=i3(r,s.left,t)-s.left)||!!n)&&(i.moveBy(e,n,["inbounds"]),!0)},o7=function(e){return t=>{var i,s=e.getMetricsManager();if(s.hasFixedEdges()&&!e.isDragging())if(z.includes(null!=(i=t.type)?i:"")){i=s.getScrollMetrics(!0);let o=ne(e,t);o&&(s=N.getGroup$$module$build$src$core$events$utils()||!1,N.setGroup$$module$build$src$core$events$utils(t.group),o9(e,i,o)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),N.setGroup$$module$build$src$core$events$utils(s))}else eF(t)&&t.scale&&t.oldScale&&t.scale>t.oldScale&&nt(e)}},ne=function(e,t){let i=null;switch(t.type){case rC.BLOCK_CREATE:case rC.BLOCK_MOVE:(i=e.getBlockById(t.blockId))&&(i=i.getRootBlock());break;case rC.COMMENT_CREATE:case rC.COMMENT_MOVE:case rC.COMMENT_RESIZE:i=e.getCommentById(t.commentId)}return i},nt=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(!0);var i=e.getTopBoundedElements();for(let s=0,o;o=i[s];s++)o9(e,t,o)}},ni=function(e){return void 0!==e.isDeletable&&void 0!==e.dispose&&void 0!==e.setDeleteStyle},ns=function(e){let t=e.getIcons();for(let i of e.inputList){let e;if(i.isVisible())if(t.push(...i.fieldRow),null==(e=i.connection)?0:e.targetBlock())t.push(i.connection.targetBlock());else{let e;(null==(e=i.connection)?void 0:e.type)===cX.INPUT_VALUE&&t.push(i.connection)}}return t},no=function(e,t){let i=e.workspace.getTopBlocks(!0);e=i.indexOf(e.getRootBlock())+t;let s=null;if(0<=e&&e<i.length?s=i[e]:0>e?s=i[i.length-1]:e>=i.length&&(s=i[0]),0>t&&s){let e,t;return null!=(t=null==(e=s.lastConnectionInStack(!1))?void 0:e.getSourceBlock())?t:s}return s},nn=function(e,t){var i=e instanceof hR?e.outputConnection.targetBlock():e.getSourceBlock();return i instanceof hR&&-1!==(e=(i=ns(i)).indexOf(e))&&0<=(t=e+t)&&t<i.length?i[t]:null},nr=function(e){return void 0!==e.getRelativeToSurfaceXY&&void 0!==e.isMovable&&void 0!==e.startDrag&&void 0!==e.drag&&void 0!==e.endDrag&&void 0!==e.revertDrag},nl=function(e){return void 0!==e.autoHide},na=function(e,t){ea(M.ICON,e.toString(),t)},nc=function(e){return void 0!==e.getProcedureModel&&void 0!==e.doProcedureUpdate&&void 0!==e.isProcedureDef},nh=function(e){return void 0!==e.startPublishing&&void 0!==e.stopPublishing},nu=function(e){let t=e.getProcedureMap().getProcedures().filter(e=>!e.getReturnTypes()).map(e=>[e.getName(),e.getParameters().map(e=>e.getName()),!1]);e.getBlocksByType("procedures_defnoreturn",!1).forEach(e=>{!nc(e)&&il(e)&&t.push(e.getProcedureDef())});let i=e.getProcedureMap().getProcedures().filter(e=>!!e.getReturnTypes()).map(e=>[e.getName(),e.getParameters().map(e=>e.getName()),!0]);return e.getBlocksByType("procedures_defreturn",!1).forEach(e=>{!nc(e)&&il(e)&&i.push(e.getProcedureDef())}),t.sort(nd),i.sort(nd),[t,i]},nd=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},N.findLegalName$$module$build$src$core$procedures=function(e,t){if(t.isInFlyout)return e;for(e=e||N.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!nE(e,t.workspace,t);){let t=e.match(/^(.*?)(\d+)$/);e=t?t[1]+(parseInt(t[2])+1):e+"2"}return e},nE=function(e,t,i){return!n_(e,t,i)},n_=function(e,t,i){for(let s of t.getAllBlocks(!1))if(s!==i&&il(s)&&N.Names$$module$build$src$core$names.equals(s.getProcedureDef()[0],e))return!0;for(let s of(i=i&&nc(i)?null==i?void 0:i.getProcedureModel():void 0,t.getProcedureMap().getProcedures()))if(s!==i&&N.Names$$module$build$src$core$names.equals(s.getName(),e))return!0;return!1},N.rename$$module$build$src$core$procedures=function(e){var t=this.getSourceBlock();if(!t)throw new ca;e=e.trim();let i=N.findLegalName$$module$build$src$core$procedures(e,t);nc(t)&&!t.isInsertionMarker()&&t.getProcedureModel().setName(i);let s=this.getValue();if(s!==e&&s!==i)for(e=t.workspace.getAllBlocks(!1),t=0;t<e.length;t++){let o=e[t];o.renameProcedure&&o.renameProcedure(s,i)}return i},nT=function(e){function t(e,t){for(let o=0;o<e.length;o++){var s=e[o][0];let n=e[o][1],r=N.createElement$$module$build$src$core$utils$xml("block");r.setAttribute("type",t),r.setAttribute("gap","16");let l=N.createElement$$module$build$src$core$utils$xml("mutation");for(l.setAttribute("name",s),r.appendChild(l),s=0;s<n.length;s++){let e=N.createElement$$module$build$src$core$utils$xml("arg");e.setAttribute("name",n[s]),l.appendChild(e)}i.push(r)}}let i=[];if(y.procedures_defnoreturn){var s=N.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","procedures_defnoreturn"),s.setAttribute("gap","16");var o=N.createElement$$module$build$src$core$utils$xml("field");o.setAttribute("name","NAME"),o.appendChild(N.createTextNode$$module$build$src$core$utils$xml(N.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),s.appendChild(o),i.push(s)}return y.procedures_defreturn&&((s=N.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defreturn"),s.setAttribute("gap","16"),(o=N.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),o.appendChild(N.createTextNode$$module$build$src$core$utils$xml(N.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),s.appendChild(o),i.push(s)),y.procedures_ifreturn&&((s=N.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_ifreturn"),s.setAttribute("gap","16"),i.push(s)),i.length&&i[i.length-1].setAttribute("gap","24"),t((e=nu(e))[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),i},np=function(e){return ng(e,!1)},ng=function(e,t=!0){function i(e,t){for(let[i,o]of e)s.push({kind:"block",type:t,gap:16,extraState:{name:i,params:o}})}if(t)return ih("The XML return value of Blockly.Procedures.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),nT(e);let s=[];return y.procedures_defnoreturn&&s.push({kind:"block",type:"procedures_defnoreturn",gap:16,fields:{NAME:N.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE}}),y.procedures_defreturn&&s.push({kind:"block",type:"procedures_defreturn",gap:16,fields:{NAME:N.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE}}),y.procedures_ifreturn&&s.push({kind:"block",type:"procedures_ifreturn",gap:16}),s.length&&(s[s.length-1].gap=24),i((e=nu(e))[0],"procedures_callnoreturn"),i(e[1],"procedures_callreturn"),s},nI=function(e){var t=[],i=e.getBlocksByType("procedures_mutatorarg",!1);for(let e=0,s;s=i[e];e++)t.push(s.getFieldValue("NAME"));i=N.createElement$$module$build$src$core$utils$xml("xml");let s=N.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","procedures_mutatorarg");let o=N.createElement$$module$build$src$core$utils$xml("field");o.setAttribute("name","NAME"),t=iI(N.DEFAULT_ARG$$module$build$src$core$procedures,t),t=N.createTextNode$$module$build$src$core$utils$xml(t),o.appendChild(t),s.appendChild(o),i.appendChild(s),e.updateToolbox(i)},nR=function(e){if(eG(e)&&"mutator"===e.bubbleType&&e.isOpen&&e.blockId){var t=(e=ts(e.workspaceId).getBlockById(e.blockId)).type;("procedures_defnoreturn"===t||"procedures_defreturn"===t)&&(nI(e=e.getIcon(N.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace()),e.addChangeListener(nm))}},nm=function(e){(eP(e)||ey(e)||ek(e)||ew(e))&&nI(e=ts(e.workspaceId))},nO=function(e,t){return t.getAllBlocks(!1).filter(t=>nA(t,e)||ia(t)&&N.Names$$module$build$src$core$names.equals(t.getProcedureCall(),e))},nA=function(e,t){return nc(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&N.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),t)},N.mutateCallers$$module$build$src$core$procedures=function(e){let t=ex();var i=e.getProcedureDef()[0];let s=e.mutationToDom(!0);e=nO(i,e.workspace);for(let n=0,r;r=e[n];n++){i=(i=r.mutationToDom())&&tw(i),r.domToMutation&&r.domToMutation(s);var o=r.mutationToDom();i!==(o=o&&tw(o))&&(N.setRecordUndo$$module$build$src$core$events$utils(!1),eU(new(ej(rC.BLOCK_CHANGE))(r,"mutation",null,i,o)),N.setRecordUndo$$module$build$src$core$events$utils(t))}},N.getDefinition$$module$build$src$core$procedures=function(e,t){for(let i of t.getAllBlocks(!1))if(nc(i)&&i.isProcedureDef()&&N.Names$$module$build$src$core$names.equals(i.getProcedureModel().getName(),e)||il(i)&&N.Names$$module$build$src$core$names.equals(i.getProcedureDef()[0],e))return i;return null},nS=function(e){return e.isDynamic},nC=function(e){return void 0!==e.pathDown&&void 0!==e.pathUp},nf=function(e){return void 0!==e.pathLeft&&void 0!==e.pathRight},nL=function(e,t){ea(M.RENDERER,e,t)},nN=function(e,t,i){return(e=new(eE(M.RENDERER,e))(e)).init(t,i),e},nb=function(e){iR(e.getTargetWorkspace(),void 0,"String")},n$=function(e){iR(e.getTargetWorkspace(),void 0,"Number")},nD=function(e){iR(e.getTargetWorkspace(),void 0,"Colour")},nM=function(e){return nP(e,!1)},nP=function(e,t=!0){return(y.variables_set_dynamic||y.variables_get_dynamic||console.warn("There are no dynamic variable blocks, but there is a dynamic variable category."),t)?(ih("The XML return value of Blockly.VariablesDynamic.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),ny(e)):(e.registerButtonCallback("CREATE_VARIABLE_STRING",nb),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",n$),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",nD),[{kind:"button",text:N.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE,callbackkey:"CREATE_VARIABLE_STRING"},{kind:"button",text:N.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE,callbackkey:"CREATE_VARIABLE_NUMBER"},{kind:"button",text:N.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE,callbackkey:"CREATE_VARIABLE_COLOUR"},...i_(e,e.getVariableMap().getAllVariables(),!1,"variables_get_dynamic","variables_set_dynamic")])},ny=function(e){let t=[],i=document.createElement("button");return i.setAttribute("text",N.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(i),(i=document.createElement("button")).setAttribute("text",N.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(i),(i=document.createElement("button")).setAttribute("text",N.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(i),e.registerButtonCallback("CREATE_VARIABLE_STRING",nb),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",n$),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",nD),t.concat(e=nk(e))},nk=function(e){e=e.getVariableMap().getAllVariables();let t=[];if(0<e.length){if(y.variables_set_dynamic){var i=e[e.length-1];let s=N.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","variables_set_dynamic"),s.setAttribute("gap","24"),s.appendChild(iN(i)),t.push(s)}if(y.variables_get_dynamic){e.sort(iD);for(let s=0,o;o=e[s];s++)(i=N.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get_dynamic"),i.setAttribute("gap","8"),i.appendChild(iN(o)),t.push(i)}}return t},nw=function(e,t,i){return e&&t?nv(e,t,i):uj&&uJ?nv(uj,uJ):null},nv=function(e,t,i){let s,o,n;return t=t.isMutator?t:null!=(s=t.getRootWorkspace())?s:t,null!=(n=null==(o=e_(M.PASTER,e.paster,!1))?void 0:o.paste(e,t,i))?n:null},nB=function(e){return void 0!==e.toCopyData},nG=function(){rG.registry.register({name:dy.ESCAPE,preconditionFn:e=>!e.isReadOnly(),callback:e=>(e.hideChaff(),!0),keyCodes:[dD.ESC]})},nF=function(){rG.registry.register({name:dy.DELETE,preconditionFn:(e,t)=>(t=t.focusedNode,!e.isReadOnly()&&null!=t&&ni(t)&&t.isDeletable()&&!hK.inProgress()&&!N.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()),callback:(e,t,i,s)=>(t.preventDefault(),(e=s.focusedNode)instanceof hR?e.checkAndDelete():ni(e)&&e.isDeletable()&&(N.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),N.setGroup$$module$build$src$core$events$utils(!1)),!0),keyCodes:[dD.DELETE,dD.BACKSPACE]})},nx=function(e){return e instanceof hR&&nB(e)&&ni(e)&&e.isOwnDeletable()&&nr(e)&&e.isOwnMovable()},nU=function(){let e=rG.registry.createSerializedKey(dD.C,[dD.CTRL]),t=rG.registry.createSerializedKey(dD.C,[dD.META]);rG.registry.register({name:dy.COPY,preconditionFn:(e,t)=>(t=t.focusedNode)instanceof hR&&(e=e.isFlyout?e.targetWorkspace:e,!!t&&!!e&&!e.isReadOnly()&&!e.isDragging()&&!N.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&nx(t)),callback:(e,t,i,s)=>(t.preventDefault(),!!(t=s.focusedNode)&&!!nx(t)&&!!(e=(e=t.workspace instanceof uf?t.workspace:e).isFlyout?e.targetWorkspace:e)&&(t.workspace.isFlyout||e.hideChaff(),uq=t.toCopyData(),uQ=e,u0=nr(t)&&t.workspace==e?t.getRelativeToSurfaceXY():null,!!uq)),keyCodes:[e,t]})},nH=function(){let e=rG.registry.createSerializedKey(dD.X,[dD.CTRL]),t=rG.registry.createSerializedKey(dD.X,[dD.META]);rG.registry.register({name:dy.CUT,preconditionFn(e,t){var i;return!!(t=t.focusedNode)&&!e.isReadOnly()&&!e.isDragging()&&!N.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&(i=t)instanceof hR&&nB(i)&&ni(i)&&i.isDeletable()&&nr(i)&&i.isMovable()},callback:(e,t,i,s)=>(t=s.focusedNode)instanceof hR?(uq=t.toCopyData(),uQ=e,u0=t.getRelativeToSurfaceXY(),t.checkAndDelete(),!0):!!(ni(t)&&t.isDeletable()&&nB(t))&&(uq=t.toCopyData(),uQ=e,u0=nr(t)?t.getRelativeToSurfaceXY():null,t.dispose(),!0),keyCodes:[e,t]})},nW=function(){let e=rG.registry.createSerializedKey(dD.V,[dD.CTRL]),t=rG.registry.createSerializedKey(dD.V,[dD.META]);rG.registry.register({name:dy.PASTE,preconditionFn:e=>(e=e.isFlyout?e.targetWorkspace:e,!!uq&&!!e&&!e.isReadOnly()&&!e.isDragging()&&!N.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()),callback(e,t){if(!uq||!uQ)return!1;if(t instanceof PointerEvent)return e=ty(uQ,new r4(t.clientX,t.clientY)),!!nw(uq,uQ,e);if(!u0)return!!nw(uq,uQ);let{left:i,top:s,width:o,height:n}=uQ.getMetricsManager().getViewMetrics(!0);return new r9(s,s+n,i,i+o).contains(u0.x,u0.y)?!!nw(uq,uQ):(e=new r4(i+o/2,s+n/2),!!nw(uq,uQ,e))},keyCodes:[e,t]})},nV=function(){let e=rG.registry.createSerializedKey(dD.Z,[dD.CTRL]),t=rG.registry.createSerializedKey(dD.Z,[dD.META]);rG.registry.register({name:dy.UNDO,preconditionFn:e=>!e.isReadOnly()&&!hK.inProgress()&&!N.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken(),callback:(e,t)=>(e.hideChaff(),e.undo(!1),t.preventDefault(),!0),keyCodes:[e,t]})},nK=function(){let e=rG.registry.createSerializedKey(dD.Z,[dD.SHIFT,dD.CTRL]),t=rG.registry.createSerializedKey(dD.Z,[dD.SHIFT,dD.META]),i=rG.registry.createSerializedKey(dD.Y,[dD.CTRL]);rG.registry.register({name:dy.REDO,preconditionFn:e=>!hK.inProgress()&&!e.isReadOnly()&&!N.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken(),callback:(e,t)=>(e.hideChaff(),e.undo(!0),t.preventDefault(),!0),keyCodes:[e,t,i]})},nX=function(){nG(),nF(),nU(),nH(),nW(),nV(),nK()},nY=function(e){let t=e.saveState();return e.getParameters().length&&(t.parameters=e.getParameters().map(e=>e.saveState())),t},nz=function(e,t,i,s){if(e=e.loadState(i,s),!i.parameters)return e;for(let[o,n]of i.parameters.entries())e.insertParameter(t.loadState(n,s),o);return e},nj=function(e,t){e.setAttribute("dir","LTR"),tm(t.hasCss,t.pathToMedia);let i=eZ(r8.SVG,{xmlns:rL,"xmlns:html":rN,"xmlns:xlink":rb,version:"1.1",class:"blocklySvg"},e),s=eZ(r8.DEFS,{},i),o=String(Math.random()).substring(2);return t.gridPattern=hX.createDom(o,t.gridOptions,s,e),i},nJ=function(e,t,i){i.parentWorkspace=null;let s=(i=new uf(i)).options;i.scale=s.zoomOptions.startScale,t.appendChild(i.createDom("blocklyMainBackground",e));var o=i.getRenderer().getClassName();return o&&eq(e,o),(o=i.getTheme().getClassName())&&eq(e,o),!s.hasCategories&&s.languageTree&&e3(e=i.addFlyout(r8.SVG),t),s.hasTrashcan&&i.addTrashcan(),s.zoomOptions&&s.zoomOptions.controls&&i.addZoomControls(),i.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),i.translate(0,0),i.addChangeListener(o7(i)),tE(i),sJ(),i5(),sS(),i},nZ=function(e){let t=e.options;var i=e.getParentSvg();if(eS(i.parentNode,"contextmenu",null,function(e){eL(e)||e.preventDefault()}),i=eS(window,"resize",null,function(){sD(),e.hideComponents(!0),sE(),s4(),tE(e),nt(e)}),e.setResizeHandlerWrapper(i),nq(),t.languageTree){i=e.getToolbox();let s=e.getFlyout(!0);i?i.init():s&&(s.init(e),s.show(t.languageTree),"function"==typeof s.scrollToStart&&s.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new hG(e,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.horizontal,!0===t.moveOptions.scrollbars||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&nQ(t.pathToMedia,e)},nq=function(){dE||(eS(document,"scroll",null,function(){let e=to();for(let t=0,i;i=e[t];t++)i instanceof uf&&i.updateInverseScreenCTM()}),eC(document,"touchend",null,eI),eC(document,"touchcancel",null,eI)),dE=!0},nQ=function(e,t){function i(){for(;o.length;){let e=o.pop();e&&ef(e)}s.preload()}let s=t.getAudioManager();s.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),s.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),s.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");let o=[];o.push(eS(document,"pointermove",null,i,!0)),o.push(eS(document,"touchstart",null,i,!0))},n0=function(){cS.registry.register({displayText:()=>N.Msg$$module$build$src$core$msg.UNDO,preconditionFn:e=>0<e.workspace.getUndoStack().length?"enabled":"disabled",callback(e){e.workspace.undo(!1)},scopeType:cS.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},n1=function(){cS.registry.register({displayText:()=>N.Msg$$module$build$src$core$msg.REDO,preconditionFn:e=>0<e.workspace.getRedoStack().length?"enabled":"disabled",callback(e){e.workspace.undo(!0)},scopeType:cS.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},n2=function(){cS.registry.register({displayText:()=>N.Msg$$module$build$src$core$msg.CLEAN_UP,preconditionFn:e=>e.workspace.isMovable()?1<e.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden",callback(e){e.workspace.cleanUp()},scopeType:cS.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},n3=function(e,t){function i(t){o--,t.setCollapsed(e),0===o&&N.setGroup$$module$build$src$core$events$utils(!1)}let s=0,o=0;N.setGroup$$module$build$src$core$events$utils(!0);for(let e=0;e<t.length;e++){let n=t[e];for(;n;)o++,setTimeout(i.bind(null,n),s),n=n.getNextBlock(),s+=10}},n5=function(){cS.registry.register({displayText:()=>N.Msg$$module$build$src$core$msg.COLLAPSE_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let i=e[t];for(;i;){if(!i.isCollapsed())return"enabled";i=i.getNextBlock()}}return"disabled"}return"hidden"},callback(e){n3(!0,e.workspace.getTopBlocks(!0))},scopeType:cS.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},n6=function(){cS.registry.register({displayText:()=>N.Msg$$module$build$src$core$msg.EXPAND_ALL,preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let i=e[t];for(;i;){if(i.isCollapsed())return"enabled";i=i.getNextBlock()}}return"disabled"}return"hidden"},callback(e){n3(!1,e.workspace.getTopBlocks(!0))},scopeType:cS.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},n4=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(!1));else{e=e.getChildren(!1);for(let i=0;i<e.length;i++)n4(e[i],t)}},n8=function(e){let t=[];e=e.getTopBlocks(!0);for(let i=0;i<e.length;i++)n4(e[i],t);return t},n9=function(e,t){t?N.setGroup$$module$build$src$core$events$utils(t):(N.setGroup$$module$build$src$core$events$utils(!0),t=N.getGroup$$module$build$src$core$events$utils());let i=e.shift();i&&(i.isDeadOrDying()?n9(e,t):(i.dispose(!1,!0),setTimeout(n9,10,e,t))),N.setGroup$$module$build$src$core$events$utils(!1)},n7=function(){cS.registry.register({displayText:e=>e.workspace?1===(e=n8(e.workspace).length)?N.Msg$$module$build$src$core$msg.DELETE_BLOCK:N.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`):"",preconditionFn:e=>e.workspace&&0<n8(e.workspace).length?"enabled":"disabled",callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=n8(e.workspace);2>t.length?n9(t):io(N.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),function(e){e&&n9(t)})}},scopeType:cS.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},re=function(){n0(),n1(),n2(),n5(),n6(),n7()},rt=function(){cS.registry.register({displayText:()=>N.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden",callback(e){if(e.block){var t=e.block.toCopyData();t&&nw(t,e.block.workspace)}},scopeType:cS.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},ri=function(){cS.registry.register({displayText:e=>e.block.hasIcon(hZ.TYPE)?N.Msg$$module$build$src$core$msg.REMOVE_COMMENT:N.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>!(e=e.block).isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden",callback(e){(e=e.block).hasIcon(hZ.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:cS.ScopeType.BLOCK,id:"blockComment",weight:2})},rs=function(){cS.registry.register({displayText:e=>e.block.getInputsInline()?N.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:N.Msg$$module$build$src$core$msg.INLINE_INPUTS,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.isMovable()&&!e.isCollapsed()){for(let t=1;t<e.inputList.length;t++)if(!(e.inputList[t-1]instanceof dn||e.inputList[t]instanceof dn))return"enabled"}return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:cS.ScopeType.BLOCK,id:"blockInline",weight:3})},ro=function(){cS.registry.register({displayText:e=>e.block.isCollapsed()?N.Msg$$module$build$src$core$msg.EXPAND_BLOCK:N.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK,preconditionFn:e=>!(e=e.block).isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden",callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:cS.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},rn=function(){cS.registry.register({displayText:e=>e.block.hasDisabledReason(lK)?N.Msg$$module$build$src$core$msg.ENABLE_BLOCK:N.Msg$$module$build$src$core$msg.DISABLE_BLOCK,preconditionFn(e){if(!(e=e.block).isInFlyout&&e.workspace.options.disable&&e.isEditable()){var t=e.getDisabledReasons();return t=t.size>+!!t.has(lK),e.getInheritedDisabled()||t?"disabled":"enabled"}return"hidden"},callback(e){e=e.block;let t=N.getGroup$$module$build$src$core$events$utils();t||N.setGroup$$module$build$src$core$events$utils(!0),e.setDisabledReason(!e.hasDisabledReason(lK),lK),N.setGroup$$module$build$src$core$events$utils(t)},scopeType:cS.ScopeType.BLOCK,id:"blockDisable",weight:5})},rr=function(){cS.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(!1).length,(t=t.getNextBlock())&&(e-=t.getDescendants(!1).length),1===e?N.Msg$$module$build$src$core$msg.DELETE_BLOCK:N.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`)},preconditionFn:e=>!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden",callback(e){e.block&&e.block.checkAndDelete()},scopeType:cS.ScopeType.BLOCK,id:"blockDelete",weight:6})},rl=function(){cS.registry.register({displayText:()=>N.Msg$$module$build$src$core$msg.HELP,preconditionFn:e=>("function"==typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden",callback(e){e.block.showHelp()},scopeType:cS.ScopeType.BLOCK,id:"blockHelp",weight:7})},ra=function(){cS.registry.register({displayText:()=>N.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(e){let t;return(null==(t=e.comment)?0:t.isDeletable())?"enabled":"hidden"},callback(e){let t;N.setGroup$$module$build$src$core$events$utils(!0),null==(t=e.comment)||t.dispose(),N.setGroup$$module$build$src$core$events$utils(!1)},scopeType:cS.ScopeType.COMMENT,id:"commentDelete",weight:6})},rc=function(){cS.registry.register({displayText:()=>N.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(e){let t;return(null==(t=e.comment)?0:t.isMovable())?"enabled":"hidden"},callback(e){if(e.comment){var t=e.comment.toCopyData();t&&nw(t,e.comment.workspace)}},scopeType:cS.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},rh=function(){cS.registry.register({displayText:()=>N.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>{let t;return(null==(t=e.workspace)?0:t.isMutator)?"hidden":"enabled"},callback:(e,t,i,s)=>{(e=e.workspace)&&(N.setGroup$$module$build$src$core$events$utils(!0),(t=new cM(e)).setPlaceholderText(N.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),t.moveTo(ru(new r4(s.x,s.y),e)),N.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),N.setGroup$$module$build$src$core$events$utils(!1))},scopeType:cS.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},ru=function(e,t){var i=t.getInjectionDiv().getBoundingClientRect();return e=new r4(e.x-i.left,e.y-i.top),i=t.getOriginOffsetInPixels(),(e=r4.difference(e,i)).scale(1/t.scale),e},rd=function(){rt(),ri(),rs(),ro(),rn(),rr(),rl()},rE=function(){re(),rd()},(r_=r_||{}).scope={},r_.ASSUME_ES5=!1,r_.ASSUME_NO_NATIVE_MAP=!1,r_.ASSUME_NO_NATIVE_SET=!1,r_.SIMPLE_FROUND_POLYFILL=!1,r_.ISOLATE_POLYFILLS=!1,r_.FORCE_POLYFILL_PROMISE=!1,r_.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,r_.defineProperty=r_.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,i){return e==Array.prototype||e==Object.prototype||(e[t]=i.value),e},r_.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof r&&r];for(var t=0;t<e.length;++t){var i=e[t];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")},r_.global=r_.getGlobal(this),r_.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),r_.TRUST_ES6_POLYFILLS=!r_.ISOLATE_POLYFILLS||r_.IS_SYMBOL_NATIVE,r_.polyfills={},r_.propertyToPolyfillSymbol={},r_.POLYFILL_PREFIX="$jscp$",r_.polyfill=function(e,t,i,s){t&&(r_.ISOLATE_POLYFILLS?r_.polyfillIsolated(e,t,i,s):r_.polyfillUnisolated(e,t,i,s))},r_.polyfillUnisolated=function(e,t,i,s){for(s=0,i=r_.global,e=e.split(".");s<e.length-1;s++){var o=e[s];if(!(o in i))return;i=i[o]}(t=t(s=i[e=e[e.length-1]]))!=s&&null!=t&&r_.defineProperty(i,e,{configurable:!0,writable:!0,value:t})},r_.polyfillIsolated=function(e,t,i,s){var o=e.split(".");e=1===o.length,s=o[0],s=!e&&s in r_.polyfills?r_.polyfills:r_.global;for(var n=0;n<o.length-1;n++){var r=o[n];if(!(r in s))return;s=s[r]}o=o[o.length-1],null!=(t=t(i=r_.IS_SYMBOL_NATIVE&&"es6"===i?s[o]:null))&&(e?r_.defineProperty(r_.polyfills,o,{configurable:!0,writable:!0,value:t}):t!==i&&(void 0===r_.propertyToPolyfillSymbol[o]&&(i=1e9*Math.random()>>>0,r_.propertyToPolyfillSymbol[o]=r_.IS_SYMBOL_NATIVE?r_.global.Symbol(o):r_.POLYFILL_PREFIX+i+"$"+o),r_.defineProperty(s,r_.propertyToPolyfillSymbol[o],{configurable:!0,writable:!0,value:t})))},r_.underscoreProtoCanBeSet=function(){var e={};try{return e.__proto__={a:!0},e.a}catch(e){}return!1},r_.setPrototypeOf=r_.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:r_.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw TypeError(e+" is not extensible");return e}:null,r_.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},r_.arrayIterator=function(e){return{next:r_.arrayIteratorImpl(e)}},r_.makeIterator=function(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return r_.arrayIterator(e);throw Error(String(e)+" is not an iterable or ArrayLike")},r_.generator={},r_.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw TypeError("Iterator result "+e+" is not an object")},r_.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},r_.generator.Context.prototype.start_=function(){if(this.isRunning_)throw TypeError("Generator is already running");this.isRunning_=!0},r_.generator.Context.prototype.stop_=function(){this.isRunning_=!1},r_.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},r_.generator.Context.prototype.next_=function(e){this.yieldResult=e},r_.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},r_.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},r_.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},r_.generator.Context.prototype.yield=function(e,t){return this.nextAddress=t,{value:e}},r_.generator.Context.prototype.yieldAll=function(e,t){var i=(e=r_.makeIterator(e)).next();if(r_.generator.ensureIteratorResultIsObject_(i),!i.done)return this.yieldAllIterator_=e,this.yield(i.value,t);this.yieldResult=i.value,this.nextAddress=t},r_.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},r_.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},r_.generator.Context.prototype.setCatchFinallyBlocks=function(e,t){this.catchAddress_=e,void 0!=t&&(this.finallyAddress_=t)},r_.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},r_.generator.Context.prototype.leaveTryBlock=function(e,t){this.nextAddress=e,this.catchAddress_=t||0},r_.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},r_.generator.Context.prototype.enterFinallyBlock=function(e,t,i){i?this.finallyContexts_[i]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=t||0},r_.generator.Context.prototype.leaveFinallyBlock=function(e,t){if(t=this.finallyContexts_.splice(t||0)[0],t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();void 0!=t.jumpTo&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},r_.generator.Context.prototype.forIn=function(e){return new r_.generator.Context.PropertyIterator(e)},r_.generator.Context.PropertyIterator=function(e){for(var t in this.object_=e,this.properties_=[],e)this.properties_.push(t);this.properties_.reverse()},r_.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var e=this.properties_.pop();if(e in this.object_)return e}return null},r_.generator.Engine_=function(e){this.context_=new r_.generator.Context,this.program_=e},r_.generator.Engine_.prototype.next_=function(e){return(this.context_.start_(),this.context_.yieldAllIterator_)?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},r_.generator.Engine_.prototype.return_=function(e){this.context_.start_();var t=this.context_.yieldAllIterator_;return t?this.yieldAllStep_("return"in t?t.return:function(e){return{value:e,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},r_.generator.Engine_.prototype.throw_=function(e){return(this.context_.start_(),this.context_.yieldAllIterator_)?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},r_.generator.Engine_.prototype.yieldAllStep_=function(e,t,i){try{var s=e.call(this.context_.yieldAllIterator_,t);if(r_.generator.ensureIteratorResultIsObject_(s),!s.done)return this.context_.stop_(),s;var o=s.value}catch(e){return this.context_.yieldAllIterator_=null,this.context_.throw_(e),this.nextStep_()}return this.context_.yieldAllIterator_=null,i.call(this.context_,o),this.nextStep_()},r_.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(e){this.context_.yieldResult=void 0,this.context_.throw_(e)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},r_.generator.Generator_=function(e){this.next=function(t){return e.next_(t)},this.throw=function(t){return e.throw_(t)},this.return=function(t){return e.return_(t)},this[Symbol.iterator]=function(){return this}},r_.generator.createGenerator=function(e,t){return t=new r_.generator.Generator_(new r_.generator.Engine_(t)),r_.setPrototypeOf&&e.prototype&&r_.setPrototypeOf(t,e.prototype),t},r_.asyncExecutePromiseGenerator=function(e){function t(t){return e.next(t)}function i(t){return e.throw(t)}return new Promise(function(s,o){!function e(n){n.done?s(n.value):Promise.resolve(n.value).then(t,i).then(e,o)}(e.next())})},r_.asyncExecutePromiseGeneratorFunction=function(e){return r_.asyncExecutePromiseGenerator(e())},r_.asyncExecutePromiseGeneratorProgram=function(e){return r_.asyncExecutePromiseGenerator(new r_.generator.Generator_(new r_.generator.Engine_(e)))},r_.polyfill("globalThis",function(e){return e||r_.global},"es_2020","es3"),r_.polyfill("Array.prototype.includes",function(e){return e||function(e,t){var i=this;i instanceof String&&(i=String(i));var s=i.length;for(0>(t=t||0)&&(t=Math.max(t+s,0));t<s;t++){var o=i[t];if(o===e||Object.is(o,e))return!0}return!1}},"es7","es3"),r_.initSymbol=function(){},r_.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},r_.iteratorFromArray=function(e,t){e instanceof String&&(e+="");var i=0,s=!1,o={next:function(){if(!s&&i<e.length){var o=i++;return{value:t(o,e[o]),done:!1}}return s=!0,{done:!0,value:void 0}}};return o[Symbol.iterator]=function(){return o},o},r_.polyfill("Array.prototype.values",function(e){return e||function(){return r_.iteratorFromArray(this,function(e,t){return t})}},"es8","es3"),r_.polyfill("Array.prototype.flatMap",function(e){return e||function(e,t){var i=[];return Array.prototype.forEach.call(this,function(s,o){Array.isArray(s=e.call(t,s,o,this))?i.push.apply(i,s):i.push(s)}),i}},"es9","es5"),r_.polyfill("Array.prototype.flat",function(e){return e||function(e){e=void 0===e?1:e;var t=[];return Array.prototype.forEach.call(this,function(i){Array.isArray(i)&&0<e?(i=Array.prototype.flat.call(i,e-1),t.push.apply(t,i)):t.push(i)}),t}},"es9","es5"),r_.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r_.polyfill("Object.entries",function(e){return e||function(e){var t,i=[];for(t in e)r_.owns(e,t)&&i.push([t,e[t]]);return i}},"es8","es3"),r_.polyfill("Object.values",function(e){return e||function(e){var t,i=[];for(t in e)r_.owns(e,t)&&i.push(e[t]);return i}},"es8","es3");var b=Object.create(null),$=Object.create(null),D="default",M=class{constructor(e){this.name=e}toString(){return this.name}};M.CONNECTION_CHECKER=new M("connectionChecker"),M.CONNECTION_PREVIEWER=new M("connectionPreviewer"),M.CURSOR=new M("cursor"),M.EVENT=new M("event"),M.FIELD=new M("field"),M.INPUT=new M("input"),M.RENDERER=new M("renderer"),M.TOOLBOX=new M("toolbox"),M.THEME=new M("theme"),M.TOOLBOX_ITEM=new M("toolboxItem"),M.FLYOUTS_VERTICAL_TOOLBOX=new M("flyoutsVerticalToolbox"),M.FLYOUTS_HORIZONTAL_TOOLBOX=new M("flyoutsHorizontalToolbox"),M.FLYOUT_INFLATER=new M("flyoutInflater"),M.METRICS_MANAGER=new M("metricsManager"),M.BLOCK_DRAGGER=new M("blockDragger"),M.SERIALIZER=new M("serializer"),M.ICON=new M("icon"),M.PASTER=new M("paster"),M.VARIABLE_MODEL=new M("variableModel"),M.VARIABLE_MAP=new M("variableMap");var P={DEFAULT:D,TEST_ONLY:{typeMap:b}};P.Type=M,P.getAllItems=eT,P.getClass=eE,P.getClassFromOptions=ep,P.getObject=e_,P.hasItem=ed,P.register=ea,P.unregister=eh;var y=Object.create(null),k=750,w="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),v=null,B={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},G=0,F={TOUCH_ENABLED:w,TOUCH_MAP:B};F.checkTouchIdentifier=eA,F.clearTouchIdentifier=eR,F.getTouchIdentifierFromEvent=eO,F.longStart=eg,F.longStop=eI,F.shouldHandleEvent=em;var x=globalThis.navigator&&globalThis.navigator.userAgent||"";function U(e){return H.includes(e.toUpperCase())}let H=(rT=x).toUpperCase();rp=U("JavaFX"),rg=U("WebKit"),rI=U("Gecko")&&!rg,rR=U("Android"),x=globalThis.navigator&&globalThis.navigator.maxTouchPoints,rm=U("iPad")||U("Macintosh")&&0<x,rO=U("iPhone")&&!rm,rA=U("Macintosh"),rS=!(rm||rR&&!U("Mobile")||U("Silk"))&&(rO||rR);var W=rp,V=rA,K=40,X=125,Y={};Y.bind=eC,Y.conditionalBind=eS,Y.getScrollDeltaPixels=e$,Y.isRightButton=eN,Y.isTargetInput=eL,Y.mouseToSvg=eb,Y.unbind=ef,(el=rC||(rC={})).BLOCK_CREATE="create",el.BLOCK_DELETE="delete",el.BLOCK_CHANGE="change",el.BLOCK_FIELD_INTERMEDIATE_CHANGE="block_field_intermediate_change",el.BLOCK_MOVE="move",el.VAR_CREATE="var_create",el.VAR_DELETE="var_delete",el.VAR_RENAME="var_rename",el.VAR_TYPE_CHANGE="var_type_change",el.UI="ui",el.BLOCK_DRAG="drag",el.SELECTED="selected",el.CLICK="click",el.MARKER_MOVE="marker_move",el.BUBBLE_OPEN="bubble_open",el.TRASHCAN_OPEN="trashcan_open",el.TOOLBOX_ITEM_SELECT="toolbox_item_select",el.THEME_CHANGE="theme_change",el.VIEWPORT_CHANGE="viewport_change",el.COMMENT_CREATE="comment_create",el.COMMENT_DELETE="comment_delete",el.COMMENT_CHANGE="comment_change",el.COMMENT_MOVE="comment_move",el.COMMENT_RESIZE="comment_resize",el.COMMENT_DRAG="comment_drag",el.COMMENT_COLLAPSE="comment_collapse",el.FINISHED_LOADING="finished_loading";var z=[rC.BLOCK_CREATE,rC.BLOCK_MOVE,rC.COMMENT_CREATE,rC.COMMENT_MOVE],j="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",J={genUid:()=>{let e=j.length,t=[];for(let i=0;20>i;i++)t[i]=j.charAt(Math.random()*e);return t.join("")}},Z=0,q={TEST_ONLY:J};q.genUid=eM,q.getNextUniqueId=eD;var Q={};Q.isBlockChange=ek,Q.isBlockCreate=eP,Q.isBlockDelete=ey,Q.isBlockDrag=function(e){return e.type===rC.BLOCK_DRAG},Q.isBlockFieldIntermediateChange=ew,Q.isBlockMove=ev,Q.isBubbleOpen=eG,Q.isClick=eB,Q.isCommentChange=function(e){return e.type===rC.COMMENT_CHANGE},Q.isCommentCollapse=function(e){return e.type===rC.COMMENT_COLLAPSE},Q.isCommentCreate=function(e){return e.type===rC.COMMENT_CREATE},Q.isCommentDelete=function(e){return e.type===rC.COMMENT_DELETE},Q.isCommentDrag=function(e){return e.type===rC.COMMENT_DRAG},Q.isCommentMove=function(e){return e.type===rC.COMMENT_MOVE},Q.isCommentResize=function(e){return e.type===rC.COMMENT_RESIZE},Q.isFinishedLoading=function(e){return e.type===rC.FINISHED_LOADING},Q.isSelected=function(e){return e.type===rC.SELECTED},Q.isThemeChange=function(e){return e.type===rC.THEME_CHANGE},Q.isToolboxItemSelect=function(e){return e.type===rC.TOOLBOX_ITEM_SELECT},Q.isTrashcanOpen=function(e){return e.type===rC.TRASHCAN_OPEN},Q.isVarCreate=function(e){return e.type===rC.VAR_CREATE},Q.isVarDelete=function(e){return e.type===rC.VAR_DELETE},Q.isVarRename=function(e){return e.type===rC.VAR_RENAME},Q.isViewportChange=eF;var ee="",et=!0,ei=0,es="ORPHANED_BLOCK",eo=[],en={FIRE_QUEUE:eo,enqueueEvent:eW,fireNow:eH,fireInternal:function(e){if(eX()){if(!eo.length)try{requestAnimationFrame(()=>{setTimeout(eH,0)})}catch(e){setTimeout(eH,0)}eW(e)}},setGroupInternal:function(e){ee="boolean"==typeof e?e?eM():"":e}},er={TEST_ONLY:en};er.clearPendingUndo=eK,er.disable=N.disable$$module$build$src$core$events$utils,er.disableOrphans=eJ,er.enable=N.enable$$module$build$src$core$events$utils,er.filter=eV,er.fire=eU,er.fromJson=ez,er.get=ej,er.getDescendantIds=eY,er.getGroup=N.getGroup$$module$build$src$core$events$utils,er.getRecordUndo=ex,er.isEnabled=eX,er.setGroup=N.setGroup$$module$build$src$core$events$utils,er.setRecordUndo=N.setRecordUndo$$module$build$src$core$events$utils;var el,ea,ec,eh,eu,ed,eE,e_,eT,ep,eg,eI,eR,em,eO,eA,eS,eC,ef,eL,eN,eb,e$,eD,eM,eP,ey,ek,ew,ev,eB,eG,eF,ex,eU,eH,eW,eV,eK,eX,eY,ez,ej,eJ,eZ,eq,eQ,e0,e1,e2,e3,e5,e6,e4,e8,e9,e7,te,tt,ti,ts,to,tn,tr,tl,ta,tc,th,tu,td,tE,t_,tT,tp,tg,tI,tR,tm,tO,tA,tS,tC,tf,tL,tN,tb,t$,tD,tM,tP,ty,tk,tw,tv,tB,tG,tF,tx,tU,tH,tW,tV,tK,tX,tY,tz,tj,tJ,tZ,tq,tQ,t0,t1,t2,t3,t5,t6,t4,t8,t9,t7,ie,it,ii,is,io,ir,il,ia,ic,ih,iu,id,iE,i_,iT,ip,ig,iI,iR,im,iO,iA,iS,iC,iL,iN,ib,i$,iD,iM,iP,iy,ik,iw,iv,iB,iG,iF,ix,iU,iH,iW,iV,iK,iX,iY,iz,ij,iJ,iZ,iq,iQ,i0,i1,i2,i3,i5,i6,i4,i8,i9,i7,se,st,si,ss,so,sn,sr,sl,sa,sc,sh,su,sd,sE,s_,sT,sp,sg,sI,sR,sm,sO,sA,sS,sC,sf,sL,sN,sb,s$,sD,sM,sP,sy,sk,sw,sv,sB,sG,sF,sx,sU,sH,sW,sV,sK,sX,sY,sz,sj,sJ,sZ,sq,sQ,s0,s1,s2,s3,s5,s6,s4,s8,s9,s7,oe,ot,oi,os,oo,on,or,ol,oa,oc,oh,ou,od,oE,o_,oT,op,og,oI,oR,om,oO,oA,oS,oC,of,oL,oN,ob,o$,oD,oM,oP,oy,ok,ow,ov,oB,oG,oF,ox,oU,oH,oW,oV,oK,oX,oY,oz,oj,oJ,oZ,oq,oQ,o0,o1,o2,o3,o5,o6,o4,o8,o9,o7,ne,nt,ni,ns,no,nn,nr,nl,na,nc,nh,nu,nd,nE,n_,nT,np,ng,nI,nR,nm,nO,nA,nS,nC,nf,nL,nN,nb,n$,nD,nM,nP,ny,nk,nw,nv,nB,nG,nF,nx,nU,nH,nW,nV,nK,nX,nY,nz,nj,nJ,nZ,nq,nQ,n0,n1,n2,n3,n5,n6,n4,n8,n9,n7,re,rt,ri,rs,ro,rn,rr,rl,ra,rc,rh,ru,rd,rE,r_,rT,rp,rg,rI,rR,rm,rO,rA,rS,rC,rf,rL="http://www.w3.org/2000/svg",rN="http://www.w3.org/1999/xhtml",rb="http://www.w3.org/1999/xlink";(rF=rf||(rf={}))[rF.ELEMENT_NODE=1]="ELEMENT_NODE",rF[rF.TEXT_NODE=3]="TEXT_NODE",rF[rF.COMMENT_NODE=8]="COMMENT_NODE";var r$=null,rD=0,rM=null,rP={HTML_NS:rN};rP.NodeType=rf,rP.SVG_NS=rL,rP.XLINK_NS=rb,rP.addClass=eq,rP.createSvgElement=eZ,rP.getFastTextWidth=function(e,t,i,s){return e9(e,t+"pt",i,s)},rP.getFastTextWidthWithSizeString=e9,rP.getTextWidth=e8,rP.hasClass=e1,rP.insertAfter=e3,rP.measureFontMetrics=e7,rP.removeClass=e0,rP.removeClasses=eQ,rP.removeNode=e2,rP.setCssTransform=e5,rP.startTextWidthCache=e6,rP.stopTextWidthCache=e4;var ry=class{static findFocusedNode(e){var t=e.getRootFocusableNode();if(!t.canBeFocused())return null;var i=t.getFocusableElement();return e1(i,ry.ACTIVE_CLASS_NAME)||e1(i,ry.PASSIVE_CSS_CLASS_NAME)||((t=i.querySelector(this.ACTIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||t instanceof SVGElement)&&(t=ry.findFocusableNodeFor(t,e))?t:((i=i.querySelector(this.PASSIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||i instanceof SVGElement)&&(e=ry.findFocusableNodeFor(i,e))?e:null}static findFocusableNodeFor(e,t){if(-1!==t.getNestedTrees().map(t=>ry.findFocusableNodeFor(e,t)).findIndex(e=>!!e))return null;var i,s=t.getRootFocusableNode();return s.canBeFocused()&&e===s.getFocusableElement()||(s=null!=(i=t.lookUpFocusableNode(e.id))?i:null)?s:(i=e.parentElement,!s&&i?ry.findFocusableNodeFor(i,t):null)}};ry.ACTIVE_CLASS_NAME="blocklyActiveFocus",ry.PASSIVE_CSS_CLASS_NAME="blocklyPassiveFocus",ry.ACTIVE_FOCUS_NODE_CSS_SELECTOR=`.${ry.ACTIVE_CLASS_NAME}`,ry.PASSIVE_FOCUS_NODE_CSS_SELECTOR=`.${ry.PASSIVE_CSS_CLASS_NAME}`;var rk=class{constructor(e,t){this.tree=e,this.rootShouldBeAutoTabbable=t}},rw=class{constructor(e){this.previouslyFocusedNode=this.focusedNode=null,this.registeredTrees=[],this.isUpdatingFocusedNode=this.recentlyLostAllFocus=this.lockFocusStateChanges=this.currentlyHoldsEphemeralFocus=!1;let t=e=>{if(!this.isUpdatingFocusedNode){this.recentlyLostAllFocus=!e;var t=null;if(e instanceof HTMLElement||e instanceof SVGElement){for(var i of this.registeredTrees)if(t=ry.findFocusableNodeFor(e,i.tree))break}if(t&&t.canBeFocused()){let s;e=t.getFocusableTree(),i=null==(s=this.focusedNode)?void 0:s.getFocusableTree(),t===e.getRootFocusableNode()&&e!==i?this.focusTree(e):this.focusNode(t)}else this.defocusCurrentFocusedNode()}};e("focusin",e=>{e instanceof FocusEvent&&t(document.activeElement)}),e("focusout",e=>{e instanceof FocusEvent&&t(e.relatedTarget)})}registerTree(e,t=!1){if(this.ensureManagerIsUnlocked(),this.isRegistered(e))throw Error(`Attempted to re-register already registered tree: ${e}.`);this.registeredTrees.push(new rk(e,t)),t&&(e.getRootFocusableNode().getFocusableElement().tabIndex=0)}isRegistered(e){return!!this.lookUpRegistration(e)}lookUpRegistration(e){let t;return null!=(t=this.registeredTrees.find(t=>t.tree===e))?t:null}unregisterTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to unregister not registered tree: ${e}.`);var t=this.registeredTrees.findIndex(t=>t.tree===e);let i=this.registeredTrees[t];this.registeredTrees.splice(t,1),t=ry.findFocusedNode(e);let s=e.getRootFocusableNode();t&&this.removeHighlight(t),this.focusedNode!==t&&this.focusedNode!==s||this.updateFocusedNode(null),this.removeHighlight(s),i.rootShouldBeAutoTabbable&&e.getRootFocusableNode().getFocusableElement().removeAttribute("tabindex")}getFocusedTree(){let e,t;return null!=(t=null==(e=this.focusedNode)?void 0:e.getFocusableTree())?t:null}getFocusedNode(){return this.focusedNode}focusTree(e){let t;if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to focus unregistered tree: ${e}.`);let i=ry.findFocusedNode(e),s=e.getRestoredFocusableNode(i);e=e.getRootFocusableNode(),this.focusNode(null!=(t=null!=s?s:i)?t:e)}focusNode(e){this.ensureManagerIsUnlocked();let t=!this.currentlyHoldsEphemeralFocus;t&&(this.isUpdatingFocusedNode=!0);var i,s=(null==(i=this.focusedNode)?void 0:i.getFocusableElement())!==document.activeElement;if(this.focusedNode!==e||s)if(e.canBeFocused()){if(s=e.getFocusableTree(),!this.isRegistered(s))throw Error(`Attempted to focus unregistered node: ${e}.`);var o,n=ry.findFocusableNodeFor(e.getFocusableElement(),s);i=ry.findFocusedNode(s);var r=e;n!==e&&(r=s.getRestoredFocusableNode(i),e=s.getRootFocusableNode(),r=null!=(o=null!=r?r:i)?o:e),o=null==(e=this.focusedNode)?void 0:e.getFocusableTree(),e&&this.passivelyFocusNode(e,s),s=s.getRootFocusableNode(),i&&this.removeHighlight(i),s!==r&&this.removeHighlight(s),this.currentlyHoldsEphemeralFocus||this.activelyFocusNode(r,null!=o?o:null),this.updateFocusedNode(r)}else console.warn("Trying to focus a node that can't be focused.");t&&(this.isUpdatingFocusedNode=!1)}takeEphemeralFocus(e){if(this.ensureManagerIsUnlocked(),this.currentlyHoldsEphemeralFocus)throw Error(`Attempted to take ephemeral focus when it's already held, with new element: ${e}.`);this.currentlyHoldsEphemeralFocus=!0,this.focusedNode&&this.passivelyFocusNode(this.focusedNode,null),e.focus();let t=!1;return()=>{if(t)throw Error(`Attempted to finish ephemeral focus twice for element: ${e}.`);if(t=!0,this.currentlyHoldsEphemeralFocus=!1,this.focusedNode){this.activelyFocusNode(this.focusedNode,null);let e=this.focusedNode;setTimeout(()=>{!this.focusedNode&&this.previouslyFocusedNode===e&&this.recentlyLostAllFocus&&this.focusNode(e)},0)}}}ephemeralFocusTaken(){return this.currentlyHoldsEphemeralFocus}ensureManagerIsUnlocked(){if(this.lockFocusStateChanges)throw Error("FocusManager state changes cannot happen in a tree/node focus/blur callback.")}updateFocusedNode(e){this.previouslyFocusedNode=this.focusedNode,this.focusedNode=e}defocusCurrentFocusedNode(){this.focusedNode&&!this.currentlyHoldsEphemeralFocus&&(this.passivelyFocusNode(this.focusedNode,null),this.updateFocusedNode(null))}activelyFocusNode(e,t){let i;this.lockFocusStateChanges=!0;let s=e.getFocusableTree(),o=e.getFocusableElement(),n=null==(i=this.lookUpRegistration(s))?void 0:i.rootShouldBeAutoTabbable;s!==t&&(s.onTreeFocus(e,t),n&&(s.getRootFocusableNode().getFocusableElement().tabIndex=-1)),e.onNodeFocus(),this.lockFocusStateChanges=!1,n&&e===s.getRootFocusableNode()||o.hasAttribute("tabindex")||(o.tabIndex=-1),this.setNodeToVisualActiveFocus(e),o.focus()}passivelyFocusNode(e,t){this.lockFocusStateChanges=!0;let i=e.getFocusableTree();if(i!==t){let e;i.onTreeBlur(t),(null==(e=this.lookUpRegistration(i))?0:e.rootShouldBeAutoTabbable)&&(i.getRootFocusableNode().getFocusableElement().tabIndex=0)}e.onNodeBlur(),this.lockFocusStateChanges=!1,i!==t&&this.setNodeToVisualPassiveFocus(e)}setNodeToVisualActiveFocus(e){eq(e=e.getFocusableElement(),rw.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),e0(e,rw.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}setNodeToVisualPassiveFocus(e){e0(e=e.getFocusableElement(),rw.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),eq(e,rw.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}removeHighlight(e){e0(e=e.getFocusableElement(),rw.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),e0(e,rw.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}static getFocusManager(){return rw.focusManager||(rw.focusManager=new rw(document.addEventListener)),rw.focusManager}};rw.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyActiveFocus",rw.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyPassiveFocus",rw.focusManager=null;var rv={};rv.FocusManager=rw,rv.getFocusManager=N.getFocusManager$$module$build$src$core$focus_manager;var rB={};rB.deepMerge=ti;var rG=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),null==(t=e.keyCodes)?0:t.length)for(let i of t)this.addKeyMapping(i,e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn(`Keyboard shortcut named "${e}" not found.`),!1)}addKeyMapping(e,t,i){e=`${e}`;let s=this.keyMap.get(e);if(s&&!i)throw Error(`Shortcut named "${t}" collides with shortcuts "${s}"`);s&&i?s.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,i){let s=this.keyMap.get(e);if(!s)return i||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1;let o=s.indexOf(t);return -1<o?(s.splice(o,1),0===s.length&&this.keyMap.delete(e),!0):(i||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1)}removeAllKeyMappings(e){for(let t of this.keyMap.keys())this.removeKeyMapping(t,e,!0)}setKeyMap(e){for(let t in this.keyMap.clear(),e)this.keyMap.set(t,e[t])}getKeyMap(){let e=Object.create(null);for(let[t,i]of this.keyMap)e[t]=i;return e}getRegistry(){let e=Object.create(null);for(let[t,i]of this.shortcuts)e[t]=i;return ti(Object.create(null),e)}onKeyDown(e,t){var i=this.serializeKeyEvent(t);if(!(i=this.getShortcutNamesByKeyCode(i)))return!1;for(let s of i){let o,n,r,l;if((i=this.shortcuts.get(s))&&(!i.preconditionFn||i.preconditionFn(e,{focusedNode:null!=(o=N.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?o:void 0}))&&(null==(r=(n=i).callback)?0:r.call(n,e,t,i,{focusedNode:null!=(l=N.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?l:void 0})))return!0}return!1}getShortcutNamesByKeyCode(e){let t;return(null==(t=this.keyMap.get(e))?void 0:t.slice())||[]}getKeyCodesByShortcutName(e){let t=[];for(let[i,s]of this.keyMap)-1<s.indexOf(e)&&t.push(i);return t}serializeKeyEvent(e){let t="";for(let i in rG.modifierKeys)e.getModifierState(i)&&(""!==t&&(t+="+"),t+=i);return""!==t&&e.keyCode?t+="+"+e.keyCode:e.keyCode&&(t=String(e.keyCode)),t}checkModifiers(e){for(let t of e)if(!(t in rG.modifierKeys))throw Error(t+" is not a valid modifier key.")}createSerializedKey(e,t){let i="";if(t)for(let e in this.checkModifiers(t),rG.modifierKeys)t.includes(rG.modifierKeys[e])&&(""!==i&&(i+="+"),i+=e);return""!==i&&e?i+="+"+e:e&&(i=`${e}`),i}};rG.registry=new rG,(rx=(rx=rG||(rG={})).modifierKeys||(rx.modifierKeys={}))[rx.Shift=16]="Shift",rx[rx.Control=17]="Control",rx[rx.Alt=18]="Alt",rx[rx.Meta=91]="Meta";var rF,rx,rU,rH,rW=Object.create(null),rV=[],rK={defineBlocksWithJsonArrayInternal:function(e){N.defineBlocks$$module$build$src$core$common(N.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))}},rX={TEST_ONLY:rK};rX.createBlockDefinitionsFromJsonArray=N.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,rX.defineBlocks=N.defineBlocks$$module$build$src$core$common,rX.defineBlocksWithJsonArray=tp,rX.draggingConnections=rV,rX.fireSelectedEvent=th,rX.getAllWorkspaces=to,rX.getBlockTypeCounts=t_,rX.getMainWorkspace=tl,rX.getParentContainer=tu,rX.getSelected=tc,rX.getWorkspaceById=ts,rX.globalShortcutHandler=tg,rX.registerWorkspace=tn,rX.setMainWorkspace=ta,rX.setParentContainer=td,rX.setSelected=function(e){N.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)},rX.svgResize=tE,rX.unregisterWorkpace=tr;var rY,rz=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=N.getGroup$$module$build$src$core$events$utils(),this.recordUndo=ex()}toJson(){return{type:this.type,group:this.group}}static fromJson(e,t,i){return i.isBlank=!1,i.group=e.group||"",i.workspaceId=t.id,i}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=ts(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},rj=class extends rz{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=void 0===e,this.workspaceId=e||""}},rJ=class extends rj{constructor(e,t,i){null===(t=e?e.workspace.id:t)&&(t=void 0),super(t),this.type=rC.CLICK,this.blockId=e?e.id:void 0,this.targetType=i}toJson(){let e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new rJ)).targetType=e.targetType,t.blockId=e.blockId,t}};(l_=rY||(rY={})).BLOCK="block",l_.WORKSPACE="workspace",l_.ZOOM_CONTROLS="zoom_controls",ea(M.EVENT,rC.CLICK,rJ);var rZ={};rZ.Click=rJ,rZ.ClickTarget=rY;var rq={};rq.removeElem=tI;var rQ=class{constructor(e){this.name=e}toString(){return this.name}};rQ.POSITIONABLE=new rQ("positionable"),rQ.DRAG_TARGET=new rQ("drag_target"),rQ.DELETE_AREA=new rQ("delete_area"),rQ.AUTOHIDEABLE=new rQ("autohideable");var r0=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){let i=e.component.id;if(!t&&this.componentData.has(i)){var s;throw Error('Plugin "'+i+'" with capabilities "'+(null==(s=this.componentData.get(i))?void 0:s.capabilities)+'" already added.')}for(this.componentData.set(i,e),t=[],s=0;s<e.capabilities.length;s++){let o=String(e.capabilities[s]).toLowerCase();if(t.push(o),this.capabilityToComponentIds.has(o)){let e;null==(e=this.capabilityToComponentIds.get(o))||e.push(i)}else this.capabilityToComponentIds.set(o,[i])}this.componentData.get(i).capabilities=t}removeComponent(e){let t=this.componentData.get(e);if(t){for(let i=0;i<t.capabilities.length;i++){let s=String(t.capabilities[i]).toLowerCase();tI(this.capabilityToComponentIds.get(s),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');if(this.hasCapability(e,t))console.warn('Plugin "'+e+'already has capability "'+t+'"');else{var i,s;t=`${t}`.toLowerCase(),null==(i=this.componentData.get(e))||i.capabilities.push(t),null==(s=this.capabilityToComponentIds.get(t))||s.push(e)}}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=`${t}`.toLowerCase(),tI(this.componentData.get(e).capabilities,t),tI(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+"doesn't have capability \""+t+'" to remove')}hasCapability(e,t){return t=`${t}`.toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.includes(t)}getComponent(e){let t;return null==(t=this.componentData.get(e))?void 0:t.component}getComponents(e,t){if(e=`${e}`.toLowerCase(),!(e=this.capabilityToComponentIds.get(e)))return[];let i=[];if(t){let t=[];e.forEach(e=>{t.push(this.componentData.get(e))}),t.sort(function(e,t){return e.weight-t.weight}),t.forEach(function(e){i.push(e.component)})}else e.forEach(e=>{i.push(this.componentData.get(e).component)});return i}};r0.Capability=rQ,(lT=(lT=r0||(r0={})).ComponentWeight||(lT.ComponentWeight={}))[lT.TOOLBOX_WEIGHT=0]="TOOLBOX_WEIGHT",lT[lT.FLYOUT_WEIGHT=1]="FLYOUT_WEIGHT",lT[lT.TRASHCAN_WEIGHT=2]="TRASHCAN_WEIGHT",lT[lT.ZOOM_CONTROLS_WEIGHT=3]="ZOOM_CONTROLS_WEIGHT";var r1=r0.ComponentWeight,r2={};r2.ComponentManager=r0,r2.ComponentWeight=r1;var r3=!1,r5='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyEmboss {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyHighlighted>.blocklyPath {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n  /* Drag surface disables events to not block the toolbox, so we have to\n   * reenable them here for the cursor values to work. */\n  pointer-events: auto;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabledPattern>.blocklyPath {\n  fill: var(--blocklyDisabledPattern);\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyNonEditableField>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n  pointer-events: none;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyMenuSeparator {\n  background-color: #ccc;\n  height: 1px;\n  border: 0;\n  margin-left: 4px;\n  margin-right: 4px;\n}\n\n.blocklyBlockDragSurface, .blocklyAnimationLayer {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n\n.blocklyField {\n  cursor: default;\n}\n\n.blocklyInputField {\n  cursor: text;\n}\n\n.blocklyDragging .blocklyField,\n.blocklyDragging .blocklyIconGroup {\n  cursor: grabbing;\n}\n\n.blocklyActiveFocus:is(\n  .blocklyFlyout,\n  .blocklyWorkspace,\n  .blocklyField,\n  .blocklyPath,\n  .blocklyHighlightedConnectionPath,\n  .blocklyComment,\n  .blocklyBubble,\n  .blocklyIconGroup,\n  .blocklyTextarea\n) {\n  outline: none;\n}\n',r6={};r6.inject=tm,r6.register=tR;var r4=class{constructor(e,t){this.x=e,this.y=t}clone(){return new r4(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t||!!e&&!!t&&e.x===t.x&&e.y===t.y}static distance(e,t){let i=e.x-t.x;return Math.sqrt(i*i+(e=e.y-t.y)*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new r4(e.x-t.x,e.y-t.y)}static sum(e,t){return new r4(e.x+t.x,e.y+t.y)}},r8=class{constructor(e){this.tagName=e}toString(){return this.tagName}};r8.ANIMATE=new r8("animate"),r8.CIRCLE=new r8("circle"),r8.CLIPPATH=new r8("clipPath"),r8.DEFS=new r8("defs"),r8.FECOMPOSITE=new r8("feComposite"),r8.FECOMPONENTTRANSFER=new r8("feComponentTransfer"),r8.FEFLOOD=new r8("feFlood"),r8.FEFUNCA=new r8("feFuncA"),r8.FEGAUSSIANBLUR=new r8("feGaussianBlur"),r8.FEPOINTLIGHT=new r8("fePointLight"),r8.FESPECULARLIGHTING=new r8("feSpecularLighting"),r8.FILTER=new r8("filter"),r8.FOREIGNOBJECT=new r8("foreignObject"),r8.G=new r8("g"),r8.IMAGE=new r8("image"),r8.LINE=new r8("line"),r8.PATH=new r8("path"),r8.PATTERN=new r8("pattern"),r8.POLYGON=new r8("polygon"),r8.RECT=new r8("rect"),r8.SVG=new r8("svg"),r8.TEXT=new r8("text"),r8.TSPAN=new r8("tspan");var r9=class{constructor(e,t,i,s){this.top=e,this.bottom=t,this.left=i,this.right=s}clone(){return new r9(this.top,this.bottom,this.left,this.right)}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return this.left<=e.right&&this.right>=e.left&&this.bottom>=e.top&&this.top<=e.bottom}static equals(e,t){return e===t||!!e&&!!t&&e.top===t.top&&e.bottom===t.bottom&&e.left===t.left&&e.right===t.right}static createFromPoint(e,t,i){let s=e.x;return new r9(e=e.y,e+i,s,s+t)}},r7=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t||!!e&&!!t&&e.width===t.width&&e.height===t.height}static max(e,t){return new r7(Math.max(e.width,t.width),Math.max(e.height,t.height))}static min(e,t){return new r7(Math.min(e.width,t.width),Math.min(e.height,t.height))}},le={getSizeInternal:function(e){if("none"!==tS(e,"display"))return tA(e);let t=e.style,i=t.display,s=t.visibility,o=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";let n=e.offsetWidth;return e=e.offsetHeight,t.display=i,t.position=o,t.visibility=s,new r7(n,e)}},lt={TEST_ONLY:le};lt.getBorderBox=tL,lt.getComputedStyle=tS,lt.getContainerOffsetToScrollInto=tb,lt.getPageOffset=tC,lt.getSize=tO,lt.getViewportPageOffset=tf,lt.scrollIntoContainerView=tN;var li=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,ls=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,lo={TEST_ONLY:{XY_REGEX:li,XY_STYLE_REGEX:ls}};lo.getDocumentScroll=tP,lo.getInjectionDivXY=tD,lo.getRelativeXY=t$,lo.getViewportBBox=tM,lo.screenToWsCoordinates=ty,lo.wsToScreenCoordinates=tk;var ln=class{constructor(e,t,i,s,o){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new r4(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new r4(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=i||!1,this.margin=void 0!==o?o:ln.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),s&&(e+=" "+s),this.outerSvg=eZ(r8.SVG,{class:e}),s=eZ(r8.G,{},this.outerSvg),this.svgBackground=eZ(r8.RECT,{class:"blocklyScrollbarBackground"},s),e=Math.floor((ln.scrollbarThickness-5)/2),this.svgHandle=eZ(r8.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},s),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),e3(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=eS(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=eS(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){let e=ln.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),ef(this.onMouseDownBarWrapper_),ef(this.onMouseDownHandleWrapper_),e2(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e=0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e=0>=e||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,e5(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){(e||(e=this.workspace.getMetrics()))&&(this.oldHostMetrics&&ln.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics()))}requiresViewResize(e){return!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=ln.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=ln.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-ln.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth;var i=this.scrollbarLength-this.handleLength;e=(e.viewLeft-e.scrollLeft)/t*i,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=i/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=ln.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-ln.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight;var i=this.scrollbarLength-this.handleLength;e=(e.viewTop-e.scrollTop)/t*i,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=i/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){let t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){let t=e!==this.isVisible();this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),eR(),this.cleanUp(),eN(e))e.stopPropagation();else{var t=eb(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var i=tD(this.svgHandle);i=this.horizontal?i.x:i.y;var s=this.handlePosition,o=.95*this.handleLength;t<=i?s-=o:t>=i+this.handleLength&&(s+=o),this.setHandlePosition(this.constrainHandlePosition(s)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),eN(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=eS(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=eS(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){eR(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(ef(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(ef(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){let e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||void 0===t)&&this.updateMetrics()}setOrigin(e,t){this.origin=new r4(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};ln.scrollbarThickness=w?25:15,ln.DEFAULT_SCROLLBAR_MARGIN=.5;var lr={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},ll={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:la,DOMParser:lc,XMLSerializer:lh}=globalThis;lc&&(lr=new lc),lh&&(ll=new lh);var lu="https://developers.google.com/blockly/xml",ld=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,lE={NAME_SPACE:lu};lE.createElement=N.createElement$$module$build$src$core$utils$xml,lE.createTextNode=N.createTextNode$$module$build$src$core$utils$xml,lE.domToText=tw,lE.injectDependencies=function(e){({document:la=la,DOMParser:lc=lc,XMLSerializer:lh=lh}=e),lr=new lc,ll=new lh},lE.textToDom=N.textToDom$$module$build$src$core$utils$xml;var l_,lT,lp,lg="categoryToolbox",lI="flyoutToolbox";(l$=lp||(lp={}))[l$.TOP=0]="TOP",l$[l$.BOTTOM=1]="BOTTOM",l$[l$.LEFT=2]="LEFT",l$[l$.RIGHT=3]="RIGHT";var lR={hasCategoriesInternal:function(e){if(!e)return!1;let t=e.kind;return t?t===lg:!!e.contents.filter(e=>"CATEGORY"===e.kind.toUpperCase()).length}},lm={};lm.Position=lp,lm.TEST_ONLY=lR,lm.convertFlyoutDefToJsonArray=tF,lm.convertToolboxDefToJson=tB,lm.hasCategories=tx,lm.isCategoryCollapsible=tU,lm.parseToolboxTree=tK,(lD=ly||(ly={}))[lD.TOP=0]="TOP",lD[lD.BOTTOM=1]="BOTTOM",(lM=lk||(lk={}))[lM.LEFT=0]="LEFT",lM[lM.RIGHT=1]="RIGHT",(lP=lw||(lw={}))[lP.UP=0]="UP",lP[lP.DOWN=1]="DOWN";var lO={};lO.bumpDirection=lw,lO.bumpPositionRect=tz,lO.getCornerOppositeToolbox=tY,lO.getStartPositionRect=tX,lO.horizontalPosition=lk,lO.verticalPosition=ly;var lA="sprites.png",lS=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=eZ(r8.G,{});let e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:r0.ComponentWeight.ZOOM_CONTROLS_WEIGHT,capabilities:[r0.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){for(let e of(this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&e2(this.svgGroup),this.boundEvents))ef(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new r9(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var i,s=tY(this.workspace,e),o=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(o+=this.LARGE_SPACING+this.HEIGHT),e=tX(s,new r7(this.WIDTH,o),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),s=s.vertical,t=tz(e,this.MARGIN_VERTICAL,s===ly.TOP?lw.DOWN:lw.UP,t),s===ly.TOP){var n,r=this.SMALL_SPACING+this.HEIGHT;null==(n=this.zoomInGroup)||n.setAttribute("transform","translate(0, "+r+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(r+this.LARGE_SPACING+this.HEIGHT)+")")}else{let e;n=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0,null==(e=this.zoomInGroup)||e.setAttribute("transform","translate(0, "+n+")"),n=n+this.SMALL_SPACING+this.HEIGHT,null==(r=this.zoomOutGroup)||r.setAttribute("transform","translate(0, "+n+")")}this.top=t.top,this.left=t.left,null==(i=this.svgGroup)||i.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=eZ(r8.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);let t=eZ(r8.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);eZ(r8.RECT,{width:32,height:32},t),eZ(r8.IMAGE,{width:96,height:124,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(rb,"xlink:href",this.workspace.options.pathToMedia+lA),this.boundEvents.push(eS(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=eZ(r8.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);let t=eZ(r8.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);eZ(r8.RECT,{width:32,height:32},t),eZ(r8.IMAGE,{width:96,height:124,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(rb,"xlink:href",this.workspace.options.pathToMedia+lA),this.boundEvents.push(eS(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),eR(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=eZ(r8.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);let t=eZ(r8.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);eZ(r8.RECT,{width:32,height:32},t),eZ(r8.IMAGE,{width:96,height:124,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(rb,"xlink:href",this.workspace.options.pathToMedia+lA),this.boundEvents.push(eS(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();let t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),eR(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){eU(new(ej(rC.CLICK))(null,this.workspace.id,"zoom_controls"))}};tR("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n");var lC={};lC.register=tj,lC.unregister=function(e){eh(M.SERIALIZER,e)};var lf=class{constructor(){this.priority=25}save(e){let t=[];for(let i of e.getTopComments())(e=tJ(i,{addCoordinates:!0,saveIds:!0}))&&t.push(e);return t.length?t:null}load(e,t){for(let i of e)tZ(i,t,{recordUndo:ex()})}clear(e){for(let t of e.getTopComments())t.dispose()}};tj("workspaceComments",new lf);var lL={};lL.WorkspaceCommentSerializer=lf,lL.append=tZ,lL.save=tJ;var lN={};lN.register=tq,lN.unregister=function(e){eh(M.PASTER,e)};var lb=class{paste(e,t,i){let s;e=e.commentState,i&&(e.x=i.x,e.y=i.y),N.disable$$module$build$src$core$events$utils();try{s=tZ(e,t),tQ(s)}finally{N.enable$$module$build$src$core$events$utils()}return s?(eX()&&eU(new(ej(rC.COMMENT_CREATE))(s)),N.getFocusManager$$module$build$src$core$focus_manager().focusNode(s),s):null}};lb.TYPE="workspace-comment",tq(lb.TYPE,new lb),N.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:28,connectingSnapRadius:28,currentConnectionPreference:8,bumpDelay:250},N.config$$module$build$src$core$config;var l$,lD,lM,lP,ly,lk,lw,lv,lB="aria-",lG="role";(aA=lv||(lv={})).GRID="grid",aA.GRIDCELL="gridcell",aA.GROUP="group",aA.LISTBOX="listbox",aA.MENU="menu",aA.MENUITEM="menuitem",aA.MENUITEMCHECKBOX="menuitemcheckbox",aA.OPTION="option",aA.PRESENTATION="presentation",aA.ROW="row",aA.TREE="tree",aA.TREEITEM="treeitem",aA.SEPARATOR="separator",aA.STATUS="status",(aS=aL||(aL={})).ACTIVEDESCENDANT="activedescendant",aS.COLCOUNT="colcount",aS.DISABLED="disabled",aS.EXPANDED="expanded",aS.INVALID="invalid",aS.LABEL="label",aS.LABELLEDBY="labelledby",aS.LEVEL="level",aS.ORIENTATION="orientation",aS.POSINSET="posinset",aS.ROWCOUNT="rowcount",aS.SELECTED="selected",aS.SETSIZE="setsize",aS.VALUEMAX="valuemax",aS.VALUEMIN="valuemin",aS.LIVE="live",aS.HIDDEN="hidden";var lF={};lF.Role=lv,lF.State=aL,lF.setRole=t1,lF.setState=t2;var lx=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){let e=document.createElement("div");e.id=eD(),this.element=e,e.className="blocklyMenuItem "+(this.enabled?"":"blocklyMenuItemDisabled ")+(this.checked?"blocklyMenuItemSelected ":"")+(this.highlight?"blocklyMenuItemHighlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl ":"");let t=document.createElement("div");if(t.className="blocklyMenuItemContent",this.checkable){var i=document.createElement("div");i.className="blocklyMenuItemCheckbox ",t.appendChild(i)}return i=this.content,"string"==typeof this.content&&(i=document.createTextNode(this.content)),t.appendChild(i),e.appendChild(t),this.roleName&&t1(e,this.roleName),t2(e,aL.SELECTED,this.checkable&&this.checked||!1),t2(e,aL.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return null!=(e=this.opt_value)?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;let t=this.getElement();t&&this.isEnabled()&&(e?eq(t,"blocklyMenuItemHighlight"):e0(t,"blocklyMenuItemHighlight"))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(e){this.isEnabled()&&this.actionHandler&&this.actionHandler(this,e)}onAction(e,t){this.actionHandler=e.bind(t)}},lU=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.pointerLeaveHandler=this.pointerEnterHandler=this.clickHandler=this.pointerMoveHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){let t=document.createElement("div");t.className="blocklyMenu",t.tabIndex=0,this.roleName&&t1(t,this.roleName),this.element=t;for(let e=0,i;i=this.menuItems[e];e++)t.appendChild(i.createDom());return this.pointerMoveHandler=eS(t,"pointermove",this,this.handlePointerMove,!0),this.clickHandler=eS(t,"pointerup",this,this.handleClick,!0),this.pointerEnterHandler=eS(t,"pointerenter",this,this.handlePointerEnter,!0),this.pointerLeaveHandler=eS(t,"pointerleave",this,this.handlePointerLeave,!0),this.onKeyDownHandler=eS(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){let e=this.getElement();e&&e.focus({preventScroll:!0})}blur(){let e=this.getElement();e&&e.blur()}setRole(e){this.roleName=e}dispose(){this.pointerMoveHandler&&(ef(this.pointerMoveHandler),this.pointerMoveHandler=null),this.clickHandler&&(ef(this.clickHandler),this.clickHandler=null),this.pointerEnterHandler&&(ef(this.pointerEnterHandler),this.pointerEnterHandler=null),this.pointerLeaveHandler&&(ef(this.pointerLeaveHandler),this.pointerLeaveHandler=null),this.onKeyDownHandler&&(ef(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e=0,t;t=this.menuItems[e];e++)t.dispose();this.element=null}getMenuItem(e){let t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem")){let t=this.getMenuItems();for(let i=0,s;s=t[i];i++)if(s.getElement()===e)return s}e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;if(t&&(t.setHighlighted(!1),this.highlightedItem=null),e){e.setHighlighted(!0),this.highlightedItem=e,t=this.getElement();let i=e.getElement();t&&i&&(tN(i,t),t2(t,aL.ACTIVEDESCENDANT,e.getId()))}}highlightNext(){let e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){let e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>e?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){let i;e+=t;let s=this.getMenuItems();for(;i=s[e];){if(i.isEnabled()){this.setHighlighted(i);break}e+=t}}handlePointerMove(e){0!==Math.max(Math.abs(e.movementX),Math.abs(e.movementY))&&(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){var t=this.openingCoords;if(this.openingCoords=null,t&&"number"==typeof e.clientX){let i=new r4(e.clientX,e.clientY);if(1>r4.distance(t,i))return}(t=this.getMenuItem(e.target))&&t.performAction(e)}handlePointerEnter(e){this.focus()}handlePointerLeave(e){this.getElement()&&this.setHighlighted(null)}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.key){case"Enter":case" ":t&&t.performAction(e);break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){let e=this.getElement(),t=tO(e);return t.height=e.scrollHeight,t}getMenuItems(){return this.menuItems.filter(e=>e instanceof lx)}},lH=class{constructor(){this.element=null}createDom(){return this.element=document.createElement("hr"),this.element.className="blocklyMenuSeparator",t1(this.element,lv.SEPARATOR),this.element}dispose(){let e;null==(e=this.element)||e.remove(),this.element=null}},lW="_TEMP_COLLAPSED_INPUT",lV="_TEMP_COLLAPSED_FIELD",lK="MANUALLY_DISABLED";(aC=N.inputTypes$$module$build$src$core$inputs$input_types||(N.inputTypes$$module$build$src$core$inputs$input_types={}))[aC.VALUE=1]="VALUE",aC[aC.STATEMENT=3]="STATEMENT",aC[aC.DUMMY=5]="DUMMY",aC[aC.CUSTOM=6]="CUSTOM",aC[aC.END_ROW=7]="END_ROW",N.inputTypes$$module$build$src$core$inputs$input_types;var lX=new Set,lY=new WeakSet,lz=new WeakMap,lj=null,lJ=null,lZ=0,lq={};lq.finishQueuedRenders=t6,lq.queueRender=t5,lq.triggerQueuedRenders=t4,N.Msg$$module$build$src$core$msg=Object.create(null),aN=function(e){Object.keys(e).forEach(function(t){N.Msg$$module$build$src$core$msg[t]=e[t]})},ab={Msg:N.Msg$$module$build$src$core$msg,setLocale:aN};var lQ="blocklyToast",l0="blocklyToastMessage",l1="blocklyToastCloseButton",l2=class{static show(e,t){if(t.oncePerSession&&t.id){if(this.shownIds.has(t.id))return;this.shownIds.add(t.id)}this.hide(e);let i=this.createDom(e,t);requestAnimationFrame(()=>{i.style.bottom="2rem"})}static createDom(e,t){let i,{message:s,duration:o=5,assertiveness:n=l2.Assertiveness.POLITE}=t,r=document.createElement("div");e.getInjectionDiv().appendChild(r),r.dataset.toastId=t.id,r.className=lQ,t1(r,lv.STATUS),t2(r,aL.LIVE,n),(t=r.appendChild(document.createElement("div"))).className=l0,t.innerText=s,(t=r.appendChild(document.createElement("button"))).className=l1,t2(t,aL.LABEL,N.Msg$$module$build$src$core$msg.CLOSE);var l=eZ(r8.SVG,{width:24,height:24,viewBox:"0 0 24 24",fill:"none"},t);return t2(l,aL.HIDDEN,!0),eZ(r8.RECT,{x:19.7782,y:2.80762,width:2,height:24,transform:"rotate(45, 19.7782, 2.80762)",fill:"black"},l),eZ(r8.RECT,{x:2.80762,y:4.22183,width:2,height:24,transform:"rotate(-45, 2.80762, 4.22183)",fill:"black"},l),t.addEventListener("click",()=>{r.remove(),e.markFocused()}),t=()=>{i=setTimeout(()=>r.remove(),1e3*o)},l=()=>clearTimeout(i),r.addEventListener("focusin",l),r.addEventListener("focusout",t),r.addEventListener("mouseenter",l),r.addEventListener("mousemove",l),r.addEventListener("mouseleave",t),t(),r}static hide(e,t){(e=e.getInjectionDiv().querySelector(`.${lQ}`))instanceof HTMLElement&&(!t||t===e.dataset.toastId)&&e.remove()}};l2.shownIds=new Set,(af=(af=l2||(l2={})).Assertiveness||(af.Assertiveness={})).ASSERTIVE="assertive",af.POLITE="polite",tR(`
.${lQ} {
  font-size: 1.2rem;
  position: absolute;
  bottom: -10rem;
  right: 2rem;
  padding: 1rem;
  color: black;
  background-color: white;
  border: 2px solid black;
  border-radius: 0.4rem;
  z-index: 999;
  display: flex;
  align-items: center;
  gap: 0.8rem;
  line-height: 1.5;
  transition: bottom 0.3s ease-out;
}

.${lQ} .${l0} {
  maxWidth: 18rem;
}

.${lQ} .${l1} {
  margin: 0;
  padding: 0.2rem;
  background-color: transparent;
  color: black;
  border: none;
  cursor: pointer;
}
`);var l3=function(e,t){window.alert(e),t&&t()},l5=l3,l6=function(e,t){t(window.confirm(e))},l4=l6,l8=function(e,t,i){i(window.prompt(e,t))},l9=l8,l7=l2.show.bind(l2),ae=l7,at={};at.alert=is,at.confirm=io,at.prompt=ir,at.setAlert=function(e=l3){l5=e},at.setConfirm=function(e=l6){l4=e},at.setPrompt=function(e=l8){l9=e},at.setToast=function(e=l7){ae=e},at.toast=function(e,t){ae(e,t)};var ai={};ai.isLegacyProcedureCallBlock=ia,ai.isLegacyProcedureDefBlock=il;var as=new Set,ao={};ao.warn=ih;var an="VARIABLE",ar="ijkmnopqrstuvwxyzabcdefgh",al={generateUniqueNameInternal:function(e){return iI(ar.charAt(0),e.getVariableMap().getAllVariables().map(e=>e.getName()))}},aa={CATEGORY_NAME:an,TEST_ONLY:al,VAR_LETTER_OPTIONS:ar};aa.allDeveloperVariables=N.allDeveloperVariables$$module$build$src$core$variables,aa.allUsedVarModels=N.allUsedVarModels$$module$build$src$core$variables,aa.compareByName=iD,aa.createVariableButtonHandler=iR,aa.deleteVariable=N.deleteVariable$$module$build$src$core$variables,aa.flyoutCategory=id,aa.flyoutCategoryBlocks=ip,aa.generateUniqueName=ig,aa.generateUniqueNameFromOptions=iI,aa.generateVariableFieldDom=iN,aa.getAddedVariables=i$,aa.getOrCreateVariablePackage=N.getOrCreateVariablePackage$$module$build$src$core$variables,aa.getVariable=N.getVariable$$module$build$src$core$variables,aa.getVariableUsesById=iM,aa.internalFlyoutCategory=iu,aa.jsonFlyoutCategoryBlocks=i_,aa.nameUsedWithAnyType=iA,aa.nameUsedWithConflictingParam=iS,aa.promptName=im,aa.renameVariable=N.renameVariable$$module$build$src$core$variables;var ac=class extends Error{},ah=class extends ac{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},au=class extends ac{constructor(e,t,i){super(`The block ${t.toDevString()} is missing a(n) ${e}
connection`),this.block=t,this.state=i}},ad=class extends ac{constructor(e,t,i,s){super(`The block ${i.toDevString()} could not connect its
${t} to its parent, because: ${e}`),this.childBlock=i,this.childState=s}},aE=class extends ac{constructor(e){super("Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=e}},a_=class extends ac{constructor(e,t,i){super(`Cannot add an icon of type '${e}' to the block ${t.toDevString()}, because there is no icon registered with type '${e}'. Make sure that all of your icons have been registered.`),this.block=t,this.state=i}},aT={};aT.BadConnectionCheck=ad,aT.DeserializationError=ac,aT.MissingBlockType=ah,aT.MissingConnection=au,aT.RealChildOfShadow=aE,aT.UnregisteredIcon=a_;var ap=class{constructor(){this.priority=50}save(e){let t=[];for(let i of e.getTopBlocks(!1))(e=iP(i,{addCoordinates:!0,doFullSerialization:!1}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){for(let i of e=e.blocks)iU(i,t,{recordUndo:ex()})}clear(e){for(let t of e.getTopBlocks(!1))t.dispose(!1)}};tj("blocks",new ap);var ag={};ag.BlockSerializer=ap,ag.append=iU,ag.appendInternal=iH,ag.save=iP;var aI=class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}};aI.MUTATOR=new aI("mutator"),aI.WARNING=new aI("warning"),aI.COMMENT=new aI("comment");var aR=class extends rz{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){let e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new aR)).blockId=e.blockId,t}},am=class extends aR{constructor(e,t,i,s,o){super(e),this.type=rC.BLOCK_CHANGE,e&&(this.element=t,this.name=i||void 0,this.oldValue=s,this.newValue=o)}toJson(){let e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,this.disabledReason&&(e.disabledReason=this.disabledReason),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new am)).element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,void 0!==e.disabledReason&&(t.disabledReason=e.disabledReason),t}setDisabledReason(e){if("disabled"!==this.element)throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=e}isNull(){return this.oldValue===this.newValue}run(e){var t,i=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(i=i.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");let s=i.getIcon(aI.MUTATOR);switch(s&&i1(s)&&s.bubbleIsVisible()&&s.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(i=i.getField(this.name))?i.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":i.setCommentText(e||null);break;case"collapsed":i.setCollapsed(!!e);break;case"disabled":i.setDisabledReason(!!e,null!=(t=this.disabledReason)?t:lK);break;case"inline":i.setInputsInline(!!e);break;case"mutation":t=am.getExtraBlockState_(i),i.loadExtraState?i.loadExtraState(JSON.parse(e||"{}")):i.domToMutation&&i.domToMutation(N.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),eU(new am(i,"mutation",null,t,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?oT(e):""}};ea(M.EVENT,rC.BLOCK_CHANGE,am);var aO={};aO.clamp=i3,aO.toDegrees=function(e){return 180*e/Math.PI},aO.toRadians=i2;var aA,aS,aC,af,aL,aN,ab,a$,aD,aM,aP=16,ay=1,ak=12,aw=16,av=.25,aB=null,aG=null,aF="",ax="",aU=null,aH=null,aW=null,aV=null,aK=null,aX={getBoundsInfo:function(){let e=tC(aU),t=tO(aU);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,i,s){var o;let n=aX.getBoundsInfo(),r=tO(a$);return t+r.height<n.bottom?sn(e,t,n,r):s-r.height>n.top?sr(i,s,n,r):t+r.height<document.documentElement.clientHeight?sn(e,t,n,r):s-r.height>document.documentElement.clientTop?sr(i,s,n,r):{initialX:(o=sl(o=e,n.left,n.right,r.width)).divX,initialY:0,finalX:o.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}}},aY={ANIMATION_TIME:.25,ARROW_HORIZONTAL_PADDING:12,ARROW_SIZE:16,BORDER_SIZE:1,PADDING_Y:16,TEST_ONLY:aX};aY.clearContent=i9,aY.createDom=i5,aY.getContentDiv=i8,aY.getOwner=i4,aY.getPositionX=sl,aY.hide=sh,aY.hideIfOwner=sc,aY.hideWithoutAnimation=su,aY.isVisible=sa,aY.repositionForWindowResize=sE,aY.setBoundsElement=i6,aY.setColour=i7,aY.show=so,aY.showPositionedByBlock=function(e,t,i,s,o=!0){return ss(st(t),e,o,i,s)},aY.showPositionedByField=se;var az={};az.commonWordPrefix=sT,az.commonWordSuffix=sp,az.isNumber=N.isNumber$$module$build$src$core$utils$string,az.shortestStringLength=s_,az.wrap=N.wrap$$module$build$src$core$utils$string;var aj=void 0,aJ=!1,aZ=!1,aq=50,aQ=0,a0=0,a1=0,a2=0,a3=null,a5=null,a6=0,a4=10,a8=10,a9=750,a7=5,ce=null,ct={HOVER_MS:750,LIMIT:50,MARGINS:5,OFFSET_X:0,OFFSET_Y:10,RADIUS_OK:10};ct.bindMouseEvents=sC,ct.block=sM,ct.createDom=sS,ct.dispose=s$,ct.getCustomTooltip=function(){return aj},ct.getDiv=function(){return ce},ct.getTooltipOfObject=sO,ct.hide=sD,ct.isVisible=function(){return aJ},ct.setCustomTooltip=function(e){aj=e},ct.unbindMouseEvents=sf,ct.unblock=sP;var ci=.45,cs=.65,co={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},cn={};cn.blend=sW,cn.getHsvSaturation=sB,cn.getHsvValue=sG,cn.hexToRgb=sU,cn.hsvToHex=sH,cn.hueToHex=sV,cn.names=co,cn.parse=sF,cn.rgbToHex=sx,cn.setHsvSaturation=function(e){ci=e},cn.setHsvValue=function(e){cs=e};var cr={};cr.checkMessageReferences=function(e){let t=!0,i=N.Msg$$module$build$src$core$msg,s=e.match(/%{BKY_[A-Z]\w*}/gi);if(s)for(let o=0;o<s.length;o++)void 0===i[s[o].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+s[o]+" in "+e),t=!1);return t},cr.parseBlockColour=sz,cr.replaceMessageReferences=sY,cr.tokenizeInterpolation=sX;var cl=class{get size_(){return this.size}set size_(e){this.size=e}constructor(e,t,i){this.DEFAULT_VALUE=null,this.name=void 0,this.tooltip=this.validator_=null,this.size=new r7(0,0),this.constants_=this.mouseDownWrapper=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.id_=null,this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new r7(0,0),e!==cl.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(sY(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=e,this.id_=`${e.id}_field_${eD()}`}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){if(!this.fieldGroup_){var e=this.id_;if(!e)throw Error("Expected ID to be defined prior to init.");this.fieldGroup_=eZ(r8.G,{id:e}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip),this.bindEvents_(),this.initModel(),this.applyColour()}}initView(){this.createBorderRect_(),this.createTextElement_(),this.fieldGroup_&&eq(this.fieldGroup_,"blocklyField")}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=eZ(r8.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=eZ(r8.TEXT,{class:"blocklyText blocklyFieldText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){let e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");sC(e),this.mouseDownWrapper=eS(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return null!==(e=this.saveLegacyState(cl))?e:this.getValue()}loadState(e){this.loadLegacyState(cl,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?((e=N.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",this.name||""),tw(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml&&(this.fromXml(N.textToDom$$module$build$src$core$utils$xml(t)),!0)}dispose(){let e;sc(this),s0(this),(null==(e=this.getSourceBlock())?0:e.isDeadOrDying())||e2(this.fieldGroup_),this.disposed=!0}updateEditable(){let e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(eq(e,"blocklyEditableField"),e0(e,"blocklyNonEditableField")):(eq(e,"blocklyNonEditableField"),e0(e,"blocklyEditableField")))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==cl.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){let t=this.getConstants(),i=2*(e=void 0!==e?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING),s=t.FIELD_TEXT_HEIGHT,o=0;this.textElement_&&(i+=o=e8(this.textElement_)),this.isFullBlockField()||(s=Math.max(s,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=s,this.size_.width=i,this.positionTextElement_(e,o),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var i,s=this.getConstants(),o=this.size_.height/2;this.textElement_.setAttribute("x",String((null==(i=this.getSourceBlock())?0:i.RTL)?this.size_.width-t-e:e)),this.textElement_.setAttribute("y",String(s.FIELD_TEXT_BASELINE_CENTER?o:o-s.FIELD_TEXT_HEIGHT/2+s.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_&&(this.render_(),this.isDirty_=!1),this.size_):new r7(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new ca;if(this.isFullBlockField()){var i=this.sourceBlock_.getHeightWidth();let s=t.workspace.scale;e=this.getAbsoluteXY_(),t=(i.width+1)*s,i=(i.height+1)*s,rI?(e.x+=1.5*s,e.y+=1.5*s):(e.x-=.5*s,e.y-=.5*s)}else i=this.borderRect_.getBoundingClientRect(),e=tC(this.borderRect_),t=i.width,i=i.height;return new r9(e.y,e.y+i,e.x,e.x+t)}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"…"),e=e.replace(/\s/g,cl.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="‏"),e}getText(){let e=this.getText_();return null!==e?String(e):String(this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(e,t=!0){if(null!==e){var i=N.getGroup$$module$build$src$core$events$utils();i||N.setGroup$$module$build$src$core$events$utils(!0);try{let i=this.doClassValidation_(e),a=this.processValidation(e,i,t);if(!(a instanceof Error)){var s,o=null==(s=this.getValidator())?void 0:s.call(this,a),n=this.processValidation(a,o,t);if(!(n instanceof Error)){var r=this.sourceBlock_;if(!r||!r.disposed){var l=this.getValue();l===n?this.doValueUpdate_(n):(this.doValueUpdate_(n),t&&r&&eX()&&eU(new(ej(rC.BLOCK_CHANGE))(r,"field",this.name||null,l,n)),this.isDirty_&&this.forceRerender())}}}}finally{N.setGroup$$module$build$src$core$events$utils(i)}}}processValidation(e,t,i){return null===t?(this.doValueInvalid_(e,i),this.isDirty_&&this.forceRerender(),Error()):void 0===t?e:t}getValue(){return this.value_}doClassValidation_(e){return null==e?null:e}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e,t){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||""===e||(e=this.sourceBlock_);let t=this.getClickTarget_();t?t.tooltip=e:this.tooltip=e}getTooltip(){let e=this.getClickTarget_();return e?sO(e):sO({tooltip:this.tooltip})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return tC(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let e=null,t=this.getSourceBlock();if(!t)throw new ca;let i=t.inputList;for(let s=0;s<t.inputList.length;s++){let t=i[s],o=t.fieldRow;for(let i=0;i<o.length;i++)if(o[i]===this){e=t;break}}return e}getFlipRtl(){return!1}onShortcut(e){return!1}getFocusableElement(){if(!this.fieldGroup_)throw Error("This field currently has no representative DOM element.");return this.fieldGroup_}getFocusableTree(){let e=this.getSourceBlock();if(!e)throw new ca;return e.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}static fromJson(e){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}};cl.NBSP=" ",cl.SKIP_SETUP=Symbol("SKIP_SETUP");var ca=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},cc={};cc.Field=cl,cc.UnattachedFieldError=ca;var ch,cu=null,cd=null,cE=null,c_="blocklyWidgetDiv",cT="",cp="",cg=null,cI={};cI.createDom=sJ,cI.getDiv=sj,cI.hide=sq,cI.hideIfOwner=s0,cI.hideIfOwnerIsInWorkspace=s1,cI.isVisible=sQ,cI.positionWithAnchor=s3,cI.repositionForWindowResize=s4,cI.show=sZ,cI.testOnly_setDiv=function(e){if(ch=e,null===e){let e;null==(e=document.querySelector("."+c_))||e.remove()}};var cR=null,cm={},cO=null,cA={};cA.callbackFactory=N.callbackFactory$$module$build$src$core$contextmenu,cA.dispose=oo,cA.getCurrentBlock=function(){return cR},cA.hide=os,cA.setCurrentBlock=s8,cA.show=s9;var cS=class{constructor(){this.registeredItems=new Map,this.reset()}reset(){this.registeredItems.clear()}register(e){if(this.registeredItems.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registeredItems.set(e.id,e)}unregister(e){if(!this.registeredItems.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registeredItems.delete(e)}getItem(e){let t;return null!=(t=this.registeredItems.get(e))?t:null}getContextMenuOptions(e,t){let i=[];for(let s of this.registeredItems.values()){let o;if(!s.scopeType||(s.scopeType!==cC.BLOCK||e.block)&&(s.scopeType!==cC.COMMENT||e.comment)&&(s.scopeType!==cC.WORKSPACE||e.workspace)){if(o={scope:e,weight:s.weight},s.separator)o=Object.assign({},o,{separator:!0});else{let i=s.preconditionFn(e,t);if("hidden"===i)continue;o=Object.assign({},o,{text:"function"==typeof s.displayText?s.displayText(e):s.displayText,callback:s.callback,enabled:"enabled"===i})}i.push(o)}}return i.sort(function(e,t){return e.weight-t.weight}),i}};(cV=(cW=cS||(cS={})).ScopeType||(cW.ScopeType={})).BLOCK="block",cV.WORKSPACE="workspace",cV.COMMENT="comment",cW.registry=new cW;var cC=cS.ScopeType,cf={};cf.ContextMenuRegistry=cS,cf.ScopeType=cC;var cL=class{constructor(e){this.comment=e,this.startLoc=null,this.workspace=e.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.comment.isDeadOrDying()&&!this.workspace.isReadOnly()}startDrag(){let e;this.fireDragStartEvent(),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(e){this.comment.moveDuringDrag(e)}endDrag(){let e;this.fireDragEndEvent(),this.fireMoveEvent(),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.comment,50),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0)}fireDragStartEvent(){eU(new(ej(rC.COMMENT_DRAG))(this.comment,!0))}fireDragEndEvent(){eU(new(ej(rC.COMMENT_DRAG))(this.comment,!1))}fireMoveEvent(){if(!this.comment.isDeadOrDying()){var e=new(ej(rC.COMMENT_MOVE))(this.comment);e.setReason(["drag"]),e.oldCoordinate_=this.startLoc,e.recordNew(),eU(e)}}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},cN=new WeakMap,cb={};cb.move=ol,cb.start=or;var c$=class{constructor(e){let t;this.workspace=e,this.collapsed=!1,this.editable=!0,this.location=new r4(0,0),this.text="",this.textChangeListeners=[],this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=eZ(r8.G,{class:"blocklyComment blocklyEditable blocklyDraggable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),({topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteIcon:this.deleteIcon,foldoutIcon:this.foldoutIcon,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot,e)),({foreignObject:this.foreignObject,textArea:this.textArea}=this.createTextArea(this.svgRoot)),this.resizeHandle=this.createResizeHandle(this.svgRoot,e),null==(t=e.getLayerManager())||t.append(this,50),this.size=c$.defaultCommentSize,this.setSizeWithoutFiringEvents(this.size),this.moveTo(new r4(0,0))}createHighlightRect(e){return eZ(r8.RECT,{class:"blocklyCommentHighlight"},e)}createTopBar(e,t){e=eZ(r8.G,{class:"blocklyCommentTopbar"},e);let i=eZ(r8.RECT,{class:"blocklyCommentTopbarBackground"},e),s=eZ(r8.IMAGE,{class:"blocklyDeleteIcon",href:`${t.options.pathToMedia}delete-icon.svg`},e);t=eZ(r8.IMAGE,{class:"blocklyFoldoutIcon",href:`${t.options.pathToMedia}foldout-icon.svg`},e);let o=eZ(r8.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},e),n=document.createTextNode("");return o.appendChild(n),eS(t,"pointerdown",this,this.onFoldoutDown),eS(s,"pointerdown",this,this.onDeleteDown),{topBarGroup:e,topBarBackground:i,deleteIcon:s,foldoutIcon:t,textPreview:o,textPreviewNode:n}}createTextArea(e){e=eZ(r8.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"},e);let t=document.createElementNS(rN,"body");t.setAttribute("xmlns",rN),t.className="blocklyMinimalBody";let i=document.createElementNS(rN,"textarea");return eq(i,"blocklyCommentText"),eq(i,"blocklyTextarea"),eq(i,"blocklyText"),t.appendChild(i),e.appendChild(t),eS(i,"change",this,this.onTextChange),{foreignObject:e,textArea:i}}createResizeHandle(e,t){return eS(e=eZ(r8.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),"pointerdown",this,this.onResizePointerDown),e}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSizeWithoutFiringEvents(e){let t=this.topBarBackground.getBBox(),i=this.deleteIcon.getBBox(),s=this.foldoutIcon.getBBox(),o=this.textPreview.getBBox(),n=this.resizeHandle.getBBox();this.size=e=r7.max(e,this.calcMinSize(t,s,i)),this.svgRoot.setAttribute("height",`${e.height}`),this.svgRoot.setAttribute("width",`${e.width}`),this.updateHighlightRect(e),this.updateTopBarSize(e),this.updateTextAreaSize(e,t),this.updateDeleteIconPosition(e,t,i),this.updateFoldoutIconPosition(t,s),this.updateTextPreviewSize(e,t,o,i,n),this.updateResizeHandlePosition(e,n)}setSize(e){let t=this.preResizeSize||this.size;this.setSizeWithoutFiringEvents(e),this.onSizeChange(t,this.size)}calcMinSize(e,t,i){var s;this.updateTextPreview(null!=(s=this.textArea.value)?s:""),s=e8(this.textPreview);let o=this.calcFoldoutMargin(e,t),n=this.calcDeleteMargin(e,i),r=s;return this.foldoutIcon.checkVisibility()?r+=t.width+2*o:s&&(r+=4),this.deleteIcon.checkVisibility()?r+=i.width+2*n:s&&(r+=4),new r7(r,e.height+20)}calcDeleteMargin(e,t){return(e.height-t.height)/2}calcFoldoutMargin(e,t){return(e.height-t.height)/2}updateHighlightRect(e){this.highlightRect.setAttribute("height",`${e.height}`),this.highlightRect.setAttribute("width",`${e.width}`),this.workspace.RTL&&this.highlightRect.setAttribute("x",`${-e.width}`)}updateTopBarSize(e){this.topBarBackground.setAttribute("width",`${e.width}`)}updateTextAreaSize(e,t){this.foreignObject.setAttribute("height",`${e.height-t.height}`),this.foreignObject.setAttribute("width",`${e.width}`),this.foreignObject.setAttribute("y",`${t.height}`),this.workspace.RTL&&this.foreignObject.setAttribute("x",`${-e.width}`)}updateDeleteIconPosition(e,t,i){t=this.calcDeleteMargin(t,i),this.deleteIcon.setAttribute("y",`${t}`),this.deleteIcon.setAttribute("x",`${e.width-i.width-t}`)}updateFoldoutIconPosition(e,t){e=this.calcFoldoutMargin(e,t),this.foldoutIcon.setAttribute("y",`${e}`),this.foldoutIcon.setAttribute("x",`${e}`)}updateTextPreviewSize(e,t,i,s,o){let n=(t.height-i.height)/2,r=this.calcDeleteMargin(t,s);t=this.calcFoldoutMargin(t,o),e=e.width-o.width-2*t-s.width-2*r,this.textPreview.setAttribute("x",`${o.width+2*t*(this.workspace.RTL?-1:1)}`),this.textPreview.setAttribute("y",`${n+i.height/2}`),this.textPreview.setAttribute("width",`${e}`)}updateResizeHandlePosition(e,t){this.resizeHandle.setAttribute("y",`${e.height-t.height}`),this.resizeHandle.setAttribute("x",`${e.width-t.width}`)}onSizeChange(e,t){for(let i=this.sizeChangeListeners.length-1;0<=i;i--)this.sizeChangeListeners[i](e,t)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}removeSizeChangeListener(e){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(e),1)}onResizePointerDown(e){this.isEditable()&&(this.bringToFront(),eN(e)||(this.preResizeSize=this.getSize(),or(this.workspace,e,new r4(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=eS(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=eS(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation())}onResizePointerUp(e){eR(),this.resizePointerUpListener&&(ef(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(ef(this.resizePointerMoveListener),this.resizePointerMoveListener=null),this.setSize(this.size),this.preResizeSize=void 0}onResizePointerMove(e){e=ol(this.workspace,e),this.setSizeWithoutFiringEvents(new r7(this.workspace.RTL?-e.x:e.x,e.y))}isCollapsed(){return this.collapsed}setCollapsed(e){(this.collapsed=e)?eq(this.svgRoot,"blocklyCollapsed"):e0(this.svgRoot,"blocklyCollapsed"),this.setSizeWithoutFiringEvents(this.size),this.onCollapse()}onCollapse(){for(let e=this.collapseChangeListeners.length-1;0<=e;e--)this.collapseChangeListeners[e](this.collapsed)}addOnCollapseListener(e){this.collapseChangeListeners.push(e)}removeOnCollapseListener(e){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(e),1)}onFoldoutDown(e){eR(),this.bringToFront(),eN(e)||(this.setCollapsed(!this.collapsed),this.workspace.hideChaff()),e.stopPropagation()}isEditable(){return this.editable}setEditable(e){(this.editable=e)?(eq(this.svgRoot,"blocklyEditable"),e0(this.svgRoot,"blocklyReadonly"),this.textArea.removeAttribute("readonly")):(e0(this.svgRoot,"blocklyEditable"),eq(this.svgRoot,"blocklyReadonly"),this.textArea.setAttribute("readonly","true"))}getRelativeToSurfaceXY(){return this.location}moveTo(e){this.location=e,this.svgRoot.setAttribute("transform",`translate(${e.x}, ${e.y})`)}getText(){return this.text}setText(e){this.textArea.value=e,this.onTextChange()}setPlaceholderText(e){this.textArea.placeholder=e}addTextChangeListener(e){this.textChangeListeners.push(e)}removeTextChangeListener(e){this.textChangeListeners.splice(this.textChangeListeners.indexOf(e),1)}onTextChange(){let e=this.text;this.text=this.textArea.value,this.updateTextPreview(this.text),this.setSize(this.size);for(let t=this.textChangeListeners.length-1;0<=t;t--)this.textChangeListeners[t](e,this.text)}updateTextPreview(e){this.textPreviewNode.textContent=this.truncateText(e)}truncateText(e){return 12<=e.length?`${e.substring(0,9)}...`:e}bringToFront(){let e=this.svgRoot.parentNode,t=e.childNodes;t[t.length-1]!==this.svgRoot&&e.appendChild(this.svgRoot)}onDeleteDown(e){eR(),eN(e)||this.dispose(),e.stopPropagation()}dispose(){this.disposing=!0,e2(this.svgRoot);for(let e=this.disposeListeners.length-1;0<=e;e--)this.disposeListeners[e]();this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(e){this.disposeListeners.push(e)}removeDisposeListener(e){this.disposeListeners.splice(this.disposeListeners.indexOf(e),1)}};c$.defaultCommentSize=new r7(120,100),tR("\n.injectionDiv {\n  --commentFillColour: #FFFCC7;\n  --commentBorderColour: #F2E49B;\n}\n\n.blocklyComment .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 1px solid var(--commentBorderColour);\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n\n.blocklyReadonly.blocklyComment .blocklyTextarea {\n  cursor: inherit;\n}\n\n.blocklyDeleteIcon {\n  width: 20px;\n  height: 20px;\n  display: none;\n  cursor: pointer;\n}\n\n.blocklyFoldoutIcon {\n  width: 20px;\n  height: 20px;\n  transform-origin: 12px 12px;\n  cursor: pointer;\n}\n.blocklyResizeHandle {\n  width: 12px;\n  height: 12px;\n  cursor: se-resize;\n}\n.blocklyReadonly.blocklyComment .blocklyResizeHandle {\n  cursor: inherit;\n}\n\n.blocklyCommentTopbarBackground {\n  fill: var(--commentBorderColour);\n  height: 24px;\n}\n\n.blocklyComment .blocklyCommentPreview.blocklyText {\n  fill: #000;\n  dominant-baseline: middle;\n  visibility: hidden;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentPreview {\n  visibility: visible;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,\n.blocklyCollapsed.blocklyComment .blocklyResizeHandle {\n  display: none;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {\n  transform: rotate(-90deg);\n}\n\n.blocklyRTL .blocklyCommentTopbar {\n  transform: scale(-1, 1);\n}\n\n.blocklyRTL .blocklyCommentForeignObject {\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyCommentPreview {\n  /* Revert the scale and control RTL using direction instead. */\n  transform: scale(-1, 1);\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyResizeHandle {\n  transform: scale(-1, 1);\n  cursor: sw-resize;\n}\n\n.blocklyCommentHighlight {\n  fill: none;\n}\n\n.blocklySelected .blocklyCommentHighlight {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {\n  stroke: none;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n");var cD=class{constructor(e,t){this.workspace=e,this.text="",this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new r4(0,0),this.disposing=this.disposed=!1,this.id=t&&!e.getCommentById(t)?t:eM(),this.size=c$.defaultCommentSize,e.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){eX()&&eU(new(ej(rC.COMMENT_CREATE))(this))}fireDeleteEvent(){eX()&&eU(new(ej(rC.COMMENT_DELETE))(this))}fireChangeEvent(e,t){eX()&&eU(new(ej(rC.COMMENT_CHANGE))(this,e,t))}fireCollapseEvent(e){eX()&&eU(new(ej(rC.COMMENT_COLLAPSE))(this,e))}setText(e){let t=this.text;this.text=e,this.fireChangeEvent(t,e)}getText(){return this.text}setSize(e){let t=new(ej(rC.COMMENT_RESIZE))(this);this.size=e,t.recordCurrentSizeAsNewSize(),eU(t)}getSize(){return this.size}setCollapsed(e){this.collapsed=e,this.fireCollapseEvent(e)}isCollapsed(){return this.collapsed}setEditable(e){this.editable=e}isEditable(){return this.isOwnEditable()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setMovable(e){this.movable=e}isMovable(){return this.isOwnMovable()&&!this.workspace.isReadOnly()}isOwnMovable(){return this.movable}setDeletable(e){this.deletable=e}isDeletable(){return this.isOwnDeletable()&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnDeletable(){return this.deletable}moveTo(e,t){let i=new(ej(rC.COMMENT_MOVE))(this);t&&i.setReason(t),this.location=e,i.recordNew(),eU(i)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}},cM=class extends cD{constructor(e,t){super(e,t),this.dragStrategy=new cL(this),this.workspace=e,this.view=new c$(e),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.view.getSvgRoot().setAttribute("data-id",this.id),this.view.getSvgRoot().setAttribute("id",this.id),this.addModelUpdateBindings(),eS(this.view.getSvgRoot(),"pointerdown",this,this.startGesture),eS(this.view.getSvgRoot(),"wheel",this,e=>{e.stopPropagation()})}addModelUpdateBindings(){this.view.addTextChangeListener((e,t)=>void super.setText(t)),this.view.addSizeChangeListener((e,t)=>void super.setSize(t)),this.view.addOnCollapseListener(()=>void super.setCollapsed(this.view.isCollapsed())),this.view.addDisposeListener(()=>{this.isDeadOrDying()||this.dispose()})}setText(e){this.view.setText(e)}setPlaceholderText(e){this.view.setPlaceholderText(e)}setSize(e){this.view.setSize(e)}setCollapsed(e){this.view.setCollapsed(e)}setEditable(e){super.setEditable(e),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){var e,t;let i=this.getRelativeToSurfaceXY(),s=null!=(t=null==(e=this.view)?void 0:e.getSize())?t:this.getSize();return this.workspace.RTL?(e=i.x-s.width,t=i.x):(e=i.x,t=i.x+s.width),new r9(i.y,i.y+s.height,e,t)}moveBy(e,t,i){let s=this.getRelativeToSurfaceXY();e=new r4(s.x+e,s.y+t),this.moveTo(e,i)}moveTo(e,t){super.moveTo(e,t),this.view.moveTo(e)}moveDuringDrag(e){this.location=e,this.view.moveTo(e)}setDragging(e){e?eq(this.getSvgRoot(),"blocklyDragging"):e0(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0;let e=N.getFocusManager$$module$build$src$core$focus_manager();e.getFocusedNode()===this&&setTimeout(()=>e.focusTree(this.workspace),0),this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(e){let t=this.workspace.getGesture(e);t&&(eL(e)?e.stopPropagation():t.handleCommentStart(e,this),N.getFocusManager$$module$build$src$core$focus_manager().focusNode(this))}setDeleteStyle(e){e?eq(this.getSvgRoot(),"blocklyDraggingDelete"):e0(this.getSvgRoot(),"blocklyDraggingDelete")}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){eq(this.getSvgRoot(),"blocklySelected"),th(this)}unselect(){e0(this.getSvgRoot(),"blocklySelected"),th(null)}toCopyData(){return{paster:lb.TYPE,commentState:tJ(this,{addCoordinates:!0})}}showContextMenu(e){let t,i=cS.registry.getContextMenuOptions({comment:this,focusedNode:this},e);t=e instanceof PointerEvent?new r4(e.clientX,e.clientY):tk(this.workspace,this.getRelativeToSurfaceXY()).translate(10,10),s9(e,i,this.workspace.RTL,this.workspace,t)}snapToGrid(){if(!this.isDeadOrDying()){var e=this.workspace.getGrid();if(null!=e&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();(e=e.alignXY(t))!==t&&this.moveTo(e,["snap"])}}}getFocusableElement(){return this.getSvgRoot()}getFocusableTree(){return this.workspace}onNodeFocus(){let e;this.select(),null==(e=this.workspace.getLayerManager())||e.append(this,50)}onNodeBlur(){this.unselect()}canBeFocused(){return!0}},cP={};cP.appendDomToWorkspace=function(e,t){if(!t.getBlocksBoundingBox)return N.domToWorkspace$$module$build$src$core$xml(e,t);var i=t.getBlocksBoundingBox();if(e=N.domToWorkspace$$module$build$src$core$xml(e,t),i&&i.top!==i.bottom){var s=i.bottom;i=t.RTL?i.right:i.left;var o=1/0;let n=-1/0,r=1/0;for(let i=0;i<e.length;i++){let s=t.getBlockById(e[i]).getRelativeToSurfaceXY();s.y<r&&(r=s.y),s.x<o&&(o=s.x),s.x>n&&(n=s.x)}for(s=s-r+10,i=t.RTL?i-n:i-o,o=0;o<e.length;o++)t.getBlockById(e[o]).moveBy(i,s,["create"])}return e},cP.blockToDom=oE,cP.blockToDomWithXY=oh,cP.clearWorkspaceAndLoadFromXml=function(e,t){return t.setResizesEnabled(!1),t.clear(),e=N.domToWorkspace$$module$build$src$core$xml(e,t),t.setResizesEnabled(!0),e},cP.deleteNext=function(e){for(let t=0;t<e.childNodes.length;t++){let i=e.childNodes[t];if("next"===i.nodeName.toLowerCase()){e.removeChild(i);break}}},cP.domToBlock=N.domToBlock$$module$build$src$core$xml,cP.domToBlockInternal=og,cP.domToPrettyText=function(e){e=oT(e).split("<");let t="";for(let i=1;i<e.length;i++){let s=e[i];"/"===s[0]&&(t=t.substring(2)),e[i]=t+"<"+s,"/"!==s[0]&&"/>"!==s.slice(-2)&&(t+="  ")}return(e=(e=e.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},cP.domToText=oT,cP.domToVariables=oI,cP.domToWorkspace=N.domToWorkspace$$module$build$src$core$xml,cP.loadWorkspaceComment=op,cP.saveWorkspaceComment=oa,cP.variablesToDom=oc,cP.workspaceToDom=function(e,t=!1){let i=N.createElement$$module$build$src$core$utils$xml("xml");var s=oc(N.allUsedVarModels$$module$build$src$core$variables(e));for(let o of(s.hasChildNodes()&&i.appendChild(s),e.getTopComments()))i.appendChild(oa(o,t));for(s=0,e=e.getTopBlocks(!0);s<e.length;s++)i.appendChild(oh(e[s],t));return i};var cy=class extends aR{constructor(e){super(e),this.type=rC.BLOCK_CREATE,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=oh(e),this.ids=eY(e),this.json=iP(e,{addCoordinates:!0}))}toJson(){let e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=oT(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new cy)).xml=N.textToDom$$module$build$src$core$utils$xml(e.xml),t.ids=e.ids,t.json=e.json,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){let t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!ck(t,this.ids))if(e)iU(this.json,t);else for(e=0;e<this.ids.length;e++){let i=this.ids[e],s=t.getBlockById(i);s?s.dispose(!1):i===this.blockId&&console.warn("Can't uncreate non-existent block: "+i)}}},ck=function(e,t){return t.map(t=>e.getBlockById(t)).filter(e=>e&&e.isShadow()).length===t.length};ea(M.EVENT,rC.BLOCK_CREATE,cy);var cw=class extends rj{constructor(e,t){super(t),this.type=rC.THEME_CHANGE,this.themeName=e}toJson(){let e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new cw)).themeName=e.themeName,t}};ea(M.EVENT,rC.THEME_CHANGE,cw);var cv=class extends rj{constructor(e,t,i,s,o){super(s),this.type=rC.VIEWPORT_CHANGE,this.viewTop=e,this.viewLeft=t,this.scale=i,this.oldScale=o}toJson(){let e=super.toJson();if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new cv)).viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};ea(M.EVENT,rC.VIEWPORT_CHANGE,cv),(cK=cX||(cX={}))[cK.INPUT_VALUE=1]="INPUT_VALUE",cK[cK.OUTPUT_VALUE=2]="OUTPUT_VALUE",cK[cK.NEXT_STATEMENT=3]="NEXT_STATEMENT",cK[cK.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT";var cB=class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,t){t=this.calculateIndexForYPos(t),this.connections.splice(t,0,e)}findIndexOfConnection(e,t){if(!this.connections.length)return -1;let i=this.calculateIndexForYPos(t);if(i>=this.connections.length)return -1;t=e.y;let s=i;for(;0<=s&&this.connections[s].y===t;){if(this.connections[s]===e)return s;s--}for(s=i;s<this.connections.length&&this.connections[s].y===t;){if(this.connections[s]===e)return s;s++}return -1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let t=0,i=this.connections.length;for(;t<i;){let s=Math.floor((t+i)/2);if(this.connections[s].y<e)t=s+1;else if(this.connections[s].y>e)i=s;else{t=s;break}}return t}removeConnection(e,t){if(-1===(e=this.findIndexOfConnection(e,t)))throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,t){function i(e){let i=o-s[e].x,r=n-s[e].y;return Math.sqrt(i*i+r*r)<=t&&a.push(s[e]),r<t}let s=this.connections,o=e.x,n=e.y;e=0;let r=s.length-2,l=r;for(;e<l;)s[l].y<n?e=l:r=l,l=Math.floor((e+r)/2);let a=[];if(r=e=l,s.length){for(;0<=e&&i(e);)e--;do r++;while(r<s.length&&i(r))}return a}isInYRange(e,t,i){return Math.abs(this.connections[e].y-t)<=i}searchForClosest(e,t,i){if(!this.connections.length)return{connection:null,radius:t};let s=e.y,o=e.x;e.x=o+i.x,e.y=s+i.y;var n=this.calculateIndexForYPos(e.y);i=null;let r=t,l,a=n-1;for(;0<=a&&this.isInYRange(a,e.y,t);)l=this.connections[a],this.connectionChecker.canConnect(e,l,!0,r)&&(i=l,r=l.distanceFrom(e)),a--;for(;n<this.connections.length&&this.isInYRange(n,e.y,t);)l=this.connections[n],this.connectionChecker.canConnect(e,l,!0,r)&&(i=l,r=l.distanceFrom(e)),n++;return e.x=o,e.y=s,{connection:i,radius:r}}static init(e){let t=[];return t[cX.INPUT_VALUE]=new cB(e),t[cX.OUTPUT_VALUE]=new cB(e),t[cX.NEXT_STATEMENT]=new cB(e),t[cX.PREVIOUS_STATEMENT]=new cB(e),t}},cG=class extends rj{constructor(e,t,i){super(i),this.type=rC.SELECTED,this.oldElementId=null!=e?e:void 0,this.newElementId=null!=t?t:void 0}toJson(){let e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new cG)).oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};ea(M.EVENT,rC.SELECTED,cG);var cF=class extends aR{constructor(e){if(super(e),this.type=rC.BLOCK_DELETE,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=oh(e),this.ids=eY(e),this.wasShadow=e.isShadow(),this.oldJson=iP(e,{addCoordinates:!0})}}toJson(){let e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=oT(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new cF)).oldXml=N.textToDom$$module$build$src$core$utils$xml(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||"shadow"===t.oldXml.tagName.toLowerCase(),t.oldJson=e.oldJson,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){let t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){let i=this.ids[e],s=t.getBlockById(i);s?s.dispose(!1):i===this.blockId&&console.warn("Can't delete non-existent block: "+i)}else iU(this.oldJson,t)}};ea(M.EVENT,rC.BLOCK_DELETE,cF);var cx={fromJsonInternal:function(e){let t=e_(M.FIELD,e.type);return t?t.fromJson(e):(console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)}},cU={TEST_ONLY:cx};cU.fromJson=N.fromJson$$module$build$src$core$field_registry,cU.register=oD,cU.unregister=function(e){eh(M.FIELD,e)};var cH=class extends cl{constructor(e,t,i){super(cl.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==cl.SKIP_SETUP&&(this.setOptions(e),i&&this.configure_(i),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(cH,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=eZ(r8.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&eq(this.borderRect_,"blocklyDropdownRect"),this.fieldGroup_&&(eq(this.fieldGroup_,"blocklyField"),eq(this.fieldGroup_,"blocklyDropdownField"))}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null==(e=this.getSourceBlock())?0:e.isShadow())}createTextArrow_(){let e,t;this.arrow=eZ(r8.TSPAN,{},this.textElement_),this.arrow.appendChild(document.createTextNode((null==(e=this.getSourceBlock())?0:e.RTL)?cH.ARROW_CHAR+" ":" "+cH.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central"),(null==(t=this.getSourceBlock())?0:t.RTL)?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=eZ(r8.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(rb,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new ca;this.dropdownCreate(),this.menu_&&(this.menu_.openingCoords=e&&"number"==typeof e.clientX?new r4(e.clientX,e.clientY):null,i9(),eq(e=this.menu_.render(i8()),"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&i7(t=t.getColour(),e=this.sourceBlock_.getColourTertiary()),se(this,this.dropdownDispose_.bind(this)),i8().style.height=`${this.menu_.getSize().height}px`,this.menu_.focus(),this.selectedMenuItem&&this.menu_.setHighlighted(this.selectedMenuItem),this.applyColour())}dropdownCreate(){let e=this.getSourceBlock();if(!e)throw new ca;let t=new lU;t.setRole(lv.LISTBOX),this.menu_=t;let i=this.getOptions(!1);this.selectedMenuItem=null;for(let o=0;o<i.length;o++){var s=i[o];if(s===cH.SEPARATOR){t.addChild(new lH);continue}let[n,r]=s;oM(n)?((s=new Image(n.width,n.height)).src=n.src,s.alt=n.alt):s=n,(s=new lx(s,r)).setRole(lv.OPTION),s.setRightToLeft(e.RTL),s.setCheckable(!0),t.addChild(s),s.setChecked(r===this.value_),r===this.value_&&(this.selectedMenuItem=s),s.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){sc(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(e&&this.generatedOptions||(this.generatedOptions=this.menuGenerator_(),this.validateOptions(this.generatedOptions)),this.generatedOptions)}setOptions(e){Array.isArray(e)?(this.validateOptions(e),e=this.trimOptions(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],this.setValue(this.selectedOption[1])}doClassValidation_(e){return this.getOptions(!0).some(t=>t[1]===e)?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(!0);for(let t=0,i;i=e[t];t++)i[1]===this.value_&&(this.selectedOption=i)}applyColour(){let e=this.sourceBlock_;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.getColourTertiary()),this.menu_?this.borderRect_.setAttribute("fill",e.getColourTertiary()):this.borderRect_.setAttribute("fill","transparent")),e&&this.arrow&&(e.isShadow()?this.arrow.style.fill=e.getColourSecondary():this.arrow.style.fill=e.getColour())}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";let e=this.selectedOption&&this.selectedOption[0];oM(e)?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){let t,i=this.getSourceBlock();if(!i)throw new ca;this.imageElement.style.display="",this.imageElement.setAttributeNS(rb,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));let s=Number(e.height);e=Number(e.width);var o=!!this.borderRect_;let n=Math.max(o?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,s+cH.IMAGE_Y_PADDING);o=o?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,t=this.svgArrow?this.positionSVGArrow(e+o,n/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):e8(this.arrow),this.size_.width=e+t+2*o,this.size_.height=n;let r=0;i.RTL?this.imageElement.setAttribute("x",`${o+t}`):(r=e+t,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${o}`)),this.imageElement.setAttribute("y",String(n/2-s/2)),this.positionTextElement_(r+o,e+t)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();eq(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);let i=e8(this.getTextElement());t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let s=0;this.svgArrow&&(s=this.positionSVGArrow(i+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=i+s+2*t,this.size_.height=e,this.positionTextElement_(t,i)}positionSVGArrow(e,t){if(!this.svgArrow)return 0;let i=this.getSourceBlock();if(!i)throw new ca;let s=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,o=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,n=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(i.RTL?s:e+o)+","+t+")"),n+o}getText_(){if(!this.selectedOption)return null;let e=this.selectedOption[0];if(oM(e))return e.alt;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement){let t,i;return null!=(i=null!=(t=e.title)?t:e.ariaLabel)?i:e.innerText}return"string"==typeof e?e:(console.warn("Can't get text for existing dropdown option. If you're using HTMLElement dropdown options in node, ensure you're using jsdom-global or similar."),null)}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}trimOptions(e){let t=!1,i=e.map(e=>{if(e===cH.SEPARATOR)return e;let[i,s]=e;return"string"==typeof i?[sY(i),s]:(t=!0,[oM(i)?Object.assign({},i,{alt:sY(i.alt)}):Object.assign({},i),s])});if(t||2>e.length)return{options:i};var s=i.map(([e])=>e),o=s_(s);e=sT(s,o);let n=sp(s,o);return(e||n)&&!(o<=e+n)?(o=e?s[0].substring(0,e-1):void 0,s=n?s[0].substr(1-n):void 0,{options:this.applyTrim(i,e,n),prefix:o,suffix:s}):{options:i}}applyTrim(e,t,i){return e.map(([e,s])=>[e.substring(t,e.length-i),s])}validateOptions(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let i=0;i<e.length;i++){let s=e[i];Array.isArray(s)||s===cH.SEPARATOR?"string"!=typeof s[1]?(t=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option id must be a string. 
          Found ${s[1]} in: ${s}`)):!s[0]||"string"==typeof s[0]||oM(s[0])||"undefined"!=typeof HTMLElement&&s[0]instanceof HTMLElement||(t=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option must have a string 
          label, image description, or HTML element. Found ${s[0]} in: ${s}`)):(t=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option must be an array or
          the string literal 'separator'. Found: ${s}`))}if(t)throw TypeError("Found invalid FieldDropdown options.")}};cH.SEPARATOR="separator",cH.ARROW_CHAR="▾",cH.IMAGE_Y_OFFSET=5,cH.IMAGE_Y_PADDING=2*cH.IMAGE_Y_OFFSET,oD("field_dropdown",cH);var cW,cV,cK,cX,cY,cz=class{constructor(e,t,i,s){this.name=e,this.startHats=!1,this.blockStyles=t||Object.create(null),this.categoryStyles=i||Object.create(null),this.componentStyles=s||Object.create(null),this.fontStyle=Object.create(null),ea(M.THEME,e,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){if(!(e=this.componentStyles[e]))return null;if("string"==typeof e){let t=this.getComponentStyle(e);if(t)return t}return`${e}`}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){let i=new cz(e=e.toLowerCase()),s=t.base;if(s){if("string"==typeof s){let e;s=null!=(e=e_(M.THEME,s))?e:void 0}s instanceof cz&&(ti(i,s),i.name=e)}return ti(i.blockStyles,t.blockStyles),ti(i.categoryStyles,t.categoryStyles),ti(i.componentStyles,t.componentStyles),ti(i.fontStyle,t.fontStyle),null!==t.startHats&&(i.startHats=t.startHats),i}},cj=new cz("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}}),cJ=class{constructor(e){let t,i,s;this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let o=null,n=!1;var r,l=!1,a=!1,c=!1,h=!1,u=!1;let d=!!e.readOnly;d||(n=tx(o=tB(null!=(r=e.toolbox)?r:null)),l=void 0===(l=e.trashcan)?n:l,a=void 0===(a=e.collapse)?n:a,c=void 0===(c=e.comments)?n:c,h=void 0===(h=e.disable)?n:h,u=void 0===(u=e.sounds)||u),r=e.maxTrashcanContents,l?void 0===r&&(r=32):r=0;let E=!!e.rtl,_=e.horizontalLayout;void 0===_&&(_=!1);var T="end"!==e.toolboxPosition;T=_?T?lp.TOP:lp.BOTTOM:T===E?lp.RIGHT:lp.LEFT;let p=e.css;void 0===p&&(p=!0);let g="https://blockly-demo.appspot.com/static/media/";e.media&&(g=e.media.endsWith("/")?e.media:e.media+"/");let I=e.oneBasedIndex,R=e.renderer||"geras",m=e.plugins||{},O=e.modalInputs;void 0===O&&(O=!0),this.RTL=E,this.oneBasedIndex=void 0===I||I,this.collapse=a,this.comments=c,this.disable=h,this.readOnly=d,this.maxBlocks=e.maxBlocks||1/0,this.maxInstances=null!=(t=e.maxInstances)?t:null,this.modalInputs=O,this.pathToMedia=g,this.hasCategories=n,this.moveOptions=cJ.parseMoveOptions(e,n),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=l,this.maxTrashcanContents=r,this.hasSounds=u,this.hasCss=p,this.horizontalLayout=_,this.languageTree=o,this.gridOptions=cJ.parseGridOptions(e),this.zoomOptions=cJ.parseZoomOptions(e),this.toolboxPosition=T,this.theme=cJ.parseThemeOptions(e),this.renderer=R,this.rendererOverrides=null!=(i=e.rendererOverrides)?i:null,this.parentWorkspace=null!=(s=e.parentWorkspace)?s:null,this.plugins=m}static parseMoveOptions(e,t){let i=e.move||{},s={};return void 0===i.scrollbars&&void 0===e.scrollbars?s.scrollbars=t:"object"==typeof i.scrollbars?(s.scrollbars={horizontal:!!i.scrollbars.horizontal,vertical:!!i.scrollbars.vertical},s.scrollbars.horizontal&&s.scrollbars.vertical?s.scrollbars=!0:s.scrollbars.horizontal||s.scrollbars.vertical||(s.scrollbars=!1)):s.scrollbars=!!i.scrollbars||!!e.scrollbars,s.wheel=s.scrollbars&&void 0!==i.wheel?!!i.wheel:"object"==typeof s.scrollbars,s.drag=!!s.scrollbars&&(void 0===i.drag||!!i.drag),s}static parseZoomOptions(e){e=e.zoom||{};let t={};return t.controls=void 0!==e.controls&&!!e.controls,t.wheel=void 0!==e.wheel&&!!e.wheel,t.startScale=void 0===e.startScale?1:Number(e.startScale),t.maxScale=void 0===e.maxScale?3:Number(e.maxScale),t.minScale=void 0===e.minScale?.3:Number(e.minScale),t.scaleSpeed=void 0===e.scaleSpeed?1.2:Number(e.scaleSpeed),t.pinch=void 0===e.pinch?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions(e){e=e.grid||{};let t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=void 0===e.length?1:Number(e.length),t.snap=0<t.spacing&&!!e.snap,t}static parseThemeOptions(e){return"string"==typeof(e=e.theme||cj)?e_(M.THEME,e):e instanceof cz?e:cz.defineTheme(e.name||"builtin"+eD(),e)}},cZ=class{constructor(e,t){this.bubble=e,this.workspace=t,this.startLoc=null}isMovable(){return!0}startDrag(){let e;this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null==(e=this.workspace.getLayerManager())||e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(e){this.bubble.moveDuringDrag(e)}endDrag(){let e;this.workspace.setResizesEnabled(!0),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.bubble,100),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},cq=class{constructor(e,t,i,s){this.workspace=e,this.anchor=t,this.ownerRect=i,this.size=new r7(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new cZ(this,this.workspace),this.id=eD(),this.svgRoot=eZ(r8.G,{class:"blocklyBubble"},e.getBubbleCanvas()),e=eZ(r8.G,{class:"blocklyEmboss"},this.svgRoot),this.tail=eZ(r8.PATH,{class:"blocklyBubbleTail"},e),this.background=eZ(r8.RECT,{class:"blocklyDraggable",x:0,y:0,rx:cY.BORDER_WIDTH,ry:cY.BORDER_WIDTH},e),this.contentContainer=eZ(r8.G,{},this.svgRoot),this.focusableElement=null!=s?s:this.svgRoot,this.focusableElement.setAttribute("id",this.id),eS(this.background,"pointerdown",this,this.onMouseDown)}dispose(){e2(this.svgRoot),this.disposed=!0}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e,t=!1){e.width=Math.max(e.width,cY.MIN_SIZE),e.height=Math.max(e.height,cY.MIN_SIZE),this.size=e,this.background.setAttribute("width",`${e.width}`),this.background.setAttribute("height",`${e.height}`),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){let t;null==(t=this.workspace.getGesture(e))||t.handleBubbleStart(e,this),N.getFocusManager$$module$build$src$core$focus_manager().focusNode(this)}positionRelativeToAnchor(){let e=this.anchor.x;e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new r9(0,0,0,0)){var t=this.workspace.getMetricsManager().getViewMetrics(!0),i=this.getOptimalRelativeLeft(t),s=this.getOptimalRelativeTop(t);let o={x:i,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},n={x:-this.size.width-30,y:s};s={x:e.getWidth(),y:s};var r={x:i,y:e.getHeight()};i=e.getWidth()<e.getHeight()?s:r,e=e.getWidth()<e.getHeight()?r:s,s=this.getOverlap(o,t),r=this.getOverlap(n,t);let l=this.getOverlap(i,t);t=Math.max(s,r,l,t=this.getOverlap(e,t)),s===t?(this.relativeLeft=o.x,this.relativeTop=o.y):r===t?(this.relativeLeft=n.x,this.relativeTop=n.y):l===t?(this.relativeLeft=i.x,this.relativeTop=i.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var i=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(i+this.size.width,t.left+t.width)-Math.max(i,t.left))*(Math.min(e+this.size.height,t.top+t.height)-Math.max(e,t.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;if(this.size.width>e.width)return t;if(e=this.getWorkspaceViewRect(e),this.workspace.RTL){var i=this.anchor.x-t;i-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):i>e.right&&(t=-(e.right-this.anchor.x))}else{let s=(i=t+this.anchor.x)+this.size.width;i<e.left?t=e.left-this.anchor.x:s>e.right&&(t=e.right-this.anchor.x-this.size.width)}return t}getOptimalRelativeTop(e){let t=-this.size.height/4;if(this.size.height>e.height)return t;let i=this.anchor.y+t,s=i+this.size.height;return i<(e=this.getWorkspaceViewRect(e)).top?t=e.top-this.anchor.y:s>e.bottom&&(t=e.bottom-this.anchor.y-this.size.height),t}getWorkspaceViewRect(e){let t=e.top,i=e.top+e.height,s=e.left;return e=e.left+e.width,i-=this.getScrollbarThickness(),this.workspace.RTL?s-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new r9(t,i,s,e)}getScrollbarThickness(){return ln.scrollbarThickness/this.workspace.scale}renderTail(){let e,t=[];var i=this.size.width/2,s=this.size.height/2,o=-this.relativeLeft,n=-this.relativeTop;if(i===o&&s===n)t.push("M "+i+","+s);else{n-=s,o-=i,this.workspace.RTL&&(o*=-1);var r=Math.sqrt(n*n+o*o),l=Math.acos(o/r);0>n&&(l=2*Math.PI-l);var a=l+Math.PI/2;a>2*Math.PI&&(a-=2*Math.PI);var c=Math.sin(a);let e=Math.cos(a),h=(this.size.width+this.size.height)/cY.TAIL_THICKNESS;h=Math.min(h,this.size.width,this.size.height)/4,o=i+(a=1-cY.ANCHOR_RADIUS/r)*o,n=s+a*n,a=i+h*e;let u=s+h*c;i-=h*e,s-=h*c,(c=l+(c=i2(this.workspace.RTL?-cY.TAIL_ANGLE:cY.TAIL_ANGLE)))>2*Math.PI&&(c-=2*Math.PI),l=Math.sin(c)*r/cY.TAIL_BEND,r=Math.cos(c)*r/cY.TAIL_BEND,t.push("M"+a+","+u),t.push("C"+(a+r)+","+(u+l)+" "+o+","+n+" "+o+","+n),t.push("C"+o+","+n+" "+(i+r)+","+(s+l)+" "+i+","+s)}t.push("z"),null==(e=this.tail)||e.setAttribute("d",t.join(" "))}bringToFront(){let e,t=null==(e=this.svgRoot)?void 0:e.parentNode;return!!this.svgRoot&&(null==t?void 0:t.lastChild)!==this.svgRoot&&(null==t||t.appendChild(this.svgRoot),!0)}getRelativeToSurfaceXY(){return new r4(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){th(this)}unselect(){th(null)}getFocusableElement(){return this.focusableElement}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.bringToFront()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}};cY=cq,cq.BORDER_WIDTH=6,cq.DOUBLE_BORDER=2*cY.BORDER_WIDTH,cq.MIN_SIZE=cY.DOUBLE_BORDER,cq.TAIL_THICKNESS=1,cq.TAIL_ANGLE=20,cq.TAIL_BEND=4,cq.ANCHOR_RADIUS=8;var cQ=class extends cq{constructor(e,t,i,s){let o,n;super(t,i,s),this.workspace=t,this.anchor=i,this.ownerRect=s,this.autoLayout=!0,t=new cJ(e),this.validateWorkspaceOptions(t),this.svgDialog=eZ(r8.SVG,{x:cq.BORDER_WIDTH,y:cq.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new cJ(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),t.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(r8.G),this.miniWorkspace.getCanvas()),null==(e=this.miniWorkspace.getFlyout())||e.init(this.miniWorkspace),null==e||e.show(t.languageTree)),eq(this.svgRoot,"blocklyMiniWorkspaceBubble"),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this)),null==(o=this.miniWorkspace.getFlyout())||null==(n=o.getWorkspace())||n.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging())for(let e of this.miniWorkspace.getTopBlocks(!1)){let t=e.getRelativeToSurfaceXY();if(20>t.y&&e.moveBy(0,20-t.y),e.RTL){let i=-20,s=this.miniWorkspace.getFlyout();s&&(i-=s.getWidth()),t.x>i&&e.moveBy(i-t.x,0)}else 20>t.x&&e.moveBy(20-t.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()){var e=this.getSize(),t=this.calculateWorkspaceSize();Math.abs(e.width-t.width)<cQ.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-t.height)<cQ.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${t.width}px`),this.svgDialog.setAttribute("height",`${t.height}px`),this.miniWorkspace.setCachedParentSvgSize(t.width,t.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${t.width}, 0)`),this.setSize(new r7(t.width+cq.DOUBLE_BORDER,t.height+cq.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let t=e.width+cQ.MARGIN;e=e.height+cQ.MARGIN;let i=this.miniWorkspace.getFlyout();return i&&(e=Math.max(e,i.getWorkspace().getMetricsManager().getScrollMetrics().height+20),t+=i.getWidth()),new r7(t,e)}updateBlockStyles(){let e;for(var t of this.miniWorkspace.getAllBlocks(!1))t.setStyle(t.getStyleName());if(t=null==(e=this.miniWorkspace.getFlyout())?void 0:e.getWorkspace())for(let e of t.getAllBlocks(!1))e.setStyle(e.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,t){super.moveTo(e,t),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};cQ.MINIMUM_VIEW_CHANGE=10,cQ.MARGIN=3*cq.DOUBLE_BORDER;var c0=class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new r4(0,0),this.workspaceLocation=new r4(0,0),this.svgRoot=null,this.tooltip=e,this.id=eD()}getType(){throw Error("Icons must implement getType")}initView(e){if(!this.svgRoot){var t=this.sourceBlock;this.svgRoot=eZ(r8.G,{class:"blocklyIconGroup",id:this.id}),t.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),eS(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,sC(this.svgRoot)}}dispose(){sf(this.svgRoot),e2(this.svgRoot)}getWeight(){return -1}getSize(){return new r7(0,0)}setTooltip(e){this.tooltip=null!=e?e:this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",i1(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){let e;null==(e=this.svgRoot)||e.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(e){this.workspaceLocation=r4.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}getFocusableElement(){let e=this.svgRoot;if(!e)throw Error("Attempting to focus uninitialized icon.");return e}getFocusableTree(){return this.sourceBlock.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getSourceBlock(){return this.sourceBlock}};N.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends c0{constructor(e,t){super(t),this.flyoutBlockTypes=e,this.sourceBlock=t,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return N.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),eZ(r8.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),eZ(r8.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),eZ(r8.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),eq(this.svgRoot,"blocklyMutatorIcon"))}dispose(){let e;super.dispose(),null==(e=this.miniWorkspaceBubble)||e.dispose()}getWeight(){return N.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new r7(17,17)}applyColour(){let e,t;super.applyColour(),null==(e=this.miniWorkspaceBubble)||e.setColour(this.sourceBlock.getColour()),null==(t=this.miniWorkspaceBubble)||t.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.miniWorkspaceBubble)||t.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(e){let t=this;return r_.asyncExecutePromiseGeneratorFunction(function*(){if(t.bubbleIsVisible()!==e){if(yield t6(),e){let e;t.miniWorkspaceBubble=new cQ(t.getMiniWorkspaceConfig(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour(),t.createRootBlock(),t.addSaveConnectionsListener(),null==(e=t.miniWorkspaceBubble)||e.addWorkspaceChangeListener(t.createMiniWorkspaceChangeListener())}else{let e;null==(e=t.miniWorkspaceBubble)||e.dispose(),t.miniWorkspaceBubble=null,t.saveConnectionsListener&&t.sourceBlock.workspace.removeChangeListener(t.saveConnectionsListener),t.saveConnectionsListener=null}eU(new(ej(rC.BUBBLE_OPEN))(t.sourceBlock,e,"mutator"))}})}getBubble(){return this.miniWorkspaceBubble}getMiniWorkspaceConfig(){let e,t={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(e=this.sourceBlock.workspace.options.rendererOverrides)?e:void 0};return this.flyoutBlockTypes.length&&(t.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(e=>({kind:"block",type:e}))}),t}getAnchorLocation(){return r4.sum(this.workspaceLocation,new r4(8.5,8.5))}getBubbleOwnerRect(){let e=this.sourceBlock.getSvgRoot().getBBox();return new r9(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){let e,t,i,s;if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");for(var o of(this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace()),this.rootBlock.getDescendants(!1)))o.queueRender();this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),o=null!=(s=null==(e=this.miniWorkspaceBubble)||null==(t=e.getWorkspace())||null==(i=t.getFlyout())?void 0:i.getWidth())?s:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(o+16):16,16)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{N.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||eP(e)||ek(e)&&"disabled"===e.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=N.getGroup$$module$build$src$core$events$utils();e||N.setGroup$$module$build$src$core$events$utils(!0);var t=am.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var i=am.getExtraBlockState_(this.sourceBlock);t!==i&&eU(new(ej(rC.BLOCK_CHANGE))(this.sourceBlock,"mutation",null,t,i)),N.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){let e;return null==(e=this.miniWorkspaceBubble)?void 0:e.getWorkspace()}},N.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=aI.MUTATOR,N.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,N.MutatorIcon$$module$build$src$core$icons$mutator_icon;var c1=Object.create(null);N.register$$module$build$src$core$extensions("parent_tooltip_when_inline",function(){let e=this.tooltip;this.setTooltip((function(){let t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}).bind(this))});var c2={TEST_ONLY:{allExtensions:c1}};c2.apply=oy,c2.buildTooltipForDropdown=N.buildTooltipForDropdown$$module$build$src$core$extensions,c2.buildTooltipWithFieldText=N.buildTooltipWithFieldText$$module$build$src$core$extensions,c2.isRegistered=oP,c2.register=N.register$$module$build$src$core$extensions,c2.registerMixin=N.registerMixin$$module$build$src$core$extensions,c2.registerMutator=N.registerMutator$$module$build$src$core$extensions,c2.runAfterPageLoad=function(e){if("object"!=typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)e();else{let t=setInterval(function(){"complete"===document.readyState&&(clearInterval(t),e())},10)}},c2.unregister=function(e){oP(e)?delete c1[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},(df=dD||(dD={}))[df.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",df[df.MAC_ENTER=3]="MAC_ENTER",df[df.BACKSPACE=8]="BACKSPACE",df[df.TAB=9]="TAB",df[df.NUM_CENTER=12]="NUM_CENTER",df[df.ENTER=13]="ENTER",df[df.SHIFT=16]="SHIFT",df[df.CTRL=17]="CTRL",df[df.ALT=18]="ALT",df[df.PAUSE=19]="PAUSE",df[df.CAPS_LOCK=20]="CAPS_LOCK",df[df.ESC=27]="ESC",df[df.SPACE=32]="SPACE",df[df.PAGE_UP=33]="PAGE_UP",df[df.PAGE_DOWN=34]="PAGE_DOWN",df[df.END=35]="END",df[df.HOME=36]="HOME",df[df.LEFT=37]="LEFT",df[df.UP=38]="UP",df[df.RIGHT=39]="RIGHT",df[df.DOWN=40]="DOWN",df[df.PLUS_SIGN=43]="PLUS_SIGN",df[df.PRINT_SCREEN=44]="PRINT_SCREEN",df[df.INSERT=45]="INSERT",df[df.DELETE=46]="DELETE",df[df.ZERO=48]="ZERO",df[df.ONE=49]="ONE",df[df.TWO=50]="TWO",df[df.THREE=51]="THREE",df[df.FOUR=52]="FOUR",df[df.FIVE=53]="FIVE",df[df.SIX=54]="SIX",df[df.SEVEN=55]="SEVEN",df[df.EIGHT=56]="EIGHT",df[df.NINE=57]="NINE",df[df.FF_SEMICOLON=59]="FF_SEMICOLON",df[df.FF_EQUALS=61]="FF_EQUALS",df[df.FF_DASH=173]="FF_DASH",df[df.FF_HASH=163]="FF_HASH",df[df.QUESTION_MARK=63]="QUESTION_MARK",df[df.AT_SIGN=64]="AT_SIGN",df[df.A=65]="A",df[df.B=66]="B",df[df.C=67]="C",df[df.D=68]="D",df[df.E=69]="E",df[df.F=70]="F",df[df.G=71]="G",df[df.H=72]="H",df[df.I=73]="I",df[df.J=74]="J",df[df.K=75]="K",df[df.L=76]="L",df[df.M=77]="M",df[df.N=78]="N",df[df.O=79]="O",df[df.P=80]="P",df[df.Q=81]="Q",df[df.R=82]="R",df[df.S=83]="S",df[df.T=84]="T",df[df.U=85]="U",df[df.V=86]="V",df[df.W=87]="W",df[df.X=88]="X",df[df.Y=89]="Y",df[df.Z=90]="Z",df[df.META=91]="META",df[df.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",df[df.CONTEXT_MENU=93]="CONTEXT_MENU",df[df.NUM_ZERO=96]="NUM_ZERO",df[df.NUM_ONE=97]="NUM_ONE",df[df.NUM_TWO=98]="NUM_TWO",df[df.NUM_THREE=99]="NUM_THREE",df[df.NUM_FOUR=100]="NUM_FOUR",df[df.NUM_FIVE=101]="NUM_FIVE",df[df.NUM_SIX=102]="NUM_SIX",df[df.NUM_SEVEN=103]="NUM_SEVEN",df[df.NUM_EIGHT=104]="NUM_EIGHT",df[df.NUM_NINE=105]="NUM_NINE",df[df.NUM_MULTIPLY=106]="NUM_MULTIPLY",df[df.NUM_PLUS=107]="NUM_PLUS",df[df.NUM_MINUS=109]="NUM_MINUS",df[df.NUM_PERIOD=110]="NUM_PERIOD",df[df.NUM_DIVISION=111]="NUM_DIVISION",df[df.F1=112]="F1",df[df.F2=113]="F2",df[df.F3=114]="F3",df[df.F4=115]="F4",df[df.F5=116]="F5",df[df.F6=117]="F6",df[df.F7=118]="F7",df[df.F8=119]="F8",df[df.F9=120]="F9",df[df.F10=121]="F10",df[df.F11=122]="F11",df[df.F12=123]="F12",df[df.NUMLOCK=144]="NUMLOCK",df[df.SCROLL_LOCK=145]="SCROLL_LOCK",df[df.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",df[df.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",df[df.SEMICOLON=186]="SEMICOLON",df[df.DASH=189]="DASH",df[df.EQUALS=187]="EQUALS",df[df.COMMA=188]="COMMA",df[df.PERIOD=190]="PERIOD",df[df.SLASH=191]="SLASH",df[df.APOSTROPHE=192]="APOSTROPHE",df[df.TILDE=192]="TILDE",df[df.SINGLE_QUOTE=222]="SINGLE_QUOTE",df[df.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",df[df.BACKSLASH=220]="BACKSLASH",df[df.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",df[df.WIN_KEY=224]="WIN_KEY",df[df.MAC_FF_META=224]="MAC_FF_META",df[df.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",df[df.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",df[df.WIN_IME=229]="WIN_IME",df[df.VK_NONAME=252]="VK_NONAME",df[df.PHANTOM=255]="PHANTOM";var c3={};c3.arc=oz,c3.curve=oH,c3.line=oX,c3.lineOnAxis=oY,c3.lineTo=oK,c3.moveBy=oV,c3.moveTo=oW,c3.point=oU;var c5={};c5.Coordinate=r4,c5.KeyCodes=dD,c5.Rect=r9,c5.Size=r7,c5.Svg=r8,c5.aria=lF,c5.array=rq,c5.browserEvents=Y,c5.colour=cn,c5.deprecation=ao,c5.dom=rP,c5.extensions=c2,c5.idGenerator=q,c5.math=aO,c5.object=rB,c5.parsing=cr,c5.string=az,c5.style=lt,c5.svgMath=lo,c5.svgPaths=c3,c5.toolbox=lm,c5.userAgent={ANDROID:rR,GECKO:rI,IPAD:rm,IPHONE:rO,JavaFx:W,MAC:V,MOBILE:rS,raw:rT},c5.xml=lE;var c6=class{constructor(e,t){this.type=t,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=e,this.id=`${e.id}_connection_${eD()}`}connect_(e){let t,i,s=cX.INPUT_VALUE,o=this.getSourceBlock();var n=e.getSourceBlock();if(e.isConnected()&&e.disconnectInternal(!1),this.isConnected()){let e=this.stashShadowState(),i=this.targetBlock();i.isShadow()?i.dispose(!1):(this.disconnectInternal(),t=i),this.applyShadowState(e)}eX()&&(i=new(ej(rC.BLOCK_MOVE))(n)).setReason(["connect"]),oj(this,e),n.setParent(o),i&&(i.recordNew(),eU(i)),t&&(e=this.type===s?t.outputConnection:t.previousConnection)&&((n=c6.getConnectionForOrphanedConnection(n,e))?e.connect(n):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.isSuperior()&&this.setShadowStateInternal();let e=this.targetBlock();e&&!e.isDeadOrDying()&&e.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===cX.INPUT_VALUE||this.type===cX.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return!0;if(this.getConnectionChecker().canConnect(this,e,!1)){let t=N.getGroup$$module$build$src$core$events$utils();t||N.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),N.setGroup$$module$build$src$core$events$utils(t)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(e=!0){let t,{parentConnection:i,childConnection:s}=this.getParentAndChildConnections();if(!i||!s)throw Error("Source connection not connected.");let o=N.getGroup$$module$build$src$core$events$utils();o||N.setGroup$$module$build$src$core$events$utils(!0),eX()&&(t=new(ej(rC.BLOCK_MOVE))(s.getSourceBlock())).setReason(["disconnect"]);let n=this.targetConnection;n&&(n.targetConnection=null),this.targetConnection=null,e&&s.getSourceBlock().setParent(null),t&&(t.recordNew(),eU(t)),s.getSourceBlock().isShadow()||i.respawnShadow_(),N.setGroup$$module$build$src$core$events$utils(o)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,t){var i;return!this.getSourceBlock().isDeadOrDying()&&(t=null==(i=e.getInput(t))?void 0:i.connection,(!(i=this.targetBlock())||i===e)&&!!t&&t.targetConnection!==this&&(t.isConnected()&&t.disconnect(),t.connect(this),!0))}targetBlock(){if(this.isConnected()){let e,t;return null!=(t=null==(e=this.targetConnection)?void 0:e.getSourceBlock())?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?oE(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?iP(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let e=null,t=this.sourceBlock_.inputList;for(let i=0;i<t.length;i++)if(t[i].connection===this){e=t[i];break}return e}toString(){let e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let i=0,s;s=e.inputList[i];i++)if(s.connection===this){t=s;break}if(!t)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";t='Input "'+t.name+'" connection on '}return t+e.toDevString()}stashShadowState(){let e=this.getShadowDom(!0),t=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:t}}applyShadowState({shadowDom:e,shadowState:t}){this.shadowDom=e,this.shadowState=t}setShadowStateInternal({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom=e,this.shadowState=t,this.getSourceBlock().isDeadOrDying()||((e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(e){var t=this.getSourceBlock();let i=this.getShadowState(),s=this.getShadowDom();if(t.isDeadOrDying()||!i&&!s)return null;if(i)return iH(i,t.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(s){if(t=og(s,t.workspace),e)if(this.type===cX.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else if(this.type===cX.NEXT_STATEMENT){if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}else throw Error("Cannot connect a shadow block to a previous/output connection");return t}return null}serializeShadow(e){e&&(this.shadowDom=oE(e),this.shadowState=iP(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===cX.OUTPUT_VALUE)return oZ(e,t.getSourceBlock());e=e.lastConnectionInStack(!0);let i=t.getConnectionChecker();return e&&i.canConnect(t,e,!1)?e:null}};c6.CAN_CONNECT=0,c6.REASON_SELF_CONNECTION=1,c6.REASON_WRONG_TYPE=2,c6.REASON_TARGET_NULL=3,c6.REASON_CHECKS_FAILED=4,c6.REASON_DIFFERENT_WORKSPACES=5,c6.REASON_SHADOW_PARENT=6,c6.REASON_DRAG_CHECKS_FAILED=7,c6.REASON_PREVIOUS_AND_OUTPUT=8;var c4=class extends Error{constructor(e){super(`Tried to append an icon of type ${e.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=e}},c8={};c8.DuplicateIconType=c4,(dL=N.Align$$module$build$src$core$inputs$align||(N.Align$$module$build$src$core$inputs$align={}))[dL.LEFT=-1]="LEFT",dL[dL.CENTRE=0]="CENTRE",dL[dL.RIGHT=1]="RIGHT",N.Align$$module$build$src$core$inputs$align;var c9=class extends cl{constructor(e,t,i){super(cl.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==cl.SKIP_SETUP&&(i?this.configure_(i):this.class=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&eq(this.getTextElement(),this.class),this.fieldGroup_&&eq(this.fieldGroup_,"blocklyLabelField")}doClassValidation_(e){return null==e?null:`${e}`}setClass(e){this.textElement_&&(this.class&&e0(this.textElement_,this.class),e&&eq(this.textElement_,e)),this.class=e}static fromJson(e){return new this(sY(e.text),void 0,e)}};oD("field_label",c9),c9.prototype.DEFAULT_VALUE="";var c7=[];c7[cX.INPUT_VALUE]=cX.OUTPUT_VALUE,c7[cX.OUTPUT_VALUE]=cX.INPUT_VALUE,c7[cX.NEXT_STATEMENT]=cX.PREVIOUS_STATEMENT,c7[cX.PREVIOUS_STATEMENT]=cX.NEXT_STATEMENT;var he="RENAME_VARIABLE_ID",ht="DELETE_VARIABLE_ID",hi=class extends c6{constructor(e,t){super(e,t),this.highlighted=!1,this.targetConnection=null,this.db=e.workspace.connectionDBList[t],this.dbOpposite=e.workspace.connectionDBList[c7[t]],this.offsetInBlock=new r4(0,0),this.trackedState=hi.TrackedState.WILL_TRACK}dispose(){let e,t;super.dispose(),this.trackedState===hi.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),null==(t=(e=this.sourceBlock_.pathObject).removeConnectionHighlight)||t.call(e,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){let t=this.x-e.x;return Math.sqrt(t*t+(e=this.y-e.y)*e)}bumpAwayFrom(e,t=!1){if(!this.sourceBlock_.workspace.isDragging()){var i=N.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),s=N.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),o=e.sourceBlock_.getRootBlock(),n=this.sourceBlock_.getRootBlock();if(!o.isInFlyout&&!n.isInFlyout){var r=!0;if(n.isMovable())o.isMovable()&&t&&(s=-s);else{if(!o.isMovable())return;r=!1,i=-i,s=-s}t=r?e:this,e=r?this:e,(o=r?n:o).RTL&&(i=-i),o.moveBy(t.x+i-e.x,t.y+s-e.y,["bump"])}}}moveTo(e,t){let i=!1;return this.trackedState===hi.TrackedState.WILL_TRACK?(this.db.addConnection(this,t),this.trackedState=hi.TrackedState.TRACKED,i=!0):this.trackedState===hi.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,t),i=!0),this.x=e,this.y=t,i}moveBy(e,t){return this.moveTo(this.x+e,this.y+t)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,t){this.offsetInBlock.x=e,this.offsetInBlock.y=t}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection;let t=this.targetBlock();e&&t&&(e=r4.difference(this.offsetInBlock,e.offsetInBlock),t.translate(e.x,e.y))}closest(e,t){return this.dbOpposite.searchForClosest(this,e,t)}highlight(){this.highlighted=!0;let e=this.findHighlightSvg();e&&(e.style.display="")}unhighlight(){this.highlighted=!1;let e=this.findHighlightSvg();e&&(e.style.display="none")}isHighlighted(){return this.highlighted}setTracking(e){e&&this.trackedState===hi.TrackedState.TRACKED||!e&&this.trackedState===hi.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=hi.TrackedState.TRACKED):(this.trackedState===hi.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=hi.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){let e=this.targetBlock().getDescendants(!1);for(let t=0;t<e.length;t++){let i=e[t],s=i.getConnections_(!0);for(let e=0;e<s.length;e++)s[e].setTracking(!1);for(let e of i.getIcons())i1(e)&&e.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let e=[];if(this.type!==cX.INPUT_VALUE&&this.type!==cX.NEXT_STATEMENT)return e;let t=this.targetBlock();if(t){let i;t.isCollapsed()?(i=[],t.outputConnection&&i.push(t.outputConnection),t.nextConnection&&i.push(t.nextConnection),t.previousConnection&&i.push(t.previousConnection)):i=t.getConnections_(!0);for(let t=0;t<i.length;t++)e.push(...i[t].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){let t=this.getSourceBlock();if(ex()){let i=N.getGroup$$module$build$src$core$events$utils();setTimeout((function(){t.isDisposed()||t.getParent()||(N.setGroup$$module$build$src$core$events$utils(i),this.bumpAwayFrom(e),N.setGroup$$module$build$src$core$events$utils(!1))}).bind(this),N.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(e=!0){let{parentConnection:t,childConnection:i}=this.getParentAndChildConnections();if(t&&i){var s=N.getGroup$$module$build$src$core$events$utils();s||N.setGroup$$module$build$src$core$events$utils(!0);var o=t.getSourceBlock(),n=i.getSourceBlock();super.disconnectInternal(e),o.queueRender(),n.updateDisabled(),n.queueRender(),n.getSvgRoot().style.display="block",N.setGroup$$module$build$src$core$events$utils(s)}}respawnShadow_(){super.respawnShadow_();let e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock(),t.updateDisabled(),e.updateDisabled(),e.queueRender(),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return super.setCheck(e),this.sourceBlock_.queueRender(),this}showContextMenu(e){let t=cS.registry.getContextMenuOptions({focusedNode:this},e);if(t.length){var i=this.getSourceBlock(),s=i.workspace;if(e instanceof PointerEvent)var o=new r4(e.clientX,e.clientY);else o=tk(s,o=new r4(this.x,this.y)).translate(i.RTL?-5:5,5);s9(e,t,i.RTL,s,o)}}getFocusableElement(){let e=this.findHighlightSvg();if(e)return e;throw Error("No highlight SVG found corresponding to this connection.")}getFocusableTree(){return this.getSourceBlock().workspace}onNodeFocus(){this.highlight()}onNodeBlur(){this.unhighlight()}canBeFocused(){return!0}findHighlightSvg(){return document.getElementById(this.id)}};(dN=(dN=hi||(hi={})).TrackedState||(dN.TrackedState={}))[dN.WILL_TRACK=-1]="WILL_TRACK",dN[dN.UNTRACKED=0]="UNTRACKED",dN[dN.TRACKED=1]="TRACKED";var hs=hi.TrackedState,ho={};ho.RenderedConnection=hi,ho.TrackedState=hs;var hn=class{constructor(e,t){this.name=e,this.sourceBlock=t,this.fieldRow=[],this.align=N.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=N.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,i){if(0>e||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(t||""===t&&i)&&("string"==typeof t&&(t=N.fromJson$$module$build$src$core$field_registry({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(t),t.name=i,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&this.sourceBlock.queueRender()),e}removeField(e,t){for(let t=0,i;i=this.fieldRow[t];t++)if(i.name===e)return i.dispose(),this.fieldRow.splice(t,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(t)return!1;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let t=0,i;i=this.fieldRow[t];t++)i.setVisible(e);if(this.connection&&this.connection instanceof hi){e?t=this.connection.startTrackingAll():this.connection.stopTrackingAll();let i=this.connection.targetBlock();i&&(i.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let e=0,t;t=this.fieldRow[e];e++)t.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){for(let e of this.fieldRow)e.init()}initModel(){for(let e of this.fieldRow)e.initModel()}initField(e){this.sourceBlock.rendered?e.init():e.initModel()}dispose(){for(let e=0,t;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}},hr=class extends hn{constructor(e,t){super(e,t),this.name=e,this.type=N.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},hl=class extends hn{constructor(e,t){super(e,t),this.name=e,this.type=N.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},ha=class extends hn{constructor(e,t){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,t),this.name=e,this.type=N.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(cX.NEXT_STATEMENT)}};N.ValueInput$$module$build$src$core$inputs$value_input=class extends hn{constructor(e,t){if(!e)throw Error("Value inputs must have a non-empty name");super(e,t),this.name=e,this.type=N.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(cX.INPUT_VALUE)}},N.ValueInput$$module$build$src$core$inputs$value_input;var hc=class{constructor(e,t,i){if(this.data=null,this.disposed=!1,this.hue=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable=this.movable=this.deletable=!0,this.collapsed_=this.shadow=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper=this.helpUrl=null,this.statementInputCount=0,this.workspace=e,this.id=i&&!e.getBlockById(i)?i:eM(),e.setBlockById(this.id,this),this.xy=new r4(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,!(i=y[t])||"object"!=typeof i)throw TypeError("Invalid block definition for type: "+t);Object.assign(this,i)}e.addTopBlock(this),e.addTypedBlock(this),new.target===hc&&this.doInit_()}doInit_(){let e=N.getGroup$$module$build$src$core$events$utils();e||N.setGroup$$module$build$src$core$events$utils(!0);let t=ex();try{"function"==typeof this.init&&(N.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),N.setRecordUndo$$module$build$src$core$events$utils(t)),eX()&&eU(new(ej(rC.BLOCK_CREATE))(this))}finally{N.setGroup$$module$build$src$core$events$utils(e),N.setRecordUndo$$module$build$src$core$events$utils(t)}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)}dispose(e=!1){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.unplug(e),eX()&&eU(new(ej(rC.BLOCK_DELETE))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),"function"==typeof this.destroy&&this.destroy(),this.childBlocks_.forEach(e=>e.disposeInternal()),this.inputList.forEach(e=>e.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(e=>e.dispose()),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(let e of this.inputList)e.initModel();this.initialized=!0}}unplug(e){this.outputConnection&&this.unplugFromRow(e),this.previousConnection&&this.unplugFromStack(e)}unplugFromRow(e){let t=null,i;(null==(i=this.outputConnection)?0:i.isConnected())&&(t=this.outputConnection.targetConnection,this.outputConnection.disconnect()),t&&e&&(e=this.getOnlyValueConnection())&&e.isConnected()&&!e.targetBlock().isShadow()&&(null==(e=e.targetConnection)||e.disconnect(),this.workspace.connectionChecker.canConnect(e,t,!1)?t.connect(e):null==e||e.onFailedConnect(t))}getOnlyValueConnection(){let e=null;for(let t=0;t<this.inputList.length;t++){let i=this.inputList[t].connection;if(i&&i.type===cX.INPUT_VALUE&&i.targetConnection){if(e)return null;e=i}}return e}unplugFromStack(e){var t;let i=null;if((null==(t=this.previousConnection)?0:t.isConnected())&&(i=this.previousConnection.targetConnection,this.previousConnection.disconnect()),t=this.getNextBlock(),e&&t&&!t.isShadow()){let t,s;null==(e=null!=(s=null==(t=this.nextConnection)?void 0:t.targetConnection)?s:null)||e.disconnect(),i&&this.workspace.connectionChecker.canConnect(i,e,!1)&&i.connect(e)}}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let t=0,i;i=this.inputList[t];t++)i.connection&&e.push(i.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){let i=t.targetBlock();if(!i||e&&i.isShadow())return t;t=i.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let t=0,i;i=this.inputList[t];t++)if(i.connection&&i.connection.targetBlock()===e)return i;return null}getSurroundParent(){let e=this,t;do if(t=e,!(e=e.getParent()))return null;while(e.getNextBlock()===t)return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,t=this;do t=(e=t).parentBlock_;while(t)return e}getTopStackBlock(){let e=this,t;do t=e.getPreviousBlock();while(t&&t.getNextBlock()===e&&(e=t))return e}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let i=0,s;s=this.inputList[i];i++)if(s.connection){var t=s.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),i=!!t;if(i&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!i&&e)throw Error("Block not connected to new parent.");if(i&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?tI(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){let t=[this],i=this.getChildren(e);for(let s,o=0;s=i[o];o++)t.push(...s.getDescendants(e));return t}isDeletable(){return this.deletable&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnDeletable(){return this.deletable}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnMovable(){return this.movable}setMovable(e){this.movable=e}isDuplicatable(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(t_(this,!0))}isShadow(){return this.shadow}setShadow(e){this.shadow=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setEditable(e){for(let t of(this.editable=e,this.getFields()))t.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(let e of this.inputList)if(e.connection||1<e.fieldRow.length)return!1;return!0}getMatchingConnection(e,t){let i=this.getConnections_(!0);if(e=e.getConnections_(!0),i.length!==e.length)throw Error("Connection lists did not match in length.");for(let s=0;s<e.length;s++)if(e[s]===t)return i[s];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return sO(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue}setColour(e){e=sz(e),this.hue=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&"function"!=typeof e)throw Error("onchange must be a function.");this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.onchange=e,this.onchangeWrapper=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper)}getField(e){if("string"!=typeof e)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===e?"nothing":e+" of type "+typeof e)+" instead");for(let t of this.getFields())if(t.name===e)return t;return null}*getFields(){for(let e of this.inputList)for(let t of e.fieldRow)yield t}getVars(){let e=[];for(let t of this.getFields())t.referencesVariables()&&e.push(t.getValue());return e}getVarModels(){let e=[];for(let t of this.getFields())if(t.referencesVariables()){let i=this.workspace.getVariableById(t.getValue());i&&e.push(i)}return e}updateVarName(e){for(let t of this.getFields())t.referencesVariables()&&e.getId()===t.getValue()&&t.refreshVariableName()}renameVarById(e,t){for(let i of this.getFields())i.referencesVariables()&&e===i.getValue()&&i.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){let i=this.getField(t);if(!i)throw Error('Field "'+t+'" not found.');i.setValue(e)}setPreviousStatement(e,t){if(e)void 0===t&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(cX.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)void 0===t&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(cX.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)void 0===t&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(cX.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(eU(new(ej(rC.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof hr&&this.inputList[e]instanceof hr)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof N.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof hr)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof hl)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return 0===this.disabledReasons.size}setDisabledReason(e,t){e||this.workspace.options.disable||!this.hasDisabledReason(lK)||t==lK||this.setDisabledReason(!1,lK),this.disabledReasons.has(t)!==e&&(e?this.disabledReasons.add(t):this.disabledReasons.delete(t),(e=new(ej(rC.BLOCK_CHANGE))(this,"disabled",null,!e,e)).setDisabledReason(t),eU(e))}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(!e.isEnabled())return!0;e=e.getSurroundParent()}return!1}hasDisabledReason(e){return this.disabledReasons.has(e)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(eU(new(ej(rC.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){t=this.toTokens(t);for(let e=2;e<t.length;e++)"("===t[e-2]&&")"===t[e]&&(t[e-2]=t[e-1],t.splice(e-1,2));let i="";return t=(t=t.reduce((e,t)=>(e=e+("("===i||")"===t?"":" ")+t,i=t[t.length-1],e),"")).trim()||"???",e&&t.length>e&&(t=t.substring(0,e-3)+"..."),t}toTokens(e="?"){let t=[];for(let s of this.inputList)if(s.name!=lW){for(let e of s.fieldRow)t.push(e.getText());if(s.connection){let o=s.connection.targetBlock();if(o){var i=s.connection;let n=i.getCheck();!n&&i.targetConnection&&(n=i.targetConnection.getCheck()),(i=!!n&&(n.includes("Boolean")||n.includes("Number")))&&t.push("("),t.push(...o.toTokens(e)),i&&t.push(")")}else t.push(e)}}return t}appendValueInput(e){return this.appendInput(new N.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new ha(e,this))}appendDummyInput(e=""){return this.appendInput(new hr(e,this))}appendEndRowInput(e=""){return this.appendInput(new hl(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,t){return(e=eE(M.INPUT,e,!1))?this.appendInput(new e(t,this)):null}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");for(var i=0;e["args"+i];){if(void 0===e["message"+i])throw Error(t+`args${i} must have a corresponding message (message${i}).`);i++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle(e,t):this.jsonInitColour(e,t),i=0;void 0!==e["message"+i];)this.interpolate(e["message"+i],e["args"+i]||[],e["implicitAlign"+i]||e["lastDummyAlign"+i],t),i++;if(void 0!==e.inputsInline&&(N.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),N.enable$$module$build$src$core$events$utils()),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.outputShape&&this.setOutputShape(e.outputShape),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(i=sY(e.tooltip),this.setTooltip(i)),void 0!==e.enableContextMenu&&(this.contextMenu=!!e.enableContextMenu),void 0!==e.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),void 0!==e.helpUrl&&(i=sY(e.helpUrl),this.setHelpUrl(i)),"string"==typeof e.extensions&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&oy(e.mutator,this,!0),Array.isArray(e=e.extensions))for(t=0;t<e.length;t++)oy(e[t],this,!1)}jsonInitColour(e,t){if("colour"in e)if(void 0===e.colour)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch(i){console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle(e,t){e=e.style;try{this.setStyle(e)}catch(i){console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(void 0!==t&&"boolean"!=typeof t)throw Error("opt_disableCheck must be a boolean if provided");if(!t){for(let i in t=[],e)void 0!==this[i]&&t.push(i);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate(e,t,i,s){e=sX(e),this.validateTokens(e,t.length),t=this.interpolateArguments(e,t,i),i=[];for(let o=0,n;n=t[o];o++)if(this.isInputKeyword(n.type)){if(e=this.inputFromJson(n,s)){for(let t=0,s;s=i[t];t++)e.appendField(s[0],s[1]);i.length=0}}else(e=this.fieldFromJson(n))&&i.push([e,n.name])}validateTokens(e,t){let i=[],s=0;for(let o=0;o<e.length;o++){let n=e[o];if("number"==typeof n){if(1>n||n>t)throw Error('Block "'+this.type+'": Message index %'+n+" out of range.");if(i[n])throw Error('Block "'+this.type+'": Message index %'+n+" duplicated.");i[n]=!0,s++}}if(s!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments(e,t,i){let s=[];for(let n=0;n<e.length;n++){var o=e[n];if("number"==typeof o&&(o=t[o-1]),"string"==typeof o){if("\n"===o)o={type:"input_end_row"},i&&(o.align=i);else if(!(o=this.stringToFieldJson(o)))continue}s.push(o)}return(e=s.length)&&!this.isInputKeyword(s[e-1].type)&&(e={type:"input_dummy"},i&&(e.align=i),s.push(e)),s}fieldFromJson(e){let t=N.fromJson$$module$build$src$core$field_registry(e);return!t&&e.alt?"string"==typeof e.alt?(e=this.stringToFieldJson(e.alt))?this.fieldFromJson(e):null:this.fieldFromJson(e.alt):t}inputFromJson(e,t){let i;var s={LEFT:N.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:N.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:N.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:N.Align$$module$build$src$core$inputs$align.CENTRE};switch(e.type){case"input_value":i=this.appendValueInput(e.name);break;case"input_statement":i=this.appendStatementInput(e.name);break;case"input_dummy":i=this.appendDummyInput(e.name);break;case"input_end_row":i=this.appendEndRowInput(e.name);break;default:i=this.appendInputFromRegistry(e.type,e.name)}return i?(e.check&&i.setCheck(e.check),e.align&&(void 0===(s=s[e.align.toUpperCase()])?console.warn(t+"Illegal align value: ",e.align):i.setAlign(s)),i):null}isInputKeyword(e){return"input_value"===e||"input_statement"===e||"input_dummy"===e||"input_end_row"===e||ed(M.INPUT,e)}stringToFieldJson(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(e,t){if(e!==t){var i=-1,s=t?-1:this.inputList.length;for(let o=0,n;n=this.inputList[o];o++)if(n.name===e){if(i=o,-1!==s)break}else if(t&&n.name===t&&(s=o,-1!==i))break;if(-1===i)throw Error('Named input "'+e+'" not found.');if(-1===s)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(i,s)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");let i=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,i)}removeInput(e,t){for(let t=0,i;i=this.inputList[t];t++)if(i.name===e)return i instanceof ha&&this.statementInputCount--,i.dispose(),this.inputList.splice(t,1),!0;if(t)return!1;throw Error("Input not found: "+e)}getInput(e){for(let t=0,i;i=this.inputList[t];t++)if(i.name===e)return i;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){let e,t;return null!=(t=null==(e=this.getIcon(aI.COMMENT))?void 0:e.getText())?t:null}setCommentText(e){var t,i;let s,o=null!=(s=null==(t=this.getIcon(aI.COMMENT))?void 0:t.getText())?s:null;if(o!==e){if(null!==e){if(!(t=this.getIcon(aI.COMMENT))){if(!(t=eE(M.ICON,aI.COMMENT.toString(),!1)))throw Error("No comment icon class is registered, so a comment cannot be set");if(!(oq(i=t=new t(this))&&i1(i)&&t3(i)&&void 0!==i.setText&&void 0!==i.getText&&void 0!==i.setBubbleSize&&void 0!==i.getBubbleSize&&void 0!==i.setBubbleLocation&&void 0!==i.getBubbleLocation&&i.getType()===aI.COMMENT))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");t=this.addIcon(t)}N.disable$$module$build$src$core$events$utils(),t.setText(e),N.enable$$module$build$src$core$events$utils()}else this.removeIcon(aI.COMMENT);eU(new(ej(rC.BLOCK_CHANGE))(this,"comment",null,o,e))}}setWarningText(e,t){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new c4(e);return this.icons.push(e),this.icons.sort((e,t)=>e.getWeight()-t.getWeight()),e}removeIcon(e){let t;return!!this.hasIcon(e)&&(null==(t=this.getIcon(e))||t.dispose(),this.icons=this.icons.filter(t=>!t.getType().equals(e)),!0)}hasIcon(e){return this.icons.some(t=>t.getType().equals(e))}getIcon(e){return e instanceof aI?this.icons.find(t=>t.getType().equals(e)):this.icons.find(t=>t.getType().toString()===e)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy}moveBy(e,t,i){if(this.parentBlock_)throw Error("Block has parent");let s=new(ej(rC.BLOCK_MOVE))(this);i&&s.setReason(i),this.xy.translate(e,t),s.recordNew(),eU(s)}makeConnection_(e){return new c6(this,e)}allInputsFilled(e){if(void 0===e&&(e=!0),!e&&this.isShadow())return!1;for(let i=0,s;s=this.inputList[i];i++)if(s.connection){var t=s.connection.targetBlock();if(!t||!t.allInputsFilled(e))return!1}return!(t=this.getNextBlock())||t.allInputsFilled(e)}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};hc.COLLAPSED_INPUT_NAME=lW,hc.COLLAPSED_FIELD_NAME=lV;var hh=null,hu=null,hd={};hd.connectionUiEffect=o1,hd.disconnectUiEffect=o2,hd.disconnectUiStop=o5,hd.disposeUiEffect=oQ;var hE=class{paste(e,t,i){let s;if(!t.isCapacityAvailable(e.typeCounts))return null;i&&(e.blockState.x=i.x,e.blockState.y=i.y),i=i||new r4(e.blockState.x||0,e.blockState.y||0),N.disable$$module$build$src$core$events$utils();try{s=iU(e.blockState,t),o6(s,i)}finally{N.enable$$module$build$src$core$events$utils()}if(!s)return s;eX()&&!s.isShadow()&&eU(new(ej(rC.BLOCK_CREATE))(s));let o=s;return t6().then(()=>N.getFocusManager$$module$build$src$core$focus_manager().focusNode(o)),s}};hE.TYPE="block",tq(hE.TYPE,new hE);var h_={};h_.BlockPaster=hE,h_.moveBlockToNotConflict=o6;var hT={};hT.bumpIntoBounds=o9,hT.bumpIntoBoundsHandler=o7,hT.bumpTopObjectsIntoBounds=nt;var hp=class{constructor(e){this.block=e,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new r4(0,0),this.originalEventGroup="",this.workspace=e.workspace}isMovable(){if(this.block.isShadow()){let e,t;return null!=(t=null==(e=this.block.getParent())?void 0:e.isMovable())&&t}return this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.block.isInFlyout}startDrag(e){if(this.block.isShadow())this.startDraggingShadow(e);else{var t;this.dragging=!0,this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(ep(M.CONNECTION_PREVIEWER,this.workspace.options))(this.block),e6(),this.workspace.setResizesEnabled(!1),o5(),e=this.shouldHealStack(e),this.shouldDisconnect(e)&&this.disconnectBlock(e),this.block.setDragging(!0),null==(t=this.workspace.getLayerManager())||t.moveToDragLayer(this.block)}}shouldHealStack(e){return!!e&&(e.altKey||e.ctrlKey||e.metaKey)}startDraggingShadow(e){let t=this.block.getParent();if(!t)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=r4.difference(t.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),t.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){let t,i,s;if(this.startParentConn=null!=(s=null==(t=this.block.outputConnection)?void 0:t.targetConnection)?s:null==(i=this.block.previousConnection)?void 0:i.targetConnection,e){let e;this.startChildConn=null==(e=this.block.nextConnection)?void 0:e.targetConnection}this.block.unplug(e),o2(this.block)}fireDragStartEvent(){eU(new(ej(rC.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1)))}fireDragEndEvent(){eU(new(ej(rC.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1)))}fireMoveEvent(){if(!this.block.isDeadOrDying()){var e=new(ej(rC.BLOCK_MOVE))(this.block);e.setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),eU(e)}}drag(e){if(this.block.isShadow()){let t;null==(t=this.block.getParent())||t.drag(r4.sum(e,this.dragOffset))}else this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,r4.difference(e,this.startLoc))}updateConnectionPreview(e,t){var i=this.connectionCandidate;let s=this.getConnectionCandidate(e,t);if(s){this.connectionCandidate=t=i&&this.currCandidateIsBetter(i,t,s)?i:s;var o,n,{local:r,neighbour:l}=t;if(t=r.type===cX.OUTPUT_VALUE||r.type===cX.PREVIOUS_STATEMENT,i=l.isConnected()&&!(null==(o=l.targetBlock())?0:o.isInsertionMarker()),t&&i&&!this.orphanCanConnectAtEnd(e,l.targetBlock(),r.type)){let e;null==(e=this.connectionPreviewer)||e.previewReplacement(r,l,l.targetBlock())}else null==(n=this.connectionPreviewer)||n.previewConnection(r,l)}else{let e;null==(e=this.connectionPreviewer)||e.hidePreview(),this.connectionCandidate=null}}orphanCanConnectAtEnd(e,t,i){return!!c6.getConnectionForOrphanedConnection(e,i===cX.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}currCandidateIsBetter(e,t,i){let{local:s,neighbour:o}=e;e=new r4(s.x,s.y);let n=new r4(o.x,o.y);return t=r4.distance(r4.sum(e,t),n),i.distance>t-N.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(e,t){e=this.getLocalConnections(e);let i=this.getSearchRadius(),s=null;for(let o of e){let{connection:e,radius:n}=o.closest(i,t);e&&(s={local:o,neighbour:e,distance:n},i=n)}return s}getSearchRadius(){return this.connectionCandidate?N.config$$module$build$src$core$config.connectingSnapRadius:N.config$$module$build$src$core$config.snapRadius}getLocalConnections(e){let t=e.getConnections_(!1),i=e.lastConnectionInStack(!0);return i&&i!==e.nextConnection&&t.push(i),t}endDrag(e){if(this.block.isShadow()){let t;null==(t=this.block.getParent())||t.endDrag(e)}else{var t;if(this.originalEventGroup=N.getGroup$$module$build$src$core$events$utils(),this.fireDragEndEvent(),this.fireMoveEvent(),e4(),o5(),null==(t=this.connectionPreviewer)||t.hidePreview(),!this.block.isDeadOrDying()&&this.dragging){let e;null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.block,50),this.block.setDragging(!1)}this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep())}}disposeStep(){let e,t=N.getGroup$$module$build$src$core$events$utils();N.setGroup$$module$build$src$core$events$utils(this.originalEventGroup),this.block.snapToGrid(),null==(e=this.connectionPreviewer)||e.dispose(),this.workspace.setResizesEnabled(!0),N.setGroup$$module$build$src$core$events$utils(t)}applyConnections(e){let{local:t,neighbour:i}=e;t.connect(i);let s=t.isSuperior()?i:t,o=this.block.getRootBlock();t6().then(()=>{o1(s.getSourceBlock()),setTimeout(()=>{o.bringToFront()},0)})}revertDrag(){if(this.block.isShadow()){let e;null==(e=this.block.getParent())||e.revertDrag()}else{var e,t;if(null==(e=this.connectionPreviewer)||e.hidePreview(),this.connectionCandidate=null,null==(t=this.startChildConn)||t.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case cX.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case cX.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else{let e;this.block.moveTo(this.startLoc,["drag"]),null==(e=this.workspace.getLayerManager())||e.moveOffDragLayer(this.block,50),o9(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block)}this.startParentConn=this.startChildConn=null,this.block.setDragging(!1),this.dragging=!1}}},hg=class extends cq{constructor(e,t,i,s){super(t,i,s),this.text=e,this.workspace=t,this.anchor=i,this.ownerRect=s,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize(),eq(this.svgRoot,"blocklyTextBubble")}getText(){return this.text}setText(e){this.text=e,e2(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,t){return t=this.createParagraph(t),e=this.createTextFragments(t,e),this.workspace.RTL&&this.rightAlignTextFragments(t.getBBox().width,e),t}createParagraph(e){return eZ(r8.G,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",transform:`translate(0,${cq.BORDER_WIDTH})`,style:`direction: ${this.workspace.RTL?"rtl":"ltr"}`},e)}createTextFragments(e,t){let i=1;return t.split("\n").map(t=>{let s=eZ(r8.TEXT,{y:`${i}em`,x:cq.BORDER_WIDTH},e);return t=document.createTextNode(t),s.appendChild(t),i+=1,s})}rightAlignTextFragments(e,t){for(let i of t)i.setAttribute("text-anchor","start"),i.setAttribute("x",`${e+cq.BORDER_WIDTH}`)}updateBubbleSize(){let e=this.paragraph.getBBox();this.setSize(new r7(e.width+2*cq.BORDER_WIDTH,e.height+2*cq.BORDER_WIDTH),!0)}},hI=class extends c0{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return hI.TYPE}initView(e){this.svgRoot||(super.initView(e),eZ(r8.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),eZ(r8.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),eZ(r8.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),eq(this.svgRoot,"blocklyWarningIcon"))}dispose(){let e;super.dispose(),null==(e=this.textBubble)||e.dispose()}getWeight(){return hI.WEIGHT}getSize(){return new r7(17,17)}applyColour(){let e;super.applyColour(),null==(e=this.textBubble)||e.setColour(this.sourceBlock.getColour())}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){let t;super.onLocationChange(e),null==(t=this.textBubble)||t.setAnchorLocation(this.getAnchorLocation())}addMessage(e,t){let i;return this.textMap.get(t)===e||(e?this.textMap.set(t,e):this.textMap.delete(t),null==(i=this.textBubble)||i.setText(this.getText())),this}getText(){return[...this.textMap.values()].join("\n")}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(e){let t=this;return r_.asyncExecutePromiseGeneratorFunction(function*(){if(t.bubbleIsVisible()!==e){if(yield t6(),e)t.textBubble=new hg(t.getText(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour();else{let e;null==(e=t.textBubble)||e.dispose(),t.textBubble=null}eU(new(ej(rC.BUBBLE_OPEN))(t.sourceBlock,e,"warning"))}})}getBubble(){return this.textBubble}getAnchorLocation(){return r4.sum(this.workspaceLocation,new r4(8.5,8.5))}getBubbleOwnerRect(){let e=this.sourceBlock.getSvgRoot().getBBox();return new r9(e.y,e.y+e.height,e.x,e.x+e.width)}};hI.TYPE=aI.WARNING,hI.WEIGHT=2;var hR=class extends hc{constructor(e,t,i){if(super(e,t,i),this.childlessWidth=this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new r4(0,0),this.dragStrategy=new hp(this),!e.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=e,this.svgGroup=eZ(r8.G,{}),t&&eq(this.svgGroup,t),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup,this.style),(e=this.pathObject.svgPath).tooltip=this,sC(e),this.svgGroup.setAttribute("data-id",this.id),e.id=eD(),this.doInit_()}initSvg(){if(!this.initialized){for(var e of this.inputList)e.init();for(let e of this.getIcons())e.initView(this.createIconPointerDownListener(e)),e.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),(e=this.getSvgRoot())&&eS(e,"pointerdown",this,this.onMouseDown),e.parentNode||this.workspace.getCanvas().appendChild(e),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){this.addSelect(),th(this)}unselect(){this.removeSelect(),th(null)}setParent(e){var t=this.parentBlock_;if(e!==t){e6(),super.setParent(e),e4();var i=this.getSvgRoot();if(!this.workspace.isClearing&&i){var s=this.getRelativeToSurfaceXY();if(e)e.getSvgRoot().appendChild(i);else if(t){t=null==(e=this.workspace.getCanvas().querySelector(".blocklyDragging"))?void 0:e.parentElement;let o=this.workspace.getCanvas();t===o?o.insertBefore(i,e):o.appendChild(i),this.translate(s.x,s.y)}this.applyColour()}}}getRelativeToSurfaceXY(){let e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,i=0,s=this.getSvgRoot();if(s)do{let e=t$(s);t+=e.x,i+=e.y,s=s.parentNode}while(s&&!e.hasLayer(s))return new r4(t,i)}moveBy(e,t,i){if(this.parentBlock_)throw Error("Block has parent");let s=eX(),o=null;s&&(o=new(ej(rC.BLOCK_MOVE))(this),i&&o.setReason(i)),e=new r4(e,t),t=this.getRelativeToSurfaceXY(),e=r4.sum(t,e),this.translate(e.x,e.y),this.updateComponentLocations(e),s&&o&&(o.recordNew(),eU(o)),this.workspace.resizeContents()}translate(e,t){this.translation=`translate(${e}, ${t})`,this.relativeCoords=new r4(e,t),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,t){let i=this.getRelativeToSurfaceXY();this.moveBy(e.x-i.x,e.y-i.y,t)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){if(!this.isDeadOrDying()&&!this.getParent()&&!this.isInFlyout){var e=this.workspace.getGrid();if(null!=e&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();(e=e.alignXY(t))!==t&&this.moveTo(e,["snap"])}}}getBoundingRectangle(){return this.getBoundingRectangleWithDimensions(this.getHeightWidth())}getBoundingRectangleWithoutChildren(){return this.getBoundingRectangleWithDimensions({height:this.height,width:this.childlessWidth})}getBoundingRectangleWithDimensions(e){let t,i,s=this.getRelativeToSurfaceXY();return this.RTL?(t=s.x-e.width,i=s.x):(t=s.x,i=s.x+e.width),new r9(s.y,s.y+e.height,t,i)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e=0,t;t=this.inputList[e];e++)t.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed())}childHasWarning(){for(let e of this.getChildren(!1))if(e.getIcon(hI.TYPE)||e.childHasWarning())return!0;return!1}updateCollapsed(){var e=this.isCollapsed();for(let t=0,i;i=this.inputList[t];t++)i.name!==lW&&i.setVisible(!e);for(var t of this.getIcons())t.updateCollapsed();e?(eq(this.svgGroup,"blocklyCollapsed"),this.childHasWarning()&&this.setWarningText(N.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,hR.COLLAPSED_WARNING_ID),e=this.toString(30),(t=this.getField(lV))?t.setValue(e):(this.getInput(lW)||this.appendDummyInput(lW)).appendField(new c9(e),lV)):(this.updateDisabled(),this.removeInput(lW),e0(this.svgGroup,"blocklyCollapsed"),this.setWarningText(null,hR.COLLAPSED_WARNING_ID))}onMouseDown(e){if(!this.workspace.isReadOnly()){var t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}}showHelp(){let e="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(e){return this.workspace.isReadOnly()||!this.contextMenu?null:(e=cS.registry.getContextMenuOptions({block:this,focusedNode:this},e),this.customContextMenu&&this.customContextMenu(e),e)}calculateContextMenuLocation(e){let t,i;if(e instanceof PointerEvent)return new r4(e.clientX,e.clientY);e=tk(this.workspace,this.getRelativeToSurfaceXY());let s=null==(t=this.inputList.filter(e=>e.isVisible()).flatMap(e=>e.fieldRow).find(e=>e.isVisible()))||null==(i=t.getSvgRoot())?void 0:i.getBoundingClientRect();return new r4(this.RTL?e.x-5:e.x+5,(s&&s.height?s.y+s.height:e.y+this.height)+5)}showContextMenu(e){let t=this.generateContextMenu(e),i=this.calculateContextMenuLocation(e);t&&t.length&&(s9(e,t,this.RTL,this.workspace,i),s8(this))}updateComponentLocations(e){for(let t of(this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e),this.getChildren(!1)))t.updateComponentLocations(r4.sum(e,t.relativeCoords))}updateConnectionLocations(e){for(let t of this.getConnections_(!1))t.moveToOffset(e)}updateIconLocations(e){for(let t of this.getIcons())t.onLocationChange(e)}updateFieldLocations(e){for(let t of this.inputList)for(let i of t.fieldRow)i.onLocationChange(e)}addClass(e){eq(this.svgGroup,e)}removeClass(e){e0(this.svgGroup,e)}setDragging(e){(this.dragging=e)?(this.translation="",rV.push(...this.getConnections_(!0)),this.addClass("blocklyDragging")):(rV.length=0,this.removeClass("blocklyDragging"));for(let t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e?e0(this.svgGroup,"blocklyNotEditable"):eq(this.svgGroup,"blocklyNotEditable"),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup}dispose(e,t){this.disposing=!0,s$(),os();let i=N.getFocusManager$$module$build$src$core$focus_manager();if(i.getFocusedNode()===this){let e=this.getParent();e?i.focusNode(e):setTimeout(()=>i.focusTree(this.workspace),0)}t&&(this.unplug(e),oQ(this)),super.dispose(!!e),e2(this.svgGroup)}disposeInternal(){this.disposing=!0,super.disposeInternal(),N.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===this&&this.workspace.cancelCurrentGesture(),[...this.warningTextDb.values()].forEach(e=>clearTimeout(e)),this.warningTextDb.clear(),this.getIcons().forEach(e=>e.dispose())}checkAndDelete(){this.workspace.isFlyout||(N.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),N.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:hE.TYPE,blockState:iP(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:t_(this,!0)}}applyColour(){var e,t;for(null==(t=(e=this.pathObject).applyColour)||t.call(e,this),e=this.getIcons(),t=0;t<e.length;t++)e[t].applyColour();for(let e of this.getFields())e.applyColour()}updateDisabled(){let e=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===e){let e;null==(e=this.getNextBlock())||e.updateDisabled()}else for(let t of(this.applyColour(),this.visuallyDisabled=e,this.getChildren(!1)))t.updateDisabled()}setWarningText(e,t=""){if(t)this.warningTextDb.has(t)&&(clearTimeout(this.warningTextDb.get(t)),this.warningTextDb.delete(t));else{for(var i of this.warningTextDb.values())clearTimeout(i);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(t,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(t),this.setWarningText(e,t))},100));else if(this.isInFlyout&&(e=null),i=this.getIcon(hI.TYPE),e){let s=this.getSurroundParent(),o=null;for(;s;)s.isCollapsed()&&(o=s),s=s.getSurroundParent();o&&o.setWarningText(N.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,hR.COLLAPSED_WARNING_ID),i?i.addMessage(e,t):this.addIcon(new hI(this).addMessage(e,t))}else i&&(t?(i.addMessage("",t),i.getText()||this.removeIcon(hI.TYPE)):this.removeIcon(hI.TYPE))}setMutator(e){this.removeIcon(N.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof N.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),e}createIconPointerDownListener(e){return t=>{this.isDeadOrDying()||(t=this.workspace.getGesture(t))&&t.setStartIcon(e)}}removeIcon(e){let t=super.removeIcon(e);return e.equals(N.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),t}setDisabledReason(e,t){let i=this.isEnabled();super.setDisabledReason(e,t),this.isEnabled()===i||this.getInheritedDisabled()||this.updateDisabled()}setDeletable(e){super.setDeletable(e),e?e0(this.svgGroup,"blocklyNotDeletable"):eq(this.svgGroup,"blocklyNotDeletable")}setHighlighted(e){this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){let t,i;super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),null==(i=(t=this.pathObject).setStyle)||i.call(t,e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){let t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_&&e0(this.svgGroup,this.styleName_),t){let i,s;this.hat=t.hat,null==(s=(i=this.pathObject).setStyle)||s.call(i,t),this.colour_=t.colourPrimary,this.style=t,this.applyColour(),eq(this.svgGroup,e),this.styleName_=e}else throw Error("Invalid style name: "+e)}getStyle(){return this.style}bringToFront(e=!1){let t=N.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode(),i=this;if(!i.isDeadOrDying()){do{let t=i.getSvgRoot(),s=t.parentNode,o=s.childNodes;if(o[o.length-1]!==t&&s.appendChild(t),e)break;i=i.getParent()}while(i)t&&N.getFocusManager$$module$build$src$core$focus_manager().focusNode(t)}}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.queueRender()}setNextStatement(e,t){super.setNextStatement(e,t),this.queueRender()}setOutput(e,t){super.setOutput(e,t),this.queueRender()}setInputsInline(e){super.setInputsInline(e),this.queueRender()}removeInput(e,t){return e=super.removeInput(e,t),this.queueRender(),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.queueRender()}appendInput(e){return super.appendInput(e),this.queueRender(),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var i=this.inputList[t].connection;i&&(i.setTracking(e),(i=i.targetBlock())&&i.setConnectionTracking(e))}}getConnections_(e){let t=[];if(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_)for(let e=0,i;i=this.inputList[e];e++)i.connection&&t.push(i.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new hi(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){let e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(let t of this.getConnections_(!1)){if(t.isSuperior()){let e;null==(e=t.targetBlock())||e.bumpNeighbours()}for(let i of t.neighbours(N.config$$module$build$src$core$config.snapRadius))i.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&i.isConnected()||(t.isSuperior()?i.bumpAwayFrom(t,!1):t.bumpAwayFrom(i,!0)))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(e,t,i){if(e.type===cX.NEXT_STATEMENT||e.type===cX.INPUT_VALUE){let s=t.x;t=t.y,s+=i.x-e.getOffsetInBlock().x,t+=i.y-e.getOffsetInBlock().y,this.moveBy(s,t)}}getChildren(e){return super.getChildren(e)}queueRender(){return t5(this)}render(){this.queueRender(),t4()}renderEfficiently(){e6(),this.isCollapsed()&&this.updateCollapsed(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),e4()}tightenChildrenEfficiently(){for(let e of this.inputList){let t=e.connection;t&&t.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}getHeightWidth(){let e=this.height,t=this.width;var i=this.getNextBlock();if(i){i=i.getHeightWidth();let s=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=i.height-s,t=Math.max(t,i.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}getDragStrategy(){return this.dragStrategy}setDragStrategy(e){this.dragStrategy=e}isMovable(){return this.dragStrategy.isMovable()}startDrag(e){this.dragStrategy.startDrag(e)}drag(e,t){this.dragStrategy.drag(e,t)}endDrag(e){this.dragStrategy.endDrag(e)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){let e=Object.assign({},{kind:"BLOCK"},iP(this)),t=new Set(["id","height","width","pinned","enabled"]),i=function(e){for(let s in e)t.has(s)?delete e[s]:"object"==typeof e[s]&&i(e[s])};return i(e),[e]}jsonInit(e){super.jsonInit(e),e.classes&&this.addClass(Array.isArray(e.classes)?e.classes.join(" "):e.classes)}getFocusableElement(){return this.pathObject.svgPath}getFocusableTree(){return this.workspace}onNodeFocus(){this.select()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}};hR.INLINE=-1,hR.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var hm=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}},hO=class extends hm{constructor(){super(),this.wouldDelete_=!1}wouldDelete(e){return e instanceof hR?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e)):this.updateWouldDelete_(ni(e)&&e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},hA=class{constructor(e,t){this.element=e,this.type=t}getElement(){return this.element}getType(){return this.type}},hS=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,i=0;return e&&(t=e.getWidth(),i=e.getHeight()),new r7(t,i)}getFlyoutMetrics(e){return{width:(e=this.getDimensionsPx_(this.workspace_.getFlyout(e))).width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){let e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){var e;let t=0,i=0,s=this.getToolboxMetrics(),o=this.getFlyoutMetrics(),n=!!this.workspace_.getToolbox(),r=!(null==(e=this.workspace_.getFlyout())?0:e.autoClose),l=(e=n?s.position:o.position)===lp.TOP;return e===lp.LEFT&&(n&&(t+=s.width),r&&(t+=o.width)),l&&(n&&(i+=s.height),r&&(i+=o.height)),{top:i,left:t}}getViewMetrics(e){var t;e=e?this.workspace_.scale:1;let i=this.getSvgMetrics(),s=this.getToolboxMetrics(),o=this.getFlyoutMetrics(),n=!!this.workspace_.getToolbox(),r=!(null==(t=this.workspace_.getFlyout())?0:t.autoClose),l=(t=n?s.position:o.position)===lp.LEFT||t===lp.RIGHT;return(t===lp.TOP||t===lp.BOTTOM)&&(n&&(i.height-=s.height),r&&(i.height-=o.height)),l&&(n&&(i.width-=s.width),r&&(i.width-=o.width)),{height:i.height/e,width:i.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;let t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};let t=this.workspace_.isMovableHorizontally(),i=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);let s={};return i||(s.top=e.top,s.bottom=e.top+e.height),t||(s.left=e.left,s.right=e.left+e.width),s}getPaddedContent_(e,t){let i=t.top+t.height,s=t.left+t.width,o=e.width;e=e.height;let n=o/2,r=e/2;return{top:Math.min(t.top-r,i-e),bottom:Math.max(i+r,t.top+e),left:Math.min(t.left-n,s-o),right:Math.max(s+n,t.left+o)}}getScrollMetrics(e,t,i){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(!1);var s=i||this.getContentMetrics();i=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,s),s=void 0!==i.top?i.top:t.top;let o=void 0!==i.left?i.left:t.left;return{top:s/e,left:o/e,width:((void 0!==i.right?i.right:t.right)-o)/e,height:((void 0!==i.bottom?i.bottom:t.bottom)-s)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){let e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(!0),i=this.getSvgMetrics(),s=this.getAbsoluteMetrics(),o=this.getViewMetrics(),n=this.getContentMetrics(),r=this.getScrollMetrics(!1,o,n);return{contentHeight:n.height,contentWidth:n.width,contentTop:n.top,contentLeft:n.left,scrollHeight:r.height,scrollWidth:r.width,scrollTop:r.top,scrollLeft:r.left,viewHeight:o.height,viewWidth:o.width,viewTop:o.top,viewLeft:o.left,absoluteTop:s.top,absoluteLeft:s.left,svgHeight:i.height,svgWidth:i.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};ea(M.METRICS_MANAGER,D,hS);var hC=class extends hS{constructor(e,t){super(e),this.flyout_=t}getBoundingBox(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch(t){e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){let t=this.getBoundingBox();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,i){return t=i||this.getContentMetrics(),i=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*i)/e,width:(t.width+t.left+i)/e,top:0,left:0}}},hf=class{constructor(e,t,i,s){let o;this.workspace=e,this.targetWorkspace=t,this.isFlyoutLabel=s,this.height=this.width=0,this.cursorSvg=this.svgText=null,this.text=i.text,this.position=new r4(0,0),this.callbackKey=i.callbackKey||i.callbackkey,this.cssClass=i["web-class"]||null,this.info=i,e=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton",this.cssClass&&(e+=" "+this.cssClass),this.id=eD(),this.svgGroup=eZ(r8.G,{id:this.id,class:e},this.workspace.getCanvas()),this.isFlyoutLabel||(o=eZ(r8.RECT,{class:"blocklyFlyoutButtonShadow",rx:hf.BORDER_RADIUS,ry:hf.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=eZ(r8.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:hf.BORDER_RADIUS,ry:hf.BORDER_RADIUS},this.svgGroup),t=eZ(r8.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup),i=sY(this.text),this.workspace.RTL&&(i+="‏"),t.textContent=i,this.isFlyoutLabel&&(this.svgText=t,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill")),s=tS(t,"fontSize");let n=tS(t,"fontWeight"),r=tS(t,"fontFamily");if(this.width=e9(t,s,n,r),i=e7(i,s,n,r),this.height=this.height||i.height,!this.isFlyoutLabel){let e,t;this.width+=2*hf.TEXT_MARGIN_X,this.height+=2*hf.TEXT_MARGIN_Y,null==(e=o)||e.setAttribute("width",String(this.width)),null==(t=o)||t.setAttribute("height",String(this.height))}e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),t.setAttribute("x",String(this.width/2)),t.setAttribute("y",String(this.height/2-i.height/2+i.baseline)),this.updateTransform(),this.onMouseDownWrapper=eS(this.svgGroup,"pointerdown",this,this.onMouseDown),this.onMouseUpWrapper=eS(this.svgGroup,"pointerup",this,this.onMouseUp)}createDom(){return this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,t){this.position.x=e,this.position.y=t,this.updateTransform()}moveBy(e,t,i){this.moveTo(this.position.x+e,this.position.y+t)}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getBoundingRectangle(){return new r9(this.position.y,this.position.y+this.height,this.position.x,this.position.x+this.width)}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){ef(this.onMouseDownWrapper),ef(this.onMouseUpWrapper),this.svgGroup&&e2(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(e){e?this.svgGroup&&(this.svgGroup.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}onMouseDown(e){let t=this.targetWorkspace.getGesture(e),i=this.targetWorkspace.getFlyout();t&&i&&t.handleFlyoutStart(e,i)}getSvgRoot(){return this.svgGroup}getFocusableElement(){return this.svgGroup}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}};hf.TEXT_MARGIN_X=5,hf.TEXT_MARGIN_Y=2,hf.BORDER_RADIUS=4,tR("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n");var hL=class{getFirstChild(e){return null}getParent(e){return e.getWorkspace()}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof hf}},hN=class{constructor(e,t){this.policy=e,this.flyout=t}getFirstChild(e){return null}getParent(e){return this.policy.getParent(e)}getNextSibling(e){let t=this.flyout.getContents();if(!t)return null;let i=t.findIndex(t=>t.getElement()===e);return -1===i?null:(++i>=t.length&&(i=0),t[i].getElement())}getPreviousSibling(e){let t=this.flyout.getContents();if(!t)return null;let i=t.findIndex(t=>t.getElement()===e);return -1===i?null:(0>--i&&(i=t.length-1),t[i].getElement())}isNavigable(e){return this.policy.isNavigable(e)}isApplicable(e){return this.policy.isApplicable(e)}},hb=class{constructor(e,t){this.gap=e,this.axis=t,this.y=this.x=0}getBoundingRectangle(){switch(this.axis){case"x":return new r9(this.y,this.y,this.x,this.x+this.gap);case"y":return new r9(this.y,this.y+this.gap,this.x,this.x)}}moveBy(e,t,i){this.x+=e,this.y+=t}isNavigable(){return!1}getFocusableElement(){throw Error("Cannot be focused")}getFocusableTree(){throw Error("Cannot be focused")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}},h$=class{getFirstChild(e){return null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return!1}isApplicable(e){return e instanceof hb}},hD=class{getFirstChild(e){return ns(e)[0]}getParent(e){var t;if(null==(t=e.previousConnection)?0:t.targetBlock()){if(t=e.getSurroundParent())return t}else{let t;if(null==(t=e.outputConnection)?0:t.targetBlock())return e.outputConnection.targetBlock()}return e.workspace}getNextSibling(e){let t,i;if(null==(t=e.nextConnection)?0:t.targetBlock()){let t;return null==(t=e.nextConnection)?void 0:t.targetBlock()}return(null==(i=e.outputConnection)?0:i.targetBlock())?nn(e,1):this.getParent(e)instanceof uf?no(e,1):null}getPreviousSibling(e){let t,i;if(null==(t=e.previousConnection)?0:t.targetBlock()){let t;return null==(t=e.previousConnection)?void 0:t.targetBlock()}return(null==(i=e.outputConnection)?0:i.targetBlock())?nn(e,-1):this.getParent(e)instanceof uf?no(e,-1):null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof hR}},hM={};hM.BlockNavigationPolicy=hD,hM.navigateBlock=nn,hM.navigateStacks=no;var hP=class{getFirstChild(e){return e.getParentInput()?e.targetConnection:null}getParent(e){return e.getSourceBlock()}getNextSibling(e){if(e.getParentInput())return nn(e,1);if(e.type===cX.NEXT_STATEMENT){let i=e.targetConnection;var t=e.getSourceBlock();if(!i&&t.getRootBlock().lastConnectionInStack(!1)===e){let i;return(t=(e=t.workspace.getTopBlocks(!0)).indexOf(t.getRootBlock())+1)>=e.length&&(t=0),t=e[t],null!=(i=this.getParentConnection(t))?i:t}return i}return e.getSourceBlock()}getPreviousSibling(e){if(e.getParentInput())return nn(e,-1);if(e.type===cX.PREVIOUS_STATEMENT||e.type===cX.OUTPUT_VALUE){let i=e.targetConnection&&!e.targetConnection.getParentInput()?e.targetConnection:null;var t=e.getSourceBlock();if(!i&&this.getParentConnection(t.getRootBlock())===e){let i;return 0>(t=(e=t.workspace.getTopBlocks(!0)).indexOf(t.getRootBlock())-1)&&(t=e.length-1),null!=(i=(t=e[t]).lastConnectionInStack(!1))?i:t}return i}return e.type===cX.NEXT_STATEMENT?e.getSourceBlock():null}getParentConnection(e){let t;return!e.outputConnection||(null==(t=e.previousConnection)?0:t.isConnected())?e.previousConnection:e.outputConnection}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof hi}},hy=class{getFirstChild(e){return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return nn(e,1)}getPreviousSibling(e){return nn(e,-1)}isNavigable(e){let t;return e.canBeFocused()&&e.isVisible()&&(e.isClickable()||e.isCurrentlyEditable())&&!((null==(t=e.getSourceBlock())?0:t.isSimpleReporter())&&e.isFullBlockField())&&e.getParentInput().isVisible()}isApplicable(e){return e instanceof cl}},hk=class{getFirstChild(e){return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return nn(e,1)}getPreviousSibling(e){return nn(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof c0}},hw=class{getFirstChild(e){return(e=e.getTopBlocks(!0)).length?e[0]:null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof uf}},hv=class{constructor(){this.rules=[new hD,new hy,new hP,new hw,new hk]}addNavigationPolicy(e){this.rules.push(e)}get(e){return this.rules.find(t=>t.isApplicable(e))}getFirstChild(e){let t,i,s=null==(t=this.get(e))?void 0:t.getFirstChild(e);return s?null!=(i=this.get(s))&&i.isNavigable(s)?s:this.getNextSibling(s):null}getParent(e){let t,i,s=null==(t=this.get(e))?void 0:t.getParent(e);return s?null!=(i=this.get(s))&&i.isNavigable(s)?s:this.getParent(s):null}getNextSibling(e){let t,i,s=null==(t=this.get(e))?void 0:t.getNextSibling(e);return s?null!=(i=this.get(s))&&i.isNavigable(s)?s:this.getNextSibling(s):null}getPreviousSibling(e){let t,i,s=null==(t=this.get(e))?void 0:t.getPreviousSibling(e);return s?null!=(i=this.get(s))&&i.isNavigable(s)?s:this.getPreviousSibling(s):null}},hB=class extends hv{constructor(e){super(),this.rules.push(new hL,new h$),this.rules=this.rules.map(t=>new hN(t,e))}},hG=class{constructor(e,t,i,s,o){this.workspace=e,this.oldHostMetrics=this.corner_=this.vScroll=this.hScroll=null,i=void 0===i||i;let n=(t=void 0===t||t)&&i;t&&(this.hScroll=new ln(e,!0,n,s,o)),i&&(this.vScroll=new ln(e,!1,n,s,o)),n&&(this.corner_=eZ(r8.RECT,{height:ln.scrollbarThickness,width:ln.scrollbarThickness,class:"blocklyScrollbarBackground"}),e3(this.corner_,e.getBubbleCanvas()))}dispose(){e2(this.corner_),this.oldHostMetrics=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){let e=this.workspace.getMetrics();if(e){var t=!1,i=!1;if(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===e.viewWidth&&this.oldHostMetrics.viewHeight===e.viewHeight&&this.oldHostMetrics.absoluteTop===e.absoluteTop&&this.oldHostMetrics.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics&&this.oldHostMetrics.scrollWidth===e.scrollWidth&&this.oldHostMetrics.viewLeft===e.viewLeft&&this.oldHostMetrics.scrollLeft===e.scrollLeft||(t=!0),this.oldHostMetrics&&this.oldHostMetrics.scrollHeight===e.scrollHeight&&this.oldHostMetrics.viewTop===e.viewTop&&this.oldHostMetrics.scrollTop===e.scrollTop||(i=!0)):i=t=!0,t||i){try{N.disable$$module$build$src$core$events$utils(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&i&&this.vScroll.resize(e)}finally{N.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft){let e;null==(e=this.corner_)||e.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteTop!==e.absoluteTop){let e;null==(e=this.corner_)||e.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,i){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(t,!1),(i||void 0===i)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},hF=class{load(e,t){return new hA(new hb(0,t.horizontalLayout?"x":"y"),"sep")}gapForItem(e,t){let i;return null!=(i=parseInt(String(e.gap)))?i:t}disposeItem(e){}getType(){return"sep"}};ea(M.FLYOUT_INFLATER,"sep",hF);var hx=class extends hO{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.reflowWrapper=null,this.contents=[],this.autoClose=!0,this.visible=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,this.inflaters=new Map,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new uf(e),this.workspace_.setMetricsManager(new hC(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.visible),this.workspace_.setNavigator(new hB(this)),this.id=eM(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=eZ(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=eZ(r8.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new hG(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(eS(this.svgGroup_,"wheel",this,this.wheel_)),this.boundEvents.push(eS(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:r0.ComponentWeight.FLYOUT_WEIGHT,capabilities:[r0.Capability.AUTOHIDEABLE,r0.Capability.DELETE_AREA,r0.Capability.DRAG_TARGET]})}dispose(){for(let e of(this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id),this.boundEvents))ef(e);this.boundEvents.length=0,this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&e2(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.visible}setVisible(e){let t=e!==this.isVisible();this.visible=e,t&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){let t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay()}getContents(){return this.contents}setContents(e){this.contents=e}updateDisplay(){let e,t;e=!!this.containerVisible&&this.isVisible(),this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none"),null==(t=this.workspace_.scrollbar)||t.setContainerVisible(e)}positionAt_(e,t,i,s){let o,n;null==(o=this.svgGroup_)||o.setAttribute("width",`${e}`),null==(n=this.svgGroup_)||n.setAttribute("height",`${t}`),this.workspace_.setCachedParentSvgSize(e,t),this.svgGroup_&&e5(this.svgGroup_,"translate("+i+"px,"+s+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(i,s),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){this.isVisible()&&(this.setVisible(!1),this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null))}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),"string"==typeof e&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=tF(e),e=this.createFlyoutInfo(e),t4(this.workspace_),this.setContents(e),this.layout_(e),this.horizontalLayout?this.height_=0:this.width_=0,this.reflow(),this.workspace_.setResizesEnabled(!0),this.reflowWrapper=e=>{e.type!==rC.BLOCK_CHANGE&&e.type!==rC.BLOCK_FIELD_INTERMEDIATE_CHANGE||this.reflow()},this.workspace_.addChangeListener(this.reflowWrapper)}createFlyoutInfo(e){let t=[],i=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(let s of e)"custom"in s&&(e=tF(e=this.getDynamicCategoryContents(s.custom)),t.push(...this.createFlyoutInfo(e))),e=s.kind.toLowerCase(),(e=this.getInflaterForType(e))&&(t.push(e.load(s,this)),(e=e.gapForItem(s,i))&&t.push(new hA(new hb(e,this.horizontalLayout?"x":"y"),"sep")));return this.normalizeSeparators(t)}normalizeSeparators(e){for(let t=e.length-1;0<t;t--){let i=e[t].getType().toLowerCase(),s=e[t-1].getType().toLowerCase();"sep"===i&&"sep"===s&&e.splice(t-1,1)}return e}getDynamicCategoryContents(e){if("function"!=typeof(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}clearOldBlocks(){let e;this.getContents().forEach(e=>{let t;null==(t=this.getInflaterForType(e.getType()))||t.disposeItem(e)}),null==(e=this.workspace_.getPotentialVariableMap())||e.clear()}onMouseDown(e){let t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()&&!this.getTargetWorkspace().isReadOnly()}createBlock(e){let t=null;N.disable$$module$build$src$core$events$utils();var i=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{t=this.placeNewBlock(e)}finally{N.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=i$(this.targetWorkspace,i),eX()){for(N.setGroup$$module$build$src$core$events$utils(!0),i=0;i<e.length;i++){let t=e[i];eU(new(ej(rC.VAR_CREATE))(t))}eU(new(ej(rC.BLOCK_CREATE))(t))}return this.autoClose&&this.hide(),t}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()}placeNewBlock(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered");let i=this.serializeBlock(e);return t.setResizesEnabled(!1),t=iU(i,t),this.positionNewBlock(e,t),t}serializeBlock(e){return iP(e)}positionNewBlock(e,t){let i=this.targetWorkspace;var s=i.getOriginOffsetInPixels(),o=this.workspace_.getOriginOffsetInPixels();(e=e.getRelativeToSurfaceXY()).scale(this.workspace_.scale),o=r4.sum(o,e),(s=r4.difference(o,s)).scale(1/i.scale),t.moveTo(new r4(s.x,s.y))}getInflaterForType(e){if(this.inflaters.has(e)){var t;return null!=(t=this.inflaters.get(e))?t:null}return(t=eE(M.FLYOUT_INFLATER,e))?(t=new t,this.inflaters.set(e,t),t):null}getFocusableElement(){throw Error("Flyouts are not directly focusable.")}getFocusableTree(){throw Error("Flyouts are not directly focusable.")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}getRootFocusableNode(){throw Error("Flyouts are not directly focusable.")}getRestoredFocusableNode(e){throw Error("Flyouts are not directly focusable.")}getNestedTrees(){throw Error("Flyouts are not directly focusable.")}lookUpFocusableNode(e){throw Error("Flyouts are not directly focusable.")}onTreeFocus(e,t){}onTreeBlur(e){throw Error("Flyouts are not directly focusable.")}},hU=class{constructor(){this.isActive=!1,this.activeClassName="blocklyKeyboardNavigation"}setIsActive(e=!0){this.isActive=e,this.updateActiveVisualization()}getIsActive(){return this.isActive}updateActiveVisualization(){this.isActive?document.body.classList.add(this.activeClassName):document.body.classList.remove(this.activeClassName)}},hH=new hU,hW={};hW.KeyboardNavigationController=hU,hW.keyboardNavigationController=hH;var hV=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled=this.workspace.isMovableVertically(),this.startScrollXY_=new r4(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){}endDrag(e){this.drag(e)}drag(e){if(e=r4.sum(this.startScrollXY_,e),this.horizontalScrollEnabled&&this.verticalScrollEnabled)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled)this.workspace.scroll(e.x,this.workspace.scrollY);else if(this.verticalScrollEnabled)this.workspace.scroll(this.workspace.scrollX,e.y);else throw TypeError("Invalid state.")}},hK=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY=new r4(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.multiTouch=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new r4(0,0)}dispose(){for(let e of(eR(),sP(),this.creatorWorkspace.clearGesture(),this.boundEvents))ef(e);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){let t=new r4(e.clientX,e.clientY);this.updateDragDelta(t)&&(this.updateIsDragging(e),eI()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=r4.difference(e,this.mouseDownXY),!this.hasExceededDragRadius&&(this.hasExceededDragRadius=r4.magnitude(this.currentDragDeltaXY)>(this.flyout?N.config$$module$build$src$core$config.flyoutDragRadius:N.config$$module$build$src$core$config.dragRadius))}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||null==(e=this.flyout)||!e.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined");return!!(!this.flyout.isScrollable()||this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY))&&(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),N.getGroup$$module$build$src$core$events$utils()||N.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),N.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),!0)}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new hV(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(e){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();let t=tc();t&&nr(t)&&t.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(t,this.startWorkspace_),this.dragger.onDragStart(e),this.dragger.onDrag(e,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(e,t){return new(ep(M.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(e,t)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,eL(e)?this.cancel():(this.gestureHasStarted=!0,o5(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=i4(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,sM(),eN(e)?this.handleRightClick(e):("pointerdown"===e.type.toLowerCase()&&"mouse"!==e.pointerType&&eg(e,this),this.mouseDownXY=new r4(e.clientX,e.clientY),this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(eS(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(eS(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(eS(document,"pointerup",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&eI())}handleMove(e){this.isDragging()&&em(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),eI())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!em(e))return;if(this.updateFromEvent(e),eI(),this.isEnding_)return void console.log("Trying to end a gesture recursively.");this.isEnding_=!0,this.dragger?(hH.setIsActive(!1),this.dragger.onDragEnd(e,this.currentDragDeltaXY)):this.workspaceDragger?(hH.setIsActive(!1),this.workspaceDragger.endDrag(this.currentDragDeltaXY)):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e))}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=eO(e);this.cachedPoints.set(t,this.getTouchPoint(e));var i=Array.from(this.cachedPoints.keys());2===i.length&&(t=this.cachedPoints.get(i[0]),i=this.cachedPoints.get(i[1]),this.startDistance=r4.distance(t,i),this.multiTouch=!0,e.preventDefault())}handleTouchMove(e){let t=eO(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(e):(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation())}handlePinch(e){var t=Array.from(this.cachedPoints.keys()),i=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),i=r4.distance(i,t)/this.startDistance,0<this.previousScale&&1/0>this.previousScale){if(t=0<(t=i-this.previousScale)?5*t:6*t,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");let s=this.startWorkspace_,o=eb(e,s.getParentSvg(),s.getInverseScreenCTM());s.zoom(o.x,o.y,t)}this.previousScale=i,e.preventDefault()}handleTouchEnd(e){e=eO(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new r4(e.pageX,e.pageY):null}isMultiTouch(){return this.multiTouch}cancel(){this.isEnding_||(eI(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(e)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),N.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startWorkspace_),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),hH.setIsActive(!1),this.dispose()}handleWsStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(t),this.mostRecentEvent=e,this.startBlock||this.startBubble||this.startComment?this.startBlock&&N.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startBlock):N.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),this.doStart(e)}fireWorkspaceClick(e){eU(new(ej(rC.CLICK))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent=e}handleBubbleStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent=e}handleCommentStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(t),this.mostRecentEvent=e}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.bringBlockToFront(),this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent)}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");if(this.flyout.isBlockCreatable(this.targetBlock)){N.getGroup$$module$build$src$core$events$utils()||N.setGroup$$module$build$src$core$events$utils(!0);var e=this.flyout.createBlock(this.targetBlock);e.snapToGrid(),e.bumpNeighbours(),N.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");eU(e=new(ej(rC.CLICK))(this.startBlock,this.startWorkspace_.id,"block"))}this.bringBlockToFront(),N.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){this.fireWorkspaceClick(this.startWorkspace_||this.creatorWorkspace)}bringBlockToFront(){this.targetBlock&&!this.flyout&&(N.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),this.targetBlock.bringToFront())}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartComment(e){this.startComment||(this.startComment=e)}setStartBlock(e){this.startBlock||this.startBubble||(this.startBlock=e,e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):(this.targetBlock=e,N.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!!this.startBlock&&!this.hasExceededDragRadius&&!this.isFieldClick()&&!this.isIconClick()}isFieldClick(){return!!this.startField&&this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose))}isIconClick(){if(!this.startIcon)return!1;let e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&e}isWorkspaceClick(){return!this.startBlock&&!this.startBubble&&!this.startField&&!this.hasExceededDragRadius}getCurrentDragger(){let e,t;return null!=(t=null!=(e=this.workspaceDragger)?e:this.dragger)?t:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){let e=to();for(let t=0,i;i=e[t];t++)if(i.currentGesture_)return!0;return!1}},hX=class{constructor(e,t){let i,s,o;this.pattern=e,this.scale=1,this.spacing=null!=(i=t.spacing)?i:0,this.length=null!=(s=t.length)?s:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling,this.snapToGrid=null!=(o=t.snap)&&o}setSpacing(e){this.spacing=e,this.update(this.scale)}getSpacing(){return this.spacing}setLength(e){this.length=e,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(e){this.snapToGrid=e}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(e){this.scale=e;var t=this.spacing*e;this.pattern.setAttribute("width",`${t}`),this.pattern.setAttribute("height",`${t}`);let i=(t=Math.floor(this.spacing/2)+.5)-this.length/2,s=t+this.length/2;t*=e,i*=e,s*=e,this.setLineAttributes(this.line1,e,i,s,t,t),this.setLineAttributes(this.line2,e,t,t,i,s)}setLineAttributes(e,t,i,s,o,n){e&&(e.setAttribute("stroke-width",`${t}`),e.setAttribute("x1",`${i}`),e.setAttribute("y1",`${o}`),e.setAttribute("x2",`${s}`),e.setAttribute("y2",`${n}`))}moveTo(e,t){this.pattern.setAttribute("x",`${e}`),this.pattern.setAttribute("y",`${t}`)}alignXY(e){var t=this.getSpacing();let i=t/2,s=Math.round(Math.round((e.x-i)/t)*t+i);return t=Math.round(Math.round((e.y-i)/t)*t+i),s===e.x&&t===e.y?e:new r4(s,t)}static createDom(e,t,i,s){let o,n;if(e=eZ(r8.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},i),0<(null!=(o=t.length)?o:1)&&0<(null!=(n=t.spacing)?n:0)){let i;eZ(r8.LINE,{stroke:t.colour},e),null!=(i=t.length)&&i&&eZ(r8.LINE,{stroke:t.colour},e)}else eZ(r8.LINE,{},e);return s&&s.style.setProperty("--blocklyGridPattern",`url(#${e.id})`),e}},hY=class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e),this.animationLayer=this.createAnimationLayer(e)),eq(e=this.createLayer(50),"blocklyBlockCanvas"),eq(e=this.createLayer(100),"blocklyBubbleCanvas")}createDragLayer(e){let t=eZ(r8.SVG,{class:"blocklyBlockDragSurface",xmlns:rL,"xmlns:html":rN,"xmlns:xlink":rb,version:"1.1"});return e.append(t),eZ(r8.G,{},t)}createAnimationLayer(e){let t=eZ(r8.SVG,{class:"blocklyAnimationLayer",xmlns:rL,"xmlns:html":rN,"xmlns:xlink":rb,version:"1.1"});return e.append(t),eZ(r8.G,{},t)}appendToAnimationLayer(e){let t,i,s=null==(t=this.dragLayer)?void 0:t.getAttribute("transform");if(s){let e;null==(e=this.animationLayer)||e.setAttribute("transform",s)}null==(i=this.animationLayer)||i.appendChild(e.getSvgRoot())}translateLayers(e,t){let i;for(let[,s]of(e=`translate(${e.x}, ${e.y}) scale(${t})`,null==(i=this.dragLayer)||i.setAttribute("transform",e),this.layers))s.setAttribute("transform",e)}moveToDragLayer(e){let t;null==(t=this.dragLayer)||t.appendChild(e.getSvgRoot()),e.canBeFocused()&&N.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}moveOffDragLayer(e,t){this.append(e,t),e.canBeFocused()&&N.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}append(e,t){let i;if(this.layers.has(t)||this.createLayer(t),e=e.getSvgRoot(),(null==(i=this.layers.get(t))?void 0:i.lastChild)!==e){let i;null==(i=this.layers.get(t))||i.appendChild(e)}}createLayer(e){let t=this.workspace.getSvgGroup(),i=eZ(r8.G,{}),s=!1;for(let[o,n]of[...this.layers].sort((e,t)=>e[0]-t[0]))if(e<o){t.insertBefore(i,n),s=!0;break}return s||t.appendChild(i),this.layers.set(e,i),i}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(50)}getBubbleLayer(){return this.layers.get(100)}},hz=class{constructor(e){this.workspace=e,this.cursor=null,this.markers=new Map}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),this.markers.set(e,t)}unregisterMarker(e){let t=this.markers.get(e);if(t)t.dispose(),this.markers.delete(e);else throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.")}getCursor(){return this.cursor}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor=e}dispose(){let e=Object.keys(this.markers);for(let t=0,i;i=e[t];t++)this.unregisterMarker(i);this.markers.clear(),this.cursor&&(this.cursor.dispose(),this.cursor=null)}};hz.LOCAL_MARKER="local_marker_1";var hj=class extends cq{constructor(e,t,i){super(e,t,i,hj.createTextArea()),this.workspace=e,this.anchor=t,this.ownerRect=i,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.locationChangeListeners=[],this.text="",this.DEFAULT_SIZE=new r7(160+cq.DOUBLE_BORDER,80+cq.DOUBLE_BORDER),this.MIN_SIZE=new r7(45+cq.DOUBLE_BORDER,20+cq.DOUBLE_BORDER),this.editable=!0,eq(this.svgRoot,"blocklyTextInputBubble"),this.textArea=this.getFocusableElement(),this.inputRoot=this.createEditor(this.contentContainer,this.textArea),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}setEditable(e){(this.editable=e)?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","")}isEditable(){return this.editable}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}addLocationChangeListener(e){this.locationChangeListeners.push(e)}static createTextArea(){let e=document.createElementNS(rN,"textarea");return e.className="blocklyTextarea blocklyText",e}createEditor(e,t){e=eZ(r8.FOREIGNOBJECT,{x:cq.BORDER_WIDTH,y:cq.BORDER_WIDTH},e);let i=document.createElementNS(rN,"body");return i.setAttribute("xmlns",rN),i.className="blocklyMinimalBody",t.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),i.appendChild(t),e.appendChild(i),this.bindTextAreaEvents(t),e}bindTextAreaEvents(e){eS(e,"wheel",this,e=>{e.stopPropagation()}),eS(e,"change",this,this.onTextChange)}createResizeHandle(e,t){return eS(e=eZ(r8.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),"pointerdown",this,this.onResizePointerDown),e}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);let i=e.width-cq.DOUBLE_BORDER,s=e.height-cq.DOUBLE_BORDER;this.inputRoot.setAttribute("width",`${i}`),this.inputRoot.setAttribute("height",`${s}`),this.resizeGroup.setAttribute("y",`${s}`),this.workspace.RTL?this.resizeGroup.setAttribute("x",`${-cq.DOUBLE_BORDER}`):this.resizeGroup.setAttribute("x",`${i}`),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}moveDuringDrag(e){super.moveDuringDrag(e),this.onLocationChange()}setPositionRelativeToAnchor(e,t){super.setPositionRelativeToAnchor(e,t),this.onLocationChange()}positionByRect(e=new r9(0,0,0,0)){super.positionByRect(e),this.onLocationChange()}onResizePointerDown(e){this.bringToFront(),eN(e)||(or(this.workspace,e,new r4(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=eS(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=eS(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){eR(),this.resizePointerUpListener&&(ef(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(ef(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=ol(this.workspace,e),this.setSize(new r7(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onTextChange(){for(let e of(this.text=this.textArea.value,this.textChangeListeners))e()}onSizeChange(){for(let e of this.sizeChangeListeners)e()}onLocationChange(){for(let e of this.locationChangeListeners)e()}};tR("\n.blocklyTextInputBubble .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 0;\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n");var hJ={};hJ.register=na,hJ.unregister=function(e){eh(M.ICON,e)};var hZ=class extends c0{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new r7(160,80),this.bubbleVisiblity=!1}getType(){return hZ.TYPE}initView(e){this.svgRoot||(super.initView(e),eZ(r8.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),eZ(r8.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),eZ(r8.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),eq(this.svgRoot,"blocklyCommentIcon"))}dispose(){let e;super.dispose(),null==(e=this.textInputBubble)||e.dispose()}getWeight(){return hZ.WEIGHT}getSize(){return new r7(17,17)}applyColour(){let e;super.applyColour();let t=this.sourceBlock.getColour();null==(e=this.textInputBubble)||e.setColour(t)}updateEditable(){let e=this,t=()=>super.updateEditable;return r_.asyncExecutePromiseGeneratorFunction(function*(){t().call(e),e.bubbleIsVisible()&&(yield e.setBubbleVisible(!1),yield e.setBubbleVisible(!0))})}onLocationChange(e){let t,i=this.workspaceLocation;super.onLocationChange(e),this.bubbleLocation&&(e=r4.difference(this.workspaceLocation,i),this.bubbleLocation=r4.sum(this.bubbleLocation,e)),e=this.getAnchorLocation(),null==(t=this.textInputBubble)||t.setAnchorLocation(e)}setText(e){let t,i=this.text;eU(new(ej(rC.BLOCK_CHANGE))(this.sourceBlock,"comment",null,i,e)),this.text=e,null==(t=this.textInputBubble)||t.setText(this.text)}getText(){return this.text}setBubbleSize(e){let t;this.bubbleSize=e,null==(t=this.textInputBubble)||t.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}setBubbleLocation(e){let t;this.bubbleLocation=e,null==(t=this.textInputBubble)||t.moveDuringDrag(e)}getBubbleLocation(){return this.bubbleLocation}saveState(){if(this.text){let e={text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width},t=this.getBubbleLocation();return t&&(e.x=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(t.x+this.bubbleSize.width):t.x,e.y=t.y),e}return null}loadState(e){let t,i,s,o;this.text=null!=(t=e.text)?t:"",this.bubbleSize=new r7(null!=(i=e.width)?i:160,null!=(s=e.height)?s:80),this.bubbleVisiblity=null!=(o=e.pinned)&&o,this.setBubbleVisible(this.bubbleVisiblity);let n=e.x,r=e.y;t6().then(()=>{n&&r&&(n=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(n+this.bubbleSize.width):n,this.setBubbleLocation(new r4(n,r)))})}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var e=this.textInputBubble.getText();this.text!==e&&(eU(new(ej(rC.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}onBubbleLocationChange(){this.textInputBubble&&(this.bubbleLocation=this.textInputBubble.getRelativeToSurfaceXY())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){let t=this;return r_.asyncExecutePromiseGeneratorFunction(function*(){t.bubbleVisiblity!==e&&(t.bubbleVisiblity=e,yield t6(),!t.sourceBlock.rendered||t.sourceBlock.isInFlyout||t.sourceBlock.isInsertionMarker()||(e?(t.sourceBlock.isEditable()?t.showEditableBubble():t.showNonEditableBubble(),t.applyColour()):t.hideBubble(),eU(new(ej(rC.BUBBLE_OPEN))(t.sourceBlock,e,"comment"))))})}getBubble(){return this.textInputBubble}showEditableBubble(){let e,t;this.createBubble(),null==(e=this.textInputBubble)||e.addTextChangeListener(()=>this.onTextChange()),null==(t=this.textInputBubble)||t.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){let e;this.createBubble(),null==(e=this.textInputBubble)||e.setEditable(!1)}createBubble(){this.textInputBubble=new hj(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.bubbleLocation&&this.textInputBubble.moveDuringDrag(this.bubbleLocation),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange()),this.textInputBubble.addLocationChangeListener(()=>this.onBubbleLocationChange())}hideBubble(){let e;null==(e=this.textInputBubble)||e.dispose(),this.textInputBubble=null}getAnchorLocation(){return r4.sum(this.workspaceLocation,new r4(8.5,8.5))}getBubbleOwnerRect(){return this.sourceBlock.getBoundingRectangleWithoutChildren()}};hZ.TYPE=aI.COMMENT,hZ.WEIGHT=3,na(hZ.TYPE,hZ);var hq={};hq.CommentIcon=hZ,hq.Icon=c0,hq.IconType=aI,hq.MutatorIcon=N.MutatorIcon$$module$build$src$core$icons$mutator_icon,hq.WarningIcon=hI,hq.exceptions=c8,hq.registry=hJ,N.Names$$module$build$src$core$names=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.getName():null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)}populateVariables(e){e=N.allUsedVarModels$$module$build$src$core$variables(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),N.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let i=e;t===N.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))&&(i=e),e=i.toLowerCase();let s=t===N.NameType$$module$build$src$core$names.VARIABLE||t===N.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(t)||this.db.set(t,new Map);let o=this.db.get(t);return o.has(e)?s+o.get(e):(t=this.getDistinctName(i,t),o.set(e,t.substr(s.length)),t)}getUserNames(e){let t;return(e=null==(t=this.db.get(e))?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){let i;e=this.safeName(e);let s=null,o,n;for(;this.dbReverse.has(e+(null!=(o=s)?o:""))||this.reservedWords.has(e+(null!=(n=s)?n:""));)s=s?s+1:2;return e+=null!=(i=s)?i:"",this.dbReverse.add(e),(t===N.NameType$$module$build$src$core$names.VARIABLE||t===N.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(e[0])&&(e="my_"+e)):e=N.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}},(db=(db=N.Names$$module$build$src$core$names||(N.Names$$module$build$src$core$names={})).NameType||(db.NameType={})).DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",db.VARIABLE="VARIABLE",db.PROCEDURE="PROCEDURE",N.NameType$$module$build$src$core$names=N.Names$$module$build$src$core$names.NameType,N.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=N.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,({NameType:N.NameType$$module$build$src$core$names}).Names=N.Names$$module$build$src$core$names;var hQ=class extends Map{constructor(){super()}set(e,t){return this.get(e)===t||(super.set(e,t),nh(t)&&t.startPublishing()),this}delete(e){let t=this.get(e);return(e=super.delete(e))&&nh(t)&&t.stopPublishing(),e}clear(){if(this.size)for(let e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}};dM="PROCEDURE",N.DEFAULT_ARG$$module$build$src$core$procedures="x",(dP={CATEGORY_NAME:dM,DEFAULT_ARG:N.DEFAULT_ARG$$module$build$src$core$procedures}).ObservableProcedureMap=hQ,dP.allProcedures=nu,dP.findLegalName=N.findLegalName$$module$build$src$core$procedures,dP.flyoutCategory=ng,dP.getCallers=nO,dP.getDefinition=N.getDefinition$$module$build$src$core$procedures,dP.internalFlyoutCategory=np,dP.isNameUsed=n_,dP.isProcedureBlock=nc,dP.mutateCallers=N.mutateCallers$$module$build$src$core$procedures,dP.mutatorOpenListener=nR,dP.rename=N.rename$$module$build$src$core$procedures;var h0=new class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=0x1000000}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return 1<=(e.type&this.FIELD)}isHat(e){return 1<=(e.type&this.HAT)}isIcon(e){return 1<=(e.type&this.ICON)}isSpacer(e){return 1<=(e.type&this.SPACER)}isInRowSpacer(e){return 1<=(e.type&this.IN_ROW_SPACER)}isSpacerRow(e){return 1<=(e.type&this.BETWEEN_ROW_SPACER)}isInput(e){return 1<=(e.type&this.INPUT)}isExternalInput(e){return 1<=(e.type&this.EXTERNAL_VALUE_INPUT)}isInlineInput(e){return 1<=(e.type&this.INLINE_INPUT)}isStatementInput(e){return 1<=(e.type&this.STATEMENT_INPUT)}isPreviousConnection(e){return 1<=(e.type&this.PREVIOUS_CONNECTION)}isNextConnection(e){return 1<=(e.type&this.NEXT_CONNECTION)}isPreviousOrNextConnection(e){return this.isPreviousConnection(e)||this.isNextConnection(e)}isRoundCorner(e){return 1<=(e.type&this.LEFT_ROUND_CORNER)||1<=(e.type&this.RIGHT_ROUND_CORNER)}isLeftRoundedCorner(e){return this.isRoundCorner(e)&&1<=(e.type&this.LEFT_ROUND_CORNER)}isRightRoundedCorner(e){return this.isRoundCorner(e)&&1<=(e.type&this.RIGHT_ROUND_CORNER)}isLeftSquareCorner(e){return 1<=(e.type&this.LEFT_SQUARE_CORNER)}isRightSquareCorner(e){return 1<=(e.type&this.RIGHT_SQUARE_CORNER)}isCorner(e){return 1<=(e.type&this.CORNER)}isJaggedEdge(e){return 1<=(e.type&this.JAGGED_EDGE)}isRow(e){return 1<=(e.type&this.ROW)}isBetweenRowSpacer(e){return 1<=(e.type&this.BETWEEN_ROW_SPACER)}isTopRow(e){return 1<=(e.type&this.TOP_ROW)}isBottomRow(e){return 1<=(e.type&this.BOTTOM_ROW)}isTopOrBottomRow(e){return this.isTopRow(e)||this.isBottomRow(e)}isInputRow(e){return 1<=(e.type&this.INPUT_ROW)}},h1=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=h0.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},h2=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=h0.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;0<=e;e--){let t=this.elements[e];if(h0.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){let t=this.elements[e];if(h0.isInRowSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;0<=e;e--){let t=this.elements[e];if(h0.isInRowSpacer(t))return t}return null}},h3=class extends h2{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=h0.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,i=0;for(let s=0;s<this.elements.length;s++){let o=this.elements[s];t+=o.width,h0.isSpacer(o)||(h0.isNextConnection(o)?i=Math.max(i,o.height):e=Math.max(e,o.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+i,this.descenderHeight=i,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},h5=class extends h1{constructor(e,t){super(e),this.connectionModel=t,this.type|=h0.CONNECTION,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=t.isHighlighted()}},h6=class extends h5{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=h0.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},h4=class extends h6{constructor(e,t){super(e,t),this.height=0,this.type|=h0.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},h8=class extends h1{constructor(e,t,i){super(e),this.field=t,this.parentInput=i,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=h0.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},h9=class extends h1{constructor(e){super(e),this.type|=h0.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},h7=class extends h1{constructor(e,t){super(e),this.icon=t,this.flipRtl=!1,this.type|=h0.ICON,e=t.getSize(),this.height=e.height,this.width=e.width}},ue=class extends h1{constructor(e,t){super(e),this.type=this.type|h0.SPACER|h0.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},ut=class extends h6{constructor(e,t){super(e,t),this.type|=h0.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},ui=class extends h2{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=h0.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){let i=this.elements[t];this.width+=i.width,h0.isInput(i)&&(h0.isStatementInput(i)?e+=i.connectedBlockWidth:h0.isExternalInput(i)&&0!==i.connectedBlockWidth&&(e+=i.connectedBlockWidth-i.connectionWidth)),h0.isSpacer(i)||(this.height=Math.max(this.height,i.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},us=class extends h1{constructor(e){super(e),this.type|=h0.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},uo=class extends h5{constructor(e,t){super(e,t),this.type|=h0.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},un=class extends h5{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=h0.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},ur=class extends h5{constructor(e,t){super(e,t),this.type|=h0.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},ul=class extends h1{constructor(e,t){super(e),this.type=(t&&"left"!==t?h0.RIGHT_ROUND_CORNER:h0.LEFT_ROUND_CORNER)|h0.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},ua=class extends h2{constructor(e,t,i){super(e),this.height=t,this.width=i,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type=this.type|h0.SPACER|h0.BETWEEN_ROW_SPACER,this.elements=[new ue(this.constants_,i)]}measure(){}},uc=class extends h1{constructor(e,t){super(e),this.type=(t&&"left"!==t?h0.RIGHT_SQUARE_CORNER:h0.LEFT_SQUARE_CORNER)|h0.CORNER,this.width=this.height=this.constants_.NO_PADDING}},uh=class extends h6{constructor(e,t){super(e,t),this.type|=h0.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},uu=class extends h2{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=h0.TOP_ROW}hasLeftSquareCorner(e){let t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,i=e.getPreviousBlock();return!!e.outputConnection||t||!!i&&i.getNextBlock()===e}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,i=0;for(let s=0;s<this.elements.length;s++){let o=this.elements[s];t+=o.width,h0.isSpacer(o)||(h0.isHat(o)?i=Math.max(i,o.ascenderHeight):e=Math.max(e,o.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+i,this.capline=this.ascenderHeight=i,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},ud=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=oV(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);let t=e.blockStyles;for(let e in t)this.blockStyles[e]=this.validatedBlockStyle_(t[e]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=void 0!==e.startHats?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=e7("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){let t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.startsWith("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){let t={};return e&&Object.assign(t,e),e=sz(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?sz(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?sz(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return sW("#fff",e,.6)||e}generateTertiaryColour_(e){return sW("#fff",e,.3)||e}dispose(){this.embossFilter&&e2(this.embossFilter),this.disabledPattern&&e2(this.disabledPattern),this.debugFilter&&e2(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){let e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH,i=oX([oU(t,e/4),oU(-(2*t),e/2),oU(t,e/4)]);return{height:e,width:t,path:i}}makeStartHat(){let e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,i=oH("c",[oU(30,-e),oU(70,-e),oU(t,0)]);return{height:.75*e,width:t,path:i}}makePuzzleTab(){function e(e){let s=-(e=e?-1:1);var o=i/2;let n=o+2.5,r=o+.5,l=oU(-t,e*o);return o=oU(t,e*o),oH("c",[oU(0,e*n),oU(-t,s*r),l])+oH("s",[oU(t,2.5*s),o])}let t=this.TAB_WIDTH,i=this.TAB_HEIGHT,s=e(!0),o=e(!1);return{type:this.SHAPES.PUZZLE,width:t,height:i,pathDown:o,pathUp:s}}makeNotch(){function e(e){return oX([oU(e*s,i),oU(3*e,0),oU(e*s,-i)])}let t=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,s=(t-3)/2,o=e(1),n=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:i,pathLeft:o,pathRight:n}}makeInsideCorners(){let e=this.CORNER_RADIUS,t=oz("a","0 0,0",e,oU(-e,e)),i=oz("a","0 0,0",e,oU(e,e));return{width:e,height:e,pathTop:t,pathBottom:i}}makeOutsideCorners(){let e=this.CORNER_RADIUS,t=oV(0,e)+oz("a","0 0,1",e,oU(e,-e)),i=oz("a","0 0,1",e,oU(e,e)),s=oz("a","0 0,1",e,oU(-e,-e));return{topLeft:t,topRight:i,bottomRight:oz("a","0 0,1",e,oU(-e,e)),bottomLeft:s,rightHeight:e}}shapeFor(e){switch(e.type){case cX.INPUT_VALUE:case cX.OUTPUT_VALUE:return this.PUZZLE_TAB;case cX.PREVIOUS_STATEMENT:case cX.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,i,s){this.injectCSS_(t,i),this.defs=eZ(r8.DEFS,{},e),e=eZ(r8.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),eZ(r8.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=eZ(r8.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),eZ(r8.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),eZ(r8.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),eZ(r8.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=eZ(r8.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),eZ(r8.RECT,{width:10,height:10,fill:"#aaa"},e),eZ(r8.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter(),s&&(s.style.setProperty("--blocklyEmbossFilter",`url(#${this.embossFilterId})`),s.style.setProperty("--blocklyDisabledPattern",`url(#${this.disabledPatternId})`),s.style.setProperty("--blocklyDebugFilter",`url(#${this.debugFilterId})`))}createDebugFilter(){if(!this.debugFilter){let e=eZ(r8.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),t=eZ(r8.FECOMPONENTTRANSFER,{result:"outBlur"},e);eZ(r8.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),eZ(r8.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),eZ(r8.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);let i=t.join("\n");this.cssNode?this.cssNode.firstChild.textContent=i:((t=document.createElement("style")).id=e,e=document.createTextNode(i),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode=t)}getCSS_(e){return[`${e} .blocklyText, `,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>rect,`,`${e} .blocklyEditableField>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${e} .blocklyNonEditableField>text,`,`${e} .blocklyEditableField>text {`,"fill: #000;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${e} .blocklyEditableField:not(.blocklyEditing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${e} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${e} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${e} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${e} .blocklyReplaceable .blocklyPathLight,`,`${e} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},uE={};uE.ConstantProvider=ud,uE.isDynamicShape=nS,uE.isNotch=nf,uE.isPuzzleTab=nC;var u_=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren,this.block_.childlessWidth=this.info_.width}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){let t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){let e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=oV(e.xPos,this.info_.startY);for(let e=0,i;i=t[e];e++)h0.isLeftRoundedCorner(i)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:h0.isRightRoundedCorner(i)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:h0.isPreviousConnection(i)?this.outlinePath_+=i.shape.pathLeft:h0.isHat(i)?this.outlinePath_+=this.constants_.START_HAT.path:h0.isSpacer(i)&&(this.outlinePath_+=oY("h",i.width));this.outlinePath_+=oY("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+oY("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){let t=e.getLastInput();this.positionExternalValueConnection_(e);let i=nS(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=oY("H",t.xPos+t.width)+i+oY("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var i=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+oY("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var s=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=oY("H",i)+t+oY("v",s)+this.constants_.INSIDE_CORNERS.pathBottom+oY("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=oY("V",e.yPos+e.height)}drawBottom_(){let e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let i=0,s="";for(let o=t.length-1,n;n=t[o];o--)h0.isNextConnection(n)?s+=n.shape.pathRight:h0.isLeftSquareCorner(n)?s+=oY("H",e.xPos):h0.isLeftRoundedCorner(n)?s+=this.constants_.OUTSIDE_CORNERS.bottomLeft:h0.isRightRoundedCorner(n)?(s+=this.constants_.OUTSIDE_CORNERS.bottomRight,i=this.constants_.OUTSIDE_CORNERS.rightHeight):h0.isSpacer(n)&&(s+=oY("h",-1*n.width));this.outlinePath_+=oY("V",e.baseline-i),this.outlinePath_+=s}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){let t=e.connectionOffsetY+e.height;e=nS(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=oY("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let e=0,t;t=this.info_.rows[e];e++)for(let e=0,i;i=t.elements[e];e++)h0.isInlineInput(i)?this.drawInlineInput_(i):(h0.isIcon(i)||h0.isField(i))&&this.layoutField_(i)}layoutField_(e){let t=e.centerline-e.height/2,i=e.xPos;var s="";this.info_.RTL&&(i=-(i+e.width),e.flipRtl&&(i+=e.width,s="scale(-1 1)")),h0.isIcon(e)?((s=e.icon).setOffsetInBlock(new r4(i,t)),this.info_.isInsertionMarker&&s.hideForInsertionMarker()):((e=e.field.getSvgRoot()).setAttribute("transform","translate("+i+","+t+")"+s),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){let t=e.width,i=e.height,s=e.connectionOffsetY,o=e.connectionHeight+s;this.inlinePath_+=oW(e.xPos+e.connectionWidth,e.centerline-i/2)+oY("v",s)+e.shape.pathDown+oY("v",i-o)+oY("h",t-e.connectionWidth)+oY("v",-i)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){let t=e.centerline-e.height/2;if(e.connectionModel){let i=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,t+e.connectionOffsetY)}}positionStatementInputConnection_(e){let t=e.getLastInput();if(null==t?0:t.connectionModel){let i=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e.yPos)}}positionExternalValueConnection_(e){let t=e.getLastInput();if(t&&t.connectionModel){let i=e.xPos+e.width;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e.yPos)}}positionPreviousConnection_(){let e=this.info_.topRow;if(e.connection){let t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){let e=this.info_.bottomRow;if(e.connection){let t=e.connection,i=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-i:i,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){let e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}updateConnectionHighlights(){for(let e of this.info_.rows)for(let t of e.elements){if(!(t instanceof h5))continue;let e=this.drawConnectionHighlightPath(t);e&&(e.style.display=t.highlighted?"":"none")}}drawConnectionHighlightPath(e){let t,i,s=e.connectionModel;e=s.type===cX.INPUT_VALUE||s.type===cX.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(e):this.getStatementConnectionHighlightPath(e);let o=s.getSourceBlock();return null==(i=(t=o.pathObject).addConnectionHighlight)?void 0:i.call(t,s,e,s.getOffsetInBlock(),o.RTL)}getExpressionConnectionHighlightPath(e){let t="";return nS(e.shape)?t=e.shape.pathDown(e.height):nC(e.shape)&&(t=e.shape.pathDown),oV(0,-(e=this.constants_.TAB_OFFSET_FROM_TOP))+oY("v",e)+t+oY("v",e)}getStatementConnectionHighlightPath(e){if(!nf(e.shape))throw Error("Statement connections should have notch shapes");let t=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS;return oV(-t,0)+oY("h",t)+e.shape.pathLeft+oY("h",t)}},uT=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new un(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new uu(this.constants_),this.bottomRow=new h3(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new ui(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let i=0,s;s=t[i];i++){let t=new h7(this.constants_,s);this.isCollapsed&&!s.isShownWhenCollapsed()||e.elements.push(t)}t=void 0;for(let i=0,s;s=this.block_.inputList[i];i++)if(s.isVisible()){this.shouldStartNewRow_(s,t)&&(this.rows.push(e),e=new ui(this.constants_),this.inputRows.push(e));for(let t=0,i;i=s.fieldRow[t];t++)e.elements.push(new h8(this.constants_,i,s));this.addInput_(s,e),t=s}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new us(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;let t=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e,i=this.topRow.hasLeftSquareCorner(this.block_)?uc:ul;this.topRow.elements.push(new i(this.constants_)),t?(e=new h9(this.constants_),this.topRow.elements.push(e)):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new ur(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof ha&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,i=this.topRow.hasRightSquareCorner(this.block_)?uc:ul,this.topRow.elements.push(new i(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof ha?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new uc(this.constants_)):this.bottomRow.elements.push(new ul(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new uo(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new uc(this.constants_,"right")):this.bottomRow.elements.push(new ul(this.constants_,"right"))}addInput_(e,t){this.isInline&&e instanceof N.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new ut(this.constants_,e)),t.hasInlineInput=!0):e instanceof ha?(t.elements.push(new uh(this.constants_,e)),t.hasStatement=!0):e instanceof N.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new h4(this.constants_,e)),t.hasExternalInput=!0):(e instanceof hr||e instanceof hl)&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),null===t.align&&(t.align=e.align)}shouldStartNewRow_(e,t){return!!t&&(t instanceof hl||e instanceof ha||t instanceof ha||(e instanceof N.ValueInput$$module$build$src$core$inputs$value_input||e instanceof hr||t instanceof N.ValueInput$$module$build$src$core$inputs$value_input)&&!this.isInline)}addElemSpacing_(){for(let e=0,t;t=this.rows[e];e++){let e=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new ue(this.constants_,this.getInRowSpacing_(null,e[0]))),e.length){for(let i=0;i<e.length-1;i++){t.elements.push(e[i]);let s=this.getInRowSpacing_(e[i],e[i+1]);t.elements.push(new ue(this.constants_,s))}t.elements.push(e[e.length-1]),t.endsWithElemSpacer()&&t.elements.push(new ue(this.constants_,this.getInRowSpacing_(e[e.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&h0.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&h0.isInput(e)&&!t){if(h0.isExternalInput(e))return this.constants_.NO_PADDING;if(h0.isInlineInput(e))return this.constants_.LARGE_PADDING;if(h0.isStatementInput(e))return this.constants_.NO_PADDING}return e&&h0.isLeftSquareCorner(e)&&t&&(h0.isPreviousConnection(t)||h0.isNextConnection(t))?t.notchOffset:e&&h0.isLeftRoundedCorner(e)&&t&&(h0.isPreviousConnection(t)||h0.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&h0.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,i=0;for(let o=0,n;n=this.rows[o];o++){if(n.measure(),t=Math.max(t,n.width),n.hasStatement){let t,i;var s=n.getLastInput();e=Math.max(e,s=n.width-(null!=(i=null==(t=s)?void 0:t.width)?i:0))}i=Math.max(i,n.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let e=0,t;t=this.rows[e];e++)t.hasStatement&&(t.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,i),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let t=0,i;i=this.rows[t];t++)if(i.hasStatement)this.alignStatementRow_(i);else{var e=i.width;0<(e=this.getDesiredRowWidth_(i)-e)&&this.addAlignmentPadding_(i,e),h0.isTopOrBottomRow(i)&&(i.widthWithConnectedBlocks=i.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){let i=e.getFirstSpacer(),s=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===N.Align$$module$build$src$core$inputs$align.LEFT&&s)s.width+=t;else if(e.align===N.Align$$module$build$src$core$inputs$align.CENTRE&&i&&s)i.width+=t/2,s.width+=t/2;else if(e.align===N.Align$$module$build$src$core$inputs$align.RIGHT&&i)i.width+=t;else{if(!s)return;s.width+=t}e.width+=t}alignStatementRow_(e){let t=e.getLastInput();if(t){var i=e.width-t.width,s=this.statementEdge;0<(i=s-i)&&this.addAlignmentPadding_(e,i),i=e.width,s=this.getDesiredRowWidth_(e),t.width+=s-i,t.height=Math.max(t.height,e.height),e.width+=s-i,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){let e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var i=this.getSpacerRowHeight_(e,t);let s=this.getSpacerRowWidth_(e,t);return i=new ua(this.constants_,i,s),e.hasStatement&&(i.followsStatement=!0),t.hasStatement&&(i.precedesStatement=!0),i}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return h0.isSpacer(t)?e.yPos+t.height/2:h0.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,h0.isNextConnection(t)?e+t.height/2:e-t.height/2):h0.isTopRow(e)?h0.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let i=0,s;s=e.elements[i];i++)h0.isSpacer(s)&&(s.height=e.height),s.xPos=t,s.centerline=this.getElemCenterline_(e,s),t+=s.width}finalize_(){let e=0,t=0;for(let i=0,s;s=this.rows[i];i++)s.yPos=t,s.xPos=this.startX,t+=s.height,e=Math.max(e,s.widthWithConnectedBlocks),this.recordElemPositions_(s);if(this.outputConnection&&this.block_.nextConnection){let t=this.block_.nextConnection.targetBlock();t&&(e=Math.max(e,t.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}getMeasureableForConnection(e){let t;if((null==(t=this.outputConnection)?void 0:t.connectionModel)===e)return this.outputConnection;for(let t of this.rows)for(let i of t.elements)if(i instanceof h5&&i.connectionModel===e)return i;return null}},up=class{constructor(e,t,i){this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=i,this.style=t,this.svgRoot=e,this.svgPath=eZ(r8.PATH,{class:"blocklyPath"},this.svgRoot),this.setClass_("blocklyBlock",!0)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?eq(this.svgRoot,e):e0(this.svgRoot,e))}updateHighlighted(e){e?this.setClass_("blocklyHighlighted",!0):this.setClass_("blocklyHighlighted",!1)}updateShadow_(e){e?(this.setClass_("blocklyShadow",!0),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)):this.setClass_("blocklyShadow",!1)}updateDisabled_(e){this.setClass_("blocklyDisabled",e),this.setClass_("blocklyDisabledPattern",e)}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}addConnectionHighlight(e,t,i,s){return(i=`translate(${i.x}, ${i.y})`+(s?" scale(-1 1)":""),s=this.connectionHighlights.get(e))?(s.setAttribute("d",t),s.setAttribute("transform",i),s):(t=eZ(r8.PATH,{id:e.id,class:"blocklyHighlightedConnectionPath",style:"display: none;",d:t,transform:i},this.svgRoot),this.connectionHighlights.set(e,t),t)}removeConnectionHighlight(e){let t=this.connectionHighlights.get(e);t&&(e2(t),this.connectionHighlights.delete(e))}},ug=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t,i){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName(),i)}refreshDom(e,t,i){let s=this.getConstants();s.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=s.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t,i)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new ud}makeRenderInfo_(e){return new uT(this,e)}makeDrawer_(e,t){return new u_(e,t)}makePathObject(e,t){return new up(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,t,i){return!!c6.getConnectionForOrphanedConnection(e,i===cX.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}render(e){let t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},uI={};uI.BottomRow=h3,uI.Connection=h5,uI.ConstantProvider=ud,uI.Drawer=u_,uI.ExternalValueInput=h4,uI.Field=h8,uI.Hat=h9,uI.Icon=h7,uI.InRowSpacer=ue,uI.InlineInput=ut,uI.InputConnection=h6,uI.InputRow=ui,uI.JaggedEdge=us,uI.Measurable=h1,uI.NextConnection=uo,uI.OutputConnection=un,uI.PathObject=up,uI.PreviousConnection=ur,uI.RenderInfo=uT,uI.Renderer=ug,uI.RoundCorner=ul,uI.Row=h2,uI.SpacerRow=ua,uI.SquareCorner=uc,uI.StatementInput=uh,uI.TopRow=uu,uI.Types=h0,uI.init=nN,uI.register=nL,uI.unregister=function(e){eh(M.RENDERER,e)};var uR=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&e0(e,t),(t=this.theme.getClassName())&&eq(e,t));for(let e=0,t;t=this.subscribedWorkspaces[e];e++)t.refreshTheme();for(let[i,s]of this.componentDB)for(let o of s){e=o.element,t=o.propertyName;let s=this.theme&&this.theme.getComponentStyle(i);e.style.setProperty(t,s||"")}for(let e of this.subscribedWorkspaces)e.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces.push(e)}unsubscribeWorkspace(e){if(!tI(this.subscribedWorkspaces,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,i){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:i}),t=this.theme&&this.theme.getComponentStyle(t),e.style.setProperty(i,t||"")}unsubscribe(e){if(e)for(let[t,i]of this.componentDB){for(let t=i.length-1;0<=t;t--)i[t].element===e&&i.splice(t,1);i.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces.length=0,this.componentDB.clear()}},um="VARIABLE_DYNAMIC",uO={CATEGORY_NAME:um};uO.flyoutCategory=nP,uO.flyoutCategoryBlocks=nk,uO.internalFlyoutCategory=nM,uO.onCreateVariableButtonClick_Colour=nD,uO.onCreateVariableButtonClick_Number=n$,uO.onCreateVariableButtonClick_String=nb;var uA=class{canConnect(e,t,i,s){return this.canConnectWithReason(e,t,i,s)===c6.CAN_CONNECT}canConnectWithReason(e,t,i,s){let o=this.doSafetyChecks(e,t);return o!==c6.CAN_CONNECT?o:this.doTypeChecks(e,t)?i&&!this.doDragChecks(e,t,s||0)?c6.REASON_DRAG_CHECKS_FAILED:c6.CAN_CONNECT:c6.REASON_CHECKS_FAILED}getErrorMessage(e,t,i){switch(e){case c6.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case c6.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case c6.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case c6.REASON_TARGET_NULL:return"Target connection is null.";case c6.REASON_CHECKS_FAILED:return"Connection checks failed. "+(t+" expected "+t.getCheck())+", found "+i.getCheck();case c6.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case c6.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case c6.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){let i,s,o;return e&&t?(e.isSuperior()?(i=e.getSourceBlock(),s=t.getSourceBlock(),o=t):(s=e.getSourceBlock(),i=t.getSourceBlock(),o=e,e=t),i===s?c6.REASON_SELF_CONNECTION:o.type!==c7[e.type]?c6.REASON_WRONG_TYPE:i.workspace!==s.workspace?c6.REASON_DIFFERENT_WORKSPACES:i.isShadow()&&!s.isShadow()?c6.REASON_SHADOW_PARENT:o.type===cX.OUTPUT_VALUE&&s.previousConnection&&s.previousConnection.isConnected()||o.type===cX.PREVIOUS_STATEMENT&&s.outputConnection&&s.outputConnection.isConnected()?c6.REASON_PREVIOUS_AND_OUTPUT:c6.CAN_CONNECT):c6.REASON_TARGET_NULL}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return!0;for(let i=0;i<e.length;i++)if(t.includes(e[i]))return!0;return!1}doDragChecks(e,t,i){if(e.distanceFrom(t)>i||t.getSourceBlock().isInsertionMarker())return!1;switch(t.type){case cX.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case cX.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case cX.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;case cX.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection||t.targetBlock()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;default:return!1}return!rV.includes(t)}canConnectToPrevious_(e,t){return!(e.targetConnection||rV.includes(t))&&(!t.targetConnection||!!(e=t.targetBlock()).isInsertionMarker()&&!e.getPreviousBlock())}};ea(M.CONNECTION_CHECKER,D,uA);var uS=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new hQ,this.readOnly=!1,this.potentialVariableMap=null,this.id=eM(),tn(this),this.options=e||new cJ({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(ep(M.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new(this.getVariableMapClass())(this),this.setIsReadOnly(this.options.readOnly)}dispose(){this.listeners.length=0,this.clear(),tr(this)}sortObjects(e,t){let i=Math.sin(i2(uS.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getRelativeToSurfaceXY(),t=t.getRelativeToSurfaceXY(),e.y+i*e.x-(t.y+i*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!tI(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e=!1){let t=[].concat(this.topBlocks);return e&&1<t.length&&t.sort(this.sortObjects.bind(this)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){tI(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t=!1){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&1<e.length&&e.sort(this.sortObjects.bind(this)),e.filter(e=>!e.isInsertionMarker())):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!tI(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e=!1){let t=[].concat(this.topComments);return e&&1<t.length&&t.sort(this.sortObjects.bind(this)),t}getAllBlocks(e=!1){if(e){var t=this.getTopBlocks(!0);e=[];for(let i=0;i<t.length;i++)e.push(...t[i].getDescendants(!0))}else for(e=this.getTopBlocks(!1),t=0;t<e.length;t++)e.push(...e[t].getChildren(!1));return e.filter(e=>!e.isInsertionMarker())}clear(){this.isClearing=!0;try{let e=N.getGroup$$module$build$src$core$events$utils();for(e||N.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();N.setGroup$$module$build$src$core$events$utils(e),this.isFlyout||this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,t){ih("Blockly.Workspace.renameVariableById","v12","v13","Blockly.Workspace.getVariableMap().renameVariable"),(e=this.variableMap.getVariableById(e))&&this.variableMap.renameVariable(e,t)}createVariable(e,t,i){return ih("Blockly.Workspace.createVariable","v12","v13","Blockly.Workspace.getVariableMap().createVariable"),this.variableMap.createVariable(e,null!=t?t:void 0,null!=i?i:void 0)}getVariableUsesById(e){return ih("Blockly.Workspace.getVariableUsesById","v12","v13","Blockly.Workspace.getVariableMap().getVariableUsesById"),iM(this,e)}deleteVariableById(e){ih("Blockly.Workspace.deleteVariableById","v12","v13","Blockly.Workspace.getVariableMap().deleteVariable");let t=this.variableMap.getVariableById(e);t?N.deleteVariable$$module$build$src$core$variables(this,t):console.warn(`Can't delete non-existent variable: ${e}`)}getVariable(e,t){return ih("Blockly.Workspace.getVariable","v12","v13","Blockly.Workspace.getVariableMap().getVariable"),this.variableMap.getVariable(e,t)}getVariableById(e){return ih("Blockly.Workspace.getVariableById","v12","v13","Blockly.Workspace.getVariableMap().getVariableById"),this.variableMap.getVariableById(e)}getVariablesOfType(e){return ih("Blockly.Workspace.getVariablesOfType","v12","v13","Blockly.Workspace.getVariableMap().getVariablesOfType"),this.variableMap.getVariablesOfType(null!=e?e:"")}getAllVariables(){return ih("Blockly.Workspace.getAllVariables","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables()}getAllVariableNames(){return ih("Blockly.Workspace.getAllVariableNames","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables().map(e=>e.getName())}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(void 0!==this.options.maxInstances[e]?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let t=0;for(let i in e){if(e[i]>this.remainingCapacityOfType(i))return!1;t+=e[i]}return!(t>this.remainingCapacity())}hasBlockLimits(){return 1/0!==this.options.maxBlocks||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,i=e?this.undoStack_:this.redoStack_;let s=t.pop();if(s){for(var o=[s];t.length&&s.group&&s.group===t[t.length-1].group;){let e=t.pop();e&&o.push(e)}for(t=0;t<o.length;t++)i.push(o[t]);N.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(i=0;i<o.length;i++)o[i].run(e)}finally{N.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,eK()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){tI(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return null!=(t=this.commentDB.get(e))?t:null}allInputsFilled(e){let t=this.getTopBlocks(!1);for(let i=0;i<t.length;i++)if(!t[i].allInputsFilled(e))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new(this.getVariableMapClass())(this,!0)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null,t=this.options.parentWorkspace;return this.isFlyout?t&&t.options&&(e=t.options.parentWorkspace):t&&(e=t),e}static getById(e){return ts(e)}static getAll(){return to()}getVariableMapClass(){let e=ep(M.VARIABLE_MAP,this.options,!0);if(!e)throw Error("No variable map is registered.");return e}isReadOnly(){return this.readOnly}setIsReadOnly(e){this.readOnly=e,this.options.readOnly=e}};uS.SCAN_ANGLE=3;var uC=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound=null,this.muted=!1}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var i=new globalThis.Audio}catch(e){return}for(let t=0;t<e.length;t++){let o=e[t],n=o.match(/\.(\w+)$/);if(n&&i.canPlayType("audio/"+n[1])){var s=new globalThis.Audio(o);break}}s&&this.sounds.set(t,s)}}preload(){for(let e of this.sounds.values()){e.volume=.01;let t=e.play();if(void 0!==t?t.then(e.pause).catch(function(){}):e.pause(),rm||rO)break}}play(e,t){if(!this.muted){var i=this.sounds.get(e);i?(e=new Date,null!==this.lastSound&&e.getTime()-this.lastSound.getTime()<100||(this.lastSound=e,(i=rm||rR?i:i.cloneNode()).volume=void 0===t?1:t,i.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}}setMuted(e){this.muted=e}getMuted(){return this.muted}},uf=class extends uS{constructor(e){let t;super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.visible=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardMoveInProgress=this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.navigator=new hv,this.metricsManager=new(ep(M.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||uf.setTopLevelWorkspaceMetrics,this.componentManager=new r0,this.connectionDBList=cB.init(this.connectionChecker),this.audioManager=new uC(e.parentWorkspace),this.grid=this.options.gridPattern?new hX(this.options.gridPattern,e.gridOptions):null,this.markerManager=new hz(this),aa&&iu&&this.registerToolboxCategoryCallback(an,iu),uO&&nM&&this.registerToolboxCategoryCallback(um,nM),dP&&np&&(this.registerToolboxCategoryCallback(dM,np),this.addChangeListener(nR)),this.addChangeListener(this.variableChangeCallback.bind(this)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new uR(this,this.options.theme||cj),this.themeManager_.subscribeWorkspace(this),this.renderer=nN(this.options.renderer||"geras",this.getTheme(),null!=(t=this.options.rendererOverrides)?t:void 0),this.cachedParentSvgSize=new r7(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}getMarker(e){return this.markerManager?this.markerManager.getMarker(e):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=cj),this.themeManager_.setTheme(e)}refreshTheme(){if(this.svgGroup_){var e=null===this.options.parentWorkspace;this.renderer.refreshDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0)}this.updateBlockStyles(this.getAllBlocks(!1).filter(e=>!!e.getStyleName())),this.refreshToolboxSelection(),this.toolbox&&this.toolbox.refreshTheme(),this.isVisible()&&this.setVisible(!0),eU(e=new(ej(rC.THEME_CHANGE))(this.getTheme().name,this.id))}updateBlockStyles(e){for(let t=0,i;i=e[t];t++){let e=i.getStyleName();e&&i.setStyle(e)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){let e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.visible}getSvgXY(e){let t=0,i=0,s=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(s=this.scale);do{let o=t$(e);(e===this.getCanvas()||e===this.getBubbleCanvas())&&(s=1),t+=o.x*s,i+=o.y*s,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv())return new r4(t,i)}getCachedParentSvgSize(){let e=this.cachedParentSvgSize;return new r7(e.width,e.height)}getOriginOffsetInPixels(){return tD(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,t){return this.injectionDiv||(this.injectionDiv=null!=t?t:null),this.svgGroup_=eZ(r8.G,{class:"blocklyWorkspace",id:this.id}),t&&t2(this.svgGroup_,aL.LABEL,N.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),e&&(this.svgBackground_=eZ(r8.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"===e&&this.grid?this.svgBackground_.style.fill="var(--blocklyGridPattern)":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new hY(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(eS(this.svgGroup_,"pointerdown",this,this.onMouseDown,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),eS(this.svgGroup_,"wheel",this,this.onMouseWheel)),this.options.hasCategories&&(this.toolbox=new(ep(M.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=ep(M.CURSOR,this.options))&&this.markerManager.setCursor(new e(this)),e=null===this.options.parentWorkspace,this.renderer.createDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0),N.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!!this.injectionDiv||this.isFlyout),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&e2(this.svgGroup_),this.toolbox&&(this.toolbox.dispose(),this.toolbox=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){let e=this.getParentSvg();e&&e.parentNode&&e2(e.parentNode)}this.resizeHandlerWrapper&&(ef(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null),N.getFocusManager$$module$build$src$core$focus_manager().isRegistered(this)&&N.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}addTrashcan(){this.trashcan=uf.newTrashcan(this);let e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new lS(this);let e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}copyOptionsForFlyout(){return new cJ({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,plugins:this.options.plugins,modalInputs:this.options.modalInputs,move:{scrollbars:!0}})}addFlyout(e){let t=this.copyOptionsForFlyout();return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(ep(M.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(t):new(ep(M.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(t),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox?this.toolbox.getFlyout():null}getToolbox(){return this.toolbox}updateScreenCalculations(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox?this.toolbox.position():this.flyout&&this.flyout.position();let e=this.componentManager.getComponents(r0.Capability.POSITIONABLE,!0),t=this.getMetricsManager().getUiMetrics(),i=[];for(let s=0,o;o=e[s];s++){o.position(t,i);let e=o.getBoundingRectangle();e&&i.push(e)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations()}updateScreenCalculationsIfScrolled(){let e=tP();r4.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,t){let i=this.getParentSvg();null!=e&&(this.cachedParentSvgSize.width=e,i.setAttribute("data-cached-width",`${e}`)),null!=t&&(this.cachedParentSvgSize.height=t,i.setAttribute("data-cached-height",`${t}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if("svg"===e.tagName){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(eX()){var e=this.scale,t=-this.scrollY,i=-this.scrollX;if(!(e===this.oldScale&&1>Math.abs(t-this.oldTop)&&1>Math.abs(i-this.oldLeft))){var s=new(ej(rC.VIEWPORT_CHANGE))(t,i,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=i,eU(s)}}}translate(e,t){let i,s;null==(i=this.layerManager)||i.translateLayers(new r4(e,t),this.scale),null==(s=this.grid)||s.moveTo(e,t),this.maybeFireViewportChangeEvent()}getWidth(){let e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.visible=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox&&this.toolbox.setVisible(e),e||this.hideChaff(!0))}render(){let e=this.getAllBlocks(!1);for(let t=e.length-1;0<=t;t--)e[t].queueRender();this.getTopBlocks().flatMap(e=>e.getDescendants(!1)).filter(e=>e.isInsertionMarker()).forEach(e=>e.queueRender())}highlightBlock(e,t){if(void 0===t){for(let e=0,t;t=this.highlightedBlocks[e];e++)t.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=void 0===t||t)?this.highlightedBlocks.includes(e)||this.highlightedBlocks.push(e):tI(this.highlightedBlocks,e),e.setHighlighted(t))}variableChangeCallback(e){switch(e.type){case rC.VAR_CREATE:case rC.VAR_DELETE:case rC.VAR_RENAME:case rC.VAR_TYPE_CHANGE:this.refreshToolboxSelection()}}refreshToolboxSelection(){let e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox&&e.toolbox.getFlyout()&&e.toolbox.refreshSelection()}recordDragTargets(){let e=this.componentManager.getComponents(r0.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let t=0,i;i=e[t];t++){let e=i.getClientRect();e&&this.dragTargetAreas.push({component:i,clientRect:e})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let t=0,i;i=this.dragTargetAreas[t];t++)if(i.clientRect.contains(e.clientX,e.clientY))return i.component;return null}onMouseDown(e){let t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){or(this,e,t)}moveDrag(e){return ol(this,e)}setKeyboardMoveInProgress(e){this.keyboardMoveInProgress=e}isDragging(){return this.keyboardMoveInProgress||null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){let e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){let e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel(e){if(hK.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,i=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||i){var s=e$(e);if(V)var o=e.metaKey;t&&(e.ctrlKey||o||!i)?(s=-s.y/50,t=eb(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,s)):(t=this.scrollX-s.x,i=this.scrollY-s.y,e.shiftKey&&!s.x&&(t=this.scrollX-s.y,i=this.scrollY),this.scroll(t,i)),e.preventDefault()}}}getBlocksBoundingBox(){let e=this.getTopBoundedElements();if(!e.length)return new r9(0,0,0,0);let t=e[0].getBoundingRectangle();for(let s=1;s<e.length;s++){var i=e[s];i.isInsertionMarker&&i.isInsertionMarker()||((i=i.getBoundingRectangle()).top<t.top&&(t.top=i.top),i.bottom>t.bottom&&(t.bottom=i.bottom),i.left<t.left&&(t.left=i.left),i.right>t.right&&(t.right=i.right))}return t}cleanUp(){this.setResizesEnabled(!1),N.setGroup$$module$build$src$core$events$utils(!0);var e=this.getTopBlocks(!0),t=e.filter(e=>e.isMovable());let i=e.filter(e=>!e.isMovable()).map(e=>e.getBoundingRectangle());e=function(e){for(let t of i)if(e.intersects(t))return t;return null};var s=0;let o=this.renderer.getConstants().MIN_BLOCK_HEIGHT;for(let i of t){for(t=i.getBoundingRectangle(),i.moveBy(-t.left,s-t.top,["cleanup"]),i.snapToGrid(),s=e(t=i.getBoundingRectangle());null!=s;)s=s.top+s.getHeight()+o,i.moveBy(0,s-t.top,["cleanup"]),i.snapToGrid(),s=e(t=i.getBoundingRectangle());s=i.getRelativeToSurfaceXY().y+i.getHeightWidth().height+o}N.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(e){if(!this.isReadOnly()&&!this.isFlyout){var t=cS.registry.getContextMenuOptions({workspace:this,focusedNode:this},e);this.configureContextMenu&&this.configureContextMenu(t,e);var i=e instanceof PointerEvent?new r4(e.clientX,e.clientY):tk(this,new r4(5,5));s9(e,t,this.RTL,this,i)}}updateToolbox(e){if(e=tB(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(tx(e)){if(!this.toolbox)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(ta(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,t,i){i=Math.pow(this.options.zoomOptions.scaleSpeed,i);let s=this.scale*i;if(this.scale!==s){s>this.options.zoomOptions.maxScale?i=this.options.zoomOptions.maxScale/this.scale:s<this.options.zoomOptions.minScale&&(i=this.options.zoomOptions.minScale/this.scale);var o=this.getCanvas().getCTM(),n=this.getParentSvg().createSVGPoint();n.x=e,n.y=t,e=(n=n.matrixTransform(o.inverse())).x,t=n.y,o=o.translate(e*(1-i),t*(1-i)).scale(i),this.scrollX=o.e,this.scrollY=o.f,this.setScale(s)}}zoomCenter(e){let t;var i=this.getMetrics();this.flyout?(t=i.svgWidth?i.svgWidth/2:0,i=i.svgHeight?i.svgHeight/2:0):(t=i.viewWidth/2+i.absoluteLeft,i=i.viewHeight/2+i.absoluteTop),this.zoom(t,i,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var i=this.getBlocksBoundingBox(),s=i.right-i.left+40;if(i=i.bottom-i.top+40,s){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),i+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),s+=this.flyout.getWidth()/this.scale)),t/=s,e/=i,N.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{N.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){eq(this.getCanvas(),"blocklyCanvasTransitioning"),eq(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){e0(this.getCanvas(),"blocklyCanvasTransitioning"),e0(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,i=(e.scrollHeight-e.viewHeight)/2;t=-t-e.scrollLeft,i=-i-e.scrollTop,this.scroll(t,i)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,t){if(this.isMovable()){var i=e?this.getBlockById(e):null;if(i){e=i.getRelativeToSurfaceXY(),i=t?{height:i.height,width:i.width}:i.getHeightWidth();var s=this.scale;t=(e.x+(this.RTL?-1:1)*i.width/2)*s,e=(e.y+i.height/2)*s,i=this.getMetrics(),this.scroll(-(t-i.viewWidth/2),-(e-i.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.scale}getAbsoluteScale(){let e=e=>{if(e.isFlyout){let t,i=null==(t=e.targetWorkspace)?void 0:t.getFlyout();if(i instanceof hx)return i.getFlyoutScale()}return e.getScale()},t=(i,s)=>i.options.parentWorkspace&&i.options.parentWorkspace.getSvgGroup().contains(i.getSvgGroup())?t(i.options.parentWorkspace,s*e(i)):s*e(i);return t(this,1)}scroll(e,t){this.hideChaff(!0);let i=this.getMetrics();e=Math.min(e,-i.scrollLeft),t=Math.min(t,-i.scrollTop);let s=i.scrollTop+Math.max(0,i.scrollHeight-i.viewHeight);e=Math.max(e,-(i.scrollLeft+Math.max(0,i.scrollWidth-i.viewWidth))),t=Math.max(t,-s),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+i.scrollLeft),-(t+i.scrollTop),!1),e+=i.absoluteLeft,t+=i.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e=!1){return super.getAllBlocks(e)}getTopBlocks(e=!1){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){tI(this.topBoundedElements,e)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(e){let t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,t){if("function"!=typeof t)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return null!=(t=this.flyoutButtonCallbacks.get(e))?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if("function"!=typeof t)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){let t;if(this.keyboardMoveInProgress)return e.preventDefault(),e.stopPropagation(),null;let i="pointerdown"===e.type;return i&&(null==(t=this.currentGesture_)?0:t.hasStarted())&&(console.warn("Tried to start the same gesture twice."),this.currentGesture_.cancel()),!this.currentGesture_&&i&&(this.currentGesture_=new hK(e,this)),this.currentGesture_}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e=!1){sD(),s1(this),su(),this.hideComponents(e)}hideComponents(e=!1){this.getComponentManager().getComponents(r0.Capability.AUTOHIDEABLE,!0).forEach(t=>t.autoHide(e))}static setTopLevelWorkspaceMetrics(e){let t=this.getMetrics();"number"==typeof e.x&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),"number"==typeof e.y&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}addClass(e){this.injectionDiv&&eq(this.injectionDiv,e)}removeClass(e){this.injectionDiv&&e0(this.injectionDiv,e)}setIsReadOnly(e){super.setIsReadOnly(e),e?this.addClass("blocklyReadOnly"):this.removeClass("blocklyReadOnly")}scrollBoundsIntoView(e,t=10){if(!hK.inProgress()){var i=this.getScale(),s=this.getMetricsManager().getViewMetrics(!0);if(s=new r9(s.top,s.top+s.height,s.left,s.left+s.width),!(e.left>=s.left&&e.top>=s.top&&e.right<=s.right&&e.bottom<=s.bottom)){e=e.clone(),e.top-=t,e.bottom+=t,e.left-=t,e.right+=t;var o=t=0;e.left<s.left?t=this.RTL?Math.min(s.left-e.left,s.right-e.right):s.left-e.left:e.right>s.right&&(t=this.RTL?s.right-e.right:Math.max(s.right-e.right,s.left-e.left)),e.top<s.top?o=s.top-e.top:e.bottom>s.bottom&&(o=Math.max(s.bottom-e.bottom,s.top-e.top)),this.scroll(this.scrollX+t*i,this.scrollY+o*i)}}}getFocusableElement(){return this.svgGroup_}getFocusableTree(){return this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){let t;return e?null:null!=(t=this.getTopBlocks(!0)[0])?t:null}getNestedTrees(){return[]}lookUpFocusableNode(e){var t;let i=null==(t=this.targetWorkspace)?void 0:t.getFlyout();if(this.isFlyout&&i){for(var s of i.getContents())if(te(t=s.getElement())&&t.canBeFocused()&&t.getFocusableElement().id===e)return t}if(s=e.indexOf("_field_"),t=e.indexOf("_connection_"),-1!==s){var o=e.substring(0,s);if(o=this.getBlockById(o)){for(var n of o.getFields())if(n.canBeFocused()&&n.getFocusableElement().id===e)return n}return null}if(-1!==t){if(o=e.substring(0,t),o=this.getBlockById(o)){for(let t of o.getConnections_(!0))if(t.id===e)return t}return null}if(n=this.getAllBlocks(!1).find(t=>t.getFocusableElement().id===e))return n;for(let t of this.getTopComments())if(t instanceof cM&&t.canBeFocused()&&t.getFocusableElement().id===e)return t;for(o of n=this.getAllBlocks().map(e=>e.getIcons()).flat()){if(o.canBeFocused()&&o.getFocusableElement().id===e)return o;if(i1(o)&&(n=o.getBubble())&&n.canBeFocused()&&n.getFocusableElement().id===e)return n}return null}onTreeFocus(e,t){}onTreeBlur(e){if(this.isFlyout&&this.targetWorkspace&&!N.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()){var t=this.targetWorkspace.getFlyout(),i=this.targetWorkspace.getToolbox();i&&e===i||(i&&i.clearSelection(),t&&nl(t)&&t.autoHide(!1))}}getNavigator(){return this.navigator}setNavigator(e){this.navigator=e}},uL={};uL.WorkspaceSvg=uf,uL.resizeSvgContents=function(e){e.resizeContents()};var uN=class extends rz{constructor(e){super(),this.isBlank=void 0===e,e&&(this.varId=e.getId(),this.workspaceId=e.getWorkspace().id)}toJson(){let e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new uN)).varId=e.varId,t}},ub=class extends uN{constructor(e){super(e),this.type=rC.VAR_CREATE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){let e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new ub)).varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?t.createVariable(this.varName,this.varType,this.varId):(e=t.getVariableById(this.varId))&&t.deleteVariable(e)}};ea(M.EVENT,rC.VAR_CREATE,ub);var u$=class{constructor(e,t,i,s){this.workspace=e,this.name=t,this.type=i||"",this.id=s||eM()}getId(){return this.id}getName(){return this.name}setName(e){return this.name=e,this}getType(){return this.type}setType(e){return this.type=e,this}getWorkspace(){return this.workspace}save(){let e={name:this.getName(),id:this.getId()},t=this.getType();return t&&(e.type=t),e}static load(e,t){e=new this(t,e.name,e.type,e.id),t.getVariableMap().addVariable(e),eU(new(ej(rC.VAR_CREATE))(e))}};ea(M.VARIABLE_MODEL,D,u$);var uD=class extends uN{constructor(e){super(e),this.type=rC.VAR_DELETE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){let e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new uD)).varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?(e=t.getVariableById(this.varId))&&t.deleteVariable(e):t.createVariable(this.varName,this.varType,this.varId)}};ea(M.EVENT,rC.VAR_DELETE,uD);var uM=class extends uN{constructor(e,t){super(e),this.type=rC.VAR_RENAME,e&&(this.oldName=e.getName(),this.newName=void 0===t?"":t)}toJson(){let e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new uM)).oldName=e.oldName,t.newName=e.newName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");let i=(t=t.getVariableMap()).getVariableById(this.varId);e?i&&t.renameVariable(i,this.newName):i&&t.renameVariable(i,this.oldName)}};ea(M.EVENT,rC.VAR_RENAME,uM);var uP=class{constructor(e,t=!1){this.workspace=e,this.potentialMap=t,this.variableMap=new Map}clear(){for(let e of this.variableMap.values())for(let t of e.values())this.deleteVariable(t);if(0!==this.variableMap.size)throw Error("Non-empty variable map")}renameVariable(e,t){if(e.getName()===t)return e;var i=e.getType();i=this.getVariable(t,i);let s=this.workspace.getAllBlocks(!1),o="";this.potentialMap||(o=N.getGroup$$module$build$src$core$events$utils())||N.setGroup$$module$build$src$core$events$utils(!0);try{i&&i.getId()!==e.getId()?this.renameVariableWithConflict(e,t,i,s):this.renameVariableAndUses(e,t,s)}finally{this.potentialMap||N.setGroup$$module$build$src$core$events$utils(o)}return e}changeVariableType(e,t){var i;let s;return null==(i=this.variableMap.get(e.getType()))||i.delete(e.getId()),e.setType(t),(i=null!=(s=this.variableMap.get(t))?s:new Map).set(e.getId(),e),this.variableMap.has(t)||this.variableMap.set(t,i),e}renameVariableById(e,t){ih("VariableMap.renameVariableById","v12","v13","VariableMap.renameVariable");let i=this.getVariableById(e);if(!i)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(i,t)}renameVariableAndUses(e,t,i){for(this.potentialMap||eU(new(ej(rC.VAR_RENAME))(e,t)),e.setName(t),t=0;t<i.length;t++)i[t].updateVarName(e)}renameVariableWithConflict(e,t,i,s){let o,n=e.getType(),r=i.getName();for(t!==r&&this.renameVariableAndUses(i,t,s),t=0;t<s.length;t++)s[t].renameVarById(e.getId(),i.getId());this.potentialMap||eU(new(ej(rC.VAR_DELETE))(e)),null==(o=this.variableMap.get(n))||o.delete(e.getId())}createVariable(e,t,i){let s;var o=this.getVariable(e,t);if(o){if(i&&o.getId()!==i)throw Error('Variable "'+e+'" is already in use and its id is "'+o.getId()+'" which conflicts with the passed in id, "'+i+'".');return o}if(i&&this.getVariableById(i))throw Error('Variable id, "'+i+'", is already in use.');if(o=i||eM(),t=t||"",!(i=e_(M.VARIABLE_MODEL,D,!0)))throw Error("No variable model is registered.");return o=new i(this.workspace,e,t,o),(e=null!=(s=this.variableMap.get(t))?s:new Map).set(o.getId(),o),this.variableMap.has(t)||this.variableMap.set(t,e),this.potentialMap||eU(new(ej(rC.VAR_CREATE))(o)),o}addVariable(e){let t,i=e.getType();this.variableMap.has(i)||this.variableMap.set(i,new Map),null==(t=this.variableMap.get(i))||t.set(e.getId(),e)}deleteVariable(e){let t=iM(this.workspace,e.getId()),i="";this.potentialMap||(i=N.getGroup$$module$build$src$core$events$utils())||N.setGroup$$module$build$src$core$events$utils(!0);try{for(let e=0;e<t.length;e++)t[e].dispose(!0);let i=this.variableMap.get(e.getType());i&&i.has(e.getId())&&(i.delete(e.getId()),this.potentialMap||eU(new(ej(rC.VAR_DELETE))(e)),0===i.size&&this.variableMap.delete(e.getType()))}finally{this.potentialMap||N.setGroup$$module$build$src$core$events$utils(i)}}deleteVariableById(e){ih("VariableMap.deleteVariableById","v12","v13","Blockly.Variables.deleteVariable"),(e=this.getVariableById(e))&&N.deleteVariable$$module$build$src$core$variables(this.workspace,e)}getVariable(e,t){let i;return(t=this.variableMap.get(t||""))&&null!=(i=[...t.values()].find(t=>N.Names$$module$build$src$core$names.equals(t.getName(),e)))?i:null}getVariableById(e){for(let t of this.variableMap.values())if(t.has(e)){let i;return null!=(i=t.get(e))?i:null}return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?[...e.values()]:[]}getTypes(){return[...this.variableMap.keys()]}getAllVariables(){let e=[];for(let t of this.variableMap.values())e=e.concat(...t.values());return e}getAllVariableNames(){ih("VariableMap.getAllVariableNames","v12","v13","Blockly.Variables.getAllVariables");let e=[];for(let t of this.variableMap.values())for(let i of t.values())e.push(i.getName());return e}getVariableUsesById(e){return ih("VariableMap.getVariableUsesById","v12","v13","Blockly.Variables.getVariableUsesById"),iM(this.workspace,e)}};ea(M.VARIABLE_MAP,D,uP);var uy=class extends rj{constructor(e,t){super(t),this.type=rC.TRASHCAN_OPEN,this.isOpen=e}toJson(){let e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new uy)).isOpen=e.isOpen,t}};ea(M.EVENT,rC.TRASHCAN_OPEN,uy);var uk=class extends hO{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,0>=this.workspace.options.maxTrashcanContents||(e=this.workspace.copyOptionsForFlyout(),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===lp.TOP?lp.BOTTOM:lp.TOP,this.flyout=new(ep(M.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===lp.RIGHT?lp.LEFT:lp.RIGHT,this.flyout=new(ep(M.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){let e;this.svgGroup=eZ(r8.G,{class:"blocklyTrash"});let t=String(Math.random()).substring(2);e=eZ(r8.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup),eZ(r8.RECT,{width:uw,height:uv,y:uB},e);let i=eZ(r8.IMAGE,{width:96,x:-uU,height:124,y:-uH,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup);return i.setAttributeNS(rb,"xlink:href",this.workspace.options.pathToMedia+lA),e=eZ(r8.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup),eZ(r8.RECT,{width:uw,height:uB},e),this.svgLid=eZ(r8.IMAGE,{width:96,x:-uU,height:124,y:-uH,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup),this.svgLid.setAttributeNS(rb,"xlink:href",this.workspace.options.pathToMedia+lA),eC(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),eC(this.svgGroup,"pointerup",this,this.click),eC(i,"pointerover",this,this.mouseOver),eC(i,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){if(0<this.workspace.options.maxTrashcanContents){let e=this.flyout.createDom(r8.SVG);eq(e,"blocklyTrashcanFlyout"),e3(e,this.workspace.getParentSvg()),this.flyout.init(this.workspace)}this.workspace.getComponentManager().addComponent({component:this,weight:r0.ComponentWeight.TRASHCAN_WEIGHT,capabilities:[r0.Capability.AUTOHIDEABLE,r0.Capability.DELETE_AREA,r0.Capability.DRAG_TARGET,r0.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&e2(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents.map(function(e){return JSON.parse(e)}),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout(()=>{let i,s;null==(i=this.flyout)||i.show(e),t.cursor="",null==(s=this.workspace.scrollbar)||s.setVisible(!1)},10),this.fireUiEvent(!0)}}closeFlyout(){if(this.contentsIsOpen()){var e,t;null==(e=this.flyout)||e.hide(),null==(t=this.workspace.scrollbar)||t.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets()}}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,t){if(this.initialized){var i,s,o=tY(this.workspace,e);t=tz(e=tX(o,new r7(uw,uv+uB),uF,uG,e,this.workspace),uG,o.vertical===ly.TOP?lw.DOWN:lw.UP,t),this.top=t.top,this.left=t.left,null==(i=this.svgGroup)||i.setAttribute("transform","translate("+this.left+","+this.top+")"),null==(s=this.flyout)||s.position()}}getBoundingRectangle(){return new r9(this.top,this.top+uv+uB,this.left,this.left+uw)}getClientRect(){if(!this.svgGroup)return null;var e=this.svgGroup.getBoundingClientRect();let t=e.top+uH-ux;return e=e.left+uU-ux,new r9(t,t+uB+uv+2*ux,e,e+uw+2*ux)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){var e=1/(uK+1);this.lidOpen+=this.isLidOpen?e:-e,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*uz),e=uX+this.lidOpen*(uY-uX),this.svgGroup&&(this.svgGroup.style.opacity=`${e}`),this.lidOpen>this.minOpenness&&1>this.lidOpen&&(this.lidTask=setTimeout(this.animateLid.bind(this),uV/uK))}setLidAngle(e){let t,i=this.workspace.toolboxPosition===lp.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;null==(t=this.svgLid)||t.setAttribute("transform","rotate("+(i?-e:e)+","+(i?4:uw-4)+","+(uB-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*uz)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){eU(e=new(ej(rC.TRASHCAN_OPEN))(e,this.workspace.id))}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(0>=this.workspace.options.maxTrashcanContents||!ey(e)||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),!this.contents.includes(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(uW)}}}cleanBlockJson(e){return!function e(t){if(t){if(delete t.id,delete t.x,delete t.y,delete t.enabled,delete t.disabledReasons,t.icons&&t.icons.comment){var i=t.icons.comment;delete i.height,delete i.width,delete i.pinned}for(var s in i=t.inputs){var o=i[s];let t=o.block;o=o.shadow,t&&e(t),o&&e(o)}t.next&&(t=(s=t.next).block,s=s.shadow,t&&e(t),s&&e(s))}}(e=JSON.parse(JSON.stringify(e))),Object.assign({},{kind:"BLOCK"},e)}},uw=47,uv=44,uB=16,uG=20,uF=20,ux=10,uU=0,uH=32,uW=.1,uV=80,uK=4,uX=.4,uY=.8,uz=45,uj=null,uJ=null,uZ={};uZ.BlockPaster=hE,uZ.TEST_ONLY={duplicateInternal:function(e){let t=e.toCopyData();return t?nw(t,e.workspace):null},copyInternal:function(e){let t,i=e.toCopyData();return uj=i,uJ=null!=(t=e.workspace)?t:null,i}},uZ.paste=nw,uZ.registry=lN,(d$=dy||(dy={})).ESCAPE="escape",d$.DELETE="delete",d$.COPY="copy",d$.CUT="cut",d$.PASTE="paste",d$.UNDO="undo",d$.REDO="redo";var uq=null,uQ=null,u0=null;nX();var u1={};u1.names=dy,u1.registerCopy=nU,u1.registerCut=nH,u1.registerDefaultShortcuts=nX,u1.registerDelete=nF,u1.registerEscape=nG,u1.registerPaste=nW,u1.registerRedo=nK,u1.registerUndo=nV;var u2=class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=75}save(e){return(e=e.getProcedureMap().getProcedures().map(e=>nY(e))).length?e:null}load(e,t){let i=t.getProcedureMap();for(let s of e)i.add(nz(this.procedureModelClass,this.parameterModelClass,s,t))}clear(e){e.getProcedureMap().clear()}},u3={};u3.ProcedureSerializer=u2,u3.loadProcedure=nz,u3.saveProcedure=nY;var u5=class{constructor(){this.priority=100}save(e){return(e=e.getAllVariables().map(e=>e.save())).length?e:null}load(e,t){let i=e_(M.VARIABLE_MODEL,D);e.forEach(e=>{null==i||i.load(e,t)})}clear(e){e.getVariableMap().clear()}};tj("variables",new u5);var u6={};u6.VariableSerializer=u5;var u4={};u4.load=function(e,t,{recordUndo:i=!1}={}){var s=eT(M.SERIALIZER,!0);if(s){s=Object.entries(s).sort((e,t)=>t[1].priority-e[1].priority);var o=ex();for(let[,e]of(N.setRecordUndo$$module$build$src$core$events$utils(i),(i=N.getGroup$$module$build$src$core$events$utils())||N.setGroup$$module$build$src$core$events$utils(!0),e6(),t instanceof uf&&t.setResizesEnabled(!1),s.reverse()))null==e||e.clear(t);for(let[i,o]of s.reverse())e[i]&&(null==o||o.load(e[i],t));t instanceof uf&&t.setResizesEnabled(!0),e4(),eU(new(ej(rC.FINISHED_LOADING))(t)),N.setGroup$$module$build$src$core$events$utils(i),N.setRecordUndo$$module$build$src$core$events$utils(o)}},u4.save=function(e){let t=Object.create(null),i=eT(M.SERIALIZER,!0);for(let s in i){let o,n=null==(o=i[s])?void 0:o.save(e);n&&(t[s]=n)}return t},"Blockly"in globalThis||(globalThis.Blockly={Msg:ab});var u8="label",u9=class{load(e,t){return(e=new hf(t.getWorkspace(),t.targetWorkspace,e,!0)).show(),new hA(e,u8)}gapForItem(e,t){return t}disposeItem(e){(e=e.getElement())instanceof hf&&e.dispose()}getType(){return u8}};ea(M.FLYOUT_INFLATER,u8,u9);var u7=class extends ud{constructor(e){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:+this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,e&&(this.GRID_UNIT=e),this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=+this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=+this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;let t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&e2(this.selectedGlowFilter),this.replacementGlowFilter&&e2(this.replacementGlowFilter)}makeStartHat(){let e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,i=oH("c",[oU(25,-e),oU(71,-e),oU(t,0)]);return{height:.75*e,width:t,path:i}}makeHexagonal(){function e(e,i,s){var o=e/2;return oK(-(s=s?-1:1)*(o=o>t?t:o),e=(i?-1:1)*e/2)+oK(s*o,e)}let t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width:e=>(e/=2)>t?t:e,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}makeRounded(){function e(e,t,s){let o=e>i?e-i:0,n=s===t?"0":"1";return oz("a","0 0,"+n,e=(e>i?i:e)/2,oU((s?1:-1)*e,(t?-1:1)*e))+oY("v",(t?-1:1)*o)+oz("a","0 0,"+n,e,oU((s?-1:1)*e,(t?-1:1)*e))}let t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,i=2*t;return{type:this.SHAPES.ROUND,isDynamic:!0,width:e=>(e/=2)>t?t:e,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}makeSquared(){function e(e,i,s){e-=2*t;let o=s===i?"0":"1";return oz("a","0 0,"+o,t,oU((s?1:-1)*t,(i?-1:1)*t))+oY("v",(i?-1:1)*e)+oz("a","0 0,"+o,t,oU((s?-1:1)*t,(i?-1:1)*t))}let t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width:e=>t,height:e=>e,connectionOffsetY:e=>e/2,connectionOffsetX:e=>-e,pathDown:t=>e(t,!1,!1),pathUp:t=>e(t,!0,!1),pathRightDown:t=>e(t,!1,!0),pathRightUp:t=>e(t,!1,!0)}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case cX.INPUT_VALUE:case cX.OUTPUT_VALUE:if(null!==(e=e.getSourceBlock().getOutputShape()))switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}if(t&&t.includes("Boolean"))return this.HEXAGONAL;if(t&&t.includes("Number"))return this.ROUNDED;return t&&t.includes("String"),this.ROUNDED;case cX.PREVIOUS_STATEMENT:case cX.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(e){return oH("c",[oU(e*o/2,0),oU(e*o*3/4,r/2),oU(e*o,r)])+oX([oU(e*o,n)])+oH("c",[oU(e*o/4,r/2),oU(e*o/2,r),oU(e*o,r)])+oY("h",e*s)+oH("c",[oU(e*o/2,0),oU(e*o*3/4,-(r/2)),oU(e*o,-r)])+oX([oU(e*o,-n)])+oH("c",[oU(e*o/4,-(r/2)),oU(e*o/2,-r),oU(e*o,-r)])}let t=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,s=t/3,o=s/3,n=i/2,r=n/2,l=e(1),a=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:i,pathLeft:l,pathRight:a}}makeInsideCorners(){let e=this.CORNER_RADIUS,t=oz("a","0 0,0",e,oU(-e,e)),i=oz("a","0 0,1",e,oU(-e,e)),s=oz("a","0 0,0",e,oU(e,e)),o=oz("a","0 0,1",e,oU(e,e));return{width:e,height:e,pathTop:t,pathBottom:s,rightWidth:e,rightHeight:e,pathTopRight:i,pathBottomRight:o}}generateSecondaryColour_(e){return sW("#000",e,.15)||e}generateTertiaryColour_(e){return sW("#000",e,.25)||e}createDom(e,t,i,s){super.createDom(e,t,i,s),e=eZ(r8.DEFS,{},e),t=eZ(r8.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),eZ(r8.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),i=eZ(r8.FECOMPONENTTRANSFER,{result:"outBlur"},t),eZ(r8.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),eZ(r8.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),eZ(r8.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter=t,e=eZ(r8.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),eZ(r8.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=eZ(r8.FECOMPONENTTRANSFER,{result:"outBlur"},e),eZ(r8.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),eZ(r8.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),eZ(r8.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),eZ(r8.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e,s&&(s.style.setProperty("--blocklySelectedGlowFilter",`url(#${this.selectedGlowFilterId})`),s.style.setProperty("--blocklyReplacementGlowFilter",`url(#${this.replacementGlowFilterId})`))}getCSS_(e){return[`${e} .blocklyText,`,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyTextInputBubble textarea {`,"font-weight: normal;","}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>rect:not(.blocklyDropdownRect),`,`${e} .blocklyEditableField>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${e} .blocklyNonEditableField>text,`,`${e} .blocklyEditableField>text,`,`${e} .blocklyNonEditableField>g>text,`,`${e} .blocklyEditableField>g>text {`,"fill: #575E75;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>rect,",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${e} .blocklyDropdownText {`,"fill: #fff !important;","}",`${e}.blocklyWidgetDiv .blocklyMenuItem,`,`${e}.blocklyDropDownDiv .blocklyMenuItem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e}.blocklyDropDownDiv .blocklyMenuItemContent {`,"color: #fff;","}",`${e} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${e} .blocklyDisabledPattern > .blocklyOutlinePath {`,"fill: var(--blocklyDisabledPattern)","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}",`${e} .blocklySelected>.blocklyPath.blocklyPathSelected {`,"fill: none;","filter: var(--blocklySelectedGlowFilter);","}",`${e} .blocklyReplaceable>.blocklyPath {`,"filter: var(--blocklyReplacementGlowFilter);","}"]}},de=class extends u_{constructor(e,t){super(e,t)}draw(){let e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),e.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(0>=e.height)){if(h0.isSpacer(e)){let s=e.precedesStatement;var t=e.followsStatement;if(s||t){let o=this.constants_.INSIDE_CORNERS;var i=o.rightHeight;i=e.height-(s?i:0),t=t?o.pathBottomRight:"",e=0<i?oY("V",e.yPos+i):"",this.outlinePath_+=t+e+(s?o.pathTopRight:"");return}}this.outlinePath_+=oY("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){let e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=oV(e.xPos,this.info_.startY),this.outlinePath_+=oY("h",e.width)}drawFlatBottom_(){let e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=oY("V",e.baseline),this.outlinePath_+=oY("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);let t=e.input.name;e.connectedBlock||this.info_.isInsertionMarker||(e=oW(e.xPos+e.connectionWidth,e.centerline-e.height/2)+this.getInlineInputPath(e),this.block_.pathObject.setOutlinePath(t,e))}getInlineInputPath(e){let t=e.width-2*e.connectionWidth,i=e.height;return oY("h",t)+e.shape.pathRightDown(i)+oY("h",-t)+e.shape.pathUp(i)+"z"}drawStatementInput_(e){var t=e.getLastInput();let i=t.xPos+t.notchOffset+t.shape.width,s=this.constants_.INSIDE_CORNERS,o=t.shape.pathRight+oY("h",-(t.notchOffset-s.width))+s.pathTop,n=e.height-2*s.height;t=s.pathBottom+oY("h",t.notchOffset-s.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=oY("H",i)+o+oY("v",n)+t+oY("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}drawConnectionHighlightPath(e){let t,i,s=e.connectionModel;if(s.type===cX.NEXT_STATEMENT||s.type===cX.PREVIOUS_STATEMENT||s.type===cX.OUTPUT_VALUE&&!e.isDynamicShape)return super.drawConnectionHighlightPath(e);e=s.type===cX.INPUT_VALUE?oW(e.connectionWidth,-e.height/2)+this.getInlineInputPath(e):oW(e.width,-e.height/2)+e.shape.pathDown(e.height);let o=s.getSourceBlock();return null==(i=(t=o.pathObject).addConnectionHighlight)?void 0:i.call(t,s,e,s.getOffsetInBlock(),o.RTL)}},dt=class extends cl{constructor(e,t,i,s,o,n,r){if(super(cl.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",i=Number(sY(i)),t=Number(sY(t)),isNaN(i)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(0>=i||0>=t)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new r7(t,i+dt.Y_PADDING),this.imageHeight=i,"function"==typeof o&&(this.clickHandler=o),e!==cl.SKIP_SETUP&&(r?this.configure_(r):(this.flipRtl=!!n,this.altText=sY(s)||""),this.setValue(sY(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=sY(e.alt))}initView(){this.imageElement=eZ(r8.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(rb,"xlink:href",this.value_),this.fieldGroup_&&eq(this.fieldGroup_,"blocklyImageField"),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return"string"!=typeof e?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS(rb,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}isClickable(){return super.isClickable()&&!!this.clickHandler}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}};dt.Y_PADDING=1,oD("field_image",dt),dt.prototype.DEFAULT_VALUE="";var di=class extends cl{set size_(e){super.size_=e}get size_(){let e=super.size_;return 14>e.width&&(e.width=14),e}constructor(e,t,i){super(cl.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onKeyInputWrapper=this.onKeyDownWrapper=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,e!==cl.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),void 0!==e.spellcheck&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new ca;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()),this.fieldGroup_&&eq(this.fieldGroup_,"blocklyInputField")}isFullBlockField(){let e,t=this.getSourceBlock();if(!t)throw new ca;return this.fullBlockClickTarget_=!(null==(e=this.getConstants())||!e.FULL_BLOCK_FIELDS)&&t.isSimpleReporter()}doValueInvalid_(e,t=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_&&eX()&&this.value_!==e&&t&&eU(new(ej(rC.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){let e=this.getSourceBlock();if(!e)throw new ca;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.getColourTertiary())):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let e;return(null==(e=this.getConstants())?0:e.FULL_BLOCK_FIELDS)&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var e=this.htmlInput_;this.isTextValid_?(e0(e,"blocklyInvalidInput"),t2(e,aL.INVALID,!1)):(eq(e,"blocklyInvalidInput"),t2(e,aL.INVALID,!0))}if(!(e=this.getSourceBlock()))throw new ca;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e,t=!1,i=!0){this.workspace_=this.sourceBlock_.workspace,!t&&this.workspace_.options.modalInputs&&(rS||rR||rm)?this.showPromptEditor():this.showInlineEditor(t,i)}showPromptEditor(){ir(N.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),e=>{null!==e&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)})}showInlineEditor(e,t){let i=this.getSourceBlock();if(!i)throw new ca;sZ(this,i.RTL,this.widgetDispose_.bind(this),this.workspace_,t),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new ca;N.setGroup$$module$build$src$core$events$utils(!0);let t=sj();var i=this.getClickTarget_();if(!i)throw Error("A click target has not been set.");eq(i,"blocklyEditing"),(i=document.createElement("input")).className="blocklyHtmlInput",i.setAttribute("spellcheck",this.spellcheck_);let s=this.workspace_.getAbsoluteScale();var o=this.getConstants().FIELD_TEXT_FONTSIZE*s+"pt";return t.style.fontSize=o,i.style.fontSize=o,o=di.BORDERRADIUS*s+"px",this.isFullBlockField()&&(o=((o=this.getScaledBBox()).bottom-o.top)/2+"px",e=e.getParent()?e.getParent().getColourTertiary():this.sourceBlock_.getColourTertiary(),i.style.border=+s+"px solid "+e,t.style.borderRadius=o,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*s+"px")),i.style.borderRadius=o,t.appendChild(i),i.value=i.defaultValue=this.getEditorText_(this.value_),i.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(i),i}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&eX()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(eU(new(ej(rC.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),N.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=sj().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,!(e=this.getClickTarget_()))throw Error("A click target has not been set.");e0(e,"blocklyEditing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper=eS(e,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper=eS(e,"input",this,this.onHtmlInputChange)}unbindInputEvents_(){this.onKeyDownWrapper&&(ef(this.onKeyDownWrapper),this.onKeyDownWrapper=null),this.onKeyInputWrapper&&(ef(this.onKeyInputWrapper),this.onKeyInputWrapper=null)}onHtmlInputKeyDown_(e){if("Enter"===e.key)s0(this),su();else if("Escape"===e.key)this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),s0(this),su();else if("Tab"===e.key){var t;e.preventDefault();let i=null==(t=this.workspace_)?void 0:t.getCursor();t=e=>(e instanceof di||e instanceof hR&&e.isSimpleReporter())&&e!==this.getSourceBlock(),(e=(e=e.shiftKey?null==i?void 0:i.getPreviousNode(this,t,!1):null==i?void 0:i.getNextNode(this,t,!1))instanceof hR&&e.isSimpleReporter()?e.getFields().next().value:e)instanceof di&&(s0(this),su(),e.showEditor())}}onHtmlInputChange(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&eX()&&this.value_!==e&&eU(new(ej(rC.BLOCK_FIELD_INTERMEDIATE_CHANGE))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e,t=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,t)}resizeEditor_(){t6().then(()=>{let e=this.getSourceBlock();if(!e)throw new ca;let t=sj(),i=this.getScaledBBox();t.style.width=i.right-i.left+"px",t.style.height=i.bottom-i.top+"px";let s=i.top;t.style.left=`${e.RTL?i.right-t.offsetWidth:i.left}px`,t.style.top=`${s}px`})}repositionForWindowResize(){let e,t=null==(e=this.getSourceBlock())?void 0:e.getRootBlock();return t instanceof hR&&(o9(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),t)||this.resizeEditor_(),!0)}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return`${e}`}getValueFromEditorText_(e){return e}};di.BORDERRADIUS=4,N.FieldTextInput$$module$build$src$core$field_textinput=class extends di{constructor(e,t,i){super(e,t,i)}initView(){super.initView(),this.fieldGroup_&&eq(this.fieldGroup_,"blocklyTextInputField")}doClassValidation_(e){return void 0===e?null:`${e}`}static fromJson(e){return new this(sY(e.text),void 0,e)}},oD("field_input",N.FieldTextInput$$module$build$src$core$field_textinput),N.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="",N.FieldTextInput$$module$build$src$core$field_textinput;var ds=class extends h3{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},dn=class extends uh{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},dr=class extends h1{constructor(e){super(e),this.width=this.height=0,this.type|=h0.getType("RIGHT_CONNECTION")}},dl=class extends uu{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){let t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},da=class extends uT{constructor(e,t){super(e,t),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new dl(this.constants_),this.bottomRow=new ds(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=0<t.statementInputCount,this.rightSide=this.outputConnection?new dr(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return!!t&&(t instanceof hl||e instanceof ha||t instanceof ha||(e instanceof N.ValueInput$$module$build$src$core$inputs$value_input||e instanceof hr||e instanceof hl)&&(!this.isInline||this.isMultiRow))}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&h0.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&h0.isLeftRoundedCorner(e)&&t&&(h0.isPreviousConnection(t)||h0.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&h0.isLeftSquareCorner(e)&&t&&h0.isHat(t)||e&&h0.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(h0.isTopRow(e)&&h0.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;let i=h0.isInputRow(e)&&e.hasStatement,s=h0.isInputRow(t)&&t.hasStatement;return s||i?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),s&&i?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):h0.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):h0.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){let i=this.width-this.startX;return h0.isInputRow(e)&&e.hasStatement||h0.isInputRow(t)&&t.hasStatement?Math.max(i,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):i}getElemCenterline_(e,t){if(e.hasStatement&&!h0.isSpacer(t)&&!h0.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(h0.isInlineInput(t)){let i=t.connectedBlock;if(i&&i.outputConnection&&i.nextConnection)return e.yPos+i.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if((e instanceof hr||e instanceof hl)&&t.hasDummyInput&&t.align===N.Align$$module$build$src$core$inputs$align.LEFT&&e.align===N.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(t,e);else if(e instanceof ha){t.elements.push(new dn(this.constants_,e)),t.hasStatement=!0,null===t.align&&(t.align=e.align);return}super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs.get(e)){let i;for(let t=0;t<e.elements.length;t++){let s=e.elements[t];if(h0.isSpacer(s)&&(i=s),h0.isField(s)&&s.parentInput===this.rightAlignedDummyInputs.get(e))break}if(i){i.width+=t,e.width+=t;return}}super.addAlignmentPadding_(e,t)}adjustXPosition_(){let e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH,t=e;for(let o=2;o<this.rows.length-1;o+=2){var i=this.rows[o-1];let n=this.rows[o];var s=this.rows[o+1];if(i=2===o?!!this.topRow.hasPreviousConnection:!!i.followsStatement,s=o+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!s.precedesStatement,h0.isInputRow(n)&&n.hasStatement){let i,s;n.measure(),t=n.width-(null!=(s=null==(i=n.getLastInput())?void 0:i.width)?s:0)+e}else if(i&&(2===o||s)&&h0.isInputRow(n)&&!n.hasStatement){s=n.xPos,i=null;for(let e=0;e<n.elements.length;e++){let o=n.elements[e];h0.isSpacer(o)&&(i=o),!(i&&(h0.isField(o)||h0.isInput(o))&&s<t)||h0.isField(o)&&(o.field instanceof c9||o.field instanceof dt)||(i.width+=t-s),s+=o.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,i=0;i<this.rows.length;i++){let e=this.rows[i];e.yPos=t,t+=e.height}this.height=t,i=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(i),i=e.width(i),this.outputConnection.height=t,this.outputConnection.width=i,this.outputConnection.startX=i,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(i),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=i,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=i,this.width+=i+e,this.widthWithChildren+=i+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var i=this.rows[t];if(!h0.isInputRow(i))continue;e=i.elements[i.elements.length-2];let s=this.getNegativeSpacing_(i.elements[1]),o=this.getNegativeSpacing_(e);e=s+o;let n=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-e<n&&(s=(e=this.width-n)/2,o=e/2),i.elements.unshift(new ue(this.constants_,-s)),i.elements.push(new ue(this.constants_,-o))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)i=this.rows[t],h0.isTopOrBottomRow(i)&&(i.elements[1].width-=e),i.width-=e,i.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;let t=this.outputConnection.width;var i=this.outputConnection.shape.type;let s=this.constants_;if(1<this.inputRows.length)if(i===s.SHAPES.ROUND)return i=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,t-(i=this.height/2>i?i:this.height/2)*(1-Math.sin(Math.acos((i-this.constants_.SMALL_PADDING)/i)));else return 0;if(h0.isInlineInput(e)){let o=e.connectedBlock;return null==(e=o?o.pathObject.outputShapeType:e.shape.type)||o&&o.outputConnection&&(o.statementInputCount||o.nextConnection)||i===s.SHAPES.HEXAGONAL&&i!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[i][e]}return h0.isField(e)?i===s.SHAPES.ROUND&&e.field instanceof N.FieldTextInput$$module$build$src$core$field_textinput?t-2.75*s.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[i][0]:h0.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let s=2;s<this.rows.length-1;s+=2){let o=this.rows[s-1],n=this.rows[s],r=this.rows[s+1];var e=2===s,t=s+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!r.precedesStatement;if(e?this.topRow.hasPreviousConnection:o.followsStatement){var i=n.elements[1];if(i=3===n.elements.length&&i instanceof h8&&(i.field instanceof c9||i.field instanceof dt),!e&&i)o.height-=this.constants_.SMALL_PADDING,r.height-=this.constants_.SMALL_PADDING,n.height-=this.constants_.MEDIUM_PADDING;else if(e||t){if(t){for(t=0,e=!1;t<n.elements.length;t++)if(i=n.elements[t],h0.isInlineInput(i)&&i.connectedBlock&&!i.connectedBlock.isShadow()&&40<=i.connectedBlock.getHeightWidth().height){e=!0;break}e&&(o.height-=this.constants_.SMALL_PADDING,r.height-=this.constants_.SMALL_PADDING)}}else o.height+=this.constants_.SMALL_PADDING}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},dc=class extends up{constructor(e,t,i){super(e,t,i),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=i}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);let t=e.getParent();for(let i of(e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.getColourTertiary()),this.outlines.values()))i.setAttribute("fill",this.style.colourTertiary)}flipRTL(){for(let e of(super.flipRTL(),this.outlines.values()))e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.classList.add("blocklyPathSelected"),e0(this.svgPathSelected,rw.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),e0(this.svgPathSelected,rw.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME),this.svgPathSelected.removeAttribute("tabindex"),this.svgPathSelected.removeAttribute("id"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){for(let e of(this.remainingOutlines.clear(),this.outlines.keys()))this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(let e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,t){(e=this.getOutlinePath(e)).setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,eZ(r8.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let t,i;null==(t=this.outlines.get(e))||null==(i=t.parentNode)||i.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},dh=class extends ug{constructor(e){super(e)}makeConstants_(){return new u7}makeRenderInfo_(e){return new da(this,e)}makeDrawer_(e,t){return new de(e,t)}makePathObject(e,t){return new dc(e,t,this.getConstants())}getConstants(){return this.constants_}};nL("zelos",dh);var du=class{constructor(e){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=e.workspace}previewReplacement(e,t,i){N.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.fadedBlock=i,i.fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(t)&&(t.highlight(),this.staticConn=t)}finally{N.enable$$module$build$src$core$events$utils()}}previewConnection(e,t){if(e!==this.draggedConn||t!==this.staticConn){N.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(e,t)&&(this.markerConn=this.previewMarker(e,t)),this.workspace.getRenderer().shouldHighlightConnection(t)&&t.highlight(),this.draggedConn=e,this.staticConn=t}finally{N.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(e,t){return t.type===cX.PREVIOUS_STATEMENT||t.type===cX.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof dh)}previewMarker(e,t){let i=e.getSourceBlock(),s=this.createInsertionMarker(i),o=this.getMatchingConnection(i,s,e);if(!o)return null;s.queueRender(),t4(),o.connect(t);let n={x:t.x-o.x,y:t.y-o.y},r=o.getOffsetInBlock().clone();return t6().then(()=>{if(!s.isDeadOrDying()){N.disable$$module$build$src$core$events$utils();try{null==s||s.positionNearConnection(o,n,r),null==s||s.getSvgRoot().setAttribute("visibility","visible")}finally{N.enable$$module$build$src$core$events$utils()}}}),o}createInsertionMarker(e){let t=iP(e,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!t)throw Error(`Failed to serialize source block. ${e.toDevString()}`);for(let i of(e=iU(t,this.workspace)).getDescendants(!1))i.setInsertionMarker(!0);return e.initSvg(),e.getSvgRoot().setAttribute("visibility","hidden"),e}getMatchingConnection(e,t,i){if(e=e.getConnections_(!0),t=t.getConnections_(!0),e.length!==t.length)return null;for(let s=0;s<e.length;s++)if(e[s]===i)return t[s];return null}hidePreview(){N.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{N.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(e){let t,i=e.getSourceBlock(),s=i.outputConnection;if((null==(t=i.previousConnection)?0:t.targetConnection)||(null==s?0:s.targetConnection))i.unplug(!0);else{let t;null==(t=e.targetBlock())||t.unplug(!1)}i.dispose()}dispose(){this.hidePreview()}};ea(M.CONNECTION_PREVIEWER,D,du);var dd={};dd.Align=N.Align$$module$build$src$core$inputs$align,dd.DummyInput=hr,dd.EndRowInput=hl,dd.Input=hn,dd.StatementInput=ha,dd.ValueInput=N.ValueInput$$module$build$src$core$inputs$value_input,dd.inputTypes=N.inputTypes$$module$build$src$core$inputs$input_types;var dE=!1;N.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=tl());var t=[];this.init(e),e=e.getTopBlocks(!0);for(let i=0,s;s=e[i];i++){let e=this.blockToCode(s);Array.isArray(e)&&(e=e[0]),e&&(s.outputConnection&&(e=this.scrubNakedValue(e),this.STATEMENT_PREFIX&&!s.suppressPrefixSuffix&&(e=this.injectId(this.STATEMENT_PREFIX,s)+e),this.STATEMENT_SUFFIX&&!s.suppressPrefixSuffix&&(e+=this.injectId(this.STATEMENT_SUFFIX,s))),t.push(e))}return t=t.join("\n"),(t=(t=(t=this.finish(t)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,"\n"+t)}allNestedComments(e){let t=[];e=e.getDescendants(!0);for(let i=0;i<e.length;i++){let s=e[i].getCommentText();s&&t.push(s)}return t.length&&t.push(""),t.join("\n")}blockToCode(e,t){if(!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(!1)[0]);var i=this.forBlock[e.type];if("function"!=typeof i)throw Error(`${this.name_} generator does not know how to generate code for block type "${e.type}".`);if(Array.isArray(i=i.call(e,e,this))){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,i[0],t),i[1]]}if("string"==typeof i)return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(i=this.injectId(this.STATEMENT_PREFIX,e)+i),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(i+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,i,t);if(null===i)return"";throw SyntaxError("Invalid code generated: "+i)}valueToCode(e,t,i){if(isNaN(i))throw TypeError("Expecting valid order from block: "+e.type);var s=e.getInputTargetBlock(t);if(!s&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if(!s||""===(t=this.blockToCode(s)))return"";if(!Array.isArray(t))throw TypeError(`Expecting tuple from value block: ${s.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(e=t[0],isNaN(t=t[1]))throw TypeError("Expecting valid order from value block: "+s.type);if(!e)return"";s=!1;var o=Math.floor(i);let n=Math.floor(t);if(o<=n&&(o!==n||0!==o&&99!==o)){for(s=!0,o=0;o<this.ORDER_OVERRIDES.length;o++)if(this.ORDER_OVERRIDES[o][0]===i&&this.ORDER_OVERRIDES[o][1]===t){s=!1;break}}return s&&(e="("+e+")"),e}statementToCode(e,t){let i=e.getInputTargetBlock(t);if(!i&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if("string"!=typeof(e=this.blockToCode(i)))throw TypeError("Expecting code from statement block: "+(i&&i.type));return e&&(e=this.prefixLines(e,this.INDENT)),e}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){let i,s=this.nameDB_.getDistinctName(e,N.NameType$$module$build$src$core$names.PROCEDURE);for(this.functionNames_[e]=s,Array.isArray(t)&&(t=t.join("\n")),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,s);i!==t;)i=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}getVariableName(e){return this.getName(e,N.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,N.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,t){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(e,t)}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,i){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},N.CodeGenerator$$module$build$src$core$generator;var d_=class extends hx{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),i=t.getScrollMetrics(),s=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"==typeof e.y&&(this.workspace_.scrollY=-(i.top+(i.height-s.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();let t=e.getAbsoluteMetrics(),i=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===lp.LEFT?e.width:i.width-this.getWidth():this.toolboxPosition_===lp.LEFT?0:i.width:this.toolboxPosition_===lp.LEFT?0:i.width+t.left-this.getWidth()}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height;var t=this.getWidth()-this.CORNER_RADIUS;this.setBackgroundPath(t,e.height-2*this.CORNER_RADIUS),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t)}}setBackgroundPath(e,t){let i=this.toolboxPosition_===lp.RIGHT;var s=e+this.CORNER_RADIUS;(s=["M "+(i?s:0)+",0"]).push("h",i?-e:e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,+!i,i?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("v",Math.max(0,t)),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,+!i,i?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("h",i?e:-e),s.push("z"),this.svgBackground_.setAttribute("d",s.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setY(0)}wheel_(e){var t=e$(e);if(t.y){let e,i=this.workspace_.getMetricsManager(),s=i.getScrollMetrics();t=i.getViewMetrics().top-s.top+t.y,null==(e=this.workspace_.scrollbar)||e.setY(t),s1(this.workspace_),su()}e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;var t=this.MARGIN;let i=this.RTL?t:t+this.tabWidth_;for(let s of e)s.getElement().moveBy(i,t),t+=s.getElement().getBoundingRectangle().getHeight()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;let t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;let e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===lp.LEFT?new r9(-1e9,1e9,-1e9,t+e.width):new r9(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=this.getContents().reduce((e,t)=>Math.max(e,t.getElement().getBoundingRectangle().getWidth()),0);if(e+=1.5*this.MARGIN+this.tabWidth_,e*=this.workspace_.scale,e+=ln.scrollbarThickness,this.getWidth()!==e){if(this.RTL)for(let t of this.getContents()){let i=t.getElement().getBoundingRectangle().left,s=e/this.workspace_.scale-t.getElement().getBoundingRectangle().getWidth()-this.MARGIN-this.tabWidth_;t.getElement().moveBy(s-i,0)}this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==lp.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};d_.registryName="verticalFlyout",ea(M.FLYOUTS_VERTICAL_TOOLBOX,D,d_);var dT=class extends hx{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),i=t.getScrollMetrics(),s=t.getViewMetrics();t=t.getAbsoluteMetrics(),"number"==typeof e.x&&(this.workspace_.scrollX=-(i.left+(i.width-s.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();let t=e.getAbsoluteMetrics(),i=e.getViewMetrics();e=e.getToolboxMetrics();let s=this.toolboxPosition_===lp.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?s?e.height:i.height-this.getHeight():s?0:i.height:s?0:i.height+t.top-this.getHeight()}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,e=e.width-2*this.CORNER_RADIUS;var t=this.getHeight()-this.CORNER_RADIUS;this.setBackgroundPath(e,t),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t)}}setBackgroundPath(e,t){let i=this.toolboxPosition_===lp.TOP,s=["M 0,"+(i?0:this.CORNER_RADIUS)];i?(s.push("h",e+2*this.CORNER_RADIUS),s.push("v",t),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("h",-e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),s.push("h",e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("v",t),s.push("h",-e-2*this.CORNER_RADIUS)),s.push("z"),this.svgBackground_.setAttribute("d",s.join(" "))}scrollToStart(){let e;null==(e=this.workspace_.scrollbar)||e.setX(this.RTL?1/0:0)}wheel_(e){var t=e$(e);if(t=t.x||t.y){let e,i=this.workspace_.getMetricsManager(),s=i.getScrollMetrics();t=i.getViewMetrics().left-s.left+t,null==(e=this.workspace_.scrollbar)||e.setX(t),s1(this.workspace_),su()}e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;let t=this.MARGIN,i=t+this.tabWidth_;for(let s of(this.RTL&&(e=e.reverse()),e))e=s.getElement().getBoundingRectangle(),e=this.RTL?i+e.getWidth():i,s.getElement().moveBy(e,t),i+=s.getElement().getBoundingRectangle().getWidth()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;let t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;let e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===lp.TOP?new r9(-1e9,t+e.height,-1e9,1e9):new r9(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=this.getContents().reduce((e,t)=>Math.max(e,t.getElement().getBoundingRectangle().getHeight()),0);e+=1.5*this.MARGIN,e*=this.workspace_.scale,e+=ln.scrollbarThickness,this.getHeight()!==e&&(this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==lp.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets())}};ea(M.FLYOUTS_HORIZONTAL_TOOLBOX,D,dT);var dp=class extends cH{constructor(e,t,i,s,o){super(cl.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=dp.dropdownCreate,this.defaultVariableName="string"==typeof e?e:"",this.size_=new r7(0,0),e!==cl.SKIP_SETUP&&(o?this.configure_(o):this.setTypes(i,s),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new ca;this.variable||(e=N.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}initView(){super.initView(),eq(this.fieldGroup_,"blocklyVariableField")}shouldAddBorderRect_(){let e=this.getSourceBlock();if(!e)throw new ca;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==e.type)}fromXml(e){var t=this.getSourceBlock();if(!t)throw new ca;let i=e.getAttribute("id"),s=e.textContent,o=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=N.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,i,s,o),null!==o&&o!==t.getType())throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.getType()+", and does not match variable field that references it: "+oT(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.getName(),this.variable.getType()&&e.setAttribute("variabletype",this.variable.getType()),e}saveState(e){var t=this.saveLegacyState(dp);return null!==t||(this.initModel(),t={id:this.variable.getId()},e&&(t.name=this.variable.getName(),t.type=this.variable.getType())),t}loadState(e){let t=this.getSourceBlock();if(!t)throw new ca;this.loadLegacyState(dp,e)||(e=N.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.getName():""}getVariable(){return this.variable}getDefaultType(){return this.defaultType}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(null===e)return null;var t=this.getSourceBlock();if(!t)throw new ca;return(t=N.getVariable$$module$build$src$core$variables(t.workspace,e))?(t=t.getType(),this.typeIsAllowed(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){let t=this.getSourceBlock();if(!t)throw new ca;this.variable=N.getVariable$$module$build$src$core$variables(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(e){let t=this.getVariableTypes();if(!t)return!0;for(let i=0;i<t.length;i++)if(e===t[i])return!0;return!1}getVariableTypes(){if(this.variableTypes)return this.variableTypes;if(!this.sourceBlock_||this.sourceBlock_.isDeadOrDying())return[""];let e=this.sourceBlock_.workspace.getVariableMap().getTypes();if(this.sourceBlock_.isInFlyout){let t=this.sourceBlock_.workspace.getPotentialVariableMap();if(!t)return e;e=Array.from(new Set([...e,...t.getTypes()]))}return e}setTypes(e=null,t=""){var i=this.getText();if(Array.isArray(e)){if(0===e.length)throw Error(`'variableTypes' of field variable ${i} was an empty list. If you want to include all variable types, pass 'null' instead.`);i=!1;for(let s=0;s<e.length;s++)e[s]===t&&(i=!0);if(!i)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else if(null!==e)throw Error(`'variableTypes' was not an array or null in the definition of FieldVariable ${i}`);this.defaultType=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===he&&this.variable)return void N.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);if(e===ht&&this.variable){e=this.variable.getWorkspace(),N.deleteVariable$$module$build$src$core$variables(e,this.variable,this.sourceBlock_);return}}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(sY(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");let e=this.getText(),t=[];var i=this.getSourceBlock();if(i&&!i.isDeadOrDying()){i=i.workspace;let e=this.getVariableTypes();for(let n=0;n<e.length;n++){let r=e[n],l=i.getVariableMap().getVariablesOfType(r);if(t=t.concat(l),i.isFlyout){var s=void 0,o=void 0;t=t.concat(null!=(o=null==(s=i.getPotentialVariableMap())?void 0:s.getVariablesOfType(r))?o:[])}}}for(t.sort(iD),s=[],o=0;o<t.length;o++)s[o]=[t[o].getName(),t[o].getId()];return s.push([N.Msg$$module$build$src$core$msg.RENAME_VARIABLE,he]),N.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&s.push([N.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),ht]),s}};oD("field_variable",dp);var dg=class extends di{constructor(e,t,i,s,o,n){super(cl.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==cl.SKIP_SETUP&&(n?this.configure_(n):this.setConstraints(t,i,s),this.setValue(e),o&&this.setValidator(o))}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,t,i){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(i),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){null==e?this.min_=-1/0:isNaN(e=Number(e))||(this.min_=e)}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){null==e?this.max_=1/0:isNaN(e=Number(e))||(this.max_=e)}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);t.includes("e")&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));let i=t.indexOf(".");this.decimalPlaces=-1===i?e?0:null:t.length-i-1}getPrecision(){return this.precision_}doClassValidation_(e){return null===e||isNaN(e=Number((e=(e=(e=`${e}`.replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"))||0))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),null!==this.decimalPlaces&&(e=Number(e.toFixed(this.decimalPlaces))),e)}widgetCreate_(){let e=super.widgetCreate_();return-1/0<this.min_&&(e.min=`${this.min_}`,t2(e,aL.VALUEMIN,this.min_)),1/0>this.max_&&(e.max=`${this.max_}`,t2(e,aL.VALUEMAX,this.max_)),e}initView(){super.initView(),this.fieldGroup_&&eq(this.fieldGroup_,"blocklyNumberField")}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};oD("field_number",dg),dg.prototype.DEFAULT_VALUE=0;var dI=class extends c9{constructor(e,t,i){super(String(null!=e?e:""),t,i),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(sY(e.text),void 0,e)}};oD("field_label_serializable",dI);var dR=class extends cl{constructor(e,t,i){super(cl.SKIP_SETUP),this.SERIALIZABLE=!0,this.value_=this.value_,this.checkChar=dR.CHECK_CHAR,e!==cl.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){let e=this.saveLegacyState(dR);return null!==e?e:this.getValueBoolean()}initView(){super.initView();let e=this.getTextElement();eq(this.fieldGroup_,"blocklyCheckboxField"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||dR.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return!0===e||"TRUE"===e?"TRUE":!1===e||"FALSE"===e?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool(this.value_))}convertValueToBool(e){return"string"==typeof e?"TRUE"===e:!!e}static fromJson(e){return new this(e.checked,void 0,e)}};dR.CHECK_CHAR="✓",oD("field_checkbox",dR),dR.prototype.DEFAULT_VALUE=!1;var dm=class{constructor(e,t){this.draggable=e,this.workspace=t,this.dragTarget=null,this.startLoc=e.getRelativeToSurfaceXY()}onDragStart(e){N.getGroup$$module$build$src$core$events$utils()||N.setGroup$$module$build$src$core$events$utils(!0),this.draggable.startDrag(e)}onDrag(e,t){this.moveDraggable(e,t),ni(t=this.getRoot(this.draggable))&&t.setDeleteStyle(this.wouldDeleteDraggable(e,t)),this.updateDragTarget(e)}updateDragTarget(e){e=this.workspace.getDragTarget(e);let t=this.getRoot(this.draggable);if(this.dragTarget!==e){let i;null==(i=this.dragTarget)||i.onDragExit(t),null==e||e.onDragEnter(t)}null==e||e.onDragOver(t),this.dragTarget=e}moveDraggable(e,t){t=this.pixelsToWorkspaceUnits(t),t=r4.sum(this.startLoc,t),this.draggable.drag(t,e)}wouldDeleteDraggable(e,t){return!!((e=this.workspace.getDragTarget(e))&&this.workspace.getComponentManager().hasCapability(e.id,r0.Capability.DELETE_AREA))&&e.wouldDelete(t)}onDragEnd(e){let t=N.getGroup$$module$build$src$core$events$utils();var i=this.workspace.getDragTarget(e);let s=this.getRoot(this.draggable);if(i){let e;null==(e=this.dragTarget)||e.onDrop(s)}this.shouldReturnToStart(e,s)&&this.draggable.revertDrag(),(i=ni(s)&&this.wouldDeleteDraggable(e,s))&&this.draggable instanceof hR&&oQ(this.draggable.getRootBlock()),this.draggable.endDrag(e),i&&ni(s)&&(N.setGroup$$module$build$src$core$events$utils(t),s.dispose()),N.setGroup$$module$build$src$core$events$utils(!1),!i&&te(this.draggable)&&N.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.draggable)}getRoot(e){return e instanceof hR?e.getRootBlock():e}shouldReturnToStart(e,t){return!!(e=this.workspace.getDragTarget(e))&&e.shouldPreventMove(t)}pixelsToWorkspaceUnits(e){return e=new r4(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}};ea(M.BLOCK_DRAGGER,D,dm);var dO={};dO.BlockDragStrategy=hp,dO.BubbleDragStrategy=cZ,dO.CommentDragStrategy=cL,dO.Dragger=dm;var dA=class extends rj{constructor(e,t,i){super(e?e.workspace.id:void 0),this.type=rC.BLOCK_DRAG,e&&(this.blockId=e.id,this.isStart=t,this.blocks=i)}toJson(){let e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dA)).isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};ea(M.EVENT,rC.BLOCK_DRAG,dA);var dS=class extends aR{constructor(e,t,i,s){super(e),this.type=rC.BLOCK_FIELD_INTERMEDIATE_CHANGE,this.recordUndo=!1,e&&(this.name=t,this.oldValue=i,this.newValue=s)}toJson(){let e=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dS)).name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name)}};ea(M.EVENT,rC.BLOCK_FIELD_INTERMEDIATE_CHANGE,dS);var dC=class extends aR{constructor(e){super(e),this.type=rC.BLOCK_MOVE,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){let e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dC)).oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(i=e.oldCoordinate.split(","),t.oldCoordinate=new r4(Number(i[0]),Number(i[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(i=e.newCoordinate.split(","),t.newCoordinate=new r4(Number(i[0]),Number(i[1]))),void 0!==e.reason&&(t.reason=e.reason),void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}recordNew(){let e=this.currentLocation();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};let i=t.getParent();return i?(e.parentId=i.id,(t=i.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&r4.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var i=t.getBlockById(this.blockId);if(i){var s=e?this.newParentId:this.oldParentId,o=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,s){var n=t.getBlockById(s);if(!n)return void console.warn("Can't connect to non-existent block: "+s)}if(i.getParent()&&i.unplug(),e)o=i.getRelativeToSurfaceXY(),i.moveBy(e.x-o.x,e.y-o.y,this.reason);else{let e,s;(!(t=i.outputConnection)||i.previousConnection&&i.previousConnection.isConnected())&&(t=i.previousConnection),i=null==(s=t)?void 0:s.type,o?(i=n.getInput(o))&&(e=i.connection):i===cX.PREVIOUS_STATEMENT&&(e=n.nextConnection),e&&t?t.connect(e):console.warn("Can't connect to non-existent input: "+o)}}else console.warn("Can't move non-existent block: "+this.blockId)}};ea(M.EVENT,rC.BLOCK_MOVE,dC);var df,dL,dN,db,d$,dD,dM,dP,dy,dk,dw=class extends rj{constructor(e,t,i){super(e?e.workspace.id:void 0),this.type=rC.BUBBLE_OPEN,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=i)}toJson(){let e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dw)).isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}};(e=dk||(dk={})).MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning",ea(M.EVENT,rC.BUBBLE_OPEN,dw);var dv={};dv.BubbleOpen=dw,dv.BubbleType=dk;var dB=class extends rz{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=N.getGroup$$module$build$src$core$events$utils(),this.recordUndo=ex())}toJson(){let e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dB)).commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){let i=e.getEventWorkspace_();if(t){if(!e.json)throw Error("Encountered a comment event without proper json");tZ(e.json,i)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=i.getCommentById(e.commentId))?t.dispose():console.warn("Can't delete non-existent comment: "+e.commentId)}}},dG=class extends dB{constructor(e,t,i){super(e),this.type=rC.COMMENT_CHANGE,e&&(this.oldContents_=void 0===t?"":t,this.newContents_=void 0===i?"":i)}toJson(){let e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dG)).oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var i=e?this.newContents_:this.oldContents_;if(void 0===i){if(e)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson")}t.setText(i)}else console.warn("Can't change non-existent comment: "+this.commentId)}};ea(M.EVENT,rC.COMMENT_CHANGE,dG);var dF=class extends dB{constructor(e,t){super(e),this.newCollapsed=t,this.type=rC.COMMENT_COLLAPSE}toJson(){let e=super.toJson();if(void 0===this.newCollapsed)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return e.newCollapsed=this.newCollapsed,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dF)).newCollapsed=e.newCollapsed,t}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=t.getCommentById(this.commentId))?t.setCollapsed(e?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}};ea(M.EVENT,rC.COMMENT_COLLAPSE,dF);var dx=class extends dB{constructor(e){super(e),this.type=rC.COMMENT_CREATE,e&&(this.xml=oa(e),this.json=tJ(e,{addCoordinates:!0}))}toJson(){let e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=oT(this.xml),e.json=this.json,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dx)).xml=N.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}run(e){dB.CommentCreateDeleteHelper(this,e)}};ea(M.EVENT,rC.COMMENT_CREATE,dx);var dU=class extends dB{constructor(e){super(e),this.type=rC.COMMENT_DELETE,e&&(this.xml=oa(e),this.json=tJ(e,{addCoordinates:!0}))}run(e){dB.CommentCreateDeleteHelper(this,!e)}toJson(){let e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=oT(this.xml),e.json=this.json,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dU)).xml=N.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}};ea(M.EVENT,rC.COMMENT_DELETE,dU);var dH=class extends rj{constructor(e,t){super(e?e.workspace.id:void 0),this.type=rC.COMMENT_DRAG,e&&(this.commentId=e.id,this.isStart=t)}toJson(){let e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.isStart=this.isStart,e.commentId=this.commentId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dH)).isStart=e.isStart,t.commentId=e.commentId,t}};ea(M.EVENT,rC.COMMENT_DRAG,dH);var dW=class extends dB{constructor(e){super(e),this.type=rC.COMMENT_MOVE,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(e){this.reason=e}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){let e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}static fromJson(e,t,i){return t=super.fromJson(e,t,null!=i?i:new dW),i=e.oldCoordinate.split(","),t.oldCoordinate_=new r4(Number(i[0]),Number(i[1])),i=e.newCoordinate.split(","),t.newCoordinate_=new r4(Number(i[0]),Number(i[1])),t}isNull(){return r4.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newCoordinate_:this.oldCoordinate_))throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");t.moveTo(e)}else console.warn("Can't move non-existent comment: "+this.commentId)}};ea(M.EVENT,rC.COMMENT_MOVE,dW);var dV=class extends dB{constructor(e){super(e),this.type=rC.COMMENT_RESIZE,e&&(this.oldSize=e.getSize())}recordCurrentSizeAsNewSize(){if(this.newSize)throw Error("Tried to record the new size of a comment on the same event twice.");var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(!(e=e.getCommentById(this.commentId)))throw Error("The comment associated with the comment resize event could not be found");this.newSize=e.getSize()}toJson(){let e=super.toJson();if(!this.oldSize)throw Error("The old comment size is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newSize)throw Error("The new comment size is undefined. Either call recordCurrentSizeAsNewSize, or call fromJson");return e.oldWidth=Math.round(this.oldSize.width),e.oldHeight=Math.round(this.oldSize.height),e.newWidth=Math.round(this.newSize.width),e.newHeight=Math.round(this.newSize.height),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dV)).oldSize=new r7(e.oldWidth,e.oldHeight),t.newSize=new r7(e.newWidth,e.newHeight),t}isNull(){return r7.equals(this.oldSize,this.newSize)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newSize:this.oldSize))throw Error("Either oldSize or newSize is undefined. Either pass a comment to the constructor and call recordCurrentSizeAsNewSize, or call fromJson");t.setSize(e)}else console.warn("Can't resize non-existent comment: "+this.commentId)}};ea(M.EVENT,rC.COMMENT_RESIZE,dV);var dK=class extends rj{constructor(e,t,i){super(i),this.type=rC.TOOLBOX_ITEM_SELECT,this.oldItem=null!=e?e:void 0,this.newItem=null!=t?t:void 0}toJson(){let e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dK)).oldItem=e.oldItem,t.newItem=e.newItem,t}};ea(M.EVENT,rC.TOOLBOX_ITEM_SELECT,dK);var dX=class extends uN{constructor(e,t,i){super(e),this.oldType=t,this.newType=i,this.type=rC.VAR_TYPE_CHANGE}toJson(){let e=super.toJson();if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");return e.oldType=this.oldType,e.newType=this.newType,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dX)).oldType=e.oldType,t.newType=e.newType,t}run(e){let t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");let i=t.getVariableMap().getVariableById(this.varId);i&&(e?t.getVariableMap().changeVariableType(i,this.newType):t.getVariableMap().changeVariableType(i,this.oldType))}};ea(M.EVENT,rC.VAR_TYPE_CHANGE,dX);var dY=class extends rz{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=rC.FINISHED_LOADING,this.isBlank=!!e,e&&(this.workspaceId=e.id)}};ea(M.EVENT,rC.FINISHED_LOADING,dY),N.BLOCK_CHANGE$$module$build$src$core$events$events=rC.BLOCK_CHANGE,N.BLOCK_CREATE$$module$build$src$core$events$events=rC.BLOCK_CREATE,N.BLOCK_DELETE$$module$build$src$core$events$events=rC.BLOCK_DELETE,t=rC.BLOCK_DRAG,N.BLOCK_MOVE$$module$build$src$core$events$events=rC.BLOCK_MOVE,i=rC.BLOCK_FIELD_INTERMEDIATE_CHANGE,s=rC.BUBBLE_OPEN,o=rC.BLOCK_CHANGE,n=rC.CLICK,l=rC.COMMENT_CHANGE,a=rC.COMMENT_CREATE,c=rC.COMMENT_DELETE,h=rC.COMMENT_MOVE,u=rC.COMMENT_RESIZE,d=rC.COMMENT_DRAG,E=rC.BLOCK_CREATE,_=rC.BLOCK_DELETE,T=rC.FINISHED_LOADING,p=rC.BLOCK_MOVE,g=rC.SELECTED,I=rC.THEME_CHANGE,R=rC.TOOLBOX_ITEM_SELECT,m=rC.TRASHCAN_OPEN,O=rC.UI,A=rC.VAR_CREATE,S=rC.VAR_DELETE,C=rC.VAR_RENAME,f=rC.VIEWPORT_CHANGE,(L={}).Abstract=rz,L.BLOCK_CHANGE=N.BLOCK_CHANGE$$module$build$src$core$events$events,L.BLOCK_CREATE=N.BLOCK_CREATE$$module$build$src$core$events$events,L.BLOCK_DELETE=N.BLOCK_DELETE$$module$build$src$core$events$events,L.BLOCK_DRAG=t,L.BLOCK_FIELD_INTERMEDIATE_CHANGE=i,L.BLOCK_MOVE=N.BLOCK_MOVE$$module$build$src$core$events$events,L.BUBBLE_OPEN=s,L.BUMP_EVENTS=z,L.BlockBase=aR,L.BlockChange=am,L.BlockCreate=cy,L.BlockDelete=cF,L.BlockDrag=dA,L.BlockFieldIntermediateChange=dS,L.BlockMove=dC,L.BubbleOpen=dw,L.BubbleType=dk,L.CHANGE=o,L.CLICK=n,L.COMMENT_CHANGE=l,L.COMMENT_CREATE=a,L.COMMENT_DELETE=c,L.COMMENT_DRAG=d,L.COMMENT_MOVE=h,L.COMMENT_RESIZE=u,L.CREATE=E,L.Click=rJ,L.ClickTarget=rY,L.CommentBase=dB,L.CommentChange=dG,L.CommentCollapse=dF,L.CommentCreate=dx,L.CommentDelete=dU,L.CommentDrag=dH,L.CommentMove=dW,L.CommentResize=dV,L.DELETE=_,L.FINISHED_LOADING=T,L.FinishedLoading=dY,L.MOVE=p,L.SELECTED=g,L.Selected=cG,L.THEME_CHANGE=I,L.TOOLBOX_ITEM_SELECT=R,L.TRASHCAN_OPEN=m,L.ThemeChange=cw,L.ToolboxItemSelect=dK,L.TrashcanOpen=uy,L.UI=O,L.UiBase=rj,L.VAR_CREATE=A,L.VAR_DELETE=S,L.VAR_RENAME=C,L.VIEWPORT_CHANGE=f,L.VarBase=uN,L.VarCreate=ub,L.VarDelete=uD,L.VarRename=uM,L.VarTypeChange=dX,L.ViewportChange=cv,L.clearPendingUndo=eK,L.disable=N.disable$$module$build$src$core$events$utils,L.disableOrphans=eJ,L.enable=N.enable$$module$build$src$core$events$utils,L.filter=eV,L.fire=eU,L.fromJson=ez,L.get=ej,L.getDescendantIds=eY,L.getGroup=N.getGroup$$module$build$src$core$events$utils,L.getRecordUndo=ex,L.isEnabled=eX,L.setGroup=N.setGroup$$module$build$src$core$events$utils,L.setRecordUndo=N.setRecordUndo$$module$build$src$core$events$utils;var dz={};dz.BottomRow=ds,dz.ConstantProvider=u7,dz.Drawer=de,dz.PathObject=dc,dz.RenderInfo=da,dz.Renderer=dh,dz.RightConnectionShape=dr,dz.StatementInput=dn,dz.TopRow=dl,rE();var dj={};dj.registerCleanup=n2,dj.registerCollapse=n5,dj.registerCollapseExpandBlock=ro,dj.registerComment=ri,dj.registerCommentCreate=rh,dj.registerCommentDelete=ra,dj.registerCommentDuplicate=rc,dj.registerCommentOptions=function(){rc(),ra(),rh()},dj.registerDefaultOptions=rE,dj.registerDelete=rr,dj.registerDeleteAll=n7,dj.registerDisable=rn,dj.registerDuplicate=rt,dj.registerExpand=n6,dj.registerHelp=rl,dj.registerInline=rs,dj.registerRedo=n1,dj.registerUndo=n0;var dJ={};dJ.CommentView=c$,dJ.RenderedWorkspaceComment=cM,dJ.WorkspaceComment=cD;var dZ="button",dq=class{load(e,t){return(e=new hf(t.getWorkspace(),t.targetWorkspace,e,!1)).show(),new hA(e,dZ)}gapForItem(e,t){return t}disposeItem(e){(e=e.getElement())instanceof hf&&e.dispose()}getType(){return dZ}};ea(M.FLYOUT_INFLATER,dZ,dq);var dQ={};dQ.Bubble=cq,dQ.MiniWorkspaceBubble=cQ,dQ.TextBubble=hg,dQ.TextInputBubble=hj;var d0="block",d1=class{constructor(){this.permanentlyDisabledBlocks=new Set,this.listeners=new Map,this.capacityWrapper=this.filterFlyoutBasedOnCapacity.bind(this)}load(e,t){return this.setFlyout(t),(e=this.createBlock(e,t.getWorkspace())).isEnabled()?this.updateStateBasedOnCapacity(e):this.permanentlyDisabledBlocks.add(e),e.getDescendants(!1).forEach(e=>e.isInFlyout=!0),this.addBlockListeners(e),new hA(e,d0)}createBlock(e,t){return e.blockxml?(e="string"==typeof e.blockxml?N.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,t=og(e,t)):(void 0===e.enabled&&(e.enabled="true"!==e.disabled&&!0!==e.disabled),void 0===e.disabledReasons&&!1===e.enabled&&(e.disabledReasons=[lK]),"x"in e&&delete e.x,"y"in e&&delete e.y,t=iH(e,t)),t}gapForItem(e,t){let i;return e.gap?i=parseInt(String(e.gap)):e.blockxml&&(i=parseInt((e="string"==typeof e.blockxml?N.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml).getAttribute("gap"))),!i||isNaN(i)?t:i}disposeItem(e){(e=e.getElement())instanceof hR&&(this.removeListeners(e.id),e.dispose(!1,!1))}removeListeners(e){let t;(null!=(t=this.listeners.get(e))?t:[]).forEach(e=>ef(e)),this.listeners.delete(e)}setFlyout(e){if(this.flyout!==e){var t;if(this.flyout){let e;null==(e=this.flyout.targetWorkspace)||e.removeChangeListener(this.capacityWrapper)}this.flyout=e,null==(t=this.flyout.targetWorkspace)||t.addChangeListener(this.capacityWrapper)}}updateStateBasedOnCapacity(e){let t,i,s=null==(t=this.flyout)||null==(i=t.targetWorkspace)?void 0:i.isCapacityAvailable(t_(e));for(;e;)e.setDisabledReason(!s,"WORKSPACE_AT_BLOCK_CAPACITY"),e=e.getNextBlock()}addBlockListeners(e){let t=[];t.push(eS(e.getSvgRoot(),"pointerdown",e,t=>{let i,s,o=null==(i=this.flyout)||null==(s=i.targetWorkspace)?void 0:s.getGesture(t);o&&this.flyout&&(o.setStartBlock(e),o.handleFlyoutStart(t,this.flyout))})),t.push(eC(e.getSvgRoot(),"pointermove",null,()=>{let t,i;(null==(t=this.flyout)||null==(i=t.targetWorkspace)?0:i.isDragging())||e.addSelect()})),t.push(eC(e.getSvgRoot(),"pointerleave",null,()=>{let t,i;(null==(t=this.flyout)||null==(i=t.targetWorkspace)?0:i.isDragging())||e.removeSelect()})),this.listeners.set(e.id,t)}filterFlyoutBasedOnCapacity(e){!this.flyout||e&&e.type!==rC.BLOCK_CREATE&&e.type!==rC.BLOCK_DELETE||this.flyout.getWorkspace().getTopBlocks(!1).forEach(e=>{this.permanentlyDisabledBlocks.has(e)||this.updateStateBasedOnCapacity(e)})}getType(){return d0}};ea(M.FLYOUT_INFLATER,d0,d1);var d2=class{constructor(){this.curNode=this.colour=null,this.type="marker"}getCurNode(){return this.curNode}setCurNode(e){this.curNode=e}dispose(){this.curNode=null}getSourceBlockFromNode(e){return e instanceof hR?e:e instanceof cl||e instanceof hi?e.getSourceBlock():null}getSourceBlock(){return this.getSourceBlockFromNode(this.getCurNode())}},d3=class extends d2{constructor(e){super(),this.workspace=e,this.type="cursor",this.potentialNodes=null}next(){var e=this.getCurNode();return e?((e=this.getNextNode(e,e=>{let t;return e instanceof hR&&!(null==(t=e.outputConnection)?0:t.targetBlock())},!0))&&this.setCurNode(e),e):null}in(){var e=this.getCurNode();return e?((e=this.getNextNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,e=>{let t;return e instanceof hR&&!(null==(t=e.outputConnection)?0:t.targetBlock())},!0))&&this.setCurNode(e),e):null}out(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}atEndOfLine(){var e=this.getCurNode();return!!e&&this.getNextNode(e,()=>!0,!0)===(e=this.getNextNode(e,e=>{let t;return e instanceof hR&&!(null==(t=e.outputConnection)?0:t.targetBlock())},!0))}getNextNodeImpl(e,t,i=new Set){if(!e||i.has(e))return null;let s=this.workspace.getNavigator().getFirstChild(e)||this.workspace.getNavigator().getNextSibling(e);for(var o=e;o&&!s&&(o=this.workspace.getNavigator().getParent(o));)s=this.workspace.getNavigator().getNextSibling(o);return t(s)?s:s?(i.add(e),this.getNextNodeImpl(s,t,i)):null}getNextNode(e,t,i){return e&&(i||this.getLastNode()!==e)?this.getNextNodeImpl(e,t):null}getPreviousNodeImpl(e,t,i=new Set){if(!e||i.has(e))return null;let s=this.getRightMostChild(this.workspace.getNavigator().getPreviousSibling(e),e)||this.workspace.getNavigator().getParent(e);return t(s)?s:s?(i.add(e),this.getPreviousNodeImpl(s,t,i)):null}getPreviousNode(e,t,i){return e&&(i||this.getFirstNode()!==e)?this.getPreviousNodeImpl(e,t):null}getRightMostChild(e,t){if(!e)return e;let i=this.workspace.getNavigator().getFirstChild(e);if(!i||i===t)return e;for(e=i;e&&e!==t;e=this.workspace.getNavigator().getNextSibling(i))i=e;return this.getRightMostChild(i,t)}preDelete(e){let t,i;var s,o=this.getCurNode();o=o?[o]:[];let n=null!=(i=null==(s=e.previousConnection)?void 0:s.targetConnection)?i:null==(t=e.outputConnection)?void 0:t.targetConnection;n&&o.push(n),(s=e.getNextBlock())&&o.push(s),(e=e.getParent())&&o.push(e),o.push(this.workspace),this.potentialNodes=o}postDelete(){let e=this.potentialNodes;if(this.potentialNodes=null,!e)throw Error("must call preDelete first");for(let t of e){let e;if(null==(e=this.getSourceBlockFromNode(t))||!e.disposed)return void this.setCurNode(t)}throw Error("no valid nodes in this.potentialNodes")}getCurNode(){let e=N.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode(),t=this.getSourceBlockFromNode(e);return t&&t.workspace===this.workspace&&this.setCurNode(e),super.getCurNode()}setCurNode(e){super.setCurNode(e),te(e)&&N.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e instanceof hR?e.workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof cl&&(e=e.getSourceBlock()).workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren())}getFirstNode(){return this.workspace.getNavigator().getFirstChild(this.workspace)}getLastNode(){let e=this.getFirstNode();return this.getPreviousNode(e,()=>!0,!0)}};ea(M.CURSOR,D,d3);var d5=class extends ud{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([`${e} .blocklyInsertionMarker>.blocklyPathLight,`,`${e} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},d6=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+"\n"+this.inlineSteps_}drawTopCorner(e){this.steps_+=oV(e.xPos,this.info_.startY);for(let t=0,i;i=e.elements[t];t++)h0.isLeftSquareCorner(i)?this.steps_+=this.highlightConstants_.START_POINT:h0.isLeftRoundedCorner(i)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):h0.isPreviousConnection(i)?this.steps_+=this.notchPaths_.pathLeft:h0.isHat(i)?this.steps_+=this.startPaths_.path(this.RTL_):h0.isSpacer(i)&&0!==i.width&&(this.steps_+=oY("H",i.xPos+i.width-this.highlightOffset));this.steps_+=oY("H",e.xPos+e.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+oY("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){let t=e.getLastInput();if(this.RTL_){let i=e.height-t.connectionHeight;this.steps_+=oW(t.xPos+t.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+oY("v",i)}else this.steps_+=oW(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){let t=e.getLastInput();if(t)if(this.RTL_){let i=e.height-2*this.insideCornerPaths_.height;this.steps_+=oW(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+oY("v",i)+this.insideCornerPaths_.pathBottom(this.RTL_)+oK(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=oW(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+oK(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){let t=e.xPos+e.width-this.highlightOffset;e instanceof ua&&e.followsStatement&&(this.steps_+=oY("H",t)),this.RTL_&&(this.steps_+=oY("H",t),e.height>this.highlightOffset&&(this.steps_+=oY("V",e.yPos+e.height-this.highlightOffset)))}drawBottomRow(e){if(this.RTL_)this.steps_+=oY("V",e.baseline-this.highlightOffset);else{let t=this.info_.bottomRow.elements[0];h0.isLeftSquareCorner(t)?this.steps_+=oW(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):h0.isLeftRoundedCorner(t)&&(this.steps_+=oW(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=oW(this.info_.startX,e):(this.steps_+=oW(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=oY("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,h0.isLeftRoundedCorner(e.elements[0])?this.steps_+=oY("V",this.outsideCornerPaths_.height):this.steps_+=oY("V",e.capline+this.highlightOffset))}drawInlineInput(e){let t=this.highlightOffset,i=e.xPos+e.connectionWidth;var s=e.centerline-e.height/2;let o=e.width-e.connectionWidth,n=s+t;this.RTL_?(s=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=oW(i-t,n)+oY("v",s)+this.puzzleTabPaths_.pathDown(this.RTL_)+oY("v",e)+oY("h",o)):this.inlineSteps_+=oW(e.xPos+e.width+t,n)+oY("v",e.height)+oY("h",-o)+oW(i,s+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},d4=class extends u_{constructor(e,t){super(e,t),this.highlighter_=new d6(t)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();let e=this.block_.pathObject;e.setPath(this.outlinePath_+"\n"+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=oY("H",e.xPos+e.width)+oY("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){let t=e.centerline-e.height/2;if(e.connectionModel){let i=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,t+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){let t=e.getLastInput();if(null==t?0:t.connectionModel){let i=e.xPos+e.statementEdge+t.notchOffset;i=this.info_.RTL?-1*i:i+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(i,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){let t=e.getLastInput();if(t&&t.connectionModel){let i=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e.yPos)}}positionNextConnection_(){let e=this.info_.bottomRow;if(e.connection){let t=e.connection,i=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-i:i)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},d8=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=oV(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){let e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,i=(1-Math.SQRT1_2)*(e+t)-t,s=oV(i,i)+oz("a","0 0,0",e,oU(-i-t,e-i)),o=oz("a","0 0,0",e+t,oU(e+t,e+t)),n=oV(i,-i)+oz("a","0 0,0",e+t,oU(e-i,i+t));return{width:e+t,height:e,pathTop:e=>e?s:"",pathBottom:e=>e?o:n}}makeOutsideCorner(){let e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,i=(1-Math.SQRT1_2)*(e-t)+t,s=oV(i,i)+oz("a","0 0,1",e-t,oU(e-i,-i+t)),o=oV(t,e)+oz("a","0 0,1",e-t,oU(e,-e+t)),n=-i,r=oV(i,n)+oz("a","0 0,1",e-t,oU(-i+t,-n-e));return{height:e,topLeft:e=>e?s:o,bottomLeft:()=>r}}makePuzzleTab(){let e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,i=oV(-2,-t+3.4)+oK(-.45*e,-2.1),s=oY("v",2.5)+oV(-(.97*e),2.5)+oH("q",[oU(-(.05*e),10),oU(.3*e,9.5)])+oV(.67*e,-1.9)+oY("v",2.5),o=oY("v",-1.5)+oV(-.92*e,-.5)+oH("q",[oU(-.19*e,-5.5),oU(0,-11)])+oV(.92*e,1),n=oV(-5,t-.7)+oK(.46*e,-2.1);return{width:e,height:t,pathUp:e=>e?i:o,pathDown:e=>e?s:n}}makeNotch(){return{pathLeft:oY("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:oK(5.1,2.6)+oV(-10.2,6.8)+oK(5.1,2.6),height:12,width:10.2}}makeStartHat(){let e=this.constantProvider.START_HAT.height,t=oV(25,-8.7)+oH("c",[oU(29.7,-6.2),oU(57.2,-.5),oU(75,8.7)]),i=oH("c",[oU(17.8,-9.2),oU(45.3,-14.9),oU(75,-8.7)])+oW(100.5,e+.5);return{path:e=>e?t:i}}},d9=class extends ut{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},d7=class extends uh{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},Ee=class extends uT{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof ha||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e instanceof N.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new d9(this.constants_,e)),t.hasInlineInput=!0):e instanceof ha?(t.elements.push(new d7(this.constants_,e)),t.hasStatement=!0):e instanceof N.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new h4(this.constants_,e)),t.hasExternalInput=!0):(e instanceof hr||e instanceof hl)&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),this.isInline||null!==t.align||(t.align=e.align)}addElemSpacing_(){let e=!1;for(let t=0,i;i=this.rows[t];t++)i.hasExternalInput&&(e=!0);for(let i=0,s;s=this.rows[i];i++){var t=s.elements;if(s.elements=[],s.startsWithElemSpacer()&&s.elements.push(new ue(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let e=0;e<t.length-1;e++){s.elements.push(t[e]);let i=this.getInRowSpacing_(t[e],t[e+1]);s.elements.push(new ue(this.constants_,i))}s.elements.push(t[t.length-1]),s.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&s.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),s.elements.push(new ue(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&h0.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&h0.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&h0.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!h0.isInput(e)&&(!t||h0.isStatementInput(t)))return h0.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:h0.isIcon(e)?2*this.constants_.LARGE_PADDING+1:h0.isHat(e)?this.constants_.NO_PADDING:h0.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:h0.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:h0.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(h0.isInput(e)&&!t){if(h0.isExternalInput(e))return this.constants_.NO_PADDING;if(h0.isInlineInput(e))return this.constants_.LARGE_PADDING;if(h0.isStatementInput(e))return this.constants_.NO_PADDING}if(!h0.isInput(e)&&t&&h0.isInput(t)){if(h0.isField(e)&&e.isEditable){if(h0.isInlineInput(t)||h0.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(h0.isInlineInput(t)||h0.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(h0.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(h0.isIcon(e)&&t&&!h0.isInput(t))return this.constants_.LARGE_PADDING;if(h0.isInlineInput(e)&&t&&h0.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(h0.isLeftSquareCorner(e)&&t){if(h0.isHat(t))return this.constants_.NO_PADDING;if(h0.isPreviousConnection(t))return t.notchOffset;if(h0.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(h0.isLeftRoundedCorner(e)&&t){if(h0.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(h0.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return h0.isField(e)&&t&&h0.isField(t)&&e.isEditable===t.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&h0.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return h0.isTopRow(e)&&h0.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:h0.isTopRow(e)||h0.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(h0.isSpacer(t))return e.yPos+t.height/2;if(h0.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,h0.isNextConnection(t)?e+t.height/2:e-t.height/2;if(h0.isTopRow(e))return h0.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let i=e.yPos;return h0.isField(t)||h0.isIcon(t)?(i+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(i+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):i=h0.isInlineInput(t)?i+t.height/2:i+e.height/2,i}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,i=null;for(let s=this.rows.length-1,o;o=this.rows[s];s--)t.set(o,e),h0.isInputRow(o)&&(o.hasStatement&&this.alignStatementRow_(o),i&&i.hasStatement&&o.width<i.width?t.set(o,i.width):e=o.hasStatement?o.width:Math.max(e,o.width),i=o);e=0;for(let s=0,o;o=this.rows[s];s++)o.hasStatement?e=this.getDesiredRowWidth_(o):h0.isSpacer(o)?o.width=Math.max(e,t.get(o)):(i=o.width,0<(e=Math.max(e,t.get(o))-i)&&this.addAlignmentPadding_(o,e),e=o.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let s=0,o;o=this.rows[s];s++){o.yPos=t,o.xPos=this.startX,t+=o.height,e=Math.max(e,o.widthWithConnectedBlocks);var i=t-this.topRow.ascenderHeight;o===this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(i=this.constants_.MIN_BLOCK_HEIGHT-i,this.bottomRow.height+=i,t+=i),this.recordElemPositions_(o)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,i.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},Et=class extends up{constructor(e,t,i){super(e,t,i),this.constants=i,this.colourDark="#000000",this.svgPathDark=eZ(r8.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=eZ(r8.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=sW("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){super.updateHighlighted(e),this.svgPathLight.style.display=e?"none":"inline"}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},Ei=class extends ug{constructor(e){super(e),this.highlightConstants=null}init(e,t){super.init(e,t),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,t,i){super.refreshDom(e,t,i),this.getHighlightConstants().init()}makeConstants_(){return new d5}makeRenderInfo_(e){return new Ee(this,e)}makeDrawer_(e,t){return new d4(e,t)}makePathObject(e,t){return new Et(e,t,this.getConstants())}makeHighlightConstants_(){return new d8(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};nL("geras",Ei);var Es={};Es.ConstantProvider=d5,Es.Drawer=d4,Es.HighlightConstantProvider=d8,Es.Highlighter=d6,Es.InlineInput=d9,Es.PathObject=Et,Es.RenderInfo=Ee,Es.Renderer=Ei,Es.StatementInput=d7;var Eo=class extends uT{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=!0;break}for(t=0;t<this.rows.length;t++){let s=this.rows[t];var i=s.elements;if(s.elements=[],s.startsWithElemSpacer()&&s.elements.push(new ue(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let e=0;e<i.length-1;e++){s.elements.push(i[e]);let t=this.getInRowSpacing_(i[e],i[e+1]);s.elements.push(new ue(this.constants_,t))}s.elements.push(i[i.length-1]),s.endsWithElemSpacer()&&(i=this.getInRowSpacing_(i[i.length-1],null),e&&s.hasDummyInput&&(i+=this.constants_.TAB_WIDTH),s.elements.push(new ue(this.constants_,i)))}}}getInRowSpacing_(e,t){if(!e)return t&&h0.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&h0.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&h0.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!h0.isInput(e)&&!t)return h0.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:h0.isIcon(e)?2*this.constants_.LARGE_PADDING+1:h0.isHat(e)?this.constants_.NO_PADDING:h0.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:h0.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:h0.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(h0.isInput(e)&&!t){if(h0.isExternalInput(e))return this.constants_.NO_PADDING;if(h0.isInlineInput(e))return this.constants_.LARGE_PADDING;if(h0.isStatementInput(e))return this.constants_.NO_PADDING}if(!h0.isInput(e)&&t&&h0.isInput(t)){if(h0.isField(e)&&e.isEditable){if(h0.isInlineInput(t)||h0.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(h0.isInlineInput(t)||h0.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(h0.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(h0.isIcon(e)&&t&&!h0.isInput(t))return this.constants_.LARGE_PADDING;if(h0.isInlineInput(e)&&t&&h0.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(h0.isLeftSquareCorner(e)&&t){if(h0.isHat(t))return this.constants_.NO_PADDING;if(h0.isPreviousConnection(t)||h0.isNextConnection(t))return t.notchOffset}return h0.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:h0.isField(e)&&t&&h0.isField(t)&&e.isEditable===t.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&h0.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return h0.isTopRow(e)&&h0.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:h0.isTopRow(e)||h0.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(h0.isSpacer(t))return e.yPos+t.height/2;if(h0.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,h0.isNextConnection(t)?e+t.height/2:e-t.height/2;if(h0.isTopRow(e))return h0.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let i=e.yPos;return h0.isField(t)&&e.hasStatement?i+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):i+e.height/2}finalize_(){let e=0,t=0;for(var i=0;i<this.rows.length;i++){let o=this.rows[i];o.yPos=t,o.xPos=this.startX,t+=o.height,e=Math.max(e,o.widthWithConnectedBlocks);var s=t-this.topRow.ascenderHeight;o===this.bottomRow&&s<this.constants_.MIN_BLOCK_HEIGHT&&(s=this.constants_.MIN_BLOCK_HEIGHT-s,this.bottomRow.height+=s,t+=s),this.recordElemPositions_(o)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,i.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},En=class extends ug{constructor(e){super(e)}makeRenderInfo_(e){return new Eo(this,e)}};nL("thrasos",En);var Er={};Er.RenderInfo=Eo,Er.Renderer=En;var El=new cz("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}}),Ea=class{constructor(e,t,i){this.id_=e.toolboxitemid||eD(),this.level_=(this.parent_=i||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}getFocusableElement(){let e=this.getDiv();if(!e)throw Error("Trying to access toolbox item before DOM is initialized.");if(!(e instanceof HTMLElement))throw Error("Toolbox item div is unexpectedly not an HTML element.");return e}getFocusableTree(){return this.parentToolbox_}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}},Ec=class extends Ea{constructor(e,t,i){super(e,t,i),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategoryContainer",row:"blocklyToolboxCategory",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyToolboxCategoryIcon",label:"blocklyToolboxCategoryLabel",contents:"blocklyToolboxCategoryGroup",selected:"blocklyToolboxSelected",openicon:"blocklyToolboxCategoryIconOpen",closedicon:"blocklyToolboxCategoryIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){let i=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(i)}}parseCategoryDef_(e){this.name_="name"in e?sY(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),t1(this.htmlDiv_,lv.TREEITEM),t2(this.htmlDiv_,aL.SELECTED,!1),t2(this.htmlDiv_,aL.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),t1(this.iconDom_,lv.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);let e=this.labelDom_.getAttribute("id");return e&&t2(this.htmlDiv_,aL.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){let e=document.createElement("div");e.tabIndex=-1,e.id=this.getId();let t=this.cssConfig_.container;return t&&eq(e,t),e}createRowContainer_(){let e=document.createElement("div");var t=this.cssConfig_.row;return t&&eq(e,t),t=`${Ec.nestedPadding*this.getLevel()}px`,this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){let e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&eq(e,t),e}createIconDom_(){let e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){let t=this.cssConfig_.icon;t&&eq(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){let t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&eq(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=Ec.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){let t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle(t);if(e)return this.parseColour(e)}return""}getColourfromStyle(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour(e){if(null==(e=sY(e))||""===e)return"";var t=Number(e);return isNaN(t)?(t=sF(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):sV(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&eQ(e,t),(t=this.cssConfig_.openicon)&&eq(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&eQ(e,t),(t=this.cssConfig_.closedicon)&&eq(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(!(e=e.getParent()).isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){let e=this.parseColour(Ec.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||e,t&&eq(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&e0(this.rowDiv_,t);t2(this.htmlDiv_,aL.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",`${e}`),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_="string"==typeof e?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:tF(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){e2(this.htmlDiv_)}};Ec.registrationName="category",Ec.nestedPadding=19,Ec.borderWidth=8,Ec.defaultBackgroundColour="#57e",tR('\n.blocklyToolboxCategory:not(.blocklyToolboxSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolbox[layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolbox[dir="RTL"][layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyToolboxCategory {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategory {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyToolboxCategoryIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategoryIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyToolboxCategoryLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyToolboxCategoryLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxSelected .blocklyToolboxCategoryLabel {\n  color: #fff;\n}\n'),ea(M.TOOLBOX_ITEM,Ec.registrationName,Ec);var Eh=class extends Ea{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){let e=document.createElement("div");e.tabIndex=-1,e.id=this.getId();let t=this.cssConfig_.container;return t&&eq(e,t),this.htmlDiv=e}getDiv(){return this.htmlDiv}dispose(){e2(this.htmlDiv)}};Eh.registrationName="sep",tR('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolbox[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n'),ea(M.TOOLBOX_ITEM,Eh.registrationName,Eh);var Eu=class extends Ec{constructor(e,t,i){super(e,t,i),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){let e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxCategoryGroup",e}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else{let t=e.contents;if(t){this.flyoutItems_=[],e=!0;for(let i=0;i<t.length;i++){let s=t[i];!ed(M.TOOLBOX_ITEM,s.kind)||s.kind.toLowerCase()===Eh.registrationName&&e?(this.flyoutItems_.push(s),e=!0):(this.createToolboxItem(s),e=!1)}}}}createToolboxItem(e){let t=e.kind;"CATEGORY"===t.toUpperCase()&&tU(e)&&(t=Eu.registrationName),e=new(eE(M.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded("true"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();let e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),t1(this.subcategoriesDiv_,lv.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),t2(this.htmlDiv_,aL.EXPANDED,!1),this.htmlDiv_}createIconDom_(){let e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){let t=this.cssConfig_.icon;t&&eq(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){let t=document.createElement("div");t.style.display="none";var i=this.cssConfig_.contents;for(i&&eq(t,i),i=0;i<e.length;i++){let s=e[i];s.init();let o=s.getDiv();if(t.appendChild(o),s.getClickTarget){let e;null==(e=s.getClickTarget())||e.setAttribute("id",s.getId())}}return t}setExpanded(e){if(this.expanded_!==e){if(this.expanded_=e)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let e;null==(e=this.parentToolbox_.getFlyout())||e.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}t2(this.htmlDiv_,aL.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";let t=this.getChildToolboxItems();for(let i=0;i<t.length;i++)t[i].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};Eu.registrationName="collapsibleCategory",ea(M.TOOLBOX_ITEM,Eu.registrationName,Eu);var Ed=class extends hO{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.height_=this.width_=0,this.flyout=null,this.contents=new Map,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout=e.options.horizontalLayout,this.RTL=e.options.RTL,this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_;let t=e.getParentSvg();this.flyout=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_);let i=this.flyout.createDom("svg");eq(i,"blocklyToolboxFlyout"),e3(i,t),this.setVisible(!0),this.flyout.init(e),this.render(this.toolboxDef_),(e=e.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:r0.ComponentWeight.TOOLBOX_WEIGHT,capabilities:[r0.Capability.AUTOHIDEABLE,r0.Capability.DELETE_AREA,r0.Capability.DRAG_TARGET]}),N.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!0)}createDom_(e){e=e.getParentSvg();let t=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),t1(this.contentsDiv_,lv.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){let e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),eq(e,"blocklyToolbox"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){let e=document.createElement("div");return eq(e,"blocklyToolboxCategoryGroup"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=eS(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),t=eS(t,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(t)}onClick_(e){if(eN(e)||e.target===this.HtmlDiv)tl().hideChaff(!1);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t)).isSelectable()&&(this.setSelectedItem(t),t.onClick(e)),tl().hideChaff(!0)}eR()}onKeyDown_(e){let t=!1;switch(e.key){case"ArrowDown":t=this.selectNext();break;case"ArrowUp":t=this.selectPrevious();break;case"ArrowLeft":t=this.selectParent();break;case"ArrowRight":t=this.selectChild();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=!0);break;default:t=!1}!t&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(t=this.selectedItem_.onKeyDown(e)),t&&e.preventDefault()}createFlyout_(){let e=this.workspace_,t=e.copyOptionsForFlyout();return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?ep(M.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,!0):ep(M.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(t)}render(e){this.toolboxDef_=e,this.contents.forEach(e=>e.dispose()),this.contents.clear(),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){let t=document.createDocumentFragment();for(let i=0;i<e.length;i++)this.createToolboxItem(e[i],t);this.contentsDiv_.appendChild(t)}createToolboxItem(e,t){var i=e.kind;"CATEGORY"===i.toUpperCase()&&tU(e)&&(i=Eu.registrationName),(i=eE(M.TOOLBOX_ITEM,i.toLowerCase()))&&((e=new i(e,this)).init(),this.addToolboxItem_(e),(i=e.getDiv())&&t.appendChild(i),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents.set(e.getId(),e),e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return[...this.contents.values()]}addStyle(e){e&&this.HtmlDiv&&eq(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&e0(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();let t=e.top,i=t+e.height,s=e.left;return e=s+e.width,this.toolboxPosition===lp.TOP?new r9(-1e7,i,-1e7,1e7):this.toolboxPosition===lp.BOTTOM?new r9(t,1e7,-1e7,1e7):this.toolboxPosition===lp.LEFT?new r9(-1e7,1e7,-1e7,e):new r9(-1e7,1e7,s,1e7)}wouldDelete(e){return e instanceof hR?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(ni(e)&&e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){let t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contents.get(e)||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout}position(){let e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===lp.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===lp.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout.position())}handleToolboxItemResize(){let e=this.workspace_;var t=this.HtmlDiv.getBoundingClientRect();let i=this.getFlyout(),s=this.toolboxPosition===lp.LEFT?e.scrollX+t.width+((null==i?0:i.isVisible())?i.getWidth():0):e.scrollX;t=this.toolboxPosition===lp.TOP?e.scrollY+t.height+((null==i?0:i.isVisible())?i.getHeight():0):e.scrollY,e.translate(s,t),tE(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){this.contents.forEach(e=>{e.refreshTheme&&e.refreshTheme()})}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.flyout.autoClose&&this.clearSelection()}setSelectedItem(e){let t=this.selectedItem_;(e||t)&&(!e||e.isSelectable())&&(this.shouldDeselectItem_(t,e)&&null!==t&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&null!==e&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent(t,e))}shouldDeselectItem_(e,t){return null!==e&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return null!==t&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),t2(this.contentsDiv_,aL.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(!0),t2(this.contentsDiv_,aL.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){(e=this.getToolboxItems()[e])&&this.setSelectedItem(e)}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout.show(t.getContents()),this.flyout.scrollToStart()):this.flyout.hide()}fireSelectEvent(e,t){let i=e&&e.getName(),s=t&&t.getName();e===t&&(s=null),eU(e=new(ej(rC.TOOLBOX_ITEM_SELECT))(i,s,this.workspace_.id))}selectParent(){return!!this.selectedItem_&&(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):!!(this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable())&&(this.setSelectedItem(this.selectedItem_.getParent()),!0))}selectChild(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;let e=this.selectedItem_;return e.isExpanded()?this.selectNext():e.toggleExpanded(),!0}selectNext(){if(!this.selectedItem_)return!1;let e=[...this.contents.values()],t=e.indexOf(this.selectedItem_)+1;if(-1<t&&t<e.length){let i=e[t];for(;i&&!i.isSelectable();)i=e[++t];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}selectPrevious(){if(!this.selectedItem_)return!1;let e=[...this.contents.values()],t=e.indexOf(this.selectedItem_)-1;if(-1<t&&t<e.length){let i=e[t];for(;i&&!i.isSelectable();)i=e[--t];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout.dispose(),this.contents.forEach(e=>e.dispose());for(let e=0;e<this.boundEvents_.length;e++)ef(this.boundEvents_[e]);this.boundEvents_=[],this.contents.clear(),this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),e2(this.HtmlDiv)),N.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}getFocusableElement(){if(!this.HtmlDiv)throw Error("Toolbox DOM has not yet been created.");return this.HtmlDiv}getFocusableTree(){return this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){if(!e||e===this){let e;return null!=(e=this.getToolboxItems().find(e=>e.isSelectable()))?e:null}return null}getNestedTrees(){return[]}lookUpFocusableNode(e){return this.getToolboxItemById(e)}onTreeFocus(e,t){e!==this?this.getSelectedItem()!==e&&this.setSelectedItem(e):this.clearSelection()}onTreeBlur(e){let t;e&&e===(null==(t=this.flyout)?void 0:t.getWorkspace())||(this.clearSelection(),this.flyout&&nl(this.flyout)&&this.flyout.autoHide(!1))}};tR('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolbox {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxCategoryGroup {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxCategoryGroup:focus {\n  outline: none;\n}\n'),ea(M.TOOLBOX,D,Ed);var EE=cX.INPUT_VALUE,E_=cX.OUTPUT_VALUE,ET=cX.NEXT_STATEMENT,Ep=cX.PREVIOUS_STATEMENT,Eg=lp.TOP,EI=lp.BOTTOM,ER=lp.LEFT,Em=lp.RIGHT;uS.prototype.newBlock=function(e,t){return new hc(this,e,t)},uf.prototype.newBlock=function(e,t){return new hR(this,e,t)},uS.prototype.newComment=function(e){return new cD(this,e)},uf.prototype.newComment=function(e){return new cM(this,e)},uf.newTrashcan=function(e){return new uk(e)},cQ.prototype.newWorkspaceSvg=function(e){return new uf(e)},N.Names$$module$build$src$core$names.prototype.populateProcedures=function(e){e=(e=nu(e))[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],N.Names$$module$build$src$core$names.NameType.PROCEDURE)};var EO={};return EO.Block=hc,EO.BlockFlyoutInflater=d1,EO.BlockNavigationPolicy=hD,EO.BlockSvg=hR,EO.Blocks=y,EO.ButtonFlyoutInflater=dq,EO.COLLAPSED_FIELD_NAME=lV,EO.COLLAPSED_INPUT_NAME=lW,EO.COLLAPSE_CHARS=30,EO.CodeGenerator=N.CodeGenerator$$module$build$src$core$generator,EO.CollapsibleToolboxCategory=Eu,EO.ComponentManager=r0,EO.Connection=c6,EO.ConnectionChecker=uA,EO.ConnectionDB=cB,EO.ConnectionNavigationPolicy=hP,EO.ConnectionType=cX,EO.ContextMenu=cA,EO.ContextMenuItems=dj,EO.ContextMenuRegistry=cS,EO.Css=r6,EO.DELETE_VARIABLE_ID=ht,EO.DeleteArea=hO,EO.DragTarget=hm,EO.DropDownDiv=aY,EO.Events=L,EO.Extensions=c2,EO.Field=cl,EO.FieldCheckbox=dR,EO.FieldDropdown=cH,EO.FieldImage=dt,EO.FieldLabel=c9,EO.FieldLabelSerializable=dI,EO.FieldNavigationPolicy=hy,EO.FieldNumber=dg,EO.FieldTextInput=N.FieldTextInput$$module$build$src$core$field_textinput,EO.FieldVariable=dp,EO.Flyout=hx,EO.FlyoutButton=hf,EO.FlyoutButtonNavigationPolicy=hL,EO.FlyoutItem=hA,EO.FlyoutMetricsManager=hC,EO.FlyoutNavigationPolicy=hN,EO.FlyoutNavigator=hB,EO.FlyoutSeparator=hb,EO.FlyoutSeparatorNavigationPolicy=h$,EO.FocusManager=rw,EO.FocusableTreeTraverser=ry,EO.Generator=N.CodeGenerator$$module$build$src$core$generator,EO.Gesture=hK,EO.Grid=hX,EO.HorizontalFlyout=dT,EO.INPUT_VALUE=EE,EO.Input=hn,EO.InsertionMarkerPreviewer=du,EO.KeyboardNavigationController=hU,EO.LabelFlyoutInflater=u9,EO.LineCursor=d3,EO.Marker=d2,EO.MarkerManager=hz,EO.Menu=lU,EO.MenuItem=lx,EO.MetricsManager=hS,EO.Msg=N.Msg$$module$build$src$core$msg,EO.NEXT_STATEMENT=ET,EO.Names=N.Names$$module$build$src$core$names,EO.Navigator=hv,EO.OPPOSITE_TYPE=c7,EO.OUTPUT_VALUE=E_,EO.Options=cJ,EO.PREVIOUS_STATEMENT=Ep,EO.PROCEDURE_CATEGORY_NAME=dM,EO.Procedures=dP,EO.RENAME_VARIABLE_ID=he,EO.RenderedConnection=hi,EO.Scrollbar=ln,EO.ScrollbarPair=hG,EO.SeparatorFlyoutInflater=hF,EO.ShortcutItems=u1,EO.ShortcutRegistry=rG,EO.TOOLBOX_AT_BOTTOM=EI,EO.TOOLBOX_AT_LEFT=ER,EO.TOOLBOX_AT_RIGHT=Em,EO.TOOLBOX_AT_TOP=Eg,EO.Theme=cz,EO.ThemeManager=uR,EO.Themes={Classic:cj,Zelos:El},EO.Toast=l2,EO.Toolbox=Ed,EO.ToolboxCategory=Ec,EO.ToolboxItem=Ea,EO.ToolboxSeparator=Eh,EO.Tooltip=ct,EO.Touch=F,EO.Trashcan=uk,EO.UnattachedFieldError=ca,EO.VARIABLE_CATEGORY_NAME=an,EO.VARIABLE_DYNAMIC_CATEGORY_NAME=um,EO.VERSION="12.1.0",EO.VariableMap=uP,EO.VariableModel=u$,EO.Variables=aa,EO.VariablesDynamic=uO,EO.VerticalFlyout=d_,EO.WidgetDiv=cI,EO.Workspace=uS,EO.WorkspaceAudio=uC,EO.WorkspaceDragger=hV,EO.WorkspaceNavigationPolicy=hw,EO.WorkspaceSvg=uf,EO.Xml=cP,EO.ZoomControls=lS,EO.blockAnimations=hd,EO.blockRendering=uI,EO.browserEvents=Y,EO.bubbles=dQ,EO.bumpObjects=hT,EO.clipboard=uZ,EO.comments=dJ,EO.common=rX,EO.config=N.config$$module$build$src$core$config,EO.constants={COLLAPSED_FIELD_NAME:lV,COLLAPSED_INPUT_NAME:lW,MANUALLY_DISABLED:lK},EO.defineBlocksWithJsonArray=tp,EO.dialog=at,EO.dragging=dO,EO.fieldRegistry=cU,EO.geras=Es,EO.getFocusManager=N.getFocusManager$$module$build$src$core$focus_manager,EO.getMainWorkspace=tl,EO.getSelected=tc,EO.hasBubble=i1,EO.hideChaff=function(e){tl().hideChaff(e)},EO.icons=hq,EO.inject=function(e,t){var i;let s=null;if(s="string"==typeof e?document.getElementById(e)||document.querySelector(e):e,!document.contains(s)&&document!==(null==(i=s)?void 0:i.ownerDocument))throw Error("Error: container is not in current document");e=new cJ(t||{}),eq(i=document.createElement("div"),"injectionDiv"),(null==t?0:t.rtl)&&eq(i,"blocklyRTL"),s.appendChild(i),t=nj(i,e);let o=nJ(i,t,e);return nZ(o),ta(o),tE(o),i.addEventListener("focusin",function(){ta(o)}),eS(i,"keydown",null,tg),o},EO.inputs=dd,EO.isCopyable=nB,EO.isDeletable=ni,EO.isDraggable=nr,EO.isIcon=oq,EO.isObservable=nh,EO.isPaster=function(e){return void 0!==e.paste},EO.isRenderedElement=function(e){return void 0!==e.getSvgRoot},EO.isSelectable=tt,EO.isSerializable=t3,EO.isVariableBackedParameterModel=ic,EO.keyboardNavigationController=hH,EO.layers={BLOCK:50,BUBBLE:100},EO.navigateBlock=nn,EO.navigateStacks=no,EO.procedures=dP,EO.registry=P,EO.renderManagement=lq,EO.serialization={blocks:ag,exceptions:aT,priorities:{BLOCKS:50,PROCEDURES:75,VARIABLES:100,WORKSPACE_COMMENTS:25},procedures:u3,registry:lC,variables:u6,workspaceComments:lL,workspaces:u4},EO.setLocale=aN,EO.setParentContainer=td,EO.svgResize=tE,EO.thrasos=Er,EO.uiPosition=lO,EO.utils=c5,EO.zelos=dz,EO.__namespace__=N,EO},"function"==typeof define&&define.amd?define([],s):e.exports=s()}),u("cWmWX",function(e,t){var i,s;e.exports,s=function(){var e=e||{Msg:Object.create(null)};return e.Msg.ABORT_MOVE="Abort move",e.Msg.ADD_COMMENT="Add Comment",e.Msg.ALT_KEY="Alt",e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",e.Msg.CHANGE_VALUE_TITLE="Change value:",e.Msg.CHROME_OS="ChromeOS",e.Msg.CLEAN_UP="Clean up Blocks",e.Msg.CLOSE="Close",e.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",e.Msg.COLLAPSE_ALL="Collapse Blocks",e.Msg.COLLAPSE_BLOCK="Collapse Block",e.Msg.COLOUR_BLEND_COLOUR1="colour 1",e.Msg.COLOUR_BLEND_COLOUR2="colour 2",e.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",e.Msg.COLOUR_BLEND_RATIO="ratio",e.Msg.COLOUR_BLEND_TITLE="blend",e.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",e.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",e.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",e.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",e.Msg.COLOUR_RANDOM_TITLE="random colour",e.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",e.Msg.COLOUR_RGB_BLUE="blue",e.Msg.COLOUR_RGB_GREEN="green",e.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",e.Msg.COLOUR_RGB_RED="red",e.Msg.COLOUR_RGB_TITLE="colour with",e.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",e.Msg.COMMAND_KEY="⌘ Command",e.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",e.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",e.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",e.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",e.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",e.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",e.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",e.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",e.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",e.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",e.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",e.Msg.CONTROLS_IF_MSG_ELSE="else",e.Msg.CONTROLS_IF_MSG_ELSEIF="else if",e.Msg.CONTROLS_IF_MSG_IF="if",e.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",e.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",e.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",e.Msg.CONTROLS_REPEAT_INPUT_DO="do",e.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",e.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",e.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",e.Msg.CONTROL_KEY="Ctrl",e.Msg.COPY_SHORTCUT="Copy (%1)",e.Msg.CUT_SHORTCUT="Cut (%1)",e.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",e.Msg.DELETE_BLOCK="Delete Block",e.Msg.DELETE_KEY="Del",e.Msg.DELETE_SHORTCUT="Delete block (%1)",e.Msg.DELETE_VARIABLE="Delete the '%1' variable",e.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",e.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",e.Msg.DIALOG_CANCEL="Cancel",e.Msg.DIALOG_OK="OK",e.Msg.DISABLE_BLOCK="Disable Block",e.Msg.DUPLICATE_BLOCK="Duplicate",e.Msg.DUPLICATE_COMMENT="Duplicate Comment",e.Msg.EDIT_BLOCK_CONTENTS="Edit Block contents (%1)",e.Msg.ENABLE_BLOCK="Enable Block",e.Msg.EXPAND_ALL="Expand Blocks",e.Msg.EXPAND_BLOCK="Expand Block",e.Msg.EXTERNAL_INPUTS="External Inputs",e.Msg.FINISH_MOVE="Finish move",e.Msg.HELP="Help",e.Msg.HELP_PROMPT="Press %1 for help on keyboard controls",e.Msg.INLINE_INPUTS="Inline Inputs",e.Msg.INSERT_BLOCK="Insert Block (%1)",e.Msg.LINUX="Linux",e.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",e.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",e.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",e.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",e.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",e.Msg.LISTS_GET_INDEX_FIRST="first",e.Msg.LISTS_GET_INDEX_FROM_END="# from end",e.Msg.LISTS_GET_INDEX_FROM_START="#",e.Msg.LISTS_GET_INDEX_GET="get",e.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",e.Msg.LISTS_GET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",e.Msg.LISTS_GET_INDEX_LAST="last",e.Msg.LISTS_GET_INDEX_RANDOM="random",e.Msg.LISTS_GET_INDEX_REMOVE="remove",e.Msg.LISTS_GET_INDEX_TAIL="",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",e.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",e.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",e.Msg.LISTS_GET_SUBLIST_END_LAST="to last",e.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",e.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",e.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",e.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",e.Msg.LISTS_GET_SUBLIST_TAIL="",e.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",e.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",e.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",e.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",e.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#finding-items-in-a-list",e.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",e.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",e.Msg.LISTS_INLIST="in list",e.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",e.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",e.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",e.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",e.Msg.LISTS_LENGTH_TITLE="length of %1",e.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",e.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",e.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",e.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",e.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",e.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",e.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",e.Msg.LISTS_SET_INDEX_INPUT_TO="as",e.Msg.LISTS_SET_INDEX_INSERT="insert at",e.Msg.LISTS_SET_INDEX_SET="set",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",e.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",e.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",e.Msg.LISTS_SORT_ORDER_DESCENDING="descending",e.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",e.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",e.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",e.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",e.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",e.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",e.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",e.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",e.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",e.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",e.Msg.LOGIC_BOOLEAN_FALSE="false",e.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",e.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",e.Msg.LOGIC_BOOLEAN_TRUE="true",e.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",e.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",e.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",e.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",e.Msg.LOGIC_NEGATE_TITLE="not %1",e.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",e.Msg.LOGIC_NULL="null",e.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",e.Msg.LOGIC_NULL_TOOLTIP="Returns null.",e.Msg.LOGIC_OPERATION_AND="and",e.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",e.Msg.LOGIC_OPERATION_OR="or",e.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",e.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",e.Msg.LOGIC_TERNARY_CONDITION="test",e.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",e.Msg.LOGIC_TERNARY_IF_FALSE="if false",e.Msg.LOGIC_TERNARY_IF_TRUE="if true",e.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",e.Msg.MAC_OS="macOS",e.Msg.MATH_ADDITION_SYMBOL="+",e.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",e.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",e.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",e.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",e.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",e.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",e.Msg.MATH_CHANGE_TITLE="change %1 by %2",e.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",e.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",e.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: π (3.141…), e (2.718…), φ (1.618…), sqrt(2) (1.414…), sqrt(½) (0.707…), or ∞ (infinity).",e.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",e.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",e.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",e.Msg.MATH_DIVISION_SYMBOL="÷",e.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",e.Msg.MATH_IS_EVEN="is even",e.Msg.MATH_IS_NEGATIVE="is negative",e.Msg.MATH_IS_ODD="is odd",e.Msg.MATH_IS_POSITIVE="is positive",e.Msg.MATH_IS_PRIME="is prime",e.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",e.Msg.MATH_IS_WHOLE="is whole",e.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",e.Msg.MATH_MODULO_TITLE="remainder of %1 ÷ %2",e.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",e.Msg.MATH_MULTIPLICATION_SYMBOL="×",e.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",e.Msg.MATH_NUMBER_TOOLTIP="A number.",e.Msg.MATH_ONLIST_HELPURL="",e.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",e.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",e.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",e.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",e.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",e.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",e.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",e.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",e.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",e.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",e.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",e.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",e.Msg.MATH_POWER_SYMBOL="^",e.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",e.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",e.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",e.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",e.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",e.Msg.MATH_ROUND_OPERATOR_ROUND="round",e.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",e.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",e.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",e.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",e.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",e.Msg.MATH_SINGLE_OP_ROOT="square root",e.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",e.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",e.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",e.Msg.MATH_SUBTRACTION_SYMBOL="-",e.Msg.MATH_TRIG_ACOS="acos",e.Msg.MATH_TRIG_ASIN="asin",e.Msg.MATH_TRIG_ATAN="atan",e.Msg.MATH_TRIG_COS="cos",e.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",e.Msg.MATH_TRIG_SIN="sin",e.Msg.MATH_TRIG_TAN="tan",e.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",e.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",e.Msg.MOVE_BLOCK="Move Block (%1)",e.Msg.MOVE_DOWN_CONSTRAINED="Move down constrained",e.Msg.MOVE_DOWN_UNCONSTRAINED="Move down, unconstrained",e.Msg.MOVE_LEFT_CONSTRAINED="Move left, constrained",e.Msg.MOVE_LEFT_UNCONSTRAINED="Move left, unconstrained",e.Msg.MOVE_RIGHT_CONSTRAINED="Move right constrained",e.Msg.MOVE_RIGHT_UNCONSTRAINED="Move right, unconstrained",e.Msg.MOVE_UP_CONSTRAINED="Move up, constrained",e.Msg.MOVE_UP_UNCONSTRAINED="Move up unconstrained",e.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",e.Msg.NEW_NUMBER_VARIABLE="Create number variable...",e.Msg.NEW_STRING_VARIABLE="Create string variable...",e.Msg.NEW_VARIABLE="Create variable...",e.Msg.NEW_VARIABLE_TITLE="New variable name:",e.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",e.Msg.OPTION_KEY="⌥ Option",e.Msg.ORDINAL_NUMBER_SUFFIX="",e.Msg.PASTE_SHORTCUT="Paste (%1)",e.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",e.Msg.PROCEDURES_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",e.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",e.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALL_DISABLED_DEF_WARNING="Can't run the user-defined function '%1' because the definition block is disabled.",e.Msg.PROCEDURES_CREATE_DO="Create '%1'",e.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",e.Msg.PROCEDURES_DEFNORETURN_DO="",e.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",e.Msg.PROCEDURES_DEFNORETURN_TITLE="to",e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",e.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFRETURN_RETURN="return",e.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",e.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",e.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",e.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",e.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",e.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",e.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",e.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",e.Msg.REDO="Redo",e.Msg.REMOVE_COMMENT="Remove Comment",e.Msg.RENAME_VARIABLE="Rename variable...",e.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",e.Msg.SHORTCUTS_CODE_NAVIGATION="Code navigation",e.Msg.SHORTCUTS_EDITING="Editing",e.Msg.SHORTCUTS_GENERAL="General",e.Msg.START_MOVE="Start move",e.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_APPEND_TITLE="to %1 append text %2",e.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",e.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",e.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",e.Msg.TEXT_CHARAT_FIRST="get first letter",e.Msg.TEXT_CHARAT_FROM_END="get letter # from end",e.Msg.TEXT_CHARAT_FROM_START="get letter #",e.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",e.Msg.TEXT_CHARAT_LAST="get last letter",e.Msg.TEXT_CHARAT_RANDOM="get random letter",e.Msg.TEXT_CHARAT_TAIL="",e.Msg.TEXT_CHARAT_TITLE="in text %1 %2",e.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",e.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",e.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",e.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",e.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",e.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",e.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",e.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",e.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",e.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",e.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",e.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",e.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",e.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",e.Msg.TEXT_GET_SUBSTRING_TAIL="",e.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",e.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",e.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",e.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",e.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",e.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",e.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",e.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",e.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",e.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",e.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",e.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",e.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_LENGTH_TITLE="length of %1",e.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",e.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",e.Msg.TEXT_PRINT_TITLE="print %1",e.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",e.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",e.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",e.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",e.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",e.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",e.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",e.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",e.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",e.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",e.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",e.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",e.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",e.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",e.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",e.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",e.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",e.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",e.Msg.TODAY="Today",e.Msg.UNDO="Undo",e.Msg.UNKNOWN="Unknown",e.Msg.UNNAMED_KEY="unnamed",e.Msg.VARIABLES_DEFAULT_NAME="item",e.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",e.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",e.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",e.Msg.VARIABLES_SET="set %1 to %2",e.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",e.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",e.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",e.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER="A variable named '%1' already exists as a parameter in the procedure '%2'.",e.Msg.WINDOWS="Windows",e.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",e.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",e.Msg.CONTROLS_FOREACH_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_FOR_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=e.Msg.CONTROLS_IF_MSG_ELSEIF,e.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=e.Msg.CONTROLS_IF_MSG_ELSE,e.Msg.CONTROLS_IF_IF_TITLE_IF=e.Msg.CONTROLS_IF_MSG_IF,e.Msg.CONTROLS_IF_MSG_THEN=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.LISTS_CREATE_WITH_ITEM_TITLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.LISTS_GET_INDEX_HELPURL=e.Msg.LISTS_INDEX_OF_HELPURL,e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.MATH_CHANGE_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.PROCEDURES_DEFRETURN_COMMENT=e.Msg.PROCEDURES_DEFNORETURN_COMMENT,e.Msg.PROCEDURES_DEFRETURN_DO=e.Msg.PROCEDURES_DEFNORETURN_DO,e.Msg.PROCEDURES_DEFRETURN_PROCEDURE=e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,e.Msg.PROCEDURES_DEFRETURN_TITLE=e.Msg.PROCEDURES_DEFNORETURN_TITLE,e.Msg.TEXT_APPEND_VARIABLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.MATH_HUE="230",e.Msg.LOOPS_HUE="120",e.Msg.LISTS_HUE="260",e.Msg.LOGIC_HUE="210",e.Msg.VARIABLES_HUE="330",e.Msg.TEXTS_HUE="160",e.Msg.PROCEDURES_HUE="290",e.Msg.COLOUR_HUE="20",e.Msg.VARIABLES_DYNAMIC_HUE="310",e.Msg},"function"==typeof define&&define.amd?define([],s):e.exports=s()}),u("94GXq",function(e,t){e.exports=h("34v67")}),u("34v67",function(e,t){var i,s;e.exports,s=function(e){var t=e.__namespace__,i=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]);t.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",{customContextMenu:function(e){if(this.isInFlyout){var i,s;("variables_get_dynamic"===this.type||"variables_get_reporter_dynamic"===this.type)&&(n={text:t.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:(i=this,function(){let e=i.workspace,s=i.getField("VAR").getVariable();t.renameVariable$$module$build$src$core$variables(e,s)})},r=this.getField("VAR").getText(),r={text:t.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",r),enabled:!0,callback:(s=this,function(){let e=s.getField("VAR").getVariable();e&&t.deleteVariable$$module$build$src$core$variables(e.getWorkspace(),e,s)})},e.unshift(n),e.unshift(r))}else{if("variables_get_dynamic"===this.type)var o="variables_set_dynamic",n=t.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else o="variables_get_dynamic",n=t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var r=this.getField("VAR");o={type:o,fields:{VAR:r.saveState(!0)}},e.push({enabled:0<this.workspace.remainingCapacity(),text:n.replace("%1",r.getText()),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,o)})}},onchange:function(e){e=this.getFieldValue("VAR"),e=t.getVariable$$module$build$src$core$variables(this.workspace,e),"variables_get_dynamic"===this.type?this.outputConnection.setCheck(e.getType()):this.getInput("VALUE").connection.setCheck(e.getType())}}),t.defineBlocks$$module$build$src$core$common(i);var s=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]);t.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",{customContextMenu:function(e){if(this.isInFlyout){var i,s;("variables_get"===this.type||"variables_get_reporter"===this.type)&&(n={text:t.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:(i=this,function(){let e=i.workspace,s=i.getField("VAR").getVariable();t.renameVariable$$module$build$src$core$variables(e,s)})},r=this.getField("VAR").getText(),r={text:t.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",r),enabled:!0,callback:(s=this,function(){let e=s.getField("VAR").getVariable();e&&t.deleteVariable$$module$build$src$core$variables(e.getWorkspace(),e,s)})},e.unshift(n),e.unshift(r))}else{if("variables_get"===this.type)var o="variables_set",n=t.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else o="variables_get",n=t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var r=this.getField("VAR");o={type:o,fields:{VAR:r.saveState(!0)}},e.push({enabled:0<this.workspace.remainingCapacity(),text:n.replace("%1",r.getText()),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,o)})}}}),t.defineBlocks$$module$build$src$core$common(s);var o=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]);o.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT);let e=e=>{let i=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+e]});return i.setValidator(function(t){let i=this.getValue();(t="FROM_START"===t||"FROM_END"===t)!=("FROM_START"===i||"FROM_END"===i)&&this.getSourceBlock().updateAt_(e,t)}),i};this.appendDummyInput("WHERE1_INPUT").appendField(e(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(e(2),"WHERE2"),this.appendDummyInput("AT2"),t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation");var i=this.getInput("AT1")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1",`${i}`),i=this.getInput("AT2")instanceof t.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2",`${i}`),e},domToMutation:function(e){let t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},updateAt_:function(e,i){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),i?(this.appendValueInput("AT"+e).setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e),2===e&&t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL)),1===e&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT"))}},o.text_changeCase={init:function(){let e=[[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},o.text_trim={init:function(){let e=[[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[t.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(t.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},o.text_print={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var n={updateType_:function(e){this.outputConnection.setCheck("NUMBER"===e?"Number":"String")},mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("type",this.getFieldValue("TYPE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("type"))}};o.text_prompt_ext=Object.assign({},n,{init:function(){var e=[[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator(e=>{this.updateType_(e)}),this.appendValueInput("TEXT").appendField(e,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),o.text_prompt=Object.assign({},n,{init:function(){this.mixin(r);var e=[[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(t.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator(e=>{this.updateType_(e)}),this.appendDummyInput().appendField(e,"TYPE").appendField(this.newQuote_(!0)).appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:t.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),o.text_count={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},o.text_replace={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},o.text_reverse={init:function(){this.jsonInit({message0:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:t.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var r={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(e){for(let t=0,i;i=this.inputList[t];t++)for(let t=0,s;s=i.fieldRow[t];t++)if(e===s.name){i.insertFieldAt(t,this.newQuote_(!0)),i.insertFieldAt(t+2,this.newQuote_(!1));return}console.warn('field named "'+e+'" not found in '+this.toDevString())},newQuote_:function(e){return e=this.RTL?!e:e,t.fromJson$$module$build$src$core$field_registry({type:"field_image",src:e?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:e?"“":"”"})}};t.register$$module$build$src$core$extensions("text_append_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR")),t.register$$module$build$src$core$extensions("text_indexOf_tooltip",function(){this.setTooltip(()=>t.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}),t.register$$module$build$src$core$extensions("text_quotes",function(){this.mixin(r),this.quoteField_("TEXT")}),t.registerMixin$$module$build$src$core$extensions("quote_image_mixin",r),t.registerMutator$$module$build$src$core$extensions("text_join_mutator",{itemCount_:0,mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items",`${this.itemCount_}`),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(e){let t=e.newBlock("text_create_join_container");t.initSvg();let i=t.getInput("STACK").connection;for(let t=0;t<this.itemCount_;t++){let t=e.newBlock("text_create_join_item");t.initSvg(),i.connect(t.previousConnection),i=t.nextConnection}return t},compose:function(e){var t=e.getInputTargetBlock("STACK");for(e=[];t;)t.isInsertionMarker()||e.push(t.valueConnection_),t=t.getNextBlock();for(t=0;t<this.itemCount_;t++){let i=this.getInput("ADD"+t).connection.targetConnection;i&&!e.includes(i)&&i.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),t=0;t<this.itemCount_;t++){let i;null==(i=e[t])||i.reconnect(this,"ADD"+t)}},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){if(e.isInsertionMarker()){e=e.getNextBlock();continue}let i=this.getInput("ADD"+t);e.valueConnection_=i&&i.connection.targetConnection,e=e.getNextBlock(),t++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var e=0;e<this.itemCount_;e++)if(!this.getInput("ADD"+e)){let i=this.appendValueInput("ADD"+e).setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT);0===e&&i.appendField(t.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(e=this.itemCount_;this.getInput("ADD"+e);e++)this.removeInput("ADD"+e)}},function(){this.mixin(r),this.itemCount_=2,this.updateShape_(),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))}),t.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",{isAt_:!1,mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("at",`${this.isAt_}`),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},updateAt_:function(e){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),e&&(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=e}},function(){this.getField("WHERE").setValidator(function(e){e="FROM_START"===e||"FROM_END"===e;let t=this.getSourceBlock();e!==t.isAt_&&t.updateAt_(e)}),this.updateAt_(!0),this.setTooltip(()=>{var e=this.getFieldValue("WHERE");let i=t.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return("FROM_START"===e||"FROM_END"===e)&&(e="FROM_START"===e?t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(i+="  "+e.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),i})}),t.defineBlocks$$module$build$src$core$common(o);var l={},a={setStatements_:function(e){this.hasStatements_!==e&&(e?(this.appendStatementInput("STACK").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=e)},updateParams_:function(){let e="";this.arguments_.length&&(e=t.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),t.disable$$module$build$src$core$events$utils();try{this.setFieldValue(e,"PARAMS")}finally{t.enable$$module$build$src$core$events$utils()}},mutationToDom:function(e){let i=t.createElement$$module$build$src$core$utils$xml("mutation");e&&i.setAttribute("name",this.getFieldValue("NAME"));for(let s=0;s<this.argumentVarModels_.length;s++){let o=t.createElement$$module$build$src$core$utils$xml("arg"),n=this.argumentVarModels_[s];o.setAttribute("name",n.getName()),o.setAttribute("varid",n.getId()),e&&this.paramIds_&&o.setAttribute("paramId",this.paramIds_[s]),i.appendChild(o)}return this.hasStatements_||i.setAttribute("statements","false"),i},domToMutation:function(e){this.arguments_=[],this.argumentVarModels_=[];for(let s=0,o;o=e.childNodes[s];s++)if("arg"===o.nodeName.toLowerCase()){var i=o;let e=i.getAttribute("name");i=i.getAttribute("varid")||i.getAttribute("varId"),this.arguments_.push(e),null!==(i=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,i,e,""))?this.argumentVarModels_.push(i):console.log(`Failed to create a variable named "${e}", ignoring.`)}this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_("false"!==e.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;let e=Object.create(null);if(this.argumentVarModels_.length){e.params=[];for(let t=0;t<this.argumentVarModels_.length;t++)e.params.push({name:this.argumentVarModels_[t].getName(),id:this.argumentVarModels_[t].getId()})}return this.hasStatements_||(e.hasStatements=!1),e},loadExtraState:function(e){if(this.arguments_=[],this.argumentVarModels_=[],e.params)for(let s=0;s<e.params.length;s++){var i=e.params[s];i=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,i.id,i.name,""),this.arguments_.push(i.getName()),this.argumentVarModels_.push(i)}this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(!1!==e.hasStatements)},decompose:function(e){let i=t.createElement$$module$build$src$core$utils$xml("block");i.setAttribute("type","procedures_mutatorcontainer");var s=t.createElement$$module$build$src$core$utils$xml("statement");s.setAttribute("name","STACK"),i.appendChild(s);for(let e=0;e<this.arguments_.length;e++){let i=t.createElement$$module$build$src$core$utils$xml("block");i.setAttribute("type","procedures_mutatorarg");var o=t.createElement$$module$build$src$core$utils$xml("field");o.setAttribute("name","NAME");let n=t.createTextNode$$module$build$src$core$utils$xml(this.arguments_[e]);o.appendChild(n),i.appendChild(o),o=t.createElement$$module$build$src$core$utils$xml("next"),i.appendChild(o),s.appendChild(i),s=o}return e=t.domToBlock$$module$build$src$core$xml(i,e),"procedures_defreturn"===this.type?e.setFieldValue(this.hasStatements_,"STATEMENTS"):e.removeInput("STATEMENT_INPUT"),t.mutateCallers$$module$build$src$core$procedures(this),e},compose:function(e){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let i=e.getInputTargetBlock("STACK");for(;i&&!i.isInsertionMarker();){var s,o=i.getFieldValue("NAME");this.arguments_.push(o),o=this.workspace.getVariable(o,""),this.argumentVarModels_.push(o),this.paramIds_.push(i.id),i=i.nextConnection&&i.nextConnection.targetBlock()}this.updateParams_(),t.mutateCallers$$module$build$src$core$procedures(this),null!==(e=e.getFieldValue("STATEMENTS"))&&(e="TRUE"===e,this.hasStatements_!==e)&&(e?(this.setStatements_(!0),null==(s=this.statementConnection_)||s.reconnect(this,"STACK"),this.statementConnection_=null):(s=this.getInput("STACK").connection,(this.statementConnection_=s.targetConnection)&&((s=s.targetBlock()).unplug(),s.bumpNeighbours()),this.setStatements_(!1)))},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(e,i){var s=this.workspace.getVariableById(e);if(""===s.getType()){s=s.getName(),i=this.workspace.getVariableById(i);var o=!1;for(let t=0;t<this.argumentVarModels_.length;t++)this.argumentVarModels_[t].getId()===e&&(this.arguments_[t]=i.getName(),this.argumentVarModels_[t]=i,o=!0);o&&(this.displayRenamedVar_(s,i.getName()),t.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(e){let i=e.getName(),s=!1,o;for(let t=0;t<this.argumentVarModels_.length;t++)this.argumentVarModels_[t].getId()===e.getId()&&(o=this.arguments_[t],this.arguments_[t]=i,s=!0);s&&(this.displayRenamedVar_(o,i),t.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(e,i){this.updateParams_();var s=this.getIcon(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(s&&s.bubbleIsVisible()){s=s.getWorkspace().getAllBlocks(!1);for(let o=0,n;n=s[o];o++)"procedures_mutatorarg"===n.type&&t.Names$$module$build$src$core$names.equals(e,n.getFieldValue("NAME"))&&n.setFieldValue(i,"NAME")}},customContextMenu:function(e){if(!this.isInFlyout){var i=this.getFieldValue("NAME"),s={type:this.callType_,extraState:{name:i,params:this.arguments_}};if(e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",i),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,s)}),!this.isCollapsed())for(i=0;i<this.argumentVarModels_.length;i++){let o={type:"variables_get",fields:{VAR:{name:(s=this.argumentVarModels_[i]).getName(),id:s.getId(),type:s.getType()}}};e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",s.getName()),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,o)})}}}};l.procedures_defnoreturn=Object.assign({},a,{init:function(){var e=t.findLegalName$$module$build$src$core$procedures("",this);(e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(t.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),l.procedures_defreturn=Object.assign({},a,{init:function(){var e=t.findLegalName$$module$build$src$core$procedures("",this);(e=t.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(t.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT).appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"}),l.procedures_mutatorcontainer={init:function(){this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(t.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};var c=class extends t.FieldTextInput$$module$build$src$core$field_textinput{constructor(){super(...arguments),this.editingInteractively=!1}showEditor_(e){super.showEditor_(e),this.editingInteractively=!0,this.editingVariable=void 0}onFinishEditing_(e){super.onFinishEditing_(e),this.editingInteractively=!1}};l.procedures_mutatorarg={init:function(){let e=new c(t.DEFAULT_ARG$$module$build$src$core$procedures,this.validator_);this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(e,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1},validator_:function(e){var t=this.getSourceBlock();let i=t.workspace.getRootWorkspace();if(!(e=e.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;let s=(t.workspace.targetWorkspace||t.workspace).getAllBlocks(!1),o=e.toLowerCase();for(let e=0;e<s.length;e++){if(s[e].id===this.getSourceBlock().id)continue;let t=s[e].getFieldValue("NAME");if(t&&t.toLowerCase()===o)return null}return t.isInFlyout||((t=i.getVariable(e,""))&&t.getName()!==e&&i.renameVariableById(t.getId(),e),t||(this.editingInteractively?this.editingVariable?i.renameVariableById(this.editingVariable.getId(),e):this.editingVariable=i.createVariable(e,""):i.createVariable(e,""))),e}};var h="DISABLED_PROCEDURE_DEFINITION",u={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(e,i){t.Names$$module$build$src$core$names.equals(e,this.getProcedureCall())&&(this.setFieldValue(i,"NAME"),this.setTooltip((this.outputConnection?t.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:t.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",i)))},setProcedureParameters_:function(e,i){var s=t.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((s=(s=s&&s.getIcon(t.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&s.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),e.join("\n")===this.arguments_.join("\n"))this.quarkIds_=i;else{if(i.length!==e.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let e=0;e<this.arguments_.length;e++){var o=this.getInput("ARG"+e);o&&(o=o.connection.targetConnection,this.quarkConnections_[this.quarkIds_[e]]=o,s&&o&&!i.includes(this.quarkIds_[e])&&(o.disconnect(),o.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(e),this.argumentVarModels_=[],e=0;e<this.arguments_.length;e++)s=t.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[e],""),this.argumentVarModels_.push(s);if(this.updateShape_(),this.quarkIds_=i){for(i=0;i<this.arguments_.length;i++)if((e=this.quarkIds_[i])in this.quarkConnections_){let t;(null==(t=this.quarkConnections_[e])?0:t.reconnect(this,"ARG"+i))||delete this.quarkConnections_[e]}}}},updateShape_:function(){for(var e=0;e<this.arguments_.length;e++){var i=this.getField("ARGNAME"+e);if(i){t.disable$$module$build$src$core$events$utils();try{i.setValue(this.arguments_[e])}finally{t.enable$$module$build$src$core$events$utils()}}else i=t.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[e]}),this.appendValueInput("ARG"+e).setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT).appendField(i,"ARGNAME"+e)}for(e=this.arguments_.length;this.getInput("ARG"+e);e++)this.removeInput("ARG"+e);(e=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||e.appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"):this.getField("WITH")&&e.removeField("WITH"))},mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation");e.setAttribute("name",this.getProcedureCall());for(let i=0;i<this.arguments_.length;i++){let s=t.createElement$$module$build$src$core$utils$xml("arg");s.setAttribute("name",this.arguments_[i]),e.appendChild(s)}return e},domToMutation:function(e){var t=e.getAttribute("name");this.renameProcedure(this.getProcedureCall(),t),t=[];let i=[];for(let s=0,o;o=e.childNodes[s];s++)"arg"===o.nodeName.toLowerCase()&&(t.push(o.getAttribute("name")),i.push(o.getAttribute("paramId")));this.setProcedureParameters_(t,i)},saveExtraState:function(){let e=Object.create(null);return e.name=this.getProcedureCall(),this.arguments_.length&&(e.params=this.arguments_),e},loadExtraState:function(e){if(this.renameProcedure(this.getProcedureCall(),e.name),e=e.params){let t=[];t.length=e.length,t.fill(null),this.setProcedureParameters_(e,t)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(e){if(this.workspace&&!this.workspace.isFlyout&&e.recordUndo)if(e.type===t.BLOCK_CREATE$$module$build$src$core$events$events&&e.ids.includes(this.id)){var i=this.getProcedureCall(),s=t.getDefinition$$module$build$src$core$procedures(i,this.workspace);if(s&&(s.type!==this.defType_||JSON.stringify(s.getVars())!==JSON.stringify(this.arguments_))&&(s=null),s)s.isEnabled()||(this.setDisabledReason(!0,h),this.setWarningText(t.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",i)));else{t.setGroup$$module$build$src$core$events$utils(e.group),e=t.createElement$$module$build$src$core$utils$xml("xml"),(i=t.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type",this.defType_);var o=(s=this.getRelativeToSurfaceXY()).y+2*t.config$$module$build$src$core$config.snapRadius;i.setAttribute("x",`${s.x+t.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`),i.setAttribute("y",`${o}`),s=this.mutationToDom(),i.appendChild(s),(s=t.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),o=this.getProcedureCall();let n=t.findLegalName$$module$build$src$core$procedures(o,this);o!==n&&this.renameProcedure(o,n),s.appendChild(t.createTextNode$$module$build$src$core$utils$xml(o)),i.appendChild(s),e.appendChild(i),t.domToWorkspace$$module$build$src$core$xml(e,this.workspace),t.setGroup$$module$build$src$core$events$utils(!1)}}else e.type===t.BLOCK_DELETE$$module$build$src$core$events$events?(i=this.getProcedureCall(),t.getDefinition$$module$build$src$core$procedures(i,this.workspace)||(t.setGroup$$module$build$src$core$events$utils(e.group),this.dispose(!0),t.setGroup$$module$build$src$core$events$utils(!1))):e.type===t.BLOCK_CHANGE$$module$build$src$core$events$events&&"disabled"===e.element&&(i=this.getProcedureCall(),(o=t.getDefinition$$module$build$src$core$procedures(i,this.workspace))&&o.id===e.blockId&&((s=t.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),t.setGroup$$module$build$src$core$events$utils(e.group),e=o.isEnabled(),this.setDisabledReason(!e,h),this.setWarningText(e?null:t.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",i)),t.setGroup$$module$build$src$core$events$utils(s)))},customContextMenu:function(e){if(this.workspace.isMovable()){var i=this.getProcedureCall(),s=this.workspace;e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){let e=t.getDefinition$$module$build$src$core$procedures(i,s);e&&(s.centerOnBlock(e.id),t.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}})}}};l.procedures_callnoreturn=Object.assign({},u,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defnoreturn"}),l.procedures_callreturn=Object.assign({},u,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defreturn"}),l.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("value",String(Number(this.hasReturnValue_))),e},domToMutation:function(e){this.hasReturnValue_="1"===e.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(e){if(!(this.workspace.isDragging&&this.workspace.isDragging()||e.type!==t.BLOCK_MOVE$$module$build$src$core$events$events&&e.type!==t.BLOCK_CREATE$$module$build$src$core$events$events)){e=!1;var i=this;do{if(this.FUNCTION_TYPES.includes(i.type)){e=!0;break}i=i.getSurroundParent()}while(i)if(e?("procedures_defnoreturn"===i.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==i.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(t.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(t.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),!this.isInFlyout)try{t.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!e,"UNPARENTED_IFRETURN")}finally{t.setRecordUndo$$module$build$src$core$events$utils(!0)}}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},t.defineBlocks$$module$build$src$core$common(l);var d=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["π","PI"],["e","E"],["φ","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(½)","SQRT1_2"],["∞","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]);t.register$$module$build$src$core$extensions("math_op_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"})),t.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",{mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation"),i="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return e.setAttribute("divisor_input",String(i)),e},domToMutation:function(e){e="true"===e.getAttribute("divisor_input"),this.updateShape_(e)},updateShape_:function(e){let t=this.getInput("DIVISOR");e?t||this.appendValueInput("DIVISOR").setCheck("Number"):t&&this.removeInput("DIVISOR")}},function(){this.getField("PROPERTY").setValidator(function(e){e="DIVISIBLE_BY"===e,this.getSourceBlock().updateShape_(e)})}),t.register$$module$build$src$core$extensions("math_change_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),t.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",{updateType_:function(e){"MODE"===e?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("op",this.getFieldValue("OP")),e},domToMutation:function(e){if(null===(e=e.getAttribute("op")))throw TypeError("xmlElement had no op attribute");this.updateType_(e)}},function(){this.getField("OP").setValidator((function(e){this.updateType_(e)}).bind(this))}),t.defineBlocks$$module$build$src$core$common(d);var E=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]);t.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",{WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"})),t.register$$module$build$src$core$extensions("controls_flow_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",{BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"})),t.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",{customContextMenu:function(e){if(!this.isInFlyout){var i=this.getField("VAR"),s=i.getVariable().getName();this.isCollapsed()||null===s||(i={type:"variables_get",fields:{VAR:i.saveState(!0)}},e.push({enabled:!0,text:t.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",s),callback:t.callbackFactory$$module$build$src$core$contextmenu(this,i)}))}}}),t.register$$module$build$src$core$extensions("controls_for_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),t.register$$module$build$src$core$extensions("controls_forEach_tooltip",t.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var _=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]);t.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",{getSurroundLoop:function(){let e=this;do{if(_.has(e.type))return e;e=e.getSurroundParent()}while(e)return null},onchange:function(e){let i=this.workspace;if(i.isDragging&&!i.isDragging()&&(e.type===t.BLOCK_MOVE$$module$build$src$core$events$events||e.type===t.BLOCK_CREATE$$module$build$src$core$events$events)&&(e=!!this.getSurroundLoop(),this.setWarningText(e?null:t.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout))try{t.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!e,"CONTROL_FLOW_NOT_IN_LOOP")}finally{t.setRecordUndo$$module$build$src$core$events$utils(!0)}}}),t.defineBlocks$$module$build$src$core$common(E);var T=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["≠","NEQ"],["‏<","LT"],["‏≤","LTE"],["‏>","GT"],["‏≥","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]);t.register$$module$build$src$core$extensions("logic_op_tooltip",t.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"})),t.registerMutator$$module$build$src$core$extensions("controls_if_mutator",{elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;let e=t.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&e.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&e.setAttribute("else","1"),e},domToMutation:function(e){this.elseifCount_=parseInt(e.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(e.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;let e=Object.create(null);return this.elseifCount_&&(e.elseIfCount=this.elseifCount_),this.elseCount_&&(e.hasElse=!0),e},loadExtraState:function(e){this.elseifCount_=e.elseIfCount||0,this.elseCount_=+!!e.hasElse,this.updateShape_()},decompose:function(e){let t=e.newBlock("controls_if_if");t.initSvg();let i=t.nextConnection;for(let t=1;t<=this.elseifCount_;t++){let t=e.newBlock("controls_if_elseif");t.initSvg(),i.connect(t.previousConnection),i=t.nextConnection}return this.elseCount_&&((e=e.newBlock("controls_if_else")).initSvg(),i.connect(e.previousConnection)),t},compose:function(e){e=e.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;let t=[null],i=[null],s=null;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":this.elseifCount_++,t.push(e.valueConnection_),i.push(e.statementConnection_);break;case"controls_if_else":this.elseCount_++,s=e.statementConnection_;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(t,i,s)},saveConnections:function(e){e=e.nextConnection.targetBlock();let t=1;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":var i=this.getInput("IF"+t);let s=this.getInput("DO"+t);e.valueConnection_=i&&i.connection.targetConnection,e.statementConnection_=s&&s.connection.targetConnection,t++;break;case"controls_if_else":i=this.getInput("ELSE"),e.statementConnection_=i&&i.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}},rebuildShape_:function(){let e=[null],t=[null],i=null;this.getInput("ELSE")&&(i=this.getInput("ELSE").connection.targetConnection);for(let i=1;this.getInput("IF"+i);i++){let s=this.getInput("IF"+i),o=this.getInput("DO"+i);e.push(s.connection.targetConnection),t.push(o.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(e,t,i)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var e=1;this.getInput("IF"+e);e++)this.removeInput("IF"+e),this.removeInput("DO"+e);for(e=1;e<=this.elseifCount_;e++)this.appendValueInput("IF"+e).setCheck("Boolean").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+e).appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(t.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(e,t,i){for(let i=1;i<=this.elseifCount_;i++){let s,o;null==(s=e[i])||s.reconnect(this,"IF"+i),null==(o=t[i])||o.reconnect(this,"DO"+i)}null==i||i.reconnect(this,"ELSE")}},null,["controls_if_elseif","controls_if_else"]),t.register$$module$build$src$core$extensions("controls_if_tooltip",function(){this.setTooltip((function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4:"":t.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1}).bind(this))});var p={onchange:function(e){this.prevBlocks_||(this.prevBlocks_=[null,null]);var i=this.getInputTargetBlock("A");let s=this.getInputTargetBlock("B");i&&s&&!this.workspace.connectionChecker.doTypeChecks(i.outputConnection,s.outputConnection)&&(t.setGroup$$module$build$src$core$events$utils(e.group),(e=this.prevBlocks_[0])!==i&&(i.unplug(),!e||e.isDisposed()||e.isShadow()||this.getInput("A").connection.connect(e.outputConnection)),(i=this.prevBlocks_[1])!==s&&(s.unplug(),!i||i.isDisposed()||i.isShadow()||this.getInput("B").connection.connect(i.outputConnection)),this.bumpNeighbours(),t.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}};t.register$$module$build$src$core$extensions("logic_compare",function(){this.mixin(p)}),t.registerMixin$$module$build$src$core$extensions("logic_ternary",{prevParentConnection_:null,onchange:function(e){let i=this.getInputTargetBlock("THEN"),s=this.getInputTargetBlock("ELSE"),o=this.outputConnection.targetConnection;if((i||s)&&o)for(let n=0;2>n;n++){let r=1===n?i:s;r&&!r.workspace.connectionChecker.doTypeChecks(r.outputConnection,o)&&(t.setGroup$$module$build$src$core$events$utils(e.group),o===this.prevParentConnection_?(this.unplug(),o.getSourceBlock().bumpNeighbours()):(r.unplug(),r.bumpNeighbours()),t.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=o}}),t.defineBlocks$$module$build$src$core$common(T);var g=t.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]);g.lists_create_with={init:function(){this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new t.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items",String(this.itemCount_)),e},domToMutation:function(e){if(!(e=e.getAttribute("items")))throw TypeError("element did not have items");this.itemCount_=parseInt(e,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(e){let t=e.newBlock("lists_create_with_container");t.initSvg();let i=t.getInput("STACK").connection;for(let t=0;t<this.itemCount_;t++){let t=e.newBlock("lists_create_with_item");if(t.initSvg(),!t.previousConnection)throw Error("itemBlock has no previousConnection");i.connect(t.previousConnection),i=t.nextConnection}return t},compose:function(e){var t=e.getInputTargetBlock("STACK");for(e=[];t;)t.isInsertionMarker()||e.push(t.valueConnection_),t=t.getNextBlock();for(t=0;t<this.itemCount_;t++){let i=this.getInput("ADD"+t).connection.targetConnection;i&&!e.includes(i)&&i.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),t=0;t<this.itemCount_;t++){let i;null==(i=e[t])||i.reconnect(this,"ADD"+t)}},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){if(e.isInsertionMarker()){e=e.getNextBlock();continue}let i=this.getInput("ADD"+t);e.valueConnection_=null==i?void 0:i.connection.targetConnection,e=e.getNextBlock(),t++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var e=0;e<this.itemCount_;e++)if(!this.getInput("ADD"+e)){let i=this.appendValueInput("ADD"+e).setAlign(t.Align$$module$build$src$core$inputs$align.RIGHT);0===e&&i.appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(e=this.itemCount_;this.getInput("ADD"+e);e++)this.removeInput("ADD"+e)}},g.lists_create_with_container={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}},g.lists_create_with_item={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}},g.lists_indexOf={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),!(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})))throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(e,"END"),this.setInputsInline(!0),this.setTooltip(()=>t.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}},g.lists_getIndex={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator(function(e){e="REMOVE"===e,this.getSourceBlock().updateStatement_(e)}),this.appendValueInput("VALUE").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(e){let t=this.getValue();(e="FROM_START"===e||"FROM_END"===e)!=("FROM_START"===t||"FROM_END"===t)&&this.getSourceBlock().updateAt_(e)}),this.appendDummyInput().appendField(e,"WHERE"),this.appendDummyInput("AT"),t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip(()=>{let e=this.getFieldValue("MODE"),i=this.getFieldValue("WHERE"),s="";switch(e+" "+i){case"GET FROM_START":case"GET FROM_END":s=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":s=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":s=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":s=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":s=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":s=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":s=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":s=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":s=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":s=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":s=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":s=t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return("FROM_START"===i||"FROM_END"===i)&&(s+="  "+("FROM_START"===i?t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),s})},mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation");e.setAttribute("statement",String(!this.outputConnection));let i=this.getInput("AT")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at",String(i)),e},domToMutation:function(e){let t="true"===e.getAttribute("statement");this.updateStatement_(t),e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(e){e.isStatement?this.updateStatement_(!0):"string"==typeof e&&this.domToMutation(t.textToDom$$module$build$src$core$utils$xml(e))},updateStatement_:function(e){!this.outputConnection!==e&&(this.unplug(!0,!0),e?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}},g.lists_setIndex={init:function(){var e=[[t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[t.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),(e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(e){let t=this.getValue();(e="FROM_START"===e||"FROM_END"===e)!=("FROM_START"===t||"FROM_END"===t)&&this.getSourceBlock().updateAt_(e)}),this.appendDummyInput().appendField(e,"WHERE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip(()=>{let e=this.getFieldValue("MODE"),i=this.getFieldValue("WHERE"),s="";switch(e+" "+i){case"SET FROM_START":case"SET FROM_END":s=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":s=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":s=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":s=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":s=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":s=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":s=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":s=t.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return("FROM_START"===i||"FROM_END"===i)&&(s+="  "+t.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),s})},mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation"),i=this.getInput("AT")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at",String(i)),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO")}},g.lists_getSublist={init:function(){this.WHERE_OPTIONS_1=[[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST);let e=e=>{let i=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+e]});return i.setValidator(function(t){let i=this.getValue();(t="FROM_START"===t||"FROM_END"===t)!=("FROM_START"===i||"FROM_END"===i)&&this.getSourceBlock().updateAt_(e,t)}),i};this.appendDummyInput("WHERE1_INPUT").appendField(e(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(e(2),"WHERE2"),this.appendDummyInput("AT2"),t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation");var i=this.getInput("AT1")instanceof t.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1",String(i)),i=this.getInput("AT2")instanceof t.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2",String(i)),e},domToMutation:function(e){let t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e,i){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),i?(this.appendValueInput("AT"+e).setCheck("Number"),t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(t.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e),1===e&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT")),t.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}},g.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},g.lists_split={init:function(){let e=t.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[t.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!e)throw Error("field_dropdown not found");e.setValidator(e=>{this.updateType_(e)}),this.setHelpUrl(t.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(e,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(t.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(()=>{let e=this.getFieldValue("MODE");if("SPLIT"===e)return t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===e)return t.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+e)})},updateType_:function(e){if(this.getFieldValue("MODE")!==e){let e=this.getInput("INPUT").connection;e.setShadowDom(null);let t=e.targetBlock();t&&(e.disconnect(),t.isShadow()?t.dispose(!1):this.bumpNeighbours())}"SPLIT"===e?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){let e=t.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("mode",this.getFieldValue("MODE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("mode"))},saveExtraState:function(){return{mode:this.getFieldValue("MODE")}},loadExtraState:function(e){this.updateType_(e.mode)}},t.defineBlocks$$module$build$src$core$common(g);var I={blocks:Object.assign({},g,T,E,d,l,o,s,i),lists:{blocks:g},logic:{blocks:T},loops:{blocks:E,loopTypes:_},math:{blocks:d},procedures:{blocks:l},texts:{blocks:o},variables:{blocks:s},variablesDynamic:{blocks:i}};return I.__namespace__=t,I},"function"==typeof define&&define.amd?define(["./blockly_compressed.js"],s):e.exports=s(h("97Mr6"))}),u("eqdor",function(e,t){var i,s;e.exports,s=function(e){var t,i,s=e.__namespace__,o=function(e,t){let s=0,o="",n,r;t.STATEMENT_PREFIX&&(o+=t.injectId(t.STATEMENT_PREFIX,e));do r=t.valueToCode(e,"IF"+s,i.NONE)||"False",n=t.statementToCode(e,"DO"+s)||t.PASS,t.STATEMENT_SUFFIX&&(n=t.prefixLines(t.injectId(t.STATEMENT_SUFFIX,e),t.INDENT)+n),o+=(0===s?"if ":"elif ")+r+":\n"+n,s++;while(e.getInput("IF"+s))return(e.getInput("ELSE")||t.STATEMENT_SUFFIX)&&(n=e.getInput("ELSE")&&t.statementToCode(e,"ELSE")||t.PASS,t.STATEMENT_SUFFIX&&(n=t.prefixLines(t.injectId(t.STATEMENT_SUFFIX,e),t.INDENT)+n),o+="else:\n"+n),o},n=function(e,t){let o;o=e.getField("TIMES")?String(parseInt(e.getFieldValue("TIMES"),10)):t.valueToCode(e,"TIMES",i.NONE)||"0",o=s.isNumber$$module$build$src$core$utils$string(o)?parseInt(o,10):"int("+o+")";let n=t.statementToCode(e,"DO");return n=t.addLoopTrap(n,e)||t.PASS,"for "+t.nameDB_.getDistinctName("count",s.NameType$$module$build$src$core$names.VARIABLE)+" in range("+o+"):\n"+n},r=function(e,t){let s,o=e.getFieldValue("OP");if("NEG"===o)return["-"+(s=t.valueToCode(e,"NUM",i.UNARY_SIGN)||"0"),i.UNARY_SIGN];switch(t.definitions_.import_math="import math",e="SIN"===o||"COS"===o||"TAN"===o?t.valueToCode(e,"NUM",i.MULTIPLICATIVE)||"0":t.valueToCode(e,"NUM",i.NONE)||"0",o){case"ABS":s="math.fabs("+e+")";break;case"ROOT":s="math.sqrt("+e+")";break;case"LN":s="math.log("+e+")";break;case"LOG10":s="math.log10("+e+")";break;case"EXP":s="math.exp("+e+")";break;case"POW10":s="math.pow(10,"+e+")";break;case"ROUND":s="round("+e+")";break;case"ROUNDUP":s="math.ceil("+e+")";break;case"ROUNDDOWN":s="math.floor("+e+")";break;case"SIN":s="math.sin("+e+" / 180.0 * math.pi)";break;case"COS":s="math.cos("+e+" / 180.0 * math.pi)";break;case"TAN":s="math.tan("+e+" / 180.0 * math.pi)"}if(s)return[s,i.FUNCTION_CALL];switch(o){case"ASIN":s="math.asin("+e+") / math.pi * 180";break;case"ACOS":s="math.acos("+e+") / math.pi * 180";break;case"ATAN":s="math.atan("+e+") / math.pi * 180";break;default:throw Error("Unknown math operator: "+o)}return[s,i.MULTIPLICATIVE]},l=function(e,t){var o=[],n=e.workspace,r=s.allUsedVarModels$$module$build$src$core$variables(n)||[];for(var l of r)r=l.getName(),e.getVars().includes(r)||o.push(t.getVariableName(r));for(l=0,n=s.allDeveloperVariables$$module$build$src$core$variables(n);l<n.length;l++)o.push(t.nameDB_.getName(n[l],s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));n=o.length?t.INDENT+"global "+o.join(", ")+"\n":"",o=t.getProcedureName(e.getFieldValue("NAME")),l="",t.STATEMENT_PREFIX&&(l+=t.injectId(t.STATEMENT_PREFIX,e)),t.STATEMENT_SUFFIX&&(l+=t.injectId(t.STATEMENT_SUFFIX,e)),l&&(l=t.prefixLines(l,t.INDENT)),r="",t.INFINITE_LOOP_TRAP&&(r=t.prefixLines(t.injectId(t.INFINITE_LOOP_TRAP,e),t.INDENT));let a="";e.getInput("STACK")&&(a=t.statementToCode(e,"STACK"));let c="";e.getInput("RETURN")&&(c=t.valueToCode(e,"RETURN",i.NONE)||"");let h="";a&&c&&(h=l),c?c=t.INDENT+"return "+c+"\n":a||(a=t.PASS);let u=[],d=e.getVars();for(let e=0;e<d.length;e++)u[e]=t.getVariableName(d[e]);return n="def "+o+"("+u.join(", ")+"):\n"+n+l+r+a+h+c,n=t.scrub_(e,n),t.definitions_["%"+o]=n,null},a=function(e,t){var s=t.provideFunction_("text_prompt",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(msg):
  try:
    return raw_input(msg)
  except NameError:
    return input(msg)
`);return s=s+"("+(t=e.getField("TEXT")?t.quote_(e.getFieldValue("TEXT")):t.valueToCode(e,"TEXT",i.NONE)||"''")+")","NUMBER"===e.getFieldValue("TYPE")&&(s="float("+s+")"),[s,i.FUNCTION_CALL]},c=function(e,t){return[t.getVariableName(e.getFieldValue("VAR")),i.ATOMIC]},h=function(e,t){let s=t.valueToCode(e,"VALUE",i.NONE)||"0";return t.getVariableName(e.getFieldValue("VAR"))+" = "+s+"\n"};(t=i||(i={}))[t.ATOMIC=0]="ATOMIC",t[t.COLLECTION=1]="COLLECTION",t[t.STRING_CONVERSION=1]="STRING_CONVERSION",t[t.MEMBER=2.1]="MEMBER",t[t.FUNCTION_CALL=2.2]="FUNCTION_CALL",t[t.EXPONENTIATION=3]="EXPONENTIATION",t[t.UNARY_SIGN=4]="UNARY_SIGN",t[t.BITWISE_NOT=4]="BITWISE_NOT",t[t.MULTIPLICATIVE=5]="MULTIPLICATIVE",t[t.ADDITIVE=6]="ADDITIVE",t[t.BITWISE_SHIFT=7]="BITWISE_SHIFT",t[t.BITWISE_AND=8]="BITWISE_AND",t[t.BITWISE_XOR=9]="BITWISE_XOR",t[t.BITWISE_OR=10]="BITWISE_OR",t[t.RELATIONAL=11]="RELATIONAL",t[t.LOGICAL_NOT=12]="LOGICAL_NOT",t[t.LOGICAL_AND=13]="LOGICAL_AND",t[t.LOGICAL_OR=14]="LOGICAL_OR",t[t.CONDITIONAL=15]="CONDITIONAL",t[t.LAMBDA=16]="LAMBDA",t[t.NONE=99]="NONE";var u=class extends s.CodeGenerator$$module$build$src$core$generator{constructor(e="Python"){for(let t in super(e),this.ORDER_OVERRIDES=[[i.FUNCTION_CALL,i.MEMBER],[i.FUNCTION_CALL,i.FUNCTION_CALL],[i.MEMBER,i.MEMBER],[i.MEMBER,i.FUNCTION_CALL],[i.LOGICAL_NOT,i.LOGICAL_NOT],[i.LOGICAL_AND,i.LOGICAL_AND],[i.LOGICAL_OR,i.LOGICAL_OR]],this.PASS="",this.isInitialized=!1,i)"string"!=typeof(e=i[t])&&(this["ORDER_"+t]=e);this.addReservedWords("False,None,True,and,as,assert,break,class,continue,def,del,elif,else,except,exec,finally,for,from,global,if,import,in,is,lambda,nonlocal,not,or,pass,print,raise,return,try,while,with,yield,NotImplemented,Ellipsis,__debug__,quit,exit,copyright,license,credits,ArithmeticError,AssertionError,AttributeError,BaseException,BlockingIOError,BrokenPipeError,BufferError,BytesWarning,ChildProcessError,ConnectionAbortedError,ConnectionError,ConnectionRefusedError,ConnectionResetError,DeprecationWarning,EOFError,Ellipsis,EnvironmentError,Exception,FileExistsError,FileNotFoundError,FloatingPointError,FutureWarning,GeneratorExit,IOError,ImportError,ImportWarning,IndentationError,IndexError,InterruptedError,IsADirectoryError,KeyError,KeyboardInterrupt,LookupError,MemoryError,ModuleNotFoundError,NameError,NotADirectoryError,NotImplemented,NotImplementedError,OSError,OverflowError,PendingDeprecationWarning,PermissionError,ProcessLookupError,RecursionError,ReferenceError,ResourceWarning,RuntimeError,RuntimeWarning,StandardError,StopAsyncIteration,StopIteration,SyntaxError,SyntaxWarning,SystemError,SystemExit,TabError,TimeoutError,TypeError,UnboundLocalError,UnicodeDecodeError,UnicodeEncodeError,UnicodeError,UnicodeTranslateError,UnicodeWarning,UserWarning,ValueError,Warning,ZeroDivisionError,_,__build_class__,__debug__,__doc__,__import__,__loader__,__name__,__package__,__spec__,abs,all,any,apply,ascii,basestring,bin,bool,buffer,bytearray,bytes,callable,chr,classmethod,cmp,coerce,compile,complex,copyright,credits,delattr,dict,dir,divmod,enumerate,eval,exec,execfile,exit,file,filter,float,format,frozenset,getattr,globals,hasattr,hash,help,hex,id,input,int,intern,isinstance,issubclass,iter,len,license,list,locals,long,map,max,memoryview,min,next,object,oct,open,ord,pow,print,property,quit,range,raw_input,reduce,reload,repr,reversed,round,set,setattr,slice,sorted,staticmethod,str,sum,super,tuple,type,unichr,unicode,vars,xrange,zip")}init(e){super.init(e),this.PASS=this.INDENT+"pass\n",this.nameDB_?this.nameDB_.reset():this.nameDB_=new s.Names$$module$build$src$core$names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(e.getVariableMap()),this.nameDB_.populateVariables(e),this.nameDB_.populateProcedures(e);let t=[];var i=s.allDeveloperVariables$$module$build$src$core$variables(e);for(let e=0;e<i.length;e++)t.push(this.nameDB_.getName(i[e],s.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE)+" = None");for(i=0,e=s.allUsedVarModels$$module$build$src$core$variables(e);i<e.length;i++)t.push(this.getVariableName(e[i].getId())+" = None");this.definitions_.variables=t.join("\n"),this.isInitialized=!0}finish(e){let t=[],i=[];for(let e in this.definitions_){let s=this.definitions_[e];s.match(/^(from\s+\S+\s+)?import\s+\S+/)?t.push(s):i.push(s)}return e=super.finish(e),this.isInitialized=!1,this.nameDB_.reset(),(t.join("\n")+"\n\n"+i.join("\n\n")).replace(/\n\n+/g,"\n\n").replace(/\n*$/,"\n\n\n")+e}scrubNakedValue(e){return e+"\n"}quote_(e){e=e.replace(/\\/g,"\\\\").replace(/\n/g,"\\\n");let t="'";return e.includes("'")&&(e.includes('"')?e=e.replace(/'/g,"\\'"):t='"'),t+e+t}multiline_quote_(e){return e.split(/\n/g).map(this.quote_).join(" + '\\n' + \n")}scrub_(e,t,i=!1){let o="";if(!e.outputConnection||!e.outputConnection.targetConnection){var n=e.getCommentText();n&&(n=s.wrap$$module$build$src$core$utils$string(n,this.COMMENT_WRAP-3),o+=this.prefixLines(n+"\n","# "));for(let t=0;t<e.inputList.length;t++)e.inputList[t].type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE&&(n=e.inputList[t].connection.targetBlock())&&(n=this.allNestedComments(n))&&(o+=this.prefixLines(n,"# "))}return e=e.nextConnection&&e.nextConnection.targetBlock(),o+t+(i=i?"":this.blockToCode(e))}getAdjustedInt(e,t,o=0,n=!1){e.workspace.options.oneBasedIndex&&o--;let r=e.workspace.options.oneBasedIndex?"1":"0";return e=this.valueToCode(e,t,o?i.ADDITIVE:i.NONE)||r,s.isNumber$$module$build$src$core$utils$string(e)?(e=parseInt(e,10)+o,n&&(e=-e)):(e=0<o?"int("+e+" + "+o+")":0>o?"int("+e+" - "+-o+")":"int("+e+")",n&&(e="-"+e)),e}},d={};d.Order=i,d.PythonGenerator=u;var E={};E.lists_create_empty=function(e,t){return["[]",i.ATOMIC]},E.lists_create_with=function(e,t){let s=Array(e.itemCount_);for(let o=0;o<e.itemCount_;o++)s[o]=t.valueToCode(e,"ADD"+o,i.NONE)||"None";return["["+s.join(", ")+"]",i.ATOMIC]},E.lists_getIndex=function(e,t){let s=e.getFieldValue("MODE")||"GET",o=e.getFieldValue("WHERE")||"FROM_START";var n=t.valueToCode(e,"VALUE","RANDOM"===o?i.NONE:i.MEMBER)||"[]";switch(o){case"FIRST":if("GET"===s)return[n+"[0]",i.MEMBER];if("GET_REMOVE"===s)return[n+".pop(0)",i.FUNCTION_CALL];if("REMOVE"===s)return n+".pop(0)\n";break;case"LAST":if("GET"===s)return[n+"[-1]",i.MEMBER];if("GET_REMOVE"===s)return[n+".pop()",i.FUNCTION_CALL];if("REMOVE"===s)return n+".pop()\n";break;case"FROM_START":if(e=t.getAdjustedInt(e,"AT"),"GET"===s)return[n+"["+e+"]",i.MEMBER];if("GET_REMOVE"===s)return[n+".pop("+e+")",i.FUNCTION_CALL];if("REMOVE"===s)return n+".pop("+e+")\n";break;case"FROM_END":if(e=t.getAdjustedInt(e,"AT",1,!0),"GET"===s)return[n+"["+e+"]",i.MEMBER];if("GET_REMOVE"===s)return[n+".pop("+e+")",i.FUNCTION_CALL];if("REMOVE"===s)return n+".pop("+e+")\n";break;case"RANDOM":if(t.definitions_.import_random="import random","GET"===s)return["random.choice("+n+")",i.FUNCTION_CALL];if(n=t.provideFunction_("lists_remove_random_item",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(myList):
  x = int(random.random() * len(myList))
  return myList.pop(x)
`)+"("+n+")","GET_REMOVE"===s)return[n,i.FUNCTION_CALL];if("REMOVE"===s)return n+"\n"}throw Error("Unhandled combination (lists_getIndex).")},E.lists_getSublist=function(e,t){let o=t.valueToCode(e,"LIST",i.MEMBER)||"[]";var n=e.getFieldValue("WHERE1");let r=e.getFieldValue("WHERE2");switch(n){case"FROM_START":0===(n=t.getAdjustedInt(e,"AT1"))&&(n="");break;case"FROM_END":n=t.getAdjustedInt(e,"AT1",1,!0);break;case"FIRST":n="";break;default:throw Error("Unhandled option (lists_getSublist)")}switch(r){case"FROM_START":e=t.getAdjustedInt(e,"AT2",1);break;case"FROM_END":e=t.getAdjustedInt(e,"AT2",0,!0),s.isNumber$$module$build$src$core$utils$string(String(e))?0===e&&(e=""):(t.definitions_.import_sys="import sys",e+=" or sys.maxsize");break;case"LAST":e="";break;default:throw Error("Unhandled option (lists_getSublist)")}return[o+"["+n+" : "+e+"]",i.MEMBER]},E.lists_indexOf=function(e,t){let s=t.valueToCode(e,"FIND",i.NONE)||"[]",o=t.valueToCode(e,"VALUE",i.NONE)||"''",n=" -1",r="",l=" - 1";return e.workspace.options.oneBasedIndex&&(n=" 0",r=" + 1",l=""),[("FIRST"===e.getFieldValue("END")?t.provideFunction_("first_index",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(my_list, elem):
  try: index = my_list.index(elem)${r}
  except: index =${n}
  return index
`):t.provideFunction_("last_index",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(my_list, elem):
  try: index = len(my_list) - my_list[::-1].index(elem)${l}
  except: index =${n}
  return index
`))+"("+o+", "+s+")",i.FUNCTION_CALL]},E.lists_isEmpty=function(e,t){return["not len("+(t.valueToCode(e,"VALUE",i.NONE)||"[]")+")",i.LOGICAL_NOT]},E.lists_length=function(e,t){return["len("+(t.valueToCode(e,"VALUE",i.NONE)||"[]")+")",i.FUNCTION_CALL]},E.lists_repeat=function(e,t){return["["+(t.valueToCode(e,"ITEM",i.NONE)||"None")+"] * "+(e=t.valueToCode(e,"NUM",i.MULTIPLICATIVE)||"0"),i.MULTIPLICATIVE]},E.lists_reverse=function(e,t){return["list(reversed("+(t.valueToCode(e,"LIST",i.NONE)||"[]")+"))",i.FUNCTION_CALL]},E.lists_setIndex=function(e,t){let o=t.valueToCode(e,"LIST",i.MEMBER)||"[]",n=e.getFieldValue("MODE")||"GET";var r=e.getFieldValue("WHERE")||"FROM_START";let l=t.valueToCode(e,"TO",i.NONE)||"None";switch(r){case"FIRST":if("SET"===n)return o+"[0] = "+l+"\n";if("INSERT"===n)return o+".insert(0, "+l+")\n";break;case"LAST":if("SET"===n)return o+"[-1] = "+l+"\n";if("INSERT"===n)return o+".append("+l+")\n";break;case"FROM_START":if(t=t.getAdjustedInt(e,"AT"),"SET"===n)return o+"["+t+"] = "+l+"\n";if("INSERT"===n)return o+".insert("+t+", "+l+")\n";break;case"FROM_END":if(t=t.getAdjustedInt(e,"AT",1,!0),"SET"===n)return o+"["+t+"] = "+l+"\n";if("INSERT"===n)return o+".insert("+t+", "+l+")\n";break;case"RANDOM":if(t.definitions_.import_random="import random",o.match(/^\w+$/)?e="":(r=(e=t.nameDB_.getDistinctName("tmp_list",s.NameType$$module$build$src$core$names.VARIABLE))+" = "+o+"\n",o=e,e=r),e+=(t=t.nameDB_.getDistinctName("tmp_x",s.NameType$$module$build$src$core$names.VARIABLE))+" = int(random.random() * len("+o+"))\n","SET"===n)return e+(o+"["+t+"] = ")+l+"\n";if("INSERT"===n)return e+(o+".insert("+t+", ")+l+")\n"}throw Error("Unhandled combination (lists_setIndex).")},E.lists_sort=function(e,t){let s=t.valueToCode(e,"LIST",i.NONE)||"[]",o=e.getFieldValue("TYPE");return e="1"===e.getFieldValue("DIRECTION")?"False":"True",[t.provideFunction_("lists_sort",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(my_list, type, reverse):
  def try_float(s):
    try:
      return float(s)
    except:
      return 0
  key_funcs = {
    "NUMERIC": try_float,
    "TEXT": str,
    "IGNORE_CASE": lambda s: str(s).lower()
  }
  key_func = key_funcs[type]
  list_cpy = list(my_list)
  return sorted(list_cpy, key=key_func, reverse=reverse)
`)+"("+s+', "'+o+'", '+e+")",i.FUNCTION_CALL]},E.lists_split=function(e,t){var s=e.getFieldValue("MODE");if("SPLIT"===s)e=(s=t.valueToCode(e,"INPUT",i.MEMBER)||"''")+".split("+(e=t.valueToCode(e,"DELIM",i.NONE))+")";else if("JOIN"===s)s=t.valueToCode(e,"INPUT",i.NONE)||"[]",e=(t.valueToCode(e,"DELIM",i.MEMBER)||"''")+".join("+s+")";else throw Error("Unknown mode: "+s);return[e,i.FUNCTION_CALL]};var _={};_.controls_if=o,_.controls_ifelse=o,_.logic_boolean=function(e,t){return["TRUE"===e.getFieldValue("BOOL")?"True":"False",i.ATOMIC]},_.logic_compare=function(e,t){let s={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[e.getFieldValue("OP")],o=i.RELATIONAL;return[(t.valueToCode(e,"A",o)||"0")+" "+s+" "+(e=t.valueToCode(e,"B",o)||"0"),o]},_.logic_negate=function(e,t){return["not "+(t.valueToCode(e,"BOOL",i.LOGICAL_NOT)||"True"),i.LOGICAL_NOT]},_.logic_null=function(e,t){return["None",i.ATOMIC]},_.logic_operation=function(e,t){let s="AND"===e.getFieldValue("OP")?"and":"or",o="and"===s?i.LOGICAL_AND:i.LOGICAL_OR,n=t.valueToCode(e,"A",o);return e=t.valueToCode(e,"B",o),n||e?(t="and"===s?"True":"False",n||(n=t),e||(e=t)):e=n="False",[n+" "+s+" "+e,o]},_.logic_ternary=function(e,t){let s=t.valueToCode(e,"IF",i.CONDITIONAL)||"False";return[(t.valueToCode(e,"THEN",i.CONDITIONAL)||"None")+" if "+s+" else "+(e=t.valueToCode(e,"ELSE",i.CONDITIONAL)||"None"),i.CONDITIONAL]};var T={};T.controls_flow_statements=function(e,t){let i="";if(t.STATEMENT_PREFIX&&(i+=t.injectId(t.STATEMENT_PREFIX,e)),t.STATEMENT_SUFFIX&&(i+=t.injectId(t.STATEMENT_SUFFIX,e)),t.STATEMENT_PREFIX){let s=e.getSurroundLoop();s&&!s.suppressPrefixSuffix&&(i+=t.injectId(t.STATEMENT_PREFIX,s))}switch(e.getFieldValue("FLOW")){case"BREAK":return i+"break\n";case"CONTINUE":return i+"continue\n"}throw Error("Unknown flow statement.")},T.controls_for=function(e,t){let o=t.getVariableName(e.getFieldValue("VAR"));var n=t.valueToCode(e,"FROM",i.NONE)||"0",r=t.valueToCode(e,"TO",i.NONE)||"0",l=t.valueToCode(e,"BY",i.NONE)||"1";let a=t.statementToCode(e,"DO");a=t.addLoopTrap(a,e)||t.PASS;let c="";e=function(){return t.provideFunction_("upRange",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(start, stop, step):
  while start <= stop:
    yield start
    start += abs(step)
`)};let h=function(){return t.provideFunction_("downRange",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(start, stop, step):
  while start >= stop:
    yield start
    start -= abs(step)
`)};if(s.isNumber$$module$build$src$core$utils$string(n)&&s.isNumber$$module$build$src$core$utils$string(r)&&s.isNumber$$module$build$src$core$utils$string(l))n=Number(n),r=Number(r),l=Math.abs(Number(l)),0==n%1&&0==r%1&&0==l%1?(n<=r?(r++,e=0===n&&1===l?r:n+", "+r,1!==l&&(e+=", "+l)):e=n+", "+--r+", -"+l,e="range("+e+")"):e=(n<r?e():h())+("("+n+", "+r+", "+l)+")";else{let i=function(e,i){return s.isNumber$$module$build$src$core$utils$string(e)?e=String(Number(e)):e.match(/^\w+$/)||(i=t.nameDB_.getDistinctName(o+i,s.NameType$$module$build$src$core$names.VARIABLE),c+=i+" = "+e+"\n",e=i),e};n=i(n,"_start"),r=i(r,"_end"),l=i(l,"_inc"),e="number"==typeof n&&"number"==typeof r?(n<r?e():h())+("("+n+", "+r+", "+l)+")":"("+n+" <= "+r+") and "+e()+"("+n+", "+r+", "+l+") or "+h()+"("+n+", "+r+", "+l+")"}return c+="for "+o+" in "+e+":\n"+a},T.controls_forEach=function(e,t){let s=t.getVariableName(e.getFieldValue("VAR")),o=t.valueToCode(e,"LIST",i.RELATIONAL)||"[]",n=t.statementToCode(e,"DO");return"for "+s+" in "+o+":\n"+(n=t.addLoopTrap(n,e)||t.PASS)},T.controls_repeat=n,T.controls_repeat_ext=n,T.controls_whileUntil=function(e,t){let s="UNTIL"===e.getFieldValue("MODE"),o=t.valueToCode(e,"BOOL",s?i.LOGICAL_NOT:i.NONE)||"False",n=t.statementToCode(e,"DO");return n=t.addLoopTrap(n,e)||t.PASS,s&&(o="not "+o),"while "+o+":\n"+n};var p={};p.math_arithmetic=function(e,t){var s={ADD:[" + ",i.ADDITIVE],MINUS:[" - ",i.ADDITIVE],MULTIPLY:[" * ",i.MULTIPLICATIVE],DIVIDE:[" / ",i.MULTIPLICATIVE],POWER:[" ** ",i.EXPONENTIATION]}[e.getFieldValue("OP")];let o=s[0];return s=s[1],[(t.valueToCode(e,"A",s)||"0")+o+(e=t.valueToCode(e,"B",s)||"0"),s]},p.math_atan2=function(e,t){t.definitions_.import_math="import math";let s=t.valueToCode(e,"X",i.NONE)||"0";return["math.atan2("+(t.valueToCode(e,"Y",i.NONE)||"0")+", "+s+") / math.pi * 180",i.MULTIPLICATIVE]},p.math_change=function(e,t){t.definitions_.from_numbers_import_Number="from numbers import Number";let s=t.valueToCode(e,"DELTA",i.ADDITIVE)||"0";return(e=t.getVariableName(e.getFieldValue("VAR")))+" = ("+e+" if isinstance("+e+", Number) else 0) + "+s+"\n"},p.math_constant=function(e,t){let s={PI:["math.pi",i.MEMBER],E:["math.e",i.MEMBER],GOLDEN_RATIO:["(1 + math.sqrt(5)) / 2",i.MULTIPLICATIVE],SQRT2:["math.sqrt(2)",i.MEMBER],SQRT1_2:["math.sqrt(1.0 / 2)",i.MEMBER],INFINITY:["float('inf')",i.ATOMIC]};return"INFINITY"!==(e=e.getFieldValue("CONSTANT"))&&(t.definitions_.import_math="import math"),s[e]},p.math_constrain=function(e,t){let s=t.valueToCode(e,"VALUE",i.NONE)||"0";return["min(max("+s+", "+(t.valueToCode(e,"LOW",i.NONE)||"0")+"), "+(e=t.valueToCode(e,"HIGH",i.NONE)||"float('inf')")+")",i.FUNCTION_CALL]},p.math_modulo=function(e,t){return[(t.valueToCode(e,"DIVIDEND",i.MULTIPLICATIVE)||"0")+" % "+(e=t.valueToCode(e,"DIVISOR",i.MULTIPLICATIVE)||"0"),i.MULTIPLICATIVE]},p.math_number=function(e,t){return 1/0===(e=Number(e.getFieldValue("NUM")))?['float("inf")',i.FUNCTION_CALL]:-1/0===e?['-float("inf")',i.UNARY_SIGN]:[String(e),0>e?i.UNARY_SIGN:i.ATOMIC]},p.math_number_property=function(e,t){var s={EVEN:[" % 2 == 0",i.MULTIPLICATIVE,i.RELATIONAL],ODD:[" % 2 == 1",i.MULTIPLICATIVE,i.RELATIONAL],WHOLE:[" % 1 == 0",i.MULTIPLICATIVE,i.RELATIONAL],POSITIVE:[" > 0",i.RELATIONAL,i.RELATIONAL],NEGATIVE:[" < 0",i.RELATIONAL,i.RELATIONAL],DIVISIBLE_BY:[null,i.MULTIPLICATIVE,i.RELATIONAL],PRIME:[null,i.NONE,i.FUNCTION_CALL]};let o=e.getFieldValue("PROPERTY"),[n,r,l]=s[o];if(s=t.valueToCode(e,"NUMBER_TO_CHECK",r)||"0","PRIME"===o)t.definitions_.import_math="import math",t.definitions_.from_numbers_import_Number="from numbers import Number",e=t.provideFunction_("math_isPrime",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(n):
  # https://en.wikipedia.org/wiki/Primality_test#Naive_methods
  # If n is not a number but a string, try parsing it.
  if not isinstance(n, Number):
    try:
      n = float(n)
    except:
      return False
  if n == 2 or n == 3:
    return True
  # False if n is negative, is 1, or not whole, or if n is divisible by 2 or 3.
  if n <= 1 or n % 1 != 0 or n % 2 == 0 or n % 3 == 0:
    return False
  # Check all the numbers of form 6k +/- 1, up to sqrt(n).
  for x in range(6, int(math.sqrt(n)) + 2, 6):
    if n % (x - 1) == 0 or n % (x + 1) == 0:
      return False
  return True
`)+"("+s+")";else if("DIVISIBLE_BY"===o){if("0"===(e=t.valueToCode(e,"DIVISOR",i.MULTIPLICATIVE)||"0"))return["False",i.ATOMIC];e=s+" % "+e+" == 0"}else e=s+n;return[e,l]},p.math_on_list=function(e,t){let s=e.getFieldValue("OP");switch(e=t.valueToCode(e,"LIST",i.NONE)||"[]",s){case"SUM":t="sum("+e+")";break;case"MIN":t="min("+e+")";break;case"MAX":t="max("+e+")";break;case"AVERAGE":t.definitions_.from_numbers_import_Number="from numbers import Number",t=t.provideFunction_("math_mean",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(myList):
  localList = [e for e in myList if isinstance(e, Number)]
  if not localList: return
  return float(sum(localList)) / len(localList)
`)+"("+e+")";break;case"MEDIAN":t.definitions_.from_numbers_import_Number="from numbers import Number",t=t.provideFunction_("math_median",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(myList):
  localList = sorted([e for e in myList if isinstance(e, Number)])
  if not localList: return
  if len(localList) % 2 == 0:
    return (localList[len(localList) // 2 - 1] + localList[len(localList) // 2]) / 2.0
  else:
    return localList[(len(localList) - 1) // 2]
`)+"("+e+")";break;case"MODE":t=t.provideFunction_("math_modes",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(some_list):
  modes = []
  # Using a lists of [item, count] to keep count rather than dict
  # to avoid "unhashable" errors when the counted item is itself a list or dict.
  counts = []
  maxCount = 1
  for item in some_list:
    found = False
    for count in counts:
      if count[0] == item:
        count[1] += 1
        maxCount = max(maxCount, count[1])
        found = True
    if not found:
      counts.append([item, 1])
  for counted_item, item_count in counts:
    if item_count == maxCount:
      modes.append(counted_item)
  return modes
`)+"("+e+")";break;case"STD_DEV":t.definitions_.import_math="import math",t=t.provideFunction_("math_standard_deviation",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(numbers):
  n = len(numbers)
  if n == 0: return
  mean = float(sum(numbers)) / n
  variance = sum((x - mean) ** 2 for x in numbers) / n
  return math.sqrt(variance)
`)+"("+e+")";break;case"RANDOM":t.definitions_.import_random="import random",t="random.choice("+e+")";break;default:throw Error("Unknown operator: "+s)}return[t,i.FUNCTION_CALL]},p.math_random_float=function(e,t){return t.definitions_.import_random="import random",["random.random()",i.FUNCTION_CALL]},p.math_random_int=function(e,t){return t.definitions_.import_random="import random",["random.randint("+(t.valueToCode(e,"FROM",i.NONE)||"0")+", "+(e=t.valueToCode(e,"TO",i.NONE)||"0")+")",i.FUNCTION_CALL]},p.math_round=r,p.math_single=r,p.math_trig=r;var g={};g.procedures_callnoreturn=function(e,t){return t.forBlock.procedures_callreturn(e,t)[0]+"\n"},g.procedures_callreturn=function(e,t){let s=t.getProcedureName(e.getFieldValue("NAME")),o=[],n=e.getVars();for(let s=0;s<n.length;s++)o[s]=t.valueToCode(e,"ARG"+s,i.NONE)||"None";return[s+"("+o.join(", ")+")",i.FUNCTION_CALL]},g.procedures_defnoreturn=l,g.procedures_defreturn=l,g.procedures_ifreturn=function(e,t){let s="if "+(t.valueToCode(e,"CONDITION",i.NONE)||"False")+":\n";return t.STATEMENT_SUFFIX&&(s+=t.prefixLines(t.injectId(t.STATEMENT_SUFFIX,e),t.INDENT)),e.hasReturnValue_?(e=t.valueToCode(e,"VALUE",i.NONE)||"None",s+=t.INDENT+"return "+e+"\n"):s+=t.INDENT+"return\n",s};var I=/^\s*'([^']|\\')*'\s*$/,R=function(e){return I.test(e)?[e,i.ATOMIC]:["str("+e+")",i.FUNCTION_CALL]},m={};m.text=function(e,t){return[t.quote_(e.getFieldValue("TEXT")),i.ATOMIC]},m.text_append=function(e,t){let s=t.getVariableName(e.getFieldValue("VAR"));return s+" = str("+s+") + "+R(e=t.valueToCode(e,"TEXT",i.NONE)||"''")[0]+"\n"},m.text_changeCase=function(e,t){let s={UPPERCASE:".upper()",LOWERCASE:".lower()",TITLECASE:".title()"}[e.getFieldValue("CASE")];return[(t.valueToCode(e,"TEXT",i.MEMBER)||"''")+s,i.FUNCTION_CALL]},m.text_charAt=function(e,t){let s=e.getFieldValue("WHERE")||"FROM_START",o=t.valueToCode(e,"VALUE","RANDOM"===s?i.NONE:i.MEMBER)||"''";switch(s){case"FIRST":return[o+"[0]",i.MEMBER];case"LAST":return[o+"[-1]",i.MEMBER];case"FROM_START":return[o+"["+(e=t.getAdjustedInt(e,"AT"))+"]",i.MEMBER];case"FROM_END":return[o+"["+(e=t.getAdjustedInt(e,"AT",1,!0))+"]",i.MEMBER];case"RANDOM":return t.definitions_.import_random="import random",[t.provideFunction_("text_random_letter",`
def ${t.FUNCTION_NAME_PLACEHOLDER_}(text):
  x = int(random.random() * len(text))
  return text[x]
`)+"("+o+")",i.FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},m.text_count=function(e,t){return[(t.valueToCode(e,"TEXT",i.MEMBER)||"''")+".count("+(e=t.valueToCode(e,"SUB",i.NONE)||"''")+")",i.FUNCTION_CALL]},m.text_getSubstring=function(e,t){var o=e.getFieldValue("WHERE1");let n=e.getFieldValue("WHERE2"),r=t.valueToCode(e,"STRING",i.MEMBER)||"''";switch(o){case"FROM_START":0===(o=t.getAdjustedInt(e,"AT1"))&&(o="");break;case"FROM_END":o=t.getAdjustedInt(e,"AT1",1,!0);break;case"FIRST":o="";break;default:throw Error("Unhandled option (text_getSubstring)")}switch(n){case"FROM_START":e=t.getAdjustedInt(e,"AT2",1);break;case"FROM_END":e=t.getAdjustedInt(e,"AT2",0,!0),s.isNumber$$module$build$src$core$utils$string(String(e))?0===e&&(e=""):(t.definitions_.import_sys="import sys",e+=" or sys.maxsize");break;case"LAST":e="";break;default:throw Error("Unhandled option (text_getSubstring)")}return[r+"["+o+" : "+e+"]",i.MEMBER]},m.text_indexOf=function(e,t){let s="FIRST"===e.getFieldValue("END")?"find":"rfind",o=t.valueToCode(e,"FIND",i.NONE)||"''";return t=(t.valueToCode(e,"VALUE",i.MEMBER)||"''")+"."+s+"("+o+")",e.workspace.options.oneBasedIndex?[t+" + 1",i.ADDITIVE]:[t,i.FUNCTION_CALL]},m.text_isEmpty=function(e,t){return["not len("+(t.valueToCode(e,"VALUE",i.NONE)||"''")+")",i.LOGICAL_NOT]},m.text_join=function(e,t){switch(e.itemCount_){case 0:return["''",i.ATOMIC];case 1:return R(e=t.valueToCode(e,"ADD0",i.NONE)||"''");case 2:var o=t.valueToCode(e,"ADD0",i.NONE)||"''";return e=t.valueToCode(e,"ADD1",i.NONE)||"''",[R(o)[0]+" + "+R(e)[0],i.ADDITIVE];default:o=[];for(let s=0;s<e.itemCount_;s++)o[s]=t.valueToCode(e,"ADD"+s,i.NONE)||"''";return["''.join([str("+(e=t.nameDB_.getDistinctName("x",s.NameType$$module$build$src$core$names.VARIABLE))+") for "+e+" in ["+o.join(", ")+"]])",i.FUNCTION_CALL]}},m.text_length=function(e,t){return["len("+(t.valueToCode(e,"VALUE",i.NONE)||"''")+")",i.FUNCTION_CALL]},m.text_print=function(e,t){return"print("+(t.valueToCode(e,"TEXT",i.NONE)||"''")+")\n"},m.text_prompt=a,m.text_prompt_ext=a,m.text_replace=function(e,t){let s=t.valueToCode(e,"TEXT",i.MEMBER)||"''";return[s+".replace("+(t.valueToCode(e,"FROM",i.NONE)||"''")+", "+(e=t.valueToCode(e,"TO",i.NONE)||"''")+")",i.MEMBER]},m.text_reverse=function(e,t){return[(t.valueToCode(e,"TEXT",i.MEMBER)||"''")+"[::-1]",i.MEMBER]},m.text_trim=function(e,t){let s={LEFT:".lstrip()",RIGHT:".rstrip()",BOTH:".strip()"}[e.getFieldValue("MODE")];return[(t.valueToCode(e,"TEXT",i.MEMBER)||"''")+s,i.FUNCTION_CALL]};var O={};O.variables_get=c,O.variables_set=h;var A={};A.variables_get_dynamic=c,A.variables_set_dynamic=h;var S=new u;S.addReservedWords("math,random,Number");var C=Object.assign({},E,_,T,p,g,m,O,A);for(let e in C)S.forBlock[e]=C[e];var f={};return f.Order=i,f.PythonGenerator=u,f.pythonGenerator=S,f.__namespace__=s,f},"function"==typeof define&&define.amd?define(["./blockly_compressed.js"],s):e.exports=s(h("97Mr6"))});var d=h("hKdZU");h("7nxqN"),h("7nxqN").default.defineExtension("json-enc",{init:function(e){i=e},onEvent:function(e,t){"htmx:configRequest"===e&&(t.detail.headers["Content-Type"]="application/json")},encodeParameters:function(e,t,s){e.overrideMimeType("text/json");let o={};t.forEach(function(e,t){Object.hasOwn(o,t)?(Array.isArray(o[t])||(o[t]=[o[t]]),o[t].push(e)):o[t]=e});let n=i.getExpressionVars(s);return Object.keys(o).forEach(function(e){o[e]=Object.hasOwn(n,e)?n[e]:o[e]}),JSON.stringify(o)}});var E={},_=function(e){var t=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,s={},o={manual:e.Prism&&e.Prism.manual,disableWorkerMessageHandler:e.Prism&&e.Prism.disableWorkerMessageHandler,util:{encode:function e(t){return t instanceof n?new n(t.type,e(t.content),t.alias):Array.isArray(t)?t.map(e):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++i}),e.__id},clone:function e(t,i){var s,n;switch(i=i||{},o.util.type(t)){case"Object":if(i[n=o.util.objId(t)])return i[n];for(var r in s={},i[n]=s,t)t.hasOwnProperty(r)&&(s[r]=e(t[r],i));return s;case"Array":if(i[n=o.util.objId(t)])return i[n];return s=[],i[n]=s,t.forEach(function(t,o){s[o]=e(t,i)}),s;default:return t}},getLanguage:function(e){for(;e;){var i=t.exec(e.className);if(i)return i[1].toLowerCase();e=e.parentElement}return"none"},setLanguage:function(e,i){e.className=e.className.replace(RegExp(t,"gi"),""),e.classList.add("language-"+i)},currentScript:function(){if("undefined"==typeof document)return null;if(document.currentScript&&"SCRIPT"===document.currentScript.tagName&&1)return document.currentScript;try{throw Error()}catch(s){var e=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(s.stack)||[])[1];if(e){var t=document.getElementsByTagName("script");for(var i in t)if(t[i].src==e)return t[i]}return null}},isActive:function(e,t,i){for(var s="no-"+t;e;){var o=e.classList;if(o.contains(t))return!0;if(o.contains(s))return!1;e=e.parentElement}return!!i}},languages:{plain:s,plaintext:s,text:s,txt:s,extend:function(e,t){var i=o.util.clone(o.languages[e]);for(var s in t)i[s]=t[s];return i},insertBefore:function(e,t,i,s){var n=(s=s||o.languages)[e],r={};for(var l in n)if(n.hasOwnProperty(l)){if(l==t)for(var a in i)i.hasOwnProperty(a)&&(r[a]=i[a]);i.hasOwnProperty(l)||(r[l]=n[l])}var c=s[e];return s[e]=r,o.languages.DFS(o.languages,function(t,i){i===c&&t!=e&&(this[t]=r)}),r},DFS:function e(t,i,s,n){n=n||{};var r=o.util.objId;for(var l in t)if(t.hasOwnProperty(l)){i.call(t,l,t[l],s||l);var a=t[l],c=o.util.type(a);"Object"!==c||n[r(a)]?"Array"!==c||n[r(a)]||(n[r(a)]=!0,e(a,i,l,n)):(n[r(a)]=!0,e(a,i,null,n))}}},plugins:{},highlightAll:function(e,t){o.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,i){var s={callback:i,container:e,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",s),s.elements=Array.prototype.slice.apply(s.container.querySelectorAll(s.selector)),o.hooks.run("before-all-elements-highlight",s);for(var n,r=0;n=s.elements[r++];)o.highlightElement(n,!0===t,s.callback)},highlightElement:function(t,i,s){var n=o.util.getLanguage(t),r=o.languages[n];o.util.setLanguage(t,n);var l=t.parentElement;l&&"pre"===l.nodeName.toLowerCase()&&o.util.setLanguage(l,n);var a=t.textContent,c={element:t,language:n,grammar:r,code:a};function h(e){c.highlightedCode=e,o.hooks.run("before-insert",c),c.element.innerHTML=c.highlightedCode,o.hooks.run("after-highlight",c),o.hooks.run("complete",c),s&&s.call(c.element)}if(o.hooks.run("before-sanity-check",c),(l=c.element.parentElement)&&"pre"===l.nodeName.toLowerCase()&&!l.hasAttribute("tabindex")&&l.setAttribute("tabindex","0"),!c.code){o.hooks.run("complete",c),s&&s.call(c.element);return}if(o.hooks.run("before-highlight",c),!c.grammar)return void h(o.util.encode(c.code));if(i&&e.Worker){var u=new Worker(o.filename);u.onmessage=function(e){h(e.data)},u.postMessage(JSON.stringify({language:c.language,code:c.code,immediateClose:!0}))}else h(o.highlight(c.code,c.grammar,c.language))},highlight:function(e,t,i){var s={code:e,grammar:t,language:i};if(o.hooks.run("before-tokenize",s),!s.grammar)throw Error('The language "'+s.language+'" has no grammar.');return s.tokens=o.tokenize(s.code,s.grammar),o.hooks.run("after-tokenize",s),n.stringify(o.util.encode(s.tokens),s.language)},tokenize:function(e,t){var i=t.rest;if(i){for(var s in i)t[s]=i[s];delete t.rest}var c=new l;return a(c,c.head,e),function e(t,i,s,l,c,h){for(var u in s)if(s.hasOwnProperty(u)&&s[u]){var d=s[u];d=Array.isArray(d)?d:[d];for(var E=0;E<d.length;++E){if(h&&h.cause==u+","+E)return;var _=d[E],T=_.inside,p=!!_.lookbehind,g=!!_.greedy,I=_.alias;if(g&&!_.pattern.global){var R=_.pattern.toString().match(/[imsuy]*$/)[0];_.pattern=RegExp(_.pattern.source,R+"g")}for(var m=_.pattern||_,O=l.next,A=c;O!==i.tail&&(!h||!(A>=h.reach));A+=O.value.length,O=O.next){var S,C=O.value;if(i.length>t.length)return;if(!(C instanceof n)){var f=1;if(g){if(!(S=r(m,A,t,p))||S.index>=t.length)break;var L=S.index,N=S.index+S[0].length,b=A;for(b+=O.value.length;L>=b;)b+=(O=O.next).value.length;if(b-=O.value.length,A=b,O.value instanceof n)continue;for(var $=O;$!==i.tail&&(b<N||"string"==typeof $.value);$=$.next)f++,b+=$.value.length;f--,C=t.slice(A,b),S.index-=A}else if(!(S=r(m,0,C,p)))continue;var L=S.index,D=S[0],M=C.slice(0,L),P=C.slice(L+D.length),y=A+C.length;h&&y>h.reach&&(h.reach=y);var k=O.prev;if(M&&(k=a(i,k,M),A+=M.length),function(e,t,i){for(var s=t.next,o=0;o<i&&s!==e.tail;o++)s=s.next;t.next=s,s.prev=t,e.length-=o}(i,k,f),O=a(i,k,new n(u,T?o.tokenize(D,T):D,I,D)),P&&a(i,O,P),f>1){var w={cause:u+","+E,reach:y};e(t,i,s,O.prev,A,w),h&&w.reach>h.reach&&(h.reach=w.reach)}}}}}}(e,c,t,c.head,0),function(e){for(var t=[],i=e.head.next;i!==e.tail;)t.push(i.value),i=i.next;return t}(c)},hooks:{all:{},add:function(e,t){var i=o.hooks.all;i[e]=i[e]||[],i[e].push(t)},run:function(e,t){var i=o.hooks.all[e];if(i&&i.length)for(var s,n=0;s=i[n++];)s(t)}},Token:n};function n(e,t,i,s){this.type=e,this.content=t,this.alias=i,this.length=0|(s||"").length}function r(e,t,i,s){e.lastIndex=t;var o=e.exec(i);if(o&&s&&o[1]){var n=o[1].length;o.index+=n,o[0]=o[0].slice(n)}return o}function l(){var e={value:null,prev:null,next:null},t={value:null,prev:e,next:null};e.next=t,this.head=e,this.tail=t,this.length=0}function a(e,t,i){var s=t.next,o={value:i,prev:t,next:s};return t.next=o,s.prev=o,e.length++,o}if(e.Prism=o,n.stringify=function e(t,i){if("string"==typeof t)return t;if(Array.isArray(t)){var s="";return t.forEach(function(t){s+=e(t,i)}),s}var n={type:t.type,content:e(t.content,i),tag:"span",classes:["token",t.type],attributes:{},language:i},r=t.alias;r&&(Array.isArray(r)?Array.prototype.push.apply(n.classes,r):n.classes.push(r)),o.hooks.run("wrap",n);var l="";for(var a in n.attributes)l+=" "+a+'="'+(n.attributes[a]||"").replace(/"/g,"&quot;")+'"';return"<"+n.tag+' class="'+n.classes.join(" ")+'"'+l+">"+n.content+"</"+n.tag+">"},!e.document)return e.addEventListener&&(o.disableWorkerMessageHandler||e.addEventListener("message",function(t){var i=JSON.parse(t.data),s=i.language,n=i.code,r=i.immediateClose;e.postMessage(o.highlight(n,o.languages[s],s)),r&&e.close()},!1)),o;var c=o.util.currentScript();function h(){o.manual||o.highlightAll()}if(c&&(o.filename=c.src,c.hasAttribute("data-manual")&&(o.manual=!0)),!o.manual){var u=document.readyState;"loading"===u||"interactive"===u&&c&&c.defer?document.addEventListener("DOMContentLoaded",h):window.requestAnimationFrame?window.requestAnimationFrame(h):window.setTimeout(h,16)}return o}("undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{});E&&(E=_),void 0!==r&&(r.Prism=_),_.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},_.languages.markup.tag.inside["attr-value"].inside.entity=_.languages.markup.entity,_.languages.markup.doctype.inside["internal-subset"].inside=_.languages.markup,_.hooks.add("wrap",function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))}),Object.defineProperty(_.languages.markup.tag,"addInlined",{value:function(e,t){var i={};i["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:_.languages[t]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};s["language-"+t]={pattern:/[\s\S]+/,inside:_.languages[t]};var o={};o[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return e}),"i"),lookbehind:!0,greedy:!0,inside:s},_.languages.insertBefore("markup","cdata",o)}}),Object.defineProperty(_.languages.markup.tag,"addAttribute",{value:function(e,t){_.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:_.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),_.languages.html=_.languages.markup,_.languages.mathml=_.languages.markup,_.languages.svg=_.languages.markup,_.languages.xml=_.languages.extend("markup",{}),_.languages.ssml=_.languages.xml,_.languages.atom=_.languages.xml,_.languages.rss=_.languages.xml,s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/,_.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},_.languages.css.atrule.inside.rest=_.languages.css,(o=_.languages.markup)&&(o.tag.addInlined("style","css"),o.tag.addAttribute("style","css")),_.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},_.languages.javascript=_.languages.extend("clike",{"class-name":[_.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source)+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),_.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,_.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:_.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:_.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:_.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:_.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:_.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),_.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:_.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),_.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),_.languages.markup&&(_.languages.markup.tag.addInlined("script","javascript"),_.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),_.languages.js=_.languages.javascript,function(){if(void 0!==_&&"undefined"!=typeof document){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var e={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},t="data-src-status",i="loading",s="loaded",o="pre[data-src]:not(["+t+'="'+s+'"]):not(['+t+'="'+i+'"])';_.hooks.add("before-highlightall",function(e){e.selector+=", "+o}),_.hooks.add("before-sanity-check",function(n){var r=n.element;if(r.matches(o)){n.code="",r.setAttribute(t,i);var l,a,c,h,u=r.appendChild(document.createElement("CODE"));u.textContent="Loading…";var d=r.getAttribute("data-src"),E=n.language;if("none"===E){var T=(/\.(\w+)$/.exec(d)||[,"none"])[1];E=e[T]||T}_.util.setLanguage(u,E),_.util.setLanguage(r,E);var p=_.plugins.autoloader;p&&p.loadLanguages(E),l=d,a=function(e){r.setAttribute(t,s);var i=function(e){var t=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(e||"");if(t){var i=Number(t[1]),s=t[2],o=t[3];return s?o?[i,Number(o)]:[i,void 0]:[i,i]}}(r.getAttribute("data-range"));if(i){var o=e.split(/\r\n?|\n/g),n=i[0],l=null==i[1]?o.length:i[1];n<0&&(n+=o.length),n=Math.max(0,Math.min(n-1,o.length)),l<0&&(l+=o.length),l=Math.max(0,Math.min(l,o.length)),e=o.slice(n,l).join("\n"),r.hasAttribute("data-start")||r.setAttribute("data-start",String(n+1))}u.textContent=e,_.highlightElement(u)},c=function(e){r.setAttribute(t,"failed"),u.textContent=e},(h=new XMLHttpRequest).open("GET",l,!0),h.onreadystatechange=function(){var e;4==h.readyState&&(h.status<400&&h.responseText?a(h.responseText):h.status>=400?c((e=h.status,"✖ Error "+e+" while fetching file: "+h.statusText)):c("✖ Error: File does not exist or is empty"))},h.send(null)}}),_.plugins.fileHighlight={highlight:function(e){for(var t,i=(e||document).querySelectorAll(o),s=0;t=i[s++];)_.highlightElement(t)}};var n=!1;_.fileHighlight=function(){n||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),n=!0),_.plugins.fileHighlight.highlight.apply(this,arguments)}}}(),Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python;var T={};n=function(e,t,i){return e.setLocale(t),e},"function"==typeof define&&define.amd?define(["blockly/core","blockly/msg/en","blockly/blocks"],n):T=n(h("ca2Ll"),h("cWmWX"),h("94GXq"));var p={};function g(e,t,i="MATERIAL_ID"){let s=e.getFieldValue(i);return[`'${s}'`,t.ORDER_ATOMIC]}function I(e,t,i="ENTITY_ID"){let s=e.getFieldValue(i);return[`'${s}'`,t.ORDER_ATOMIC]}p=h("eqdor"),console.log("mc.mjs: Start of file execution"),h("eqdor"),window.Alpine=d.default;let R={blocks:{languageVersion:0,blocks:[]},variables:[]},m="mcEdWorkspaceAutosave";async function O(e){if(e){console.log(`Sending request to delete power: ${e}`);try{let t=await fetch(`/api/power/${e}`,{method:"DELETE"});if(t.ok)console.log("Delete request successful. The server will trigger a library refresh."),window.dispatchEvent(new CustomEvent("library-changed",{bubbles:!0}));else{let e=await t.text();console.error("Error deleting power:",t.status,e),alert(`Failed to delete power: ${e}`)}}catch(e){console.error("Network error while deleting power:",e),alert("Network error. Could not delete power.")}}}window.prepareAndOpenSaveModal=function(){let e="",i="",s=t.getTopBlocks(!0).find(e=>"procedures_defnoreturn"===e.type||"procedures_defreturn"===e.type);s&&(e=s.getFieldValue("NAME"),i=s.getCommentText()),window.dispatchEvent(new CustomEvent("open-save-modal",{detail:{name:e,description:i,category:""}}))},window.handleDeletePower=O;var A={};async function S(){let i;async function s(e,t){try{let i=await fetch("/api/ipython_magic",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({command:e,arguments:t})});if(!i.ok)throw Error(`HTTP error! status: ${i.status}`);let s=await i.json();if(s.error)return console.error("IPython Magic Error:",s.error),alert(`IPython Command Error: ${s.error}`),null;return console.log("IPython Magic Output:",s.output),s.output}catch(e){return console.error("Fetch error calling IPython API:",e),alert("Error communicating with IPython process."),null}}async function o(){if(!t)return void alert("Workspace is not ready yet.");if(window.showOpenFilePicker)try{let[e]=await window.showOpenFilePicker({types:[{description:"Blockly Workspace Files",accept:{"application/json":[".json"]}}],multiple:!1}),i=await e.getFile(),s=await i.text(),o=JSON.parse(s);t.clear(),T.serialization.workspaces.load(o,t),console.log(`Successfully loaded power from: ${i.name}`)}catch(e){"AbortError"===e.name?console.log("User cancelled the file open dialog."):(console.error("Error opening or loading file:",e),alert("An error occurred while trying to load the file."))}else{console.warn("File System Access API not supported. Using legacy file input.");let e=document.createElement("input");e.type="file",e.accept=".json,application/json",e.onchange=async e=>{let i=e.target.files[0];if(i)try{let e=await i.text(),s=JSON.parse(e);t.clear(),T.serialization.workspaces.load(s,t),console.log(`Successfully loaded power from: ${i.name}`)}catch(e){console.error("Error parsing or loading file:",e),alert("Error loading workspace: The selected file is not valid JSON.")}},e.click()}}function n(){if(t)try{let e=T.serialization.workspaces.save(t),i=JSON.stringify(e);localStorage.setItem(m,i),console.log("Workspace autosaved to localStorage.")}catch(e){console.error("Error during autosave:",e)}}function r(e,t=500){let i;return(...s)=>{clearTimeout(i),i=setTimeout(()=>{e.apply(this,s)},t)}}async function a(){console.log("Handling save power with strict type introspection...");let i=document.getElementById("savePowerForm");if(!i)return;let s=Object.fromEntries(new FormData(i).entries());if(!s.name)return void alert("Please enter a name for your power.");let o=T.serialization.workspaces.save(t),n=[],r=null,l=null,a=t.getTopBlocks(!0),c=a.find(e=>"procedures_defnoreturn"===e.type||"procedures_defreturn"===e.type);if(c){r=c.getFieldValue("NAME"),console.log(`Found functional power definition: '${r}'.`);let t=p.pythonGenerator.nameDB_.getName(r,e.BlocklyNameTypes.PROCEDURE),i=c.getVars(),s=i.map(t=>p.pythonGenerator.nameDB_.getName(t,e.BlocklyNameTypes.VARIABLE)),o=p.pythonGenerator.statementToCode(c,"STACK")||p.pythonGenerator.INDENT+"pass\n";if("procedures_defreturn"===c.type){let e=p.pythonGenerator.valueToCode(c,"RETURN",p.pythonGenerator.ORDER_NONE)||"None";o+=p.pythonGenerator.INDENT+"return "+e+"\n"}l=`def ${t}(self, ${s.join(", ")}):
${o}`;let h=a.find(e=>("procedures_callnoreturn"===e.type||"procedures_callreturn"===e.type)&&e.getFieldValue("NAME")===r);if(!h)return void alert(`Save Error: To save the function '${r}', you must place a "call ${r}" block on the workspace to define its parameter types.`);if(i.length>0)for(let e=0;e<i.length;e++){let t=i[e],s=null,o=h.getInput("ARG"+e);if(!o||!o.connection||!o.connection.targetBlock())return void alert(`Save Error for function '${r}': The parameter '${t}' must have a block connected to it to define its type.`);let l=o.connection.targetBlock().outputConnection;if(l&&l.getCheck()){let e=l.getCheck();e&&e.length>0&&(s=e[0])}if(!s)return void alert(`Save Error for function '${r}': Could not determine the type for parameter '${t}'. Please ensure the connected block has an output type.`);console.log(`- Found parameter: '${t}' of type '${s}'`),n.push({name:t,type:s,default:0})}}else console.log("No function definition found. Saving as a 'Script Power'."),l=p.pythonGenerator.workspaceToCode(t);let h=[];for(let e of c.getDescendants(!1))if("procedures_callnoreturn"===e.type||"procedures_callreturn"===e.type){let t=e.getFieldValue("NAME");t&&!h.includes(t)&&h.push(t)}console.log(`Found dependencies: ${h.join(", ")}`);let u={name:s.name,description:s.description,category:s.category||"General",power_id:s.power_id||null,function_name:r,parameters:n,blockly_json:o,python_code:l,dependencies:h};console.log("Sending final power data to server:",u);try{let e=await fetch("/api/powers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});e.ok?(alert(`Power "${s.name}" saved successfully!`),window.dispatchEvent(new CustomEvent("library-changed"))):alert(`Failed to save power: ${await e.text()}`)}catch(e){console.error("Network error while saving power:",e),alert("Network error. Could not save power.")}}c=T,c.FieldColour=class extends c.Field{static fromJson(e){return new c.FieldColour(e.colour,null)}constructor(e,t){super(e,t),this.setValue(e),this.colour_="#000000"}initView(){this.createBorderRect_(),this.borderRect_.style.fillOpacity="1",this.setValue(this.getValue())}createWidget_(){return document.createElement("div")}dispose(){c.WidgetDiv.hideIfOwner(this),super.dispose()}getValue(){return this.colour_}setValue(e){this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.workspace&&this.sourceBlock_.workspace.options.readOnly||this.colour_!==e&&(this.sourceBlock_&&c.Events.isEnabled()&&c.Events.fire(new c.Events.BlockChange(this.sourceBlock_,"field",this.name,this.colour_,e)),this.colour_=e,this.borderRect_&&(this.borderRect_.style.fill=e||"#000"))}getText(){return this.getValue()}setColours(e){return this}setColumns(e){return this}},c.FieldAxis=class extends c.FieldDropdown{static fromJson(e){return new c.FieldAxis(e.value,e.validator)}constructor(e,t){super(t.map(e=>[e,e])),this.setValue(e)}},c.FieldMinecraftColour=class extends c.FieldDropdown{constructor(t,i){super(c.FieldMinecraftColour.menuGenerator,i);let s=t;e.Colours.find(e=>e.id===s)||(s=e.Colours.length>0?e.Colours[0].id:"WHITE"),this.setValue(s)}static menuGenerator(){return e.Colours.map(e=>[{src:"data:image/svg+xml;base64,"+btoa(`<svg xmlns="http://www.w3.org/2000/svg" width="76" height="16"><rect x="0" y="0" width="16" height="16" fill="${e.hex}" stroke="#888" stroke-width="1" rx="2" ry="2"></rect><text x="21" y="12" font-family="sans-serif" font-size="12px" fill="#000000" dominant-baseline="middle">${e.name}</text></svg>`),width:76,height:16,alt:e.name},e.id])}getText_(){let t=e.Colours.find(e=>e.id===this.getValue());return t?t.name:this.getValue()||""}initView(){super.initView()}setValue(e){let t=this.getValue();super.setValue(e),null!==e&&e!==t&&this.sourceBlock_&&this.sourceBlock_.rendered&&this.forceRerender()}static fromJson(t){let i=t.colour_id||(e.Colours.length>0?e.Colours[0].id:"WHITE");return new c.FieldMinecraftColour(i,null)}},c.fieldRegistry.register("field_minecraft_colour",c.FieldMinecraftColour);var c,h,u,d,_,O,S=T;e={BlocklyNameTypes:{PROCEDURE:S.Names.NameType.PROCEDURE,VARIABLE:S.Names.NameType.VARIABLE},BlocklyUtils:{configureShadow:function(t,i){let s=e.Defaults.values[t.type]?.[i]?.shadow;s&&t.getInput(i).connection.setShadowDom(S.utils.xml.textToDom(s))}},Defaults:{values:{}},Colours:[{name:"White",hex:"#FFFFFF",id:"WHITE"},{name:"Orange",hex:"#D87F33",id:"ORANGE"},{name:"Magenta",hex:"#B24CD8",id:"MAGENTA"},{name:"Light Blue",hex:"#6699D8",id:"LIGHT_BLUE"},{name:"Yellow",hex:"#E5E533",id:"YELLOW"},{name:"Lime",hex:"#7FCC19",id:"LIME"},{name:"Pink",hex:"#F27FA5",id:"PINK"},{name:"Gray",hex:"#4C4C4C",id:"GRAY"},{name:"Light Gray",hex:"#999999",id:"LIGHT_GRAY"},{name:"Cyan",hex:"#4C7F99",id:"CYAN"},{name:"Azure",hex:"#007FFF",id:"AZURE"},{name:"Purple",hex:"#7F3FB2",id:"PURPLE"},{name:"Blue",hex:"#334CB2",id:"BLUE"},{name:"Brown",hex:"#664C33",id:"BROWN"},{name:"Green",hex:"#667F33",id:"GREEN"},{name:"Red",hex:"#993333",id:"RED"},{name:"Black",hex:"#191919",id:"BLACK"},{name:"Tinted",hex:"#2A232B",id:"TINTED_GLASS_BLOCK"}]};let C=`
        <shadow type="minecraft_vector_3d">
            <value name="X"><shadow type="math_number"><field name="NUM">0</field></shadow></value>
            <value name="Y"><shadow type="math_number"><field name="NUM">0</field></shadow></value>
            <value name="Z"><shadow type="math_number"><field name="NUM">0</field></shadow></value>
        </shadow>`,f=`
        <shadow type="minecraft_vector_3d">
            <value name="X"><shadow type="math_number"><field name="NUM">0</field></shadow></value>
            <value name="Y"><shadow type="math_number"><field name="NUM">1</field></shadow></value>
            <value name="Z"><shadow type="math_number"><field name="NUM">0</field></shadow></value>
        </shadow>`,L=`
        <shadow type="minecraft_picker_world">
            <field name="MATERIAL_ID">STONE</field>
        </shadow>`;e.Defaults.values.minecraft_matrix_3d_euler={YAW:{shadow:'<shadow type="math_number"><field name="NUM">0</field></shadow>'},PITCH:{shadow:'<shadow type="math_number"><field name="NUM">0</field></shadow>'},ROLL:{shadow:'<shadow type="math_number"><field name="NUM">0</field></shadow>'}},e.Defaults.values.minecraft_matrix_3d_elements={},["R00","R01","R02","R10","R11","R12","R20","R21","R22"].forEach((t,i)=>{e.Defaults.values.minecraft_matrix_3d_elements[t]={shadow:`<shadow type="math_number"><field name="NUM">${+(i%4==0)}</field></shadow>`}}),e.Defaults.values.minecraft_vector_binary_op={A:{shadow:C},B:{shadow:C}},e.Defaults.values.minecraft_vector_scalar_multiply={A:{shadow:C},B:{shadow:'<shadow type="math_number"><field name="NUM">1</field></shadow>'}},e.Defaults.values.minecraft_vector_dot_product={A:{shadow:C},B:{shadow:C}},e.Defaults.values.minecraft_matrix_vector_multiply={A:{shadow:'<shadow type="minecraft_matrix_3d_euler"></shadow>'},B:{shadow:C}},e.Defaults.values.minecraft_action_create_digital_line={POINT1:{shadow:C},POINT2:{shadow:C},BLOCK_TYPE:{shadow:L}},e.Defaults.values.minecraft_action_create_digital_plane={NORMAL:{shadow:f},POINT_ON_PLANE:{shadow:C},BLOCK_TYPE:{shadow:L},OUTER_WIDTH:{shadow:'<shadow type="math_number"><field name="NUM">10</field></shadow>'},OUTER_LENGTH:{shadow:'<shadow type="math_number"><field name="NUM">10</field></shadow>'},PLANE_THICKNESS:{shadow:'<shadow type="math_number"><field name="NUM">1</field></shadow>'}},e.Defaults.values.minecraft_action_create_digital_ball={CENTER:{shadow:C},RADIUS:{shadow:'<shadow type="math_number"><field name="NUM">10</field></shadow>'},INNER_RADIUS:{shadow:'<shadow type="math_number"><field name="NUM">0</field></shadow>'},BLOCK_TYPE:{shadow:L}},e.Defaults.values.minecraft_action_create_digital_tube={POINT1:{shadow:C},POINT2:{shadow:'<shadow type="minecraft_vector_3d"><value name="Y"><shadow type="math_number"><field name="NUM">10</field></shadow></value></shadow>'},OUTER_THICKNESS:{shadow:'<shadow type="math_number"><field name="NUM">3</field></shadow>'},INNER_THICKNESS:{shadow:'<shadow type="math_number"><field name="NUM">0</field></shadow>'},BLOCK_TYPE:{shadow:L}},e.Defaults.values.minecraft_action_create_digital_cube={CENTER:{shadow:C},SIDE_LENGTH:{shadow:'<shadow type="math_number"><field name="NUM">5</field></shadow>'},ROTATION_MATRIX:{shadow:'<shadow type="minecraft_matrix_3d_euler"></shadow>'},BLOCK_TYPE:{shadow:L},INNER_OFFSET_FACTOR:{shadow:'<shadow type="math_number"><field name="NUM">0</field></shadow>'}},e.Defaults.values.minecraft_action_create_digital_disc={NORMAL:{shadow:f},CENTER_POINT:{shadow:C},OUTER_RADIUS:{shadow:'<shadow type="math_number"><field name="NUM">10</field></shadow>'},BLOCK_TYPE:{shadow:L},DISC_THICKNESS:{shadow:'<shadow type="math_number"><field name="NUM">1</field></shadow>'},INNER_RADIUS:{shadow:'<shadow type="math_number"><field name="NUM">0</field></shadow>'}},e.Defaults.values.minecraft_action_set_block={BLOCK_TYPE:{shadow:L},POSITION:{shadow:C}},e.Defaults.values.minecraft_action_get_block={POSITION:{shadow:C}},e.Defaults.values.minecraft_action_get_height={POSITION:{shadow:C}},e.Defaults.values.minecraft_action_post_to_chat={MESSAGE:{shadow:'<shadow type="text"><field name="TEXT">Hello, Minecraft!</field></shadow>'}},e.Defaults.values.minecraft_action_set_sign={POSITION:{shadow:C},LINE1:{shadow:'<shadow type="text"><field name="TEXT"></field></shadow>'},LINE2:{shadow:'<shadow type="text"><field name="TEXT">Hello!</field></shadow>'},LINE3:{shadow:'<shadow type="text"><field name="TEXT"></field></shadow>'},LINE4:{shadow:'<shadow type="text"><field name="TEXT"></field></shadow>'}},e.Defaults.values.minecraft_action_create_explosion={POSITION:{shadow:C},POWER:{shadow:'<shadow type="math_number"><field name="NUM">4</field></shadow>'}},e.Defaults.values.minecraft_action_spawn_entity={ENTITY_TYPE:{shadow:'<shadow type="minecraft_picker_entity_passive_mobs"><field name="ENTITY_ID">PIG</field></shadow>'},POSITION:{shadow:'<shadow type="minecraft_vector_3d"><value name="X"><shadow type="math_number"><field name="NUM">0</field></shadow></value><value name="Y"><shadow type="math_number"><field name="NUM">0</field></shadow></value><value name="Z"><shadow type="math_number"><field name="NUM">0</field></shadow></value></shadow>'}},S.ALIGN_RIGHT="RIGHT",S.Msg={...S.Msg,MINECRAFT_COLUMN:"column",MINECRAFT_COLUMN_WIDTH:"width",MINECRAFT_COLUMN_HEIGHT:"height",MINECRAFT_COLUMN_TYPE:"type",MINECRAFT_COLUMN_FILLED:"filled",MINECRAFT_PLANE:"plane",CATEGORY_CRAFT:"Craft",CATEGORY_BLOCKS:"Blocks",CATEGORY_POSITION:"Position",MINECRAFT_SET_BLOCK:"set block",MINECRAFT_TYPE:"type",MINECRAFT_SET_BLOCKS:"set blocks",MINECRAFT_SIZE:"size",MINECRAFT_SET_FLOOR:"set floor",MINECRAFT_CREATE_DOOR:"create door",MINECRAFT_CREATE_DOOR_FACING:"facing",MINECRAFT_FACING_NORTH:"north",MINECRAFT_FACING_SOUTH:"south",MINECRAFT_FACING_EAST:"east",MINECRAFT_FACING_WEST:"west",MINECRAFT_CREATE_SHAPE:"create shape",MINECRAFT_SHAPE_CUBE:"cube",MINECRAFT_SHAPE_SPHERE:"sphere",MINECRAFT_SHAPE_PYRAMID:"pyramid",MINECRAFT_PRIMITIVE_TYPE:"type",MINECRAFT_CREATE_SHAPE_POSITION:"position",MINECRAFT_PRIMITIVE_SIZE:"size",MINECRAFT_PRIMITIVE_RADIUS:"radius",MINECRAFT_PRIMITIVE_BASE:"base",MINECRAFT_VECTOR_DELTA:"vector delta",MINECRAFT_VECTOR:"vector",ADD_COMMENT:"Add Comment",CANNOT_DELETE_VARIABLE_PROCEDURE:"Can't delete the variable '%1' because it's part of the definition of the function '%2'",CHANGE_VALUE_TITLE:"Change value:",CLEAN_UP:"Clean up Blocks",COLLAPSE_ALL:"Collapse Blocks",COLLAPSE_BLOCK:"Collapse Block",COLOUR_BLEND_COLOUR1:"colour 1",COLOUR_BLEND_COLOUR2:"colour 2",COLOUR_BLEND_HELPURL:"http://meyerweb.com/eric/tools/color-blend/",COLOUR_BLEND_RATIO:"ratio",COLOUR_BLEND_TITLE:"blend",COLOUR_BLEND_TOOLTIP:"Blends two colours together with a given ratio (0.0 - 1.0).",COLOUR_PICKER_HELPURL:"https://en.wikipedia.org/wiki/Color",COLOUR_PICKER_TOOLTIP:"Choose a colour from the palette.",COLOUR_RANDOM_HELPURL:"http://randomcolour.com",COLOUR_RANDOM_TITLE:"random colour",COLOUR_RANDOM_TOOLTIP:"Choose a colour at random.",COLOUR_RGB_BLUE:"blue",COLOUR_RGB_GREEN:"green",COLOUR_RGB_HELPURL:"http://www.december.com/html/spec/colorper.html",COLOUR_RGB_RED:"red",COLOUR_RGB_TITLE:"colour with",COLOUR_RGB_TOOLTIP:"Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",CONTROLS_FLOW_STATEMENTS_HELPURL:"https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK:"break out of loop",CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE:"continue with next iteration of loop",CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK:"Break out of the containing loop.",CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE:"Skip the rest of this loop, and continue with the next iteration.",CONTROLS_FLOW_STATEMENTS_WARNING:"Warning: This block may only be used within a loop.",CONTROLS_FOREACH_HELPURL:"https://github.com/google/blockly/wiki/Loops#for-each",CONTROLS_FOREACH_TITLE:"for each item %1 in list %2",CONTROLS_FOREACH_TOOLTIP:"For each item in a list, set the variable '%1' to the item, and then do some statements.",CONTROLS_FOR_HELPURL:"https://github.com/google/blockly/wiki/Loops#count-with",CONTROLS_FOR_TITLE:"count with %1 from %2 to %3 by %4",CONTROLS_FOR_TOOLTIP:"Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",CONTROLS_IF_ELSEIF_TOOLTIP:"Add a condition to the if block.",CONTROLS_IF_ELSE_TOOLTIP:"Add a final, catch-all condition to the if block.",CONTROLS_IF_HELPURL:"https://github.com/google/blockly/wiki/IfElse",CONTROLS_IF_IF_TOOLTIP:"Add, remove, or reorder sections to reconfigure this if block.",CONTROLS_IF_MSG_ELSE:"else",CONTROLS_IF_MSG_ELSEIF:"else if",CONTROLS_IF_MSG_IF:"if",CONTROLS_IF_TOOLTIP_1:"If a value is true, then do some statements.",CONTROLS_IF_TOOLTIP_2:"If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",CONTROLS_IF_TOOLTIP_3:"If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",CONTROLS_IF_TOOLTIP_4:"If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",CONTROLS_REPEAT_HELPURL:"https://en.wikipedia.org/wiki/For_loop",CONTROLS_REPEAT_INPUT_DO:"do",CONTROLS_REPEAT_TITLE:"repeat %1 times",CONTROLS_REPEAT_TOOLTIP:"Do some statements several times.",CONTROLS_WHILEUNTIL_HELPURL:"https://github.com/google/blockly/wiki/Loops#repeat",CONTROLS_WHILEUNTIL_OPERATOR_UNTIL:"repeat until",CONTROLS_WHILEUNTIL_OPERATOR_WHILE:"repeat while",CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL:"While a value is false, then do some statements.",CONTROLS_WHILEUNTIL_TOOLTIP_WHILE:"While a value is true, then do some statements.",DELETE_ALL_BLOCKS:"Delete all %1 blocks?",DELETE_BLOCK:"Delete Block",DELETE_VARIABLE:"Delete the '%1' variable",DELETE_VARIABLE_CONFIRMATION:"Delete %1 uses of the '%2' variable?",DELETE_X_BLOCKS:"Delete %1 Blocks",DISABLE_BLOCK:"Disable Block",DUPLICATE_BLOCK:"Duplicate",ENABLE_BLOCK:"Enable Block",EXPAND_ALL:"Expand Blocks",EXPAND_BLOCK:"Expand Block",EXTERNAL_INPUTS:"External Inputs",HELP:"Help",INLINE_INPUTS:"Inline Inputs",IOS_CANCEL:"Cancel",IOS_ERROR:"Error",IOS_OK:"OK",IOS_PROCEDURES_ADD_INPUT:"+ Add Input",IOS_PROCEDURES_ALLOW_STATEMENTS:"Allow statements",IOS_PROCEDURES_DUPLICATE_INPUTS_ERROR:"This function has duplicate inputs.",IOS_PROCEDURES_INPUTS:"INPUTS",IOS_VARIABLES_ADD_BUTTON:"Add",IOS_VARIABLES_ADD_VARIABLE:"+ Add Variable",IOS_VARIABLES_DELETE_BUTTON:"Delete",IOS_VARIABLES_EMPTY_NAME_ERROR:"You can't use an empty variable name.",IOS_VARIABLES_RENAME_BUTTON:"Rename",IOS_VARIABLES_VARIABLE_NAME:"Variable name",LISTS_CREATE_EMPTY_HELPURL:"https://github.com/google/blockly/wiki/Lists#create-empty-list",LISTS_CREATE_EMPTY_TITLE:"create empty list",LISTS_CREATE_EMPTY_TOOLTIP:"Returns a list, of length 0, containing no data records",LISTS_CREATE_WITH_CONTAINER_TITLE_ADD:"list",LISTS_CREATE_WITH_CONTAINER_TOOLTIP:"Add, remove, or reorder sections to reconfigure this list block.",LISTS_CREATE_WITH_HELPURL:"https://github.com/google/blockly/wiki/Lists#create-list-with",LISTS_CREATE_WITH_INPUT_WITH:"create list with",LISTS_CREATE_WITH_ITEM_TOOLTIP:"Add an item to the list.",LISTS_CREATE_WITH_TOOLTIP:"Create a list with any number of items.",LISTS_GET_INDEX_FIRST:"first",LISTS_GET_INDEX_FROM_END:"# from end",LISTS_GET_INDEX_FROM_START:"#",LISTS_GET_INDEX_GET:"get",LISTS_GET_INDEX_GET_REMOVE:"get and remove",LISTS_GET_INDEX_LAST:"last",LISTS_GET_INDEX_RANDOM:"random",LISTS_GET_INDEX_REMOVE:"remove",LISTS_GET_INDEX_TAIL:"",LISTS_GET_INDEX_TOOLTIP_GET_FIRST:"Returns the first item in a list.",LISTS_GET_INDEX_TOOLTIP_GET_FROM:"Returns the item at the specified position in a list.",LISTS_GET_INDEX_TOOLTIP_GET_LAST:"Returns the last item in a list.",LISTS_GET_INDEX_TOOLTIP_GET_RANDOM:"Returns a random item in a list.",LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST:"Removes and returns the first item in a list.",LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM:"Removes and returns the item at the specified position in a list.",LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST:"Removes and returns the last item in a list.",LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM:"Removes and returns a random item in a list.",LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST:"Removes the first item in a list.",LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM:"Removes the item at the specified position in a list.",LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST:"Removes the last item in a list.",LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM:"Removes a random item in a list.",LISTS_GET_SUBLIST_END_FROM_END:"to # from end",LISTS_GET_SUBLIST_END_FROM_START:"to #",LISTS_GET_SUBLIST_END_LAST:"to last",LISTS_GET_SUBLIST_HELPURL:"https://github.com/google/blockly/wiki/Lists#getting-a-sublist",LISTS_GET_SUBLIST_START_FIRST:"get sub-list from first",LISTS_GET_SUBLIST_START_FROM_END:"get sub-list from # from end",LISTS_GET_SUBLIST_START_FROM_START:"get sub-list from #",LISTS_GET_SUBLIST_TAIL:"",LISTS_GET_SUBLIST_TOOLTIP:"Creates a copy of the specified portion of a list.",LISTS_INDEX_FROM_END_TOOLTIP:"%1 is the last item.",LISTS_INDEX_FROM_START_TOOLTIP:"%1 is the first item.",LISTS_INDEX_OF_FIRST:"find first occurrence of item",LISTS_INDEX_OF_HELPURL:"https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",LISTS_INDEX_OF_LAST:"find last occurrence of item",LISTS_INDEX_OF_TOOLTIP:"Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",LISTS_INLIST:"in list",LISTS_ISEMPTY_HELPURL:"https://github.com/google/blockly/wiki/Lists#is-empty",LISTS_ISEMPTY_TITLE:"%1 is empty",LISTS_ISEMPTY_TOOLTIP:"Returns true if the list is empty.",LISTS_LENGTH_HELPURL:"https://github.com/google/blockly/wiki/Lists#length-of",LISTS_LENGTH_TITLE:"length of %1",LISTS_LENGTH_TOOLTIP:"Returns the length of a list.",LISTS_REPEAT_HELPURL:"https://github.com/google/blockly/wiki/Lists#create-list-with",LISTS_REPEAT_TITLE:"create list with item %1 repeated %2 times",LISTS_REPEAT_TOOLTIP:"Creates a list consisting of the given value repeated the specified number of times.",LISTS_REVERSE_HELPURL:"https://github.com/google/blockly/wiki/Lists#reversing-a-list",LISTS_REVERSE_MESSAGE0:"reverse %1",LISTS_REVERSE_TOOLTIP:"Reverse a copy of a list.",LISTS_SET_INDEX_HELPURL:"https://github.com/google/blockly/wiki/Lists#in-list--set",LISTS_SET_INDEX_INPUT_TO:"as",LISTS_SET_INDEX_INSERT:"insert at",LISTS_SET_INDEX_SET:"set",LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST:"Inserts the item at the start of a list.",LISTS_SET_INDEX_TOOLTIP_INSERT_FROM:"Inserts the item at the specified position in a list.",LISTS_SET_INDEX_TOOLTIP_INSERT_LAST:"Append the item to the end of a list.",LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM:"Inserts the item randomly in a list.",LISTS_SET_INDEX_TOOLTIP_SET_FIRST:"Sets the first item in a list.",LISTS_SET_INDEX_TOOLTIP_SET_FROM:"Sets the item at the specified position in a list.",LISTS_SET_INDEX_TOOLTIP_SET_LAST:"Sets the last item in a list.",LISTS_SET_INDEX_TOOLTIP_SET_RANDOM:"Sets a random item in a list.",LISTS_SORT_HELPURL:"https://github.com/google/blockly/wiki/Lists#sorting-a-list",LISTS_SORT_ORDER_ASCENDING:"ascending",LISTS_SORT_ORDER_DESCENDING:"descending",LISTS_SORT_TITLE:"sort %1 %2 %3",LISTS_SORT_TOOLTIP:"Sort a copy of a list.",LISTS_SORT_TYPE_IGNORECASE:"alphabetic, ignore case",LISTS_SORT_TYPE_NUMERIC:"numeric",LISTS_SORT_TYPE_TEXT:"alphabetic",LISTS_SPLIT_HELPURL:"https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",LISTS_SPLIT_LIST_FROM_TEXT:"make list from text",LISTS_SPLIT_TEXT_FROM_LIST:"make text from list",LISTS_SPLIT_TOOLTIP_JOIN:"Join a list of texts into one text, separated by a delimiter.",LISTS_SPLIT_TOOLTIP_SPLIT:"Split text into a list of texts, breaking at each delimiter.",LISTS_SPLIT_WITH_DELIMITER:"with delimiter",LOGIC_BOOLEAN_FALSE:"false",LOGIC_BOOLEAN_HELPURL:"https://github.com/google/blockly/wiki/Logic#values",LOGIC_BOOLEAN_TOOLTIP:"Returns either true or false.",LOGIC_BOOLEAN_TRUE:"true",LOGIC_COMPARE_HELPURL:"https://en.wikipedia.org/wiki/Inequality_(mathematics)",LOGIC_COMPARE_TOOLTIP_EQ:"Return true if both inputs equal each other.",LOGIC_COMPARE_TOOLTIP_GT:"Return true if the first input is greater than the second input.",LOGIC_COMPARE_TOOLTIP_GTE:"Return true if the first input is greater than or equal to the second input.",LOGIC_COMPARE_TOOLTIP_LT:"Return true if the first input is smaller than the second input.",LOGIC_COMPARE_TOOLTIP_LTE:"Return true if the first input is smaller than or equal to the second input.",LOGIC_COMPARE_TOOLTIP_NEQ:"Return true if both inputs are not equal to each other.",LOGIC_NEGATE_HELPURL:"https://github.com/google/blockly/wiki/Logic#not",LOGIC_NEGATE_TITLE:"not %1",LOGIC_NEGATE_TOOLTIP:"Returns true if the input is false. Returns false if the input is true.",LOGIC_NULL:"null",LOGIC_NULL_HELPURL:"https://en.wikipedia.org/wiki/Nullable_type",LOGIC_NULL_TOOLTIP:"Returns null.",LOGIC_OPERATION_AND:"and",LOGIC_OPERATION_HELPURL:"https://github.com/google/blockly/wiki/Logic#logical-operations",LOGIC_OPERATION_OR:"or",LOGIC_OPERATION_TOOLTIP_AND:"Return true if both inputs are true.",LOGIC_OPERATION_TOOLTIP_OR:"Return true if at least one of the inputs is true.",LOGIC_TERNARY_CONDITION:"test",LOGIC_TERNARY_HELPURL:"https://en.wikipedia.org/wiki/%3F:",LOGIC_TERNARY_IF_FALSE:"if false",LOGIC_TERNARY_IF_TRUE:"if true",LOGIC_TERNARY_TOOLTIP:"Check the condition in 'test'. If the condition is true, returns the 'if true' value, otherwise returns the 'if false' value.",MATH_ADDITION_SYMBOL:"+",MATH_ARITHMETIC_HELPURL:"https://en.wikipedia.org/wiki/Arithmetic",MATH_ARITHMETIC_TOOLTIP_ADD:"Return the sum of the two numbers.",MATH_ARITHMETIC_TOOLTIP_DIVIDE:"Return the quotient of the two numbers.",MATH_ARITHMETIC_TOOLTIP_MINUS:"Return the difference of the two numbers.",MATH_ARITHMETIC_TOOLTIP_MULTIPLY:"Return the product of the two numbers.",MATH_ARITHMETIC_TOOLTIP_POWER:"Return the first number raised to the power of the second number.",MATH_CHANGE_HELPURL:"https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",MATH_CHANGE_TITLE:"change %1 by %2",MATH_CHANGE_TOOLTIP:"Add a number to variable '%1'.",MATH_CONSTANT_HELPURL:"https://en.wikipedia.org/wiki/Mathematical_constant",MATH_CONSTANT_TOOLTIP:"Return one of the common constants: π (3.141…), e (2.718…), φ (1.618…), sqrt(2) (1.414…), sqrt(½) (0.707…), or ∞ (infinity).",MATH_CONSTRAIN_HELPURL:"https://en.wikipedia.org/wiki/Clamping_(graphics)",MATH_CONSTRAIN_TITLE:"constrain %1 low %2 high %3",MATH_CONSTRAIN_TOOLTIP:"Constrain a number to be between the specified limits (inclusive).",MATH_DIVISION_SYMBOL:"÷",MATH_IS_DIVISIBLE_BY:"is divisible by",MATH_IS_EVEN:"is even",MATH_IS_NEGATIVE:"is negative",MATH_IS_ODD:"is odd",MATH_IS_POSITIVE:"is positive",MATH_IS_PRIME:"is prime",MATH_IS_TOOLTIP:"Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",MATH_IS_WHOLE:"is whole",MATH_MODULO_HELPURL:"https://en.wikipedia.org/wiki/Modulo_operation",MATH_MODULO_TITLE:"remainder of %1 ÷ %2",MATH_MODULO_TOOLTIP:"Return the remainder from dividing the two numbers.",MATH_MULTIPLICATION_SYMBOL:"×",MATH_NUMBER_HELPURL:"https://en.wikipedia.org/wiki/Number",MATH_NUMBER_TOOLTIP:"A number.",MATH_ONLIST_HELPURL:"",MATH_ONLIST_OPERATOR_AVERAGE:"average of list",MATH_ONLIST_OPERATOR_MAX:"max of list",MATH_ONLIST_OPERATOR_MEDIAN:"median of list",MATH_ONLIST_OPERATOR_MIN:"min of list",MATH_ONLIST_OPERATOR_MODE:"modes of list",MATH_ONLIST_OPERATOR_RANDOM:"random item of list",MATH_ONLIST_OPERATOR_STD_DEV:"standard deviation of list",MATH_ONLIST_OPERATOR_SUM:"sum of list",MATH_ONLIST_TOOLTIP_AVERAGE:"Return the average (arithmetic mean) of the numeric values in the list.",MATH_ONLIST_TOOLTIP_MAX:"Return the largest number in the list.",MATH_ONLIST_TOOLTIP_MEDIAN:"Return the median number in the list.",MATH_ONLIST_TOOLTIP_MIN:"Return the smallest number in the list.",MATH_ONLIST_TOOLTIP_MODE:"Return a list of the most common item(s) in the list.",MATH_ONLIST_TOOLTIP_RANDOM:"Return a random element from the list.",MATH_ONLIST_TOOLTIP_STD_DEV:"Return the standard deviation of the list.",MATH_ONLIST_TOOLTIP_SUM:"Return the sum of all the numbers in the list.",MATH_POWER_SYMBOL:"^",MATH_RANDOM_FLOAT_HELPURL:"https://en.wikipedia.org/wiki/Random_number_generation",MATH_RANDOM_FLOAT_TITLE_RANDOM:"random fraction",MATH_RANDOM_FLOAT_TOOLTIP:"Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",MATH_RANDOM_INT_HELPURL:"https://en.wikipedia.org/wiki/Random_number_generation",MATH_RANDOM_INT_TITLE:"random integer from %1 to %2",MATH_RANDOM_INT_TOOLTIP:"Return a random integer between the two specified limits, inclusive.",MATH_ROUND_HELPURL:"https://en.wikipedia.org/wiki/Rounding",MATH_ROUND_OPERATOR_ROUND:"round",MATH_ROUND_OPERATOR_ROUNDDOWN:"round down",MATH_ROUND_OPERATOR_ROUNDUP:"round up",MATH_ROUND_TOOLTIP:"Round a number up or down.",MATH_SINGLE_HELPURL:"https://en.wikipedia.org/wiki/Square_root",MATH_SINGLE_OP_ABSOLUTE:"absolute",MATH_SINGLE_OP_ROOT:"square root",MATH_SINGLE_TOOLTIP_ABS:"Return the absolute value of a number.",MATH_SINGLE_TOOLTIP_EXP:"Return e to the power of a number.",MATH_SINGLE_TOOLTIP_LN:"Return the natural logarithm of a number.",MATH_SINGLE_TOOLTIP_LOG10:"Return the base 10 logarithm of a number.",MATH_SINGLE_TOOLTIP_NEG:"Return the negation of a number.",MATH_SINGLE_TOOLTIP_POW10:"Return 10 to the power of a number.",MATH_SINGLE_TOOLTIP_ROOT:"Return the square root of a number.",MATH_SUBTRACTION_SYMBOL:"-",MATH_TRIG_ACOS:"acos",MATH_TRIG_ASIN:"asin",MATH_TRIG_ATAN:"atan",MATH_TRIG_COS:"cos",MATH_TRIG_HELPURL:"https://en.wikipedia.org/wiki/Trigonometric_functions",MATH_TRIG_SIN:"sin",MATH_TRIG_TAN:"tan",MATH_TRIG_TOOLTIP_ACOS:"Return the arccosine of a number.",MATH_TRIG_TOOLTIP_ASIN:"Return the arcsine of a number.",MATH_TRIG_TOOLTIP_ATAN:"Return the arctangent of a number.",MATH_TRIG_TOOLTIP_COS:"Return the cosine of a degree (not radian).",MATH_TRIG_TOOLTIP_SIN:"Return the sine of a degree (not radian).",MATH_TRIG_TOOLTIP_TAN:"Return the tangent of a degree (not radian).",NEW_VARIABLE:"Create variable...",NEW_VARIABLE_TITLE:"New variable name:",ORDINAL_NUMBER_SUFFIX:"",PROCEDURES_ALLOW_STATEMENTS:"allow statements",PROCEDURES_BEFORE_PARAMS:"with:",PROCEDURES_CALLNORETURN_HELPURL:"https://en.wikipedia.org/wiki/Subroutine",PROCEDURES_CALLNORETURN_TOOLTIP:"Run the user-defined function '%1'.",PROCEDURES_CALLRETURN_HELPURL:"https://en.wikipedia.org/wiki/Subroutine",PROCEDURES_CALLRETURN_TOOLTIP:"Run the user-defined function '%1' and use its output.",PROCEDURES_CALL_BEFORE_PARAMS:"with:",PROCEDURES_CREATE_DO:"Create '%1'",PROCEDURES_DEFNORETURN_COMMENT:"Describe this function...",PROCEDURES_DEFNORETURN_DO:"",PROCEDURES_DEFNORETURN_HELPURL:"https://en.wikipedia.org/wiki/Subroutine",PROCEDURES_DEFNORETURN_PROCEDURE:"do something",PROCEDURES_DEFNORETURN_TITLE:"to",PROCEDURES_DEFNORETURN_TOOLTIP:"Creates a function with no output.",PROCEDURES_DEFRETURN_HELPURL:"https://en.wikipedia.org/wiki/Subroutine",PROCEDURES_DEFRETURN_RETURN:"return",PROCEDURES_DEFRETURN_TOOLTIP:"Creates a function with an output.",PROCEDURES_DEF_DUPLICATE_WARNING:"Warning: This function has duplicate parameters.",PROCEDURES_HIGHLIGHT_DEF:"Highlight function definition",PROCEDURES_IFRETURN_HELPURL:"http://c2.com/cgi/wiki?GuardClause",PROCEDURES_IFRETURN_TOOLTIP:"If a value is true, then return a second value.",PROCEDURES_IFRETURN_WARNING:"Warning: This block may be used only within a function definition.",PROCEDURES_MUTATORARG_TITLE:"input name:",PROCEDURES_MUTATORARG_TOOLTIP:"Add an input to the function.",PROCEDURES_MUTATORCONTAINER_TITLE:"inputs",PROCEDURES_MUTATORCONTAINER_TOOLTIP:"Add, remove, or reorder inputs to this function.",PROCEDURE_ALREADY_EXISTS:"A procedure named '%1' already exists.",REDO:"Redo",REMOVE_COMMENT:"Remove Comment",RENAME_VARIABLE:"Rename variable...",RENAME_VARIABLE_TITLE:"Rename all '%1' variables to:",TEXT_APPEND_HELPURL:"https://github.com/google/blockly/wiki/Text#text-modification",TEXT_APPEND_TITLE:"to %1 append text %2",TEXT_APPEND_TOOLTIP:"Append some text to variable '%1'.",TEXT_CHANGECASE_HELPURL:"https://github.com/google/blockly/wiki/Text#adjusting-text-case",TEXT_CHANGECASE_OPERATOR_LOWERCASE:"to lower case",TEXT_CHANGECASE_OPERATOR_TITLECASE:"to Title Case",TEXT_CHANGECASE_OPERATOR_UPPERCASE:"to UPPER CASE",TEXT_CHANGECASE_TOOLTIP:"Return a copy of the text in a different case.",TEXT_CHARAT_FIRST:"get first letter",TEXT_CHARAT_FROM_END:"get letter # from end",TEXT_CHARAT_FROM_START:"get letter #",TEXT_CHARAT_HELPURL:"https://github.com/google/blockly/wiki/Text#extracting-text",TEXT_CHARAT_LAST:"get last letter",TEXT_CHARAT_RANDOM:"get random letter",TEXT_CHARAT_TAIL:"",TEXT_CHARAT_TITLE:"in text %1 %2",TEXT_CHARAT_TOOLTIP:"Returns the letter at the specified position.",TEXT_COUNT_HELPURL:"https://github.com/google/blockly/wiki/Text#counting-substrings",TEXT_COUNT_MESSAGE0:"count %1 in %2",TEXT_COUNT_TOOLTIP:"Count how many times some text occurs within some other text.",TEXT_CREATE_JOIN_ITEM_TOOLTIP:"Add an item to the text.",TEXT_CREATE_JOIN_TITLE_JOIN:"join",TEXT_CREATE_JOIN_TOOLTIP:"Add, remove, or reorder sections to reconfigure this text block.",TEXT_GET_SUBSTRING_END_FROM_END:"to letter # from end",TEXT_GET_SUBSTRING_END_FROM_START:"to letter #",TEXT_GET_SUBSTRING_END_LAST:"to last letter",TEXT_GET_SUBSTRING_HELPURL:"https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",TEXT_GET_SUBSTRING_INPUT_IN_TEXT:"in text",TEXT_GET_SUBSTRING_START_FIRST:"get substring from first letter",TEXT_GET_SUBSTRING_START_FROM_END:"get substring from letter # from end",TEXT_GET_SUBSTRING_START_FROM_START:"get substring from letter #",TEXT_GET_SUBSTRING_TAIL:"",TEXT_GET_SUBSTRING_TOOLTIP:"Returns a specified portion of the text.",TEXT_INDEXOF_HELPURL:"https://github.com/google/blockly/wiki/Text#finding-text",TEXT_INDEXOF_OPERATOR_FIRST:"find first occurrence of text",TEXT_INDEXOF_OPERATOR_LAST:"find last occurrence of text",TEXT_INDEXOF_TITLE:"in text %1 %2 %3",TEXT_INDEXOF_TOOLTIP:"Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",TEXT_ISEMPTY_HELPURL:"https://github.com/google/blockly/wiki/Text#checking-for-empty-text",TEXT_ISEMPTY_TITLE:"%1 is empty",TEXT_ISEMPTY_TOOLTIP:"Returns true if the provided text is empty.",TEXT_JOIN_HELPURL:"https://github.com/google/blockly/wiki/Text#text-creation",TEXT_JOIN_TITLE_CREATEWITH:"create text with",TEXT_JOIN_TOOLTIP:"Create a piece of text by joining together any number of items.",TEXT_LENGTH_HELPURL:"https://github.com/google/blockly/wiki/Text#text-modification",TEXT_LENGTH_TITLE:"length of %1",TEXT_LENGTH_TOOLTIP:"Returns the number of letters (including spaces) in the provided text.",TEXT_PRINT_HELPURL:"https://github.com/google/blockly/wiki/Text#printing-text",TEXT_PRINT_TITLE:"print %1",TEXT_PRINT_TOOLTIP:"Print the specified text, number or other value.",TEXT_PROMPT_HELPURL:"https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",TEXT_PROMPT_TOOLTIP_NUMBER:"Prompt for user for a number.",TEXT_PROMPT_TOOLTIP_TEXT:"Prompt for user for some text.",TEXT_PROMPT_TYPE_NUMBER:"prompt for number with message",TEXT_PROMPT_TYPE_TEXT:"prompt for text with message",TEXT_REPLACE_HELPURL:"https://github.com/google/blockly/wiki/Text#replacing-substrings",TEXT_REPLACE_MESSAGE0:"replace %1 with %2 in %3",TEXT_REPLACE_TOOLTIP:"Replace all occurances of some text within some other text.",TEXT_REVERSE_HELPURL:"https://github.com/google/blockly/wiki/Text#reversing-text",TEXT_REVERSE_MESSAGE0:"reverse %1",TEXT_REVERSE_TOOLTIP:"Reverses the order of the characters in the text.",TEXT_TEXT_HELPURL:"https://en.wikipedia.org/wiki/String_(computer_science)",TEXT_TEXT_TOOLTIP:"A letter, word, or line of text.",TEXT_TRIM_HELPURL:"https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",TEXT_TRIM_OPERATOR_BOTH:"trim spaces from both sides of",TEXT_TRIM_OPERATOR_LEFT:"trim spaces from left side of",TEXT_TRIM_OPERATOR_RIGHT:"trim spaces from right side of",TEXT_TRIM_TOOLTIP:"Return a copy of the text with spaces removed from one or both ends.",TODAY:"Today",UNDO:"Undo",VARIABLES_DEFAULT_NAME:"item",VARIABLES_GET_CREATE_SET:"Create 'set %1'",VARIABLES_GET_HELPURL:"https://github.com/google/blockly/wiki/Variables#get",VARIABLES_GET_TOOLTIP:"Returns the value of this variable.",VARIABLES_SET:"set %1 to %2",VARIABLES_SET_CREATE_GET:"Create 'get %1'",VARIABLES_SET_HELPURL:"https://github.com/google/blockly/wiki/Variables#set",VARIABLES_SET_TOOLTIP:"Sets this variable to be equal to the input.",VARIABLE_ALREADY_EXISTS:"A variable named '%1' already exists.",VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE:"A variable named '%1' already exists for another variable of type '%2'.",MATH_HUE:"230",LOOPS_HUE:"120",LISTS_HUE:"260",LOGIC_HUE:"210",VARIABLES_HUE:"330",TEXTS_HUE:"160",PROCEDURES_HUE:"290",COLOUR_HUE:"20",LOOP:"loop"},(h=T).Blocks.dummy_block={init:function(){console.log("mc.mjs: Inside init() function of ...")}},h.Blocks.minecraft_coloured_block_picker={init:function(){this.appendDummyInput().appendField(new h.FieldMinecraftColour(e.Colours[0].id),"MINECRAFT_COLOUR_ID"),this.setOutput(!0,"MinecraftColour"),this.setColour("%{BKY_COLOUR_HUE}"),this.setTooltip("Select a Minecraft block colour.")}},h.Blocks.minecraft_matrix_3d_elements={init:function(){this.appendDummyInput().appendField("Rotation Matrix (Elements)"),this.appendValueInput("R00").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("r00"),this.appendValueInput("R01").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("r01"),this.appendValueInput("R02").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("r02"),this.appendValueInput("R10").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("r10"),this.appendValueInput("R11").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("r11"),this.appendValueInput("R12").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("r12"),this.appendValueInput("R20").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("r20"),this.appendValueInput("R21").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("r21"),this.appendValueInput("R22").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("r22"),this.setOutput(!0,"3DMatrix"),this.setColour(210),this.setTooltip("Define a 3x3 rotation matrix by its elements."),this.setInputsInline(!1)}},h.Blocks.minecraft_matrix_3d_euler={init:function(){this.appendDummyInput().appendField("Rotation Matrix (Euler Angles)"),this.appendValueInput("YAW").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Yaw (Z, degrees)"),this.appendValueInput("PITCH").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Pitch (Y, degrees)"),this.appendValueInput("ROLL").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Roll (X, degrees)"),this.setOutput(!0,"3DMatrix"),this.setColour(210),this.setTooltip("Define a 3x3 rotation matrix from Euler angles (yaw, pitch, roll)."),this.setInputsInline(!1)}},h.Blocks.minecraft_vector_3d={init:function(){this.appendValueInput("X").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Vec3 x"),this.appendValueInput("Y").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("y"),this.appendValueInput("Z").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("z"),this.setOutput(!0,"3DVector"),this.setColour(180),this.setTooltip("Creates a 3D vector from x, y, and z components. Accepts numbers or variables."),this.setInputsInline(!0)}},h.Blocks.minecraft_vector_delta={init:function(){this.isInFlyout?this.appendDummyInput().appendField(h.Msg.MINECRAFT_VECTOR_DELTA):this.appendDummyInput().appendField("x:").appendField(new h.FieldNumber(1),"X").appendField("y:").appendField(new h.FieldNumber(0),"Y").appendField("z:").appendField(new h.FieldNumber(0),"Z"),this.setOutput(!0,"3DVector"),this.setColour(160)}},h.Blocks.minecraft_position_player={init:function(){this.appendDummyInput().appendField("player position"),this.setOutput(!0,"3DVector"),this.setColour(160)}},h.Blocks.minecraft_position_here={init:function(){this.appendDummyInput().appendField("here"),this.setOutput(!0,"3DVector"),this.setColour(160)}},h.Blocks.minecraft_position_get_direction={init:function(){this.appendDummyInput().appendField("player direction"),this.setOutput(!0,"3DVector"),this.setColour(160)}},h.Blocks.minecraft_position_get_compass_direction={init:function(){this.appendDummyInput().appendField("player compass direction"),this.setOutput(!0,"String"),this.setColour(160),this.setTooltip("Returns the cardinal or intercardinal direction the player is facing (N, NE, E, SE, S, SW, W, NW).")}},h.Blocks.minecraft_vector_binary_op={init:function(){this.appendValueInput("A").setCheck("3DVector"),this.appendDummyInput().appendField(new h.FieldDropdown([["+","ADD"],["-","SUBTRACT"],["× (cross product)","CROSS"]]),"OP"),this.appendValueInput("B").setCheck("3DVector"),this.setInputsInline(!0),this.setOutput(!0,"3DVector"),this.setColour(180),this.setTooltip("Performs vector addition, subtraction, or cross product."),e.BlocklyUtils.configureShadow(this,"A"),e.BlocklyUtils.configureShadow(this,"B")}},h.Blocks.minecraft_vector_scalar_multiply={init:function(){this.appendValueInput("A").setCheck("3DVector"),this.appendDummyInput().appendField("×"),this.appendValueInput("B").setCheck("Number"),this.setInputsInline(!0),this.setOutput(!0,"3DVector"),this.setColour(180),this.setTooltip("Multiplies a vector by a scalar number."),e.BlocklyUtils.configureShadow(this,"A"),e.BlocklyUtils.configureShadow(this,"B")}},h.Blocks.minecraft_vector_dot_product={init:function(){this.appendValueInput("A").setCheck("3DVector"),this.appendDummyInput().appendField("• (dot product)"),this.appendValueInput("B").setCheck("3DVector"),this.setInputsInline(!0),this.setOutput(!0,"Number"),this.setColour(210),this.setTooltip("Calculates the dot product of two vectors, returning a number."),e.BlocklyUtils.configureShadow(this,"A"),e.BlocklyUtils.configureShadow(this,"B")}},h.Blocks.minecraft_matrix_vector_multiply={init:function(){this.appendValueInput("A").setCheck("3DMatrix").appendField("Rotate vector"),this.appendValueInput("B").setCheck("3DVector").appendField("by matrix"),this.setInputsInline(!0),this.setOutput(!0,"3DVector"),this.setColour(180),this.setTooltip("Rotates a vector by a transformation matrix."),e.BlocklyUtils.configureShadow(this,"A"),e.BlocklyUtils.configureShadow(this,"B")}},h.Blocks.minecraft_action_create_digital_ball={init:function(){this.appendDummyInput().appendField("Create Digital Ball"),this.appendValueInput("CENTER").setCheck("3DVector").setAlign(h.ALIGN_RIGHT).appendField("Center"),this.appendValueInput("RADIUS").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Radius"),this.appendValueInput("BLOCK_TYPE").setCheck("Block").setAlign(h.ALIGN_RIGHT).appendField("Block Type"),this.appendValueInput("INNER_RADIUS").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Inner Radius (0 for solid)"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(65),this.setTooltip("Creates a digital ball (sphere) of voxels."),this.setInputsInline(!1),e.BlocklyUtils.configureShadow(this,"CENTER"),e.BlocklyUtils.configureShadow(this,"RADIUS"),e.BlocklyUtils.configureShadow(this,"BLOCK_TYPE"),e.BlocklyUtils.configureShadow(this,"INNER_RADIUS")}},h.Blocks.minecraft_action_create_digital_cube={init:function(){this.appendDummyInput().appendField("Create Digital Cube"),this.appendValueInput("CENTER").setCheck("3DVector").setAlign(h.ALIGN_RIGHT).appendField("Center"),this.appendValueInput("SIDE_LENGTH").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Side Length"),this.appendValueInput("ROTATION_MATRIX").setCheck("3DMatrix").setAlign(h.ALIGN_RIGHT).appendField("Rotation Matrix"),this.appendValueInput("BLOCK_TYPE").setCheck("Block").setAlign(h.ALIGN_RIGHT).appendField("Block Type"),this.appendValueInput("INNER_OFFSET_FACTOR").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Inner Offset (0=solid, <1 hollow)"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(65),this.setTooltip("Creates an oriented digital cube of voxels."),this.setInputsInline(!1),e.BlocklyUtils.configureShadow(this,"CENTER"),e.BlocklyUtils.configureShadow(this,"SIDE_LENGTH"),e.BlocklyUtils.configureShadow(this,"ROTATION_MATRIX"),e.BlocklyUtils.configureShadow(this,"BLOCK_TYPE"),e.BlocklyUtils.configureShadow(this,"INNER_OFFSET_FACTOR")}},h.Blocks.minecraft_action_create_digital_plane={init:function(){this.appendDummyInput().appendField("Create Digital Plane (Rectangular)"),this.appendValueInput("NORMAL").setCheck("3DVector").setAlign(h.ALIGN_RIGHT).appendField("Normal Vector"),this.appendValueInput("POINT_ON_PLANE").setCheck("3DVector").setAlign(h.ALIGN_RIGHT).appendField("Plane Reference Point"),this.appendValueInput("BLOCK_TYPE").setCheck("Block").setAlign(h.ALIGN_RIGHT).appendField("Block Type"),this.appendValueInput("OUTER_WIDTH").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Outer Width"),this.appendValueInput("OUTER_LENGTH").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Outer Length"),this.appendValueInput("PLANE_THICKNESS").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Thickness"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(65),this.setTooltip("Creates a finite rectangular digital plane of voxels."),this.setInputsInline(!1),e.BlocklyUtils.configureShadow(this,"NORMAL"),e.BlocklyUtils.configureShadow(this,"POINT_ON_PLANE"),e.BlocklyUtils.configureShadow(this,"BLOCK_TYPE"),e.BlocklyUtils.configureShadow(this,"OUTER_WIDTH"),e.BlocklyUtils.configureShadow(this,"OUTER_LENGTH"),e.BlocklyUtils.configureShadow(this,"PLANE_THICKNESS")}},h.Blocks.minecraft_action_create_digital_disc={init:function(){this.appendDummyInput().appendField("Create Digital Disc/Annulus"),this.appendValueInput("NORMAL").setCheck("3DVector").setAlign(h.ALIGN_RIGHT).appendField("Normal Vector"),this.appendValueInput("CENTER_POINT").setCheck("3DVector").setAlign(h.ALIGN_RIGHT).appendField("Disc Center Point"),this.appendValueInput("OUTER_RADIUS").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Outer Radius"),this.appendValueInput("BLOCK_TYPE").setCheck("Block").setAlign(h.ALIGN_RIGHT).appendField("Block Type"),this.appendValueInput("DISC_THICKNESS").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Thickness (default 1)"),this.appendValueInput("INNER_RADIUS").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Inner Radius (0 for solid disc)"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(65),this.setTooltip("Creates a digital disc or annulus (ring) of voxels."),this.setInputsInline(!1),e.BlocklyUtils.configureShadow(this,"NORMAL"),e.BlocklyUtils.configureShadow(this,"CENTER_POINT"),e.BlocklyUtils.configureShadow(this,"OUTER_RADIUS"),e.BlocklyUtils.configureShadow(this,"BLOCK_TYPE"),e.BlocklyUtils.configureShadow(this,"DISC_THICKNESS"),e.BlocklyUtils.configureShadow(this,"INNER_RADIUS")}},h.Blocks.minecraft_action_create_digital_tube={init:function(){this.appendDummyInput().appendField("Create Digital Tube"),this.appendValueInput("POINT1").setCheck("3DVector").setAlign(h.ALIGN_RIGHT).appendField("Start Point (p1)"),this.appendValueInput("POINT2").setCheck("3DVector").setAlign(h.ALIGN_RIGHT).appendField("End Point (p2)"),this.appendValueInput("OUTER_THICKNESS").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Outer Thickness (radius)"),this.appendValueInput("BLOCK_TYPE").setCheck("Block").setAlign(h.ALIGN_RIGHT).appendField("Block Type"),this.appendValueInput("INNER_THICKNESS").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("Inner Thickness (0 for solid)"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(65),this.setTooltip("Creates a digital tube (cylinder) between two points."),this.setInputsInline(!1),e.BlocklyUtils.configureShadow(this,"POINT1"),e.BlocklyUtils.configureShadow(this,"POINT2"),e.BlocklyUtils.configureShadow(this,"OUTER_THICKNESS"),e.BlocklyUtils.configureShadow(this,"BLOCK_TYPE"),e.BlocklyUtils.configureShadow(this,"INNER_THICKNESS")}},h.Blocks.minecraft_action_create_digital_line={init:function(){this.appendDummyInput().appendField("Create Digital Line"),this.appendValueInput("POINT1").setCheck("3DVector").setAlign(h.ALIGN_RIGHT).appendField("Start Point (p1)"),this.appendValueInput("POINT2").setCheck("3DVector").setAlign(h.ALIGN_RIGHT).appendField("End Point (p2)"),this.appendValueInput("BLOCK_TYPE").setCheck("Block").setAlign(h.ALIGN_RIGHT).appendField("Block Type"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(65),this.setTooltip("Creates a 1-voxel thick digital line between two points."),this.setInputsInline(!1),e.BlocklyUtils.configureShadow(this,"POINT1"),e.BlocklyUtils.configureShadow(this,"POINT2"),e.BlocklyUtils.configureShadow(this,"BLOCK_TYPE")}},h.Blocks.minecraft_action_spawn_entity={init:function(){this.appendDummyInput().appendField("Spawn Entity"),this.appendValueInput("ENTITY_TYPE").setCheck("Entity").setAlign(h.ALIGN_RIGHT).appendField("Entity Type"),this.appendValueInput("POSITION").setCheck("3DVector").setAlign(h.ALIGN_RIGHT).appendField("at position"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(65),this.setTooltip("Spawns a specified entity at a given location."),this.setInputsInline(!1),e.BlocklyUtils.configureShadow(this,"ENTITY_TYPE"),e.BlocklyUtils.configureShadow(this,"POSITION")}},h.Blocks.minecraft_action_set_block={init:function(){this.appendValueInput("BLOCK_TYPE").setCheck("Block").appendField("set block"),this.appendValueInput("POSITION").setCheck("3DVector").setAlign(h.ALIGN_RIGHT).appendField("at"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(65),this.setTooltip("Places a single block at a specified location."),this.setInputsInline(!0),e.BlocklyUtils.configureShadow(this,"BLOCK_TYPE"),e.BlocklyUtils.configureShadow(this,"POSITION")}},h.Blocks.minecraft_action_get_block={init:function(){this.appendValueInput("POSITION").setCheck("3DVector").appendField("get block at"),this.setOutput(!0,"Block"),this.setColour(210),this.setTooltip("Gets the type of block at a specific location."),this.setInputsInline(!0),e.BlocklyUtils.configureShadow(this,"POSITION")}},h.Blocks.minecraft_action_get_height={init:function(){this.appendValueInput("POSITION").setCheck("3DVector").appendField("get height at (x,z) of"),this.setOutput(!0,"Number"),this.setColour(210),this.setTooltip("Gets the Y coordinate of the highest solid block at a given X, Z location."),this.setInputsInline(!0),e.BlocklyUtils.configureShadow(this,"POSITION")}},h.Blocks.minecraft_action_post_to_chat={init:function(){this.appendValueInput("MESSAGE").setCheck("String").appendField("post to chat"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(65),this.setTooltip("Posts a message to the in-game chat."),this.setInputsInline(!0),e.BlocklyUtils.configureShadow(this,"MESSAGE")}},h.Blocks.minecraft_action_create_explosion={init:function(){this.appendValueInput("POSITION").setCheck("3DVector").appendField("create explosion at"),this.appendValueInput("POWER").setCheck("Number").setAlign(h.ALIGN_RIGHT).appendField("with power"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(65),this.setTooltip("Creates an explosion of a specified power at a location. TNT is power 4."),this.setInputsInline(!0),e.BlocklyUtils.configureShadow(this,"POSITION"),e.BlocklyUtils.configureShadow(this,"POWER")}},h.Blocks.time_sleep={init:function(){this.appendValueInput("SECONDS").setCheck("Number").appendField("wait for"),this.appendDummyInput().appendField("seconds"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(120),this.setTooltip("Pauses the program for a specified number of seconds."),this.setInputsInline(!0)}},(u=T).Blocks.minecraft_material_banner={init:function(){this.appendValueInput("COLOUR").setCheck("MinecraftColour").setAlign(u.ALIGN_RIGHT).appendField("BANNER with color"),this.setOutput(!0,"Block"),this.setColour(160),this.setTooltip("A BANNER block that can be colored."),e.Defaults.values.minecraft_material_banner={COLOUR:{shadow:'<shadow type="minecraft_coloured_block_picker"><field name="MINECRAFT_COLOUR_ID">WHITE</field></shadow>'}},e.BlocklyUtils.configureShadow(this,"COLOUR")}},u.Blocks.minecraft_material_bed={init:function(){this.appendValueInput("COLOUR").setCheck("MinecraftColour").setAlign(u.ALIGN_RIGHT).appendField("BED with color"),this.setOutput(!0,"Block"),this.setColour(160),this.setTooltip("A BED block that can be colored."),e.Defaults.values.minecraft_material_bed={COLOUR:{shadow:'<shadow type="minecraft_coloured_block_picker"><field name="MINECRAFT_COLOUR_ID">WHITE</field></shadow>'}},e.BlocklyUtils.configureShadow(this,"COLOUR")}},u.Blocks.minecraft_material_candle={init:function(){this.appendValueInput("COLOUR").setCheck("MinecraftColour").setAlign(u.ALIGN_RIGHT).appendField("CANDLE with color"),this.setOutput(!0,"Block"),this.setColour(160),this.setTooltip("A CANDLE block that can be colored."),e.Defaults.values.minecraft_material_candle={COLOUR:{shadow:'<shadow type="minecraft_coloured_block_picker"><field name="MINECRAFT_COLOUR_ID">WHITE</field></shadow>'}},e.BlocklyUtils.configureShadow(this,"COLOUR")}},u.Blocks.minecraft_material_carpet={init:function(){this.appendValueInput("COLOUR").setCheck("MinecraftColour").setAlign(u.ALIGN_RIGHT).appendField("CARPET with color"),this.setOutput(!0,"Block"),this.setColour(160),this.setTooltip("A CARPET block that can be colored."),e.Defaults.values.minecraft_material_carpet={COLOUR:{shadow:'<shadow type="minecraft_coloured_block_picker"><field name="MINECRAFT_COLOUR_ID">WHITE</field></shadow>'}},e.BlocklyUtils.configureShadow(this,"COLOUR")}},u.Blocks.minecraft_material_concrete={init:function(){this.appendValueInput("COLOUR").setCheck("MinecraftColour").setAlign(u.ALIGN_RIGHT).appendField("CONCRETE with color"),this.setOutput(!0,"Block"),this.setColour(160),this.setTooltip("A CONCRETE block that can be colored."),e.Defaults.values.minecraft_material_concrete={COLOUR:{shadow:'<shadow type="minecraft_coloured_block_picker"><field name="MINECRAFT_COLOUR_ID">WHITE</field></shadow>'}},e.BlocklyUtils.configureShadow(this,"COLOUR")}},u.Blocks.minecraft_material_concrete_powder={init:function(){this.appendValueInput("COLOUR").setCheck("MinecraftColour").setAlign(u.ALIGN_RIGHT).appendField("CONCRETE POWDER with color"),this.setOutput(!0,"Block"),this.setColour(160),this.setTooltip("A CONCRETE POWDER block that can be colored."),e.Defaults.values.minecraft_material_concrete_powder={COLOUR:{shadow:'<shadow type="minecraft_coloured_block_picker"><field name="MINECRAFT_COLOUR_ID">WHITE</field></shadow>'}},e.BlocklyUtils.configureShadow(this,"COLOUR")}},u.Blocks.minecraft_material_glazed_terracotta={init:function(){this.appendValueInput("COLOUR").setCheck("MinecraftColour").setAlign(u.ALIGN_RIGHT).appendField("GLAZED TERRACOTTA with color"),this.setOutput(!0,"Block"),this.setColour(160),this.setTooltip("A GLAZED TERRACOTTA block that can be colored."),e.Defaults.values.minecraft_material_glazed_terracotta={COLOUR:{shadow:'<shadow type="minecraft_coloured_block_picker"><field name="MINECRAFT_COLOUR_ID">WHITE</field></shadow>'}},e.BlocklyUtils.configureShadow(this,"COLOUR")}},u.Blocks.minecraft_material_shulker_box={init:function(){this.appendValueInput("COLOUR").setCheck("MinecraftColour").setAlign(u.ALIGN_RIGHT).appendField("SHULKER BOX with color"),this.setOutput(!0,"Block"),this.setColour(160),this.setTooltip("A SHULKER BOX block that can be colored."),e.Defaults.values.minecraft_material_shulker_box={COLOUR:{shadow:'<shadow type="minecraft_coloured_block_picker"><field name="MINECRAFT_COLOUR_ID">WHITE</field></shadow>'}},e.BlocklyUtils.configureShadow(this,"COLOUR")}},u.Blocks.minecraft_material_stained_glass={init:function(){this.appendValueInput("COLOUR").setCheck("MinecraftColour").setAlign(u.ALIGN_RIGHT).appendField("STAINED GLASS with color"),this.setOutput(!0,"Block"),this.setColour(160),this.setTooltip("A STAINED GLASS block that can be colored."),e.Defaults.values.minecraft_material_stained_glass={COLOUR:{shadow:'<shadow type="minecraft_coloured_block_picker"><field name="MINECRAFT_COLOUR_ID">WHITE</field></shadow>'}},e.BlocklyUtils.configureShadow(this,"COLOUR")}},u.Blocks.minecraft_material_stained_glass_pane={init:function(){this.appendValueInput("COLOUR").setCheck("MinecraftColour").setAlign(u.ALIGN_RIGHT).appendField("STAINED GLASS PANE with color"),this.setOutput(!0,"Block"),this.setColour(160),this.setTooltip("A STAINED GLASS PANE block that can be colored."),e.Defaults.values.minecraft_material_stained_glass_pane={COLOUR:{shadow:'<shadow type="minecraft_coloured_block_picker"><field name="MINECRAFT_COLOUR_ID">WHITE</field></shadow>'}},e.BlocklyUtils.configureShadow(this,"COLOUR")}},u.Blocks.minecraft_material_terracotta={init:function(){this.appendValueInput("COLOUR").setCheck("MinecraftColour").setAlign(u.ALIGN_RIGHT).appendField("TERRACOTTA with color"),this.setOutput(!0,"Block"),this.setColour(160),this.setTooltip("A TERRACOTTA block that can be colored."),e.Defaults.values.minecraft_material_terracotta={COLOUR:{shadow:'<shadow type="minecraft_coloured_block_picker"><field name="MINECRAFT_COLOUR_ID">WHITE</field></shadow>'}},e.BlocklyUtils.configureShadow(this,"COLOUR")}},u.Blocks.minecraft_material_wool={init:function(){this.appendValueInput("COLOUR").setCheck("MinecraftColour").setAlign(u.ALIGN_RIGHT).appendField("WOOL with color"),this.setOutput(!0,"Block"),this.setColour(160),this.setTooltip("A WOOL block that can be colored."),e.Defaults.values.minecraft_material_wool={COLOUR:{shadow:'<shadow type="minecraft_coloured_block_picker"><field name="MINECRAFT_COLOUR_ID">WHITE</field></shadow>'}},e.BlocklyUtils.configureShadow(this,"COLOUR")}},u.Blocks.minecraft_picker_doors={init:function(){this.appendDummyInput().appendField("Doors").appendField(new u.FieldDropdown([["PALE OAK DOOR","PALE_OAK_DOOR"],["JUNGLE DOOR","JUNGLE_DOOR"],["OXIDIZED COPPER DOOR","OXIDIZED_COPPER_DOOR"],["WAXED OXIDIZED COPPER DOOR","WAXED_OXIDIZED_COPPER_DOOR"],["EXPOSED COPPER DOOR","EXPOSED_COPPER_DOOR"],["WEATHERED COPPER DOOR","WEATHERED_COPPER_DOOR"],["WAXED COPPER DOOR","WAXED_COPPER_DOOR"],["BIRCH DOOR","BIRCH_DOOR"],["ACACIA DOOR","ACACIA_DOOR"],["COPPER DOOR","COPPER_DOOR"],["BAMBOO DOOR","BAMBOO_DOOR"],["WAXED WEATHERED COPPER DOOR","WAXED_WEATHERED_COPPER_DOOR"],["CHERRY DOOR","CHERRY_DOOR"],["WARPED DOOR","WARPED_DOOR"],["IRON DOOR","IRON_DOOR"],["MANGROVE DOOR","MANGROVE_DOOR"],["CRIMSON DOOR","CRIMSON_DOOR"],["DARK OAK DOOR","DARK_OAK_DOOR"],["OAK DOOR","OAK_DOOR"],["SPRUCE DOOR","SPRUCE_DOOR"],["WAXED EXPOSED COPPER DOOR","WAXED_EXPOSED_COPPER_DOOR"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Doors material.")}},u.Blocks.minecraft_picker_fences={init:function(){this.appendDummyInput().appendField("Fences").appendField(new u.FieldDropdown([["BAMBOO FENCE","BAMBOO_FENCE"],["MANGROVE FENCE","MANGROVE_FENCE"],["OAK FENCE","OAK_FENCE"],["WARPED FENCE","WARPED_FENCE"],["CRIMSON FENCE","CRIMSON_FENCE"],["NETHER BRICK FENCE","NETHER_BRICK_FENCE"],["BIRCH FENCE","BIRCH_FENCE"],["JUNGLE FENCE","JUNGLE_FENCE"],["ACACIA FENCE","ACACIA_FENCE"],["CHERRY FENCE","CHERRY_FENCE"],["DARK OAK FENCE","DARK_OAK_FENCE"],["SPRUCE FENCE","SPRUCE_FENCE"],["PALE OAK FENCE","PALE_OAK_FENCE"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Fences material.")}},u.Blocks.minecraft_picker_gates={init:function(){this.appendDummyInput().appendField("Gates").appendField(new u.FieldDropdown([["CRIMSON FENCE GATE","CRIMSON_FENCE_GATE"],["SPRUCE FENCE GATE","SPRUCE_FENCE_GATE"],["JUNGLE FENCE GATE","JUNGLE_FENCE_GATE"],["PALE OAK FENCE GATE","PALE_OAK_FENCE_GATE"],["DARK OAK FENCE GATE","DARK_OAK_FENCE_GATE"],["CHERRY FENCE GATE","CHERRY_FENCE_GATE"],["OAK FENCE GATE","OAK_FENCE_GATE"],["WARPED FENCE GATE","WARPED_FENCE_GATE"],["MANGROVE FENCE GATE","MANGROVE_FENCE_GATE"],["ACACIA FENCE GATE","ACACIA_FENCE_GATE"],["BAMBOO FENCE GATE","BAMBOO_FENCE_GATE"],["BIRCH FENCE GATE","BIRCH_FENCE_GATE"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Gates material.")}},u.Blocks.minecraft_picker_glass={init:function(){this.appendDummyInput().appendField("Glass").appendField(new u.FieldDropdown([["GLASS","GLASS"],["GLASS PANE","GLASS_PANE"],["TINTED GLASS","TINTED_GLASS"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Glass material.")}},u.Blocks.minecraft_picker_ores={init:function(){this.appendDummyInput().appendField("Ores").appendField(new u.FieldDropdown([["COAL ORE","COAL_ORE"],["DEEPSLATE COAL ORE","DEEPSLATE_COAL_ORE"],["IRON ORE","IRON_ORE"],["DEEPSLATE IRON ORE","DEEPSLATE_IRON_ORE"],["COPPER ORE","COPPER_ORE"],["DEEPSLATE COPPER ORE","DEEPSLATE_COPPER_ORE"],["GOLD ORE","GOLD_ORE"],["DEEPSLATE GOLD ORE","DEEPSLATE_GOLD_ORE"],["REDSTONE ORE","REDSTONE_ORE"],["DEEPSLATE REDSTONE ORE","DEEPSLATE_REDSTONE_ORE"],["EMERALD ORE","EMERALD_ORE"],["DEEPSLATE EMERALD ORE","DEEPSLATE_EMERALD_ORE"],["LAPIS ORE","LAPIS_ORE"],["DEEPSLATE LAPIS ORE","DEEPSLATE_LAPIS_ORE"],["DIAMOND ORE","DIAMOND_ORE"],["DEEPSLATE DIAMOND ORE","DEEPSLATE_DIAMOND_ORE"],["NETHER GOLD ORE","NETHER_GOLD_ORE"],["NETHER QUARTZ ORE","NETHER_QUARTZ_ORE"],["ANCIENT DEBRIS","ANCIENT_DEBRIS"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Ores material.")}},u.Blocks.minecraft_picker_redstone_components={init:function(){this.appendDummyInput().appendField("Redstone Components").appendField(new u.FieldDropdown([["REDSTONE WIRE","REDSTONE_WIRE"],["REDSTONE BLOCK","REDSTONE_BLOCK"],["REDSTONE TORCH","REDSTONE_TORCH"],["REPEATER","REPEATER"],["COMPARATOR","COMPARATOR"],["PISTON","PISTON"],["STICKY PISTON","STICKY_PISTON"],["SLIME BLOCK","SLIME_BLOCK"],["HONEY BLOCK","HONEY_BLOCK"],["OBSERVER","OBSERVER"],["DROPPER","DROPPER"],["DISPENSER","DISPENSER"],["HOPPER","HOPPER"],["LECTERN","LECTERN"],["LEVER","LEVER"],["DAYLIGHT DETECTOR","DAYLIGHT_DETECTOR"],["TRIPWIRE HOOK","TRIPWIRE_HOOK"],["TARGET","TARGET"],["NOTE BLOCK","NOTE_BLOCK"],["RAIL","RAIL"],["POWERED RAIL","POWERED_RAIL"],["DETECTOR RAIL","DETECTOR_RAIL"],["ACTIVATOR RAIL","ACTIVATOR_RAIL"],["REDSTONE LAMP","REDSTONE_LAMP"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Redstone Components material.")}},u.Blocks.minecraft_picker_slabs={init:function(){this.appendDummyInput().appendField("Slabs").appendField(new u.FieldDropdown([["POLISHED GRANITE SLAB","POLISHED_GRANITE_SLAB"],["PURPUR SLAB","PURPUR_SLAB"],["DARK OAK SLAB","DARK_OAK_SLAB"],["WAXED EXPOSED CUT COPPER SLAB","WAXED_EXPOSED_CUT_COPPER_SLAB"],["TUFF SLAB","TUFF_SLAB"],["WAXED OXIDIZED CUT COPPER SLAB","WAXED_OXIDIZED_CUT_COPPER_SLAB"],["ACACIA SLAB","ACACIA_SLAB"],["POLISHED TUFF SLAB","POLISHED_TUFF_SLAB"],["WAXED WEATHERED CUT COPPER SLAB","WAXED_WEATHERED_CUT_COPPER_SLAB"],["BAMBOO SLAB","BAMBOO_SLAB"],["STONE BRICK SLAB","STONE_BRICK_SLAB"],["POLISHED ANDESITE SLAB","POLISHED_ANDESITE_SLAB"],["SMOOTH QUARTZ SLAB","SMOOTH_QUARTZ_SLAB"],["PALE OAK SLAB","PALE_OAK_SLAB"],["RESIN BRICK SLAB","RESIN_BRICK_SLAB"],["COBBLED DEEPSLATE SLAB","COBBLED_DEEPSLATE_SLAB"],["SPRUCE SLAB","SPRUCE_SLAB"],["PRISMARINE BRICK SLAB","PRISMARINE_BRICK_SLAB"],["BRICK SLAB","BRICK_SLAB"],["PETRIFIED OAK SLAB","PETRIFIED_OAK_SLAB"],["SMOOTH SANDSTONE SLAB","SMOOTH_SANDSTONE_SLAB"],["TUFF BRICK SLAB","TUFF_BRICK_SLAB"],["ANDESITE SLAB","ANDESITE_SLAB"],["MOSSY COBBLESTONE SLAB","MOSSY_COBBLESTONE_SLAB"],["POLISHED DEEPSLATE SLAB","POLISHED_DEEPSLATE_SLAB"],["CRIMSON SLAB","CRIMSON_SLAB"],["END STONE BRICK SLAB","END_STONE_BRICK_SLAB"],["DEEPSLATE TILE SLAB","DEEPSLATE_TILE_SLAB"],["CUT SANDSTONE SLAB","CUT_SANDSTONE_SLAB"],["POLISHED DIORITE SLAB","POLISHED_DIORITE_SLAB"],["EXPOSED CUT COPPER SLAB","EXPOSED_CUT_COPPER_SLAB"],["CUT RED SANDSTONE SLAB","CUT_RED_SANDSTONE_SLAB"],["BLACKSTONE SLAB","BLACKSTONE_SLAB"],["WARPED SLAB","WARPED_SLAB"],["STONE SLAB","STONE_SLAB"],["MUD BRICK SLAB","MUD_BRICK_SLAB"],["OAK SLAB","OAK_SLAB"],["BIRCH SLAB","BIRCH_SLAB"],["OXIDIZED CUT COPPER SLAB","OXIDIZED_CUT_COPPER_SLAB"],["POLISHED BLACKSTONE BRICK SLAB","POLISHED_BLACKSTONE_BRICK_SLAB"],["QUARTZ SLAB","QUARTZ_SLAB"],["MANGROVE SLAB","MANGROVE_SLAB"],["SANDSTONE SLAB","SANDSTONE_SLAB"],["CUT COPPER SLAB","CUT_COPPER_SLAB"],["PRISMARINE SLAB","PRISMARINE_SLAB"],["WAXED CUT COPPER SLAB","WAXED_CUT_COPPER_SLAB"],["GRANITE SLAB","GRANITE_SLAB"],["DARK PRISMARINE SLAB","DARK_PRISMARINE_SLAB"],["POLISHED BLACKSTONE SLAB","POLISHED_BLACKSTONE_SLAB"],["SMOOTH STONE SLAB","SMOOTH_STONE_SLAB"],["DIORITE SLAB","DIORITE_SLAB"],["SMOOTH RED SANDSTONE SLAB","SMOOTH_RED_SANDSTONE_SLAB"],["WEATHERED CUT COPPER SLAB","WEATHERED_CUT_COPPER_SLAB"],["CHERRY SLAB","CHERRY_SLAB"],["COBBLESTONE SLAB","COBBLESTONE_SLAB"],["RED SANDSTONE SLAB","RED_SANDSTONE_SLAB"],["BAMBOO MOSAIC SLAB","BAMBOO_MOSAIC_SLAB"],["MOSSY STONE BRICK SLAB","MOSSY_STONE_BRICK_SLAB"],["RED NETHER BRICK SLAB","RED_NETHER_BRICK_SLAB"],["JUNGLE SLAB","JUNGLE_SLAB"],["NETHER BRICK SLAB","NETHER_BRICK_SLAB"],["DEEPSLATE BRICK SLAB","DEEPSLATE_BRICK_SLAB"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Slabs material.")}},u.Blocks.minecraft_picker_stairs={init:function(){this.appendDummyInput().appendField("Stairs").appendField(new u.FieldDropdown([["TUFF BRICK STAIRS","TUFF_BRICK_STAIRS"],["DARK PRISMARINE STAIRS","DARK_PRISMARINE_STAIRS"],["POLISHED DEEPSLATE STAIRS","POLISHED_DEEPSLATE_STAIRS"],["GRANITE STAIRS","GRANITE_STAIRS"],["SMOOTH RED SANDSTONE STAIRS","SMOOTH_RED_SANDSTONE_STAIRS"],["CRIMSON STAIRS","CRIMSON_STAIRS"],["WAXED CUT COPPER STAIRS","WAXED_CUT_COPPER_STAIRS"],["MANGROVE STAIRS","MANGROVE_STAIRS"],["BAMBOO MOSAIC STAIRS","BAMBOO_MOSAIC_STAIRS"],["SMOOTH SANDSTONE STAIRS","SMOOTH_SANDSTONE_STAIRS"],["JUNGLE STAIRS","JUNGLE_STAIRS"],["CHERRY STAIRS","CHERRY_STAIRS"],["BRICK STAIRS","BRICK_STAIRS"],["WARPED STAIRS","WARPED_STAIRS"],["POLISHED ANDESITE STAIRS","POLISHED_ANDESITE_STAIRS"],["PRISMARINE STAIRS","PRISMARINE_STAIRS"],["QUARTZ STAIRS","QUARTZ_STAIRS"],["POLISHED DIORITE STAIRS","POLISHED_DIORITE_STAIRS"],["RESIN BRICK STAIRS","RESIN_BRICK_STAIRS"],["PURPUR STAIRS","PURPUR_STAIRS"],["OXIDIZED CUT COPPER STAIRS","OXIDIZED_CUT_COPPER_STAIRS"],["POLISHED GRANITE STAIRS","POLISHED_GRANITE_STAIRS"],["MOSSY COBBLESTONE STAIRS","MOSSY_COBBLESTONE_STAIRS"],["PRISMARINE BRICK STAIRS","PRISMARINE_BRICK_STAIRS"],["POLISHED BLACKSTONE BRICK STAIRS","POLISHED_BLACKSTONE_BRICK_STAIRS"],["DEEPSLATE BRICK STAIRS","DEEPSLATE_BRICK_STAIRS"],["MUD BRICK STAIRS","MUD_BRICK_STAIRS"],["BIRCH STAIRS","BIRCH_STAIRS"],["DIORITE STAIRS","DIORITE_STAIRS"],["POLISHED BLACKSTONE STAIRS","POLISHED_BLACKSTONE_STAIRS"],["BAMBOO STAIRS","BAMBOO_STAIRS"],["DARK OAK STAIRS","DARK_OAK_STAIRS"],["MOSSY STONE BRICK STAIRS","MOSSY_STONE_BRICK_STAIRS"],["STONE BRICK STAIRS","STONE_BRICK_STAIRS"],["NETHER BRICK STAIRS","NETHER_BRICK_STAIRS"],["SPRUCE STAIRS","SPRUCE_STAIRS"],["ACACIA STAIRS","ACACIA_STAIRS"],["WAXED EXPOSED CUT COPPER STAIRS","WAXED_EXPOSED_CUT_COPPER_STAIRS"],["RED NETHER BRICK STAIRS","RED_NETHER_BRICK_STAIRS"],["COBBLED DEEPSLATE STAIRS","COBBLED_DEEPSLATE_STAIRS"],["DEEPSLATE TILE STAIRS","DEEPSLATE_TILE_STAIRS"],["ANDESITE STAIRS","ANDESITE_STAIRS"],["END STONE BRICK STAIRS","END_STONE_BRICK_STAIRS"],["PALE OAK STAIRS","PALE_OAK_STAIRS"],["COBBLESTONE STAIRS","COBBLESTONE_STAIRS"],["POLISHED TUFF STAIRS","POLISHED_TUFF_STAIRS"],["TUFF STAIRS","TUFF_STAIRS"],["SANDSTONE STAIRS","SANDSTONE_STAIRS"],["STONE STAIRS","STONE_STAIRS"],["EXPOSED CUT COPPER STAIRS","EXPOSED_CUT_COPPER_STAIRS"],["BLACKSTONE STAIRS","BLACKSTONE_STAIRS"],["SMOOTH QUARTZ STAIRS","SMOOTH_QUARTZ_STAIRS"],["WEATHERED CUT COPPER STAIRS","WEATHERED_CUT_COPPER_STAIRS"],["RED SANDSTONE STAIRS","RED_SANDSTONE_STAIRS"],["OAK STAIRS","OAK_STAIRS"],["WAXED WEATHERED CUT COPPER STAIRS","WAXED_WEATHERED_CUT_COPPER_STAIRS"],["WAXED OXIDIZED CUT COPPER STAIRS","WAXED_OXIDIZED_CUT_COPPER_STAIRS"],["CUT COPPER STAIRS","CUT_COPPER_STAIRS"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Stairs material.")}},u.Blocks.minecraft_picker_stone_bricks={init:function(){this.appendDummyInput().appendField("Stone Bricks").appendField(new u.FieldDropdown([["BRICKS","BRICKS"],["STONE BRICKS","STONE_BRICKS"],["MUD BRICKS","MUD_BRICKS"],["DEEPSLATE BRICKS","DEEPSLATE_BRICKS"],["DEEPSLATE TILES","DEEPSLATE_TILES"],["NETHER BRICKS","NETHER_BRICKS"],["RED NETHER BRICKS","RED_NETHER_BRICKS"],["POLISHED BLACKSTONE BRICKS","POLISHED_BLACKSTONE_BRICKS"],["END STONE BRICKS","END_STONE_BRICKS"],["QUARTZ BRICKS","QUARTZ_BRICKS"],["CHISELED STONE BRICKS","CHISELED_STONE_BRICKS"],["CRACKED STONE BRICKS","CRACKED_STONE_BRICKS"],["MOSSY STONE BRICKS","MOSSY_STONE_BRICKS"],["CHISELED NETHER BRICKS","CHISELED_NETHER_BRICKS"],["CRACKED NETHER BRICKS","CRACKED_NETHER_BRICKS"],["CHISELED POLISHED BLACKSTONE","CHISELED_POLISHED_BLACKSTONE"],["CRACKED POLISHED BLACKSTONE BRICKS","CRACKED_POLISHED_BLACKSTONE_BRICKS"],["CHISELED DEEPSLATE","CHISELED_DEEPSLATE"],["CRACKED DEEPSLATE BRICKS","CRACKED_DEEPSLATE_BRICKS"],["CRACKED DEEPSLATE TILES","CRACKED_DEEPSLATE_TILES"],["CHISELED TUFF BRICKS","CHISELED_TUFF_BRICKS"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Stone Bricks material.")}},u.Blocks.minecraft_picker_trapdoors={init:function(){this.appendDummyInput().appendField("Trapdoors").appendField(new u.FieldDropdown([["CRIMSON TRAPDOOR","CRIMSON_TRAPDOOR"],["CHERRY TRAPDOOR","CHERRY_TRAPDOOR"],["BIRCH TRAPDOOR","BIRCH_TRAPDOOR"],["COPPER TRAPDOOR","COPPER_TRAPDOOR"],["WAXED WEATHERED COPPER TRAPDOOR","WAXED_WEATHERED_COPPER_TRAPDOOR"],["PALE OAK TRAPDOOR","PALE_OAK_TRAPDOOR"],["WARPED TRAPDOOR","WARPED_TRAPDOOR"],["MANGROVE TRAPDOOR","MANGROVE_TRAPDOOR"],["WEATHERED COPPER TRAPDOOR","WEATHERED_COPPER_TRAPDOOR"],["EXPOSED COPPER TRAPDOOR","EXPOSED_COPPER_TRAPDOOR"],["WAXED COPPER TRAPDOOR","WAXED_COPPER_TRAPDOOR"],["WAXED EXPOSED COPPER TRAPDOOR","WAXED_EXPOSED_COPPER_TRAPDOOR"],["JUNGLE TRAPDOOR","JUNGLE_TRAPDOOR"],["BAMBOO TRAPDOOR","BAMBOO_TRAPDOOR"],["OXIDIZED COPPER TRAPDOOR","OXIDIZED_COPPER_TRAPDOOR"],["DARK OAK TRAPDOOR","DARK_OAK_TRAPDOOR"],["ACACIA TRAPDOOR","ACACIA_TRAPDOOR"],["WAXED OXIDIZED COPPER TRAPDOOR","WAXED_OXIDIZED_COPPER_TRAPDOOR"],["OAK TRAPDOOR","OAK_TRAPDOOR"],["IRON TRAPDOOR","IRON_TRAPDOOR"],["SPRUCE TRAPDOOR","SPRUCE_TRAPDOOR"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Trapdoors material.")}},u.Blocks.minecraft_picker_walls={init:function(){this.appendDummyInput().appendField("Walls").appendField(new u.FieldDropdown([["POLISHED BLACKSTONE BRICK WALL","POLISHED_BLACKSTONE_BRICK_WALL"],["RED SANDSTONE WALL","RED_SANDSTONE_WALL"],["POLISHED DEEPSLATE WALL","POLISHED_DEEPSLATE_WALL"],["BRICK WALL","BRICK_WALL"],["NETHER BRICK WALL","NETHER_BRICK_WALL"],["TUFF BRICK WALL","TUFF_BRICK_WALL"],["DIORITE WALL","DIORITE_WALL"],["MOSSY COBBLESTONE WALL","MOSSY_COBBLESTONE_WALL"],["ANDESITE WALL","ANDESITE_WALL"],["COBBLED DEEPSLATE WALL","COBBLED_DEEPSLATE_WALL"],["SANDSTONE WALL","SANDSTONE_WALL"],["POLISHED TUFF WALL","POLISHED_TUFF_WALL"],["DEEPSLATE BRICK WALL","DEEPSLATE_BRICK_WALL"],["STONE BRICK WALL","STONE_BRICK_WALL"],["RESIN BRICK WALL","RESIN_BRICK_WALL"],["MUD BRICK WALL","MUD_BRICK_WALL"],["DEEPSLATE TILE WALL","DEEPSLATE_TILE_WALL"],["GRANITE WALL","GRANITE_WALL"],["MOSSY STONE BRICK WALL","MOSSY_STONE_BRICK_WALL"],["TUFF WALL","TUFF_WALL"],["BLACKSTONE WALL","BLACKSTONE_WALL"],["END STONE BRICK WALL","END_STONE_BRICK_WALL"],["COBBLESTONE WALL","COBBLESTONE_WALL"],["RED NETHER BRICK WALL","RED_NETHER_BRICK_WALL"],["PRISMARINE WALL","PRISMARINE_WALL"],["POLISHED BLACKSTONE WALL","POLISHED_BLACKSTONE_WALL"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Walls material.")}},u.Blocks.minecraft_picker_wood_full={init:function(){this.appendDummyInput().appendField("Wood Full").appendField(new u.FieldDropdown([["OAK WOOD","OAK_WOOD"],["SPRUCE WOOD","SPRUCE_WOOD"],["BIRCH WOOD","BIRCH_WOOD"],["JUNGLE WOOD","JUNGLE_WOOD"],["ACACIA WOOD","ACACIA_WOOD"],["DARK OAK WOOD","DARK_OAK_WOOD"],["MANGROVE WOOD","MANGROVE_WOOD"],["CHERRY WOOD","CHERRY_WOOD"],["CRIMSON HYPHAE","CRIMSON_HYPHAE"],["WARPED HYPHAE","WARPED_HYPHAE"],["STRIPPED OAK WOOD","STRIPPED_OAK_WOOD"],["STRIPPED SPRUCE WOOD","STRIPPED_SPRUCE_WOOD"],["STRIPPED BIRCH WOOD","STRIPPED_BIRCH_WOOD"],["STRIPPED JUNGLE WOOD","STRIPPED_JUNGLE_WOOD"],["STRIPPED ACACIA WOOD","STRIPPED_ACACIA_WOOD"],["STRIPPED DARK OAK WOOD","STRIPPED_DARK_OAK_WOOD"],["STRIPPED MANGROVE WOOD","STRIPPED_MANGROVE_WOOD"],["STRIPPED CHERRY WOOD","STRIPPED_CHERRY_WOOD"],["STRIPPED CRIMSON HYPHAE","STRIPPED_CRIMSON_HYPHAE"],["STRIPPED WARPED HYPHAE","STRIPPED_WARPED_HYPHAE"],["BAMBOO BLOCK","BAMBOO_BLOCK"],["STRIPPED BAMBOO BLOCK","STRIPPED_BAMBOO_BLOCK"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Wood Full material.")}},u.Blocks.minecraft_picker_wood_logs={init:function(){this.appendDummyInput().appendField("Wood Logs").appendField(new u.FieldDropdown([["OAK LOG","OAK_LOG"],["SPRUCE LOG","SPRUCE_LOG"],["BIRCH LOG","BIRCH_LOG"],["JUNGLE LOG","JUNGLE_LOG"],["ACACIA LOG","ACACIA_LOG"],["DARK OAK LOG","DARK_OAK_LOG"],["MANGROVE LOG","MANGROVE_LOG"],["CHERRY LOG","CHERRY_LOG"],["CRIMSON STEM","CRIMSON_STEM"],["WARPED STEM","WARPED_STEM"],["STRIPPED OAK LOG","STRIPPED_OAK_LOG"],["STRIPPED SPRUCE LOG","STRIPPED_SPRUCE_LOG"],["STRIPPED BIRCH LOG","STRIPPED_BIRCH_LOG"],["STRIPPED JUNGLE LOG","STRIPPED_JUNGLE_LOG"],["STRIPPED ACACIA LOG","STRIPPED_ACACIA_LOG"],["STRIPPED DARK OAK LOG","STRIPPED_DARK_OAK_LOG"],["STRIPPED MANGROVE LOG","STRIPPED_MANGROVE_LOG"],["STRIPPED CHERRY LOG","STRIPPED_CHERRY_LOG"],["STRIPPED CRIMSON STEM","STRIPPED_CRIMSON_STEM"],["STRIPPED WARPED STEM","STRIPPED_WARPED_STEM"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Wood Logs material.")}},u.Blocks.minecraft_picker_wood_planks={init:function(){this.appendDummyInput().appendField("Wood Planks").appendField(new u.FieldDropdown([["OAK PLANKS","OAK_PLANKS"],["SPRUCE PLANKS","SPRUCE_PLANKS"],["BIRCH PLANKS","BIRCH_PLANKS"],["JUNGLE PLANKS","JUNGLE_PLANKS"],["ACACIA PLANKS","ACACIA_PLANKS"],["DARK OAK PLANKS","DARK_OAK_PLANKS"],["MANGROVE PLANKS","MANGROVE_PLANKS"],["CHERRY PLANKS","CHERRY_PLANKS"],["BAMBOO PLANKS","BAMBOO_PLANKS"],["CRIMSON PLANKS","CRIMSON_PLANKS"],["WARPED PLANKS","WARPED_PLANKS"],["BAMBOO MOSAIC","BAMBOO_MOSAIC"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a Wood Planks material.")}},u.Blocks.minecraft_picker_world={init:function(){this.appendDummyInput().appendField("World").appendField(new u.FieldDropdown([["AIR","AIR"],["STONE","STONE"],["GRANITE","GRANITE"],["DIORITE","DIORITE"],["ANDESITE","ANDESITE"],["DEEPSLATE","DEEPSLATE"],["CALCITE","CALCITE"],["TUFF","TUFF"],["DIRT","DIRT"],["COARSE DIRT","COARSE_DIRT"],["ROOTED DIRT","ROOTED_DIRT"],["GRASS BLOCK","GRASS_BLOCK"],["PODZOL","PODZOL"],["MYCELIUM","MYCELIUM"],["DIRT PATH","DIRT_PATH"],["SAND","SAND"],["RED SAND","RED_SAND"],["GRAVEL","GRAVEL"],["CLAY","CLAY"],["ICE","ICE"],["PACKED ICE","PACKED_ICE"],["BLUE ICE","BLUE_ICE"],["SNOW","SNOW"],["SNOW BLOCK","SNOW_BLOCK"],["WATER","WATER"],["LAVA","LAVA"],["BEDROCK","BEDROCK"],["OBSIDIAN","OBSIDIAN"],["CRYING OBSIDIAN","CRYING_OBSIDIAN"],["MAGMA BLOCK","MAGMA_BLOCK"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(180),this.setTooltip("Select a World material.")}},u.Blocks.minecraft_picker_miscellaneous={init:function(){this.appendDummyInput().appendField("Misc. Block/Item").appendField(new u.FieldDropdown([["ACACIA BOAT","ACACIA_BOAT"],["ACACIA BUTTON","ACACIA_BUTTON"],["ACACIA CHEST BOAT","ACACIA_CHEST_BOAT"],["ACACIA HANGING SIGN","ACACIA_HANGING_SIGN"],["ACACIA LEAVES","ACACIA_LEAVES"],["ACACIA PRESSURE PLATE","ACACIA_PRESSURE_PLATE"],["ACACIA SAPLING","ACACIA_SAPLING"],["ACACIA SIGN","ACACIA_SIGN"],["ACACIA WALL HANGING SIGN","ACACIA_WALL_HANGING_SIGN"],["ACACIA WALL SIGN","ACACIA_WALL_SIGN"],["ALLAY SPAWN EGG","ALLAY_SPAWN_EGG"],["ALLIUM","ALLIUM"],["AMETHYST BLOCK","AMETHYST_BLOCK"],["AMETHYST CLUSTER","AMETHYST_CLUSTER"],["AMETHYST SHARD","AMETHYST_SHARD"],["ANGLER POTTERY SHERD","ANGLER_POTTERY_SHERD"],["ANVIL","ANVIL"],["APPLE","APPLE"],["ARCHER POTTERY SHERD","ARCHER_POTTERY_SHERD"],["ARMADILLO SCUTE","ARMADILLO_SCUTE"],["ARMADILLO SPAWN EGG","ARMADILLO_SPAWN_EGG"],["ARMOR STAND","ARMOR_STAND"],["ARMS UP POTTERY SHERD","ARMS_UP_POTTERY_SHERD"],["ARROW","ARROW"],["ATTACHED MELON STEM","ATTACHED_MELON_STEM"],["ATTACHED PUMPKIN STEM","ATTACHED_PUMPKIN_STEM"],["AXOLOTL BUCKET","AXOLOTL_BUCKET"],["AXOLOTL SPAWN EGG","AXOLOTL_SPAWN_EGG"],["AZALEA","AZALEA"],["AZALEA LEAVES","AZALEA_LEAVES"],["AZURE BLUET","AZURE_BLUET"],["BAKED POTATO","BAKED_POTATO"],["BAMBOO","BAMBOO"],["BAMBOO BUTTON","BAMBOO_BUTTON"],["BAMBOO CHEST RAFT","BAMBOO_CHEST_RAFT"],["BAMBOO HANGING SIGN","BAMBOO_HANGING_SIGN"],["BAMBOO PRESSURE PLATE","BAMBOO_PRESSURE_PLATE"],["BAMBOO RAFT","BAMBOO_RAFT"],["BAMBOO SAPLING","BAMBOO_SAPLING"],["BAMBOO SIGN","BAMBOO_SIGN"],["BAMBOO WALL HANGING SIGN","BAMBOO_WALL_HANGING_SIGN"],["BAMBOO WALL SIGN","BAMBOO_WALL_SIGN"],["BARREL","BARREL"],["BARRIER","BARRIER"],["BASALT","BASALT"],["BAT SPAWN EGG","BAT_SPAWN_EGG"],["BEACON","BEACON"],["BEEF","BEEF"],["BEEHIVE","BEEHIVE"],["BEETROOT","BEETROOT"],["BEETROOTS","BEETROOTS"],["BEETROOT SEEDS","BEETROOT_SEEDS"],["BEETROOT SOUP","BEETROOT_SOUP"],["BEE NEST","BEE_NEST"],["BEE SPAWN EGG","BEE_SPAWN_EGG"],["BELL","BELL"],["BIG DRIPLEAF","BIG_DRIPLEAF"],["BIG DRIPLEAF STEM","BIG_DRIPLEAF_STEM"],["BIRCH BOAT","BIRCH_BOAT"],["BIRCH BUTTON","BIRCH_BUTTON"],["BIRCH CHEST BOAT","BIRCH_CHEST_BOAT"],["BIRCH HANGING SIGN","BIRCH_HANGING_SIGN"],["BIRCH LEAVES","BIRCH_LEAVES"],["BIRCH PRESSURE PLATE","BIRCH_PRESSURE_PLATE"],["BIRCH SAPLING","BIRCH_SAPLING"],["BIRCH SIGN","BIRCH_SIGN"],["BIRCH WALL HANGING SIGN","BIRCH_WALL_HANGING_SIGN"],["BIRCH WALL SIGN","BIRCH_WALL_SIGN"],["BLACKSTONE","BLACKSTONE"],["BLACK BUNDLE","BLACK_BUNDLE"],["BLACK CANDLE CAKE","BLACK_CANDLE_CAKE"],["BLACK DYE","BLACK_DYE"],["BLADE POTTERY SHERD","BLADE_POTTERY_SHERD"],["BLAST FURNACE","BLAST_FURNACE"],["BLAZE POWDER","BLAZE_POWDER"],["BLAZE ROD","BLAZE_ROD"],["BLAZE SPAWN EGG","BLAZE_SPAWN_EGG"],["BLUE BUNDLE","BLUE_BUNDLE"],["BLUE CANDLE CAKE","BLUE_CANDLE_CAKE"],["BLUE DYE","BLUE_DYE"],["BLUE EGG","BLUE_EGG"],["BLUE ORCHID","BLUE_ORCHID"],["BOGGED SPAWN EGG","BOGGED_SPAWN_EGG"],["BOLT ARMOR TRIM SMITHING TEMPLATE","BOLT_ARMOR_TRIM_SMITHING_TEMPLATE"],["BONE","BONE"],["BONE BLOCK","BONE_BLOCK"],["BONE MEAL","BONE_MEAL"],["BOOK","BOOK"],["BOOKSHELF","BOOKSHELF"],["BORDURE INDENTED BANNER PATTERN","BORDURE_INDENTED_BANNER_PATTERN"],["BOW","BOW"],["BOWL","BOWL"],["BRAIN CORAL","BRAIN_CORAL"],["BRAIN CORAL BLOCK","BRAIN_CORAL_BLOCK"],["BRAIN CORAL FAN","BRAIN_CORAL_FAN"],["BRAIN CORAL WALL FAN","BRAIN_CORAL_WALL_FAN"],["BREAD","BREAD"],["BREEZE ROD","BREEZE_ROD"],["BREEZE SPAWN EGG","BREEZE_SPAWN_EGG"],["BREWER POTTERY SHERD","BREWER_POTTERY_SHERD"],["BREWING STAND","BREWING_STAND"],["BRICK","BRICK"],["BROWN BUNDLE","BROWN_BUNDLE"],["BROWN CANDLE CAKE","BROWN_CANDLE_CAKE"],["BROWN DYE","BROWN_DYE"],["BROWN EGG","BROWN_EGG"],["BROWN MUSHROOM","BROWN_MUSHROOM"],["BROWN MUSHROOM BLOCK","BROWN_MUSHROOM_BLOCK"],["BRUSH","BRUSH"],["BUBBLE COLUMN","BUBBLE_COLUMN"],["BUBBLE CORAL","BUBBLE_CORAL"],["BUBBLE CORAL BLOCK","BUBBLE_CORAL_BLOCK"],["BUBBLE CORAL FAN","BUBBLE_CORAL_FAN"],["BUBBLE CORAL WALL FAN","BUBBLE_CORAL_WALL_FAN"],["BUCKET","BUCKET"],["BUDDING AMETHYST","BUDDING_AMETHYST"],["BUNDLE","BUNDLE"],["BURN POTTERY SHERD","BURN_POTTERY_SHERD"],["BUSH","BUSH"],["CACTUS","CACTUS"],["CACTUS FLOWER","CACTUS_FLOWER"],["CAKE","CAKE"],["CALIBRATED SCULK SENSOR","CALIBRATED_SCULK_SENSOR"],["CAMEL SPAWN EGG","CAMEL_SPAWN_EGG"],["CAMPFIRE","CAMPFIRE"],["CANDLE","CANDLE"],["CANDLE CAKE","CANDLE_CAKE"],["CARROT","CARROT"],["CARROTS","CARROTS"],["CARROT ON A STICK","CARROT_ON_A_STICK"],["CARTOGRAPHY TABLE","CARTOGRAPHY_TABLE"],["CARVED PUMPKIN","CARVED_PUMPKIN"],["CAT SPAWN EGG","CAT_SPAWN_EGG"],["CAULDRON","CAULDRON"],["CAVE AIR","CAVE_AIR"],["CAVE SPIDER SPAWN EGG","CAVE_SPIDER_SPAWN_EGG"],["CAVE VINES","CAVE_VINES"],["CAVE VINES PLANT","CAVE_VINES_PLANT"],["CHAIN","CHAIN"],["CHAINMAIL BOOTS","CHAINMAIL_BOOTS"],["CHAINMAIL CHESTPLATE","CHAINMAIL_CHESTPLATE"],["CHAINMAIL HELMET","CHAINMAIL_HELMET"],["CHAINMAIL LEGGINGS","CHAINMAIL_LEGGINGS"],["CHAIN COMMAND BLOCK","CHAIN_COMMAND_BLOCK"],["CHARCOAL","CHARCOAL"],["CHERRY BOAT","CHERRY_BOAT"],["CHERRY BUTTON","CHERRY_BUTTON"],["CHERRY CHEST BOAT","CHERRY_CHEST_BOAT"],["CHERRY HANGING SIGN","CHERRY_HANGING_SIGN"],["CHERRY LEAVES","CHERRY_LEAVES"],["CHERRY PRESSURE PLATE","CHERRY_PRESSURE_PLATE"],["CHERRY SAPLING","CHERRY_SAPLING"],["CHERRY SIGN","CHERRY_SIGN"],["CHERRY WALL HANGING SIGN","CHERRY_WALL_HANGING_SIGN"],["CHERRY WALL SIGN","CHERRY_WALL_SIGN"],["CHEST","CHEST"],["CHEST MINECART","CHEST_MINECART"],["CHICKEN","CHICKEN"],["CHICKEN SPAWN EGG","CHICKEN_SPAWN_EGG"],["CHIPPED ANVIL","CHIPPED_ANVIL"],["CHISELED BOOKSHELF","CHISELED_BOOKSHELF"],["CHISELED COPPER","CHISELED_COPPER"],["CHISELED QUARTZ BLOCK","CHISELED_QUARTZ_BLOCK"],["CHISELED RED SANDSTONE","CHISELED_RED_SANDSTONE"],["CHISELED RESIN BRICKS","CHISELED_RESIN_BRICKS"],["CHISELED SANDSTONE","CHISELED_SANDSTONE"],["CHISELED TUFF","CHISELED_TUFF"],["CHORUS FLOWER","CHORUS_FLOWER"],["CHORUS FRUIT","CHORUS_FRUIT"],["CHORUS PLANT","CHORUS_PLANT"],["CLAY BALL","CLAY_BALL"],["CLOCK","CLOCK"],["CLOSED EYEBLOSSOM","CLOSED_EYEBLOSSOM"],["COAL","COAL"],["COAL BLOCK","COAL_BLOCK"],["COAST ARMOR TRIM SMITHING TEMPLATE","COAST_ARMOR_TRIM_SMITHING_TEMPLATE"],["COBBLED DEEPSLATE","COBBLED_DEEPSLATE"],["COBBLESTONE","COBBLESTONE"],["COBWEB","COBWEB"],["COCOA","COCOA"],["COCOA BEANS","COCOA_BEANS"],["COD","COD"],["COD BUCKET","COD_BUCKET"],["COD SPAWN EGG","COD_SPAWN_EGG"],["COMMAND BLOCK","COMMAND_BLOCK"],["COMMAND BLOCK MINECART","COMMAND_BLOCK_MINECART"],["COMPASS","COMPASS"],["COMPOSTER","COMPOSTER"],["CONDUIT","CONDUIT"],["COOKED BEEF","COOKED_BEEF"],["COOKED CHICKEN","COOKED_CHICKEN"],["COOKED COD","COOKED_COD"],["COOKED MUTTON","COOKED_MUTTON"],["COOKED PORKCHOP","COOKED_PORKCHOP"],["COOKED RABBIT","COOKED_RABBIT"],["COOKED SALMON","COOKED_SALMON"],["COOKIE","COOKIE"],["COPPER BLOCK","COPPER_BLOCK"],["COPPER BULB","COPPER_BULB"],["COPPER GRATE","COPPER_GRATE"],["COPPER INGOT","COPPER_INGOT"],["CORNFLOWER","CORNFLOWER"],["COW SPAWN EGG","COW_SPAWN_EGG"],["CRAFTER","CRAFTER"],["CRAFTING TABLE","CRAFTING_TABLE"],["CREAKING HEART","CREAKING_HEART"],["CREAKING SPAWN EGG","CREAKING_SPAWN_EGG"],["CREEPER BANNER PATTERN","CREEPER_BANNER_PATTERN"],["CREEPER HEAD","CREEPER_HEAD"],["CREEPER SPAWN EGG","CREEPER_SPAWN_EGG"],["CREEPER WALL HEAD","CREEPER_WALL_HEAD"],["CRIMSON BUTTON","CRIMSON_BUTTON"],["CRIMSON FUNGUS","CRIMSON_FUNGUS"],["CRIMSON HANGING SIGN","CRIMSON_HANGING_SIGN"],["CRIMSON NYLIUM","CRIMSON_NYLIUM"],["CRIMSON PRESSURE PLATE","CRIMSON_PRESSURE_PLATE"],["CRIMSON ROOTS","CRIMSON_ROOTS"],["CRIMSON SIGN","CRIMSON_SIGN"],["CRIMSON WALL HANGING SIGN","CRIMSON_WALL_HANGING_SIGN"],["CRIMSON WALL SIGN","CRIMSON_WALL_SIGN"],["CROSSBOW","CROSSBOW"],["CUT COPPER","CUT_COPPER"],["CUT RED SANDSTONE","CUT_RED_SANDSTONE"],["CUT SANDSTONE","CUT_SANDSTONE"],["CYAN BUNDLE","CYAN_BUNDLE"],["CYAN CANDLE CAKE","CYAN_CANDLE_CAKE"],["CYAN DYE","CYAN_DYE"],["DAMAGED ANVIL","DAMAGED_ANVIL"],["DANDELION","DANDELION"],["DANGER POTTERY SHERD","DANGER_POTTERY_SHERD"],["DARK OAK BOAT","DARK_OAK_BOAT"],["DARK OAK BUTTON","DARK_OAK_BUTTON"],["DARK OAK CHEST BOAT","DARK_OAK_CHEST_BOAT"],["DARK OAK HANGING SIGN","DARK_OAK_HANGING_SIGN"],["DARK OAK LEAVES","DARK_OAK_LEAVES"],["DARK OAK PRESSURE PLATE","DARK_OAK_PRESSURE_PLATE"],["DARK OAK SAPLING","DARK_OAK_SAPLING"],["DARK OAK SIGN","DARK_OAK_SIGN"],["DARK OAK WALL HANGING SIGN","DARK_OAK_WALL_HANGING_SIGN"],["DARK OAK WALL SIGN","DARK_OAK_WALL_SIGN"],["DARK PRISMARINE","DARK_PRISMARINE"],["DEAD BRAIN CORAL","DEAD_BRAIN_CORAL"],["DEAD BRAIN CORAL BLOCK","DEAD_BRAIN_CORAL_BLOCK"],["DEAD BRAIN CORAL FAN","DEAD_BRAIN_CORAL_FAN"],["DEAD BRAIN CORAL WALL FAN","DEAD_BRAIN_CORAL_WALL_FAN"],["DEAD BUBBLE CORAL","DEAD_BUBBLE_CORAL"],["DEAD BUBBLE CORAL BLOCK","DEAD_BUBBLE_CORAL_BLOCK"],["DEAD BUBBLE CORAL FAN","DEAD_BUBBLE_CORAL_FAN"],["DEAD BUBBLE CORAL WALL FAN","DEAD_BUBBLE_CORAL_WALL_FAN"],["DEAD BUSH","DEAD_BUSH"],["DEAD FIRE CORAL","DEAD_FIRE_CORAL"],["DEAD FIRE CORAL BLOCK","DEAD_FIRE_CORAL_BLOCK"],["DEAD FIRE CORAL FAN","DEAD_FIRE_CORAL_FAN"],["DEAD FIRE CORAL WALL FAN","DEAD_FIRE_CORAL_WALL_FAN"],["DEAD HORN CORAL","DEAD_HORN_CORAL"],["DEAD HORN CORAL BLOCK","DEAD_HORN_CORAL_BLOCK"],["DEAD HORN CORAL FAN","DEAD_HORN_CORAL_FAN"],["DEAD HORN CORAL WALL FAN","DEAD_HORN_CORAL_WALL_FAN"],["DEAD TUBE CORAL","DEAD_TUBE_CORAL"],["DEAD TUBE CORAL BLOCK","DEAD_TUBE_CORAL_BLOCK"],["DEAD TUBE CORAL FAN","DEAD_TUBE_CORAL_FAN"],["DEAD TUBE CORAL WALL FAN","DEAD_TUBE_CORAL_WALL_FAN"],["DEBUG STICK","DEBUG_STICK"],["DECORATED POT","DECORATED_POT"],["DIAMOND","DIAMOND"],["DIAMOND AXE","DIAMOND_AXE"],["DIAMOND BLOCK","DIAMOND_BLOCK"],["DIAMOND BOOTS","DIAMOND_BOOTS"],["DIAMOND CHESTPLATE","DIAMOND_CHESTPLATE"],["DIAMOND HELMET","DIAMOND_HELMET"],["DIAMOND HOE","DIAMOND_HOE"],["DIAMOND HORSE ARMOR","DIAMOND_HORSE_ARMOR"],["DIAMOND LEGGINGS","DIAMOND_LEGGINGS"],["DIAMOND PICKAXE","DIAMOND_PICKAXE"],["DIAMOND SHOVEL","DIAMOND_SHOVEL"],["DIAMOND SWORD","DIAMOND_SWORD"],["DISC FRAGMENT 5","DISC_FRAGMENT_5"],["DOLPHIN SPAWN EGG","DOLPHIN_SPAWN_EGG"],["DONKEY SPAWN EGG","DONKEY_SPAWN_EGG"],["DRAGON BREATH","DRAGON_BREATH"],["DRAGON EGG","DRAGON_EGG"],["DRAGON HEAD","DRAGON_HEAD"],["DRAGON WALL HEAD","DRAGON_WALL_HEAD"],["DRIED KELP","DRIED_KELP"],["DRIED KELP BLOCK","DRIED_KELP_BLOCK"],["DRIPSTONE BLOCK","DRIPSTONE_BLOCK"],["DROWNED SPAWN EGG","DROWNED_SPAWN_EGG"],["DUNE ARMOR TRIM SMITHING TEMPLATE","DUNE_ARMOR_TRIM_SMITHING_TEMPLATE"],["ECHO SHARD","ECHO_SHARD"],["EGG","EGG"],["ELDER GUARDIAN SPAWN EGG","ELDER_GUARDIAN_SPAWN_EGG"],["ELYTRA","ELYTRA"],["EMERALD","EMERALD"],["EMERALD BLOCK","EMERALD_BLOCK"],["ENCHANTED BOOK","ENCHANTED_BOOK"],["ENCHANTED GOLDEN APPLE","ENCHANTED_GOLDEN_APPLE"],["ENCHANTING TABLE","ENCHANTING_TABLE"],["ENDERMAN SPAWN EGG","ENDERMAN_SPAWN_EGG"],["ENDERMITE SPAWN EGG","ENDERMITE_SPAWN_EGG"],["ENDER CHEST","ENDER_CHEST"],["ENDER DRAGON SPAWN EGG","ENDER_DRAGON_SPAWN_EGG"],["ENDER EYE","ENDER_EYE"],["ENDER PEARL","ENDER_PEARL"],["END CRYSTAL","END_CRYSTAL"],["END GATEWAY","END_GATEWAY"],["END PORTAL","END_PORTAL"],["END PORTAL FRAME","END_PORTAL_FRAME"],["END ROD","END_ROD"],["END STONE","END_STONE"],["EVOKER SPAWN EGG","EVOKER_SPAWN_EGG"],["EXPERIENCE BOTTLE","EXPERIENCE_BOTTLE"],["EXPLORER POTTERY SHERD","EXPLORER_POTTERY_SHERD"],["EXPOSED CHISELED COPPER","EXPOSED_CHISELED_COPPER"],["EXPOSED COPPER","EXPOSED_COPPER"],["EXPOSED COPPER BULB","EXPOSED_COPPER_BULB"],["EXPOSED COPPER GRATE","EXPOSED_COPPER_GRATE"],["EXPOSED CUT COPPER","EXPOSED_CUT_COPPER"],["EYE ARMOR TRIM SMITHING TEMPLATE","EYE_ARMOR_TRIM_SMITHING_TEMPLATE"],["FARMLAND","FARMLAND"],["FEATHER","FEATHER"],["FERMENTED SPIDER EYE","FERMENTED_SPIDER_EYE"],["FERN","FERN"],["FIELD MASONED BANNER PATTERN","FIELD_MASONED_BANNER_PATTERN"],["FILLED MAP","FILLED_MAP"],["FIRE","FIRE"],["FIREFLY BUSH","FIREFLY_BUSH"],["FIREWORK ROCKET","FIREWORK_ROCKET"],["FIREWORK STAR","FIREWORK_STAR"],["FIRE CHARGE","FIRE_CHARGE"],["FIRE CORAL","FIRE_CORAL"],["FIRE CORAL BLOCK","FIRE_CORAL_BLOCK"],["FIRE CORAL FAN","FIRE_CORAL_FAN"],["FIRE CORAL WALL FAN","FIRE_CORAL_WALL_FAN"],["FISHING ROD","FISHING_ROD"],["FLETCHING TABLE","FLETCHING_TABLE"],["FLINT","FLINT"],["FLINT AND STEEL","FLINT_AND_STEEL"],["FLOWERING AZALEA","FLOWERING_AZALEA"],["FLOWERING AZALEA LEAVES","FLOWERING_AZALEA_LEAVES"],["FLOWER BANNER PATTERN","FLOWER_BANNER_PATTERN"],["FLOWER POT","FLOWER_POT"],["FLOW ARMOR TRIM SMITHING TEMPLATE","FLOW_ARMOR_TRIM_SMITHING_TEMPLATE"],["FLOW BANNER PATTERN","FLOW_BANNER_PATTERN"],["FLOW POTTERY SHERD","FLOW_POTTERY_SHERD"],["FOX SPAWN EGG","FOX_SPAWN_EGG"],["FRIEND POTTERY SHERD","FRIEND_POTTERY_SHERD"],["FROGSPAWN","FROGSPAWN"],["FROG SPAWN EGG","FROG_SPAWN_EGG"],["FROSTED ICE","FROSTED_ICE"],["FURNACE","FURNACE"],["FURNACE MINECART","FURNACE_MINECART"],["GHAST SPAWN EGG","GHAST_SPAWN_EGG"],["GHAST TEAR","GHAST_TEAR"],["GILDED BLACKSTONE","GILDED_BLACKSTONE"],["GLASS BOTTLE","GLASS_BOTTLE"],["GLISTERING MELON SLICE","GLISTERING_MELON_SLICE"],["GLOBE BANNER PATTERN","GLOBE_BANNER_PATTERN"],["GLOWSTONE","GLOWSTONE"],["GLOWSTONE DUST","GLOWSTONE_DUST"],["GLOW BERRIES","GLOW_BERRIES"],["GLOW INK SAC","GLOW_INK_SAC"],["GLOW ITEM FRAME","GLOW_ITEM_FRAME"],["GLOW LICHEN","GLOW_LICHEN"],["GLOW SQUID SPAWN EGG","GLOW_SQUID_SPAWN_EGG"],["GOAT HORN","GOAT_HORN"],["GOAT SPAWN EGG","GOAT_SPAWN_EGG"],["GOLDEN APPLE","GOLDEN_APPLE"],["GOLDEN AXE","GOLDEN_AXE"],["GOLDEN BOOTS","GOLDEN_BOOTS"],["GOLDEN CARROT","GOLDEN_CARROT"],["GOLDEN CHESTPLATE","GOLDEN_CHESTPLATE"],["GOLDEN HELMET","GOLDEN_HELMET"],["GOLDEN HOE","GOLDEN_HOE"],["GOLDEN HORSE ARMOR","GOLDEN_HORSE_ARMOR"],["GOLDEN LEGGINGS","GOLDEN_LEGGINGS"],["GOLDEN PICKAXE","GOLDEN_PICKAXE"],["GOLDEN SHOVEL","GOLDEN_SHOVEL"],["GOLDEN SWORD","GOLDEN_SWORD"],["GOLD BLOCK","GOLD_BLOCK"],["GOLD INGOT","GOLD_INGOT"],["GOLD NUGGET","GOLD_NUGGET"],["GRAY BUNDLE","GRAY_BUNDLE"],["GRAY CANDLE CAKE","GRAY_CANDLE_CAKE"],["GRAY DYE","GRAY_DYE"],["GREEN BUNDLE","GREEN_BUNDLE"],["GREEN CANDLE CAKE","GREEN_CANDLE_CAKE"],["GREEN DYE","GREEN_DYE"],["GRINDSTONE","GRINDSTONE"],["GUARDIAN SPAWN EGG","GUARDIAN_SPAWN_EGG"],["GUNPOWDER","GUNPOWDER"],["GUSTER BANNER PATTERN","GUSTER_BANNER_PATTERN"],["GUSTER POTTERY SHERD","GUSTER_POTTERY_SHERD"],["HANGING ROOTS","HANGING_ROOTS"],["HAY BLOCK","HAY_BLOCK"],["HEARTBREAK POTTERY SHERD","HEARTBREAK_POTTERY_SHERD"],["HEART OF THE SEA","HEART_OF_THE_SEA"],["HEART POTTERY SHERD","HEART_POTTERY_SHERD"],["HEAVY CORE","HEAVY_CORE"],["HEAVY WEIGHTED PRESSURE PLATE","HEAVY_WEIGHTED_PRESSURE_PLATE"],["HOGLIN SPAWN EGG","HOGLIN_SPAWN_EGG"],["HONEYCOMB","HONEYCOMB"],["HONEYCOMB BLOCK","HONEYCOMB_BLOCK"],["HONEY BOTTLE","HONEY_BOTTLE"],["HOPPER MINECART","HOPPER_MINECART"],["HORN CORAL","HORN_CORAL"],["HORN CORAL BLOCK","HORN_CORAL_BLOCK"],["HORN CORAL FAN","HORN_CORAL_FAN"],["HORN CORAL WALL FAN","HORN_CORAL_WALL_FAN"],["HORSE SPAWN EGG","HORSE_SPAWN_EGG"],["HOST ARMOR TRIM SMITHING TEMPLATE","HOST_ARMOR_TRIM_SMITHING_TEMPLATE"],["HOWL POTTERY SHERD","HOWL_POTTERY_SHERD"],["HUSK SPAWN EGG","HUSK_SPAWN_EGG"],["INFESTED CHISELED STONE BRICKS","INFESTED_CHISELED_STONE_BRICKS"],["INFESTED COBBLESTONE","INFESTED_COBBLESTONE"],["INFESTED CRACKED STONE BRICKS","INFESTED_CRACKED_STONE_BRICKS"],["INFESTED DEEPSLATE","INFESTED_DEEPSLATE"],["INFESTED MOSSY STONE BRICKS","INFESTED_MOSSY_STONE_BRICKS"],["INFESTED STONE","INFESTED_STONE"],["INFESTED STONE BRICKS","INFESTED_STONE_BRICKS"],["INK SAC","INK_SAC"],["IRON AXE","IRON_AXE"],["IRON BARS","IRON_BARS"],["IRON BLOCK","IRON_BLOCK"],["IRON BOOTS","IRON_BOOTS"],["IRON CHESTPLATE","IRON_CHESTPLATE"],["IRON GOLEM SPAWN EGG","IRON_GOLEM_SPAWN_EGG"],["IRON HELMET","IRON_HELMET"],["IRON HOE","IRON_HOE"],["IRON HORSE ARMOR","IRON_HORSE_ARMOR"],["IRON INGOT","IRON_INGOT"],["IRON LEGGINGS","IRON_LEGGINGS"],["IRON NUGGET","IRON_NUGGET"],["IRON PICKAXE","IRON_PICKAXE"],["IRON SHOVEL","IRON_SHOVEL"],["IRON SWORD","IRON_SWORD"],["ITEM FRAME","ITEM_FRAME"],["JACK O LANTERN","JACK_O_LANTERN"],["JIGSAW","JIGSAW"],["JUKEBOX","JUKEBOX"],["JUNGLE BOAT","JUNGLE_BOAT"],["JUNGLE BUTTON","JUNGLE_BUTTON"],["JUNGLE CHEST BOAT","JUNGLE_CHEST_BOAT"],["JUNGLE HANGING SIGN","JUNGLE_HANGING_SIGN"],["JUNGLE LEAVES","JUNGLE_LEAVES"],["JUNGLE PRESSURE PLATE","JUNGLE_PRESSURE_PLATE"],["JUNGLE SAPLING","JUNGLE_SAPLING"],["JUNGLE SIGN","JUNGLE_SIGN"],["JUNGLE WALL HANGING SIGN","JUNGLE_WALL_HANGING_SIGN"],["JUNGLE WALL SIGN","JUNGLE_WALL_SIGN"],["KELP","KELP"],["KELP PLANT","KELP_PLANT"],["KNOWLEDGE BOOK","KNOWLEDGE_BOOK"],["LADDER","LADDER"],["LANTERN","LANTERN"],["LAPIS BLOCK","LAPIS_BLOCK"],["LAPIS LAZULI","LAPIS_LAZULI"],["LARGE AMETHYST BUD","LARGE_AMETHYST_BUD"],["LARGE FERN","LARGE_FERN"],["LAVA BUCKET","LAVA_BUCKET"],["LAVA CAULDRON","LAVA_CAULDRON"],["LEAD","LEAD"],["LEAF LITTER","LEAF_LITTER"],["LEATHER","LEATHER"],["LEATHER BOOTS","LEATHER_BOOTS"],["LEATHER CHESTPLATE","LEATHER_CHESTPLATE"],["LEATHER HELMET","LEATHER_HELMET"],["LEATHER HORSE ARMOR","LEATHER_HORSE_ARMOR"],["LEATHER LEGGINGS","LEATHER_LEGGINGS"],["LIGHT","LIGHT"],["LIGHTNING ROD","LIGHTNING_ROD"],["LIGHT BLUE BUNDLE","LIGHT_BLUE_BUNDLE"],["LIGHT BLUE CANDLE CAKE","LIGHT_BLUE_CANDLE_CAKE"],["LIGHT BLUE DYE","LIGHT_BLUE_DYE"],["LIGHT GRAY BUNDLE","LIGHT_GRAY_BUNDLE"],["LIGHT GRAY CANDLE CAKE","LIGHT_GRAY_CANDLE_CAKE"],["LIGHT GRAY DYE","LIGHT_GRAY_DYE"],["LIGHT WEIGHTED PRESSURE PLATE","LIGHT_WEIGHTED_PRESSURE_PLATE"],["LILAC","LILAC"],["LILY OF THE VALLEY","LILY_OF_THE_VALLEY"],["LILY PAD","LILY_PAD"],["LIME BUNDLE","LIME_BUNDLE"],["LIME CANDLE CAKE","LIME_CANDLE_CAKE"],["LIME DYE","LIME_DYE"],["LINGERING POTION","LINGERING_POTION"],["LLAMA SPAWN EGG","LLAMA_SPAWN_EGG"],["LODESTONE","LODESTONE"],["LOOM","LOOM"],["MACE","MACE"],["MAGENTA BUNDLE","MAGENTA_BUNDLE"],["MAGENTA CANDLE CAKE","MAGENTA_CANDLE_CAKE"],["MAGENTA DYE","MAGENTA_DYE"],["MAGMA CREAM","MAGMA_CREAM"],["MAGMA CUBE SPAWN EGG","MAGMA_CUBE_SPAWN_EGG"],["MANGROVE BOAT","MANGROVE_BOAT"],["MANGROVE BUTTON","MANGROVE_BUTTON"],["MANGROVE CHEST BOAT","MANGROVE_CHEST_BOAT"],["MANGROVE HANGING SIGN","MANGROVE_HANGING_SIGN"],["MANGROVE LEAVES","MANGROVE_LEAVES"],["MANGROVE PRESSURE PLATE","MANGROVE_PRESSURE_PLATE"],["MANGROVE PROPAGULE","MANGROVE_PROPAGULE"],["MANGROVE ROOTS","MANGROVE_ROOTS"],["MANGROVE SIGN","MANGROVE_SIGN"],["MANGROVE WALL HANGING SIGN","MANGROVE_WALL_HANGING_SIGN"],["MANGROVE WALL SIGN","MANGROVE_WALL_SIGN"],["MAP","MAP"],["MEDIUM AMETHYST BUD","MEDIUM_AMETHYST_BUD"],["MELON","MELON"],["MELON SEEDS","MELON_SEEDS"],["MELON SLICE","MELON_SLICE"],["MELON STEM","MELON_STEM"],["MILK BUCKET","MILK_BUCKET"],["MINECART","MINECART"],["MINER POTTERY SHERD","MINER_POTTERY_SHERD"],["MOJANG BANNER PATTERN","MOJANG_BANNER_PATTERN"],["MOOSHROOM SPAWN EGG","MOOSHROOM_SPAWN_EGG"],["MOSSY COBBLESTONE","MOSSY_COBBLESTONE"],["MOSS BLOCK","MOSS_BLOCK"],["MOSS CARPET","MOSS_CARPET"],["MOURNER POTTERY SHERD","MOURNER_POTTERY_SHERD"],["MOVING PISTON","MOVING_PISTON"],["MUD","MUD"],["MUDDY MANGROVE ROOTS","MUDDY_MANGROVE_ROOTS"],["MULE SPAWN EGG","MULE_SPAWN_EGG"],["MUSHROOM STEM","MUSHROOM_STEM"],["MUSHROOM STEW","MUSHROOM_STEW"],["MUSIC DISC 11","MUSIC_DISC_11"],["MUSIC DISC 13","MUSIC_DISC_13"],["MUSIC DISC 5","MUSIC_DISC_5"],["MUSIC DISC BLOCKS","MUSIC_DISC_BLOCKS"],["MUSIC DISC CAT","MUSIC_DISC_CAT"],["MUSIC DISC CHIRP","MUSIC_DISC_CHIRP"],["MUSIC DISC CREATOR","MUSIC_DISC_CREATOR"],["MUSIC DISC CREATOR MUSIC BOX","MUSIC_DISC_CREATOR_MUSIC_BOX"],["MUSIC DISC FAR","MUSIC_DISC_FAR"],["MUSIC DISC MALL","MUSIC_DISC_MALL"],["MUSIC DISC MELLOHI","MUSIC_DISC_MELLOHI"],["MUSIC DISC OTHERSIDE","MUSIC_DISC_OTHERSIDE"],["MUSIC DISC PIGSTEP","MUSIC_DISC_PIGSTEP"],["MUSIC DISC PRECIPICE","MUSIC_DISC_PRECIPICE"],["MUSIC DISC RELIC","MUSIC_DISC_RELIC"],["MUSIC DISC STAL","MUSIC_DISC_STAL"],["MUSIC DISC STRAD","MUSIC_DISC_STRAD"],["MUSIC DISC WAIT","MUSIC_DISC_WAIT"],["MUSIC DISC WARD","MUSIC_DISC_WARD"],["MUTTON","MUTTON"],["NAME TAG","NAME_TAG"],["NAUTILUS SHELL","NAUTILUS_SHELL"],["NETHERITE AXE","NETHERITE_AXE"],["NETHERITE BLOCK","NETHERITE_BLOCK"],["NETHERITE BOOTS","NETHERITE_BOOTS"],["NETHERITE CHESTPLATE","NETHERITE_CHESTPLATE"],["NETHERITE HELMET","NETHERITE_HELMET"],["NETHERITE HOE","NETHERITE_HOE"],["NETHERITE INGOT","NETHERITE_INGOT"],["NETHERITE LEGGINGS","NETHERITE_LEGGINGS"],["NETHERITE PICKAXE","NETHERITE_PICKAXE"],["NETHERITE SCRAP","NETHERITE_SCRAP"],["NETHERITE SHOVEL","NETHERITE_SHOVEL"],["NETHERITE SWORD","NETHERITE_SWORD"],["NETHERITE UPGRADE SMITHING TEMPLATE","NETHERITE_UPGRADE_SMITHING_TEMPLATE"],["NETHERRACK","NETHERRACK"],["NETHER BRICK","NETHER_BRICK"],["NETHER PORTAL","NETHER_PORTAL"],["NETHER SPROUTS","NETHER_SPROUTS"],["NETHER STAR","NETHER_STAR"],["NETHER WART","NETHER_WART"],["NETHER WART BLOCK","NETHER_WART_BLOCK"],["OAK BOAT","OAK_BOAT"],["OAK BUTTON","OAK_BUTTON"],["OAK CHEST BOAT","OAK_CHEST_BOAT"],["OAK HANGING SIGN","OAK_HANGING_SIGN"],["OAK LEAVES","OAK_LEAVES"],["OAK PRESSURE PLATE","OAK_PRESSURE_PLATE"],["OAK SAPLING","OAK_SAPLING"],["OAK SIGN","OAK_SIGN"],["OAK WALL HANGING SIGN","OAK_WALL_HANGING_SIGN"],["OAK WALL SIGN","OAK_WALL_SIGN"],["OCELOT SPAWN EGG","OCELOT_SPAWN_EGG"],["OCHRE FROGLIGHT","OCHRE_FROGLIGHT"],["OMINOUS BOTTLE","OMINOUS_BOTTLE"],["OMINOUS TRIAL KEY","OMINOUS_TRIAL_KEY"],["OPEN EYEBLOSSOM","OPEN_EYEBLOSSOM"],["ORANGE BUNDLE","ORANGE_BUNDLE"],["ORANGE CANDLE CAKE","ORANGE_CANDLE_CAKE"],["ORANGE DYE","ORANGE_DYE"],["ORANGE TULIP","ORANGE_TULIP"],["OXEYE DAISY","OXEYE_DAISY"],["OXIDIZED CHISELED COPPER","OXIDIZED_CHISELED_COPPER"],["OXIDIZED COPPER","OXIDIZED_COPPER"],["OXIDIZED COPPER BULB","OXIDIZED_COPPER_BULB"],["OXIDIZED COPPER GRATE","OXIDIZED_COPPER_GRATE"],["OXIDIZED CUT COPPER","OXIDIZED_CUT_COPPER"],["PACKED MUD","PACKED_MUD"],["PAINTING","PAINTING"],["PALE HANGING MOSS","PALE_HANGING_MOSS"],["PALE MOSS BLOCK","PALE_MOSS_BLOCK"],["PALE MOSS CARPET","PALE_MOSS_CARPET"],["PALE OAK BOAT","PALE_OAK_BOAT"],["PALE OAK BUTTON","PALE_OAK_BUTTON"],["PALE OAK CHEST BOAT","PALE_OAK_CHEST_BOAT"],["PALE OAK HANGING SIGN","PALE_OAK_HANGING_SIGN"],["PALE OAK LEAVES","PALE_OAK_LEAVES"],["PALE OAK LOG","PALE_OAK_LOG"],["PALE OAK PLANKS","PALE_OAK_PLANKS"],["PALE OAK PRESSURE PLATE","PALE_OAK_PRESSURE_PLATE"],["PALE OAK SAPLING","PALE_OAK_SAPLING"],["PALE OAK SIGN","PALE_OAK_SIGN"],["PALE OAK WALL HANGING SIGN","PALE_OAK_WALL_HANGING_SIGN"],["PALE OAK WALL SIGN","PALE_OAK_WALL_SIGN"],["PALE OAK WOOD","PALE_OAK_WOOD"],["PANDA SPAWN EGG","PANDA_SPAWN_EGG"],["PAPER","PAPER"],["PARROT SPAWN EGG","PARROT_SPAWN_EGG"],["PEARLESCENT FROGLIGHT","PEARLESCENT_FROGLIGHT"],["PEONY","PEONY"],["PHANTOM MEMBRANE","PHANTOM_MEMBRANE"],["PHANTOM SPAWN EGG","PHANTOM_SPAWN_EGG"],["PIGLIN BANNER PATTERN","PIGLIN_BANNER_PATTERN"],["PIGLIN BRUTE SPAWN EGG","PIGLIN_BRUTE_SPAWN_EGG"],["PIGLIN HEAD","PIGLIN_HEAD"],["PIGLIN SPAWN EGG","PIGLIN_SPAWN_EGG"],["PIGLIN WALL HEAD","PIGLIN_WALL_HEAD"],["PIG SPAWN EGG","PIG_SPAWN_EGG"],["PILLAGER SPAWN EGG","PILLAGER_SPAWN_EGG"],["PINK BUNDLE","PINK_BUNDLE"],["PINK CANDLE CAKE","PINK_CANDLE_CAKE"],["PINK DYE","PINK_DYE"],["PINK PETALS","PINK_PETALS"],["PINK TULIP","PINK_TULIP"],["PISTON HEAD","PISTON_HEAD"],["PITCHER CROP","PITCHER_CROP"],["PITCHER PLANT","PITCHER_PLANT"],["PITCHER POD","PITCHER_POD"],["PLAYER HEAD","PLAYER_HEAD"],["PLAYER WALL HEAD","PLAYER_WALL_HEAD"],["PLENTY POTTERY SHERD","PLENTY_POTTERY_SHERD"],["POINTED DRIPSTONE","POINTED_DRIPSTONE"],["POISONOUS POTATO","POISONOUS_POTATO"],["POLAR BEAR SPAWN EGG","POLAR_BEAR_SPAWN_EGG"],["POLISHED ANDESITE","POLISHED_ANDESITE"],["POLISHED BASALT","POLISHED_BASALT"],["POLISHED BLACKSTONE","POLISHED_BLACKSTONE"],["POLISHED BLACKSTONE BUTTON","POLISHED_BLACKSTONE_BUTTON"],["POLISHED BLACKSTONE PRESSURE PLATE","POLISHED_BLACKSTONE_PRESSURE_PLATE"],["POLISHED DEEPSLATE","POLISHED_DEEPSLATE"],["POLISHED DIORITE","POLISHED_DIORITE"],["POLISHED GRANITE","POLISHED_GRANITE"],["POLISHED TUFF","POLISHED_TUFF"],["POPPED CHORUS FRUIT","POPPED_CHORUS_FRUIT"],["POPPY","POPPY"],["PORKCHOP","PORKCHOP"],["POTATO","POTATO"],["POTATOES","POTATOES"],["POTION","POTION"],["POTTED ACACIA SAPLING","POTTED_ACACIA_SAPLING"],["POTTED ALLIUM","POTTED_ALLIUM"],["POTTED AZALEA BUSH","POTTED_AZALEA_BUSH"],["POTTED AZURE BLUET","POTTED_AZURE_BLUET"],["POTTED BAMBOO","POTTED_BAMBOO"],["POTTED BIRCH SAPLING","POTTED_BIRCH_SAPLING"],["POTTED BLUE ORCHID","POTTED_BLUE_ORCHID"],["POTTED BROWN MUSHROOM","POTTED_BROWN_MUSHROOM"],["POTTED CACTUS","POTTED_CACTUS"],["POTTED CHERRY SAPLING","POTTED_CHERRY_SAPLING"],["POTTED CLOSED EYEBLOSSOM","POTTED_CLOSED_EYEBLOSSOM"],["POTTED CORNFLOWER","POTTED_CORNFLOWER"],["POTTED CRIMSON FUNGUS","POTTED_CRIMSON_FUNGUS"],["POTTED CRIMSON ROOTS","POTTED_CRIMSON_ROOTS"],["POTTED DANDELION","POTTED_DANDELION"],["POTTED DARK OAK SAPLING","POTTED_DARK_OAK_SAPLING"],["POTTED DEAD BUSH","POTTED_DEAD_BUSH"],["POTTED FERN","POTTED_FERN"],["POTTED FLOWERING AZALEA BUSH","POTTED_FLOWERING_AZALEA_BUSH"],["POTTED JUNGLE SAPLING","POTTED_JUNGLE_SAPLING"],["POTTED LILY OF THE VALLEY","POTTED_LILY_OF_THE_VALLEY"],["POTTED MANGROVE PROPAGULE","POTTED_MANGROVE_PROPAGULE"],["POTTED OAK SAPLING","POTTED_OAK_SAPLING"],["POTTED OPEN EYEBLOSSOM","POTTED_OPEN_EYEBLOSSOM"],["POTTED ORANGE TULIP","POTTED_ORANGE_TULIP"],["POTTED OXEYE DAISY","POTTED_OXEYE_DAISY"],["POTTED PALE OAK SAPLING","POTTED_PALE_OAK_SAPLING"],["POTTED PINK TULIP","POTTED_PINK_TULIP"],["POTTED POPPY","POTTED_POPPY"],["POTTED RED MUSHROOM","POTTED_RED_MUSHROOM"],["POTTED RED TULIP","POTTED_RED_TULIP"],["POTTED SPRUCE SAPLING","POTTED_SPRUCE_SAPLING"],["POTTED TORCHFLOWER","POTTED_TORCHFLOWER"],["POTTED WARPED FUNGUS","POTTED_WARPED_FUNGUS"],["POTTED WARPED ROOTS","POTTED_WARPED_ROOTS"],["POTTED WHITE TULIP","POTTED_WHITE_TULIP"],["POTTED WITHER ROSE","POTTED_WITHER_ROSE"],["POWDER SNOW","POWDER_SNOW"],["POWDER SNOW BUCKET","POWDER_SNOW_BUCKET"],["POWDER SNOW CAULDRON","POWDER_SNOW_CAULDRON"],["PRISMARINE","PRISMARINE"],["PRISMARINE BRICKS","PRISMARINE_BRICKS"],["PRISMARINE CRYSTALS","PRISMARINE_CRYSTALS"],["PRISMARINE SHARD","PRISMARINE_SHARD"],["PRIZE POTTERY SHERD","PRIZE_POTTERY_SHERD"],["PUFFERFISH","PUFFERFISH"],["PUFFERFISH BUCKET","PUFFERFISH_BUCKET"],["PUFFERFISH SPAWN EGG","PUFFERFISH_SPAWN_EGG"],["PUMPKIN","PUMPKIN"],["PUMPKIN PIE","PUMPKIN_PIE"],["PUMPKIN SEEDS","PUMPKIN_SEEDS"],["PUMPKIN STEM","PUMPKIN_STEM"],["PURPLE BUNDLE","PURPLE_BUNDLE"],["PURPLE CANDLE CAKE","PURPLE_CANDLE_CAKE"],["PURPLE DYE","PURPLE_DYE"],["PURPUR BLOCK","PURPUR_BLOCK"],["PURPUR PILLAR","PURPUR_PILLAR"],["QUARTZ","QUARTZ"],["QUARTZ BLOCK","QUARTZ_BLOCK"],["QUARTZ PILLAR","QUARTZ_PILLAR"],["RABBIT","RABBIT"],["RABBIT FOOT","RABBIT_FOOT"],["RABBIT HIDE","RABBIT_HIDE"],["RABBIT SPAWN EGG","RABBIT_SPAWN_EGG"],["RABBIT STEW","RABBIT_STEW"],["RAISER ARMOR TRIM SMITHING TEMPLATE","RAISER_ARMOR_TRIM_SMITHING_TEMPLATE"],["RAVAGER SPAWN EGG","RAVAGER_SPAWN_EGG"],["RAW COPPER","RAW_COPPER"],["RAW COPPER BLOCK","RAW_COPPER_BLOCK"],["RAW GOLD","RAW_GOLD"],["RAW GOLD BLOCK","RAW_GOLD_BLOCK"],["RAW IRON","RAW_IRON"],["RAW IRON BLOCK","RAW_IRON_BLOCK"],["RECOVERY COMPASS","RECOVERY_COMPASS"],["REDSTONE","REDSTONE"],["REDSTONE WALL TORCH","REDSTONE_WALL_TORCH"],["RED BUNDLE","RED_BUNDLE"],["RED CANDLE CAKE","RED_CANDLE_CAKE"],["RED DYE","RED_DYE"],["RED MUSHROOM","RED_MUSHROOM"],["RED MUSHROOM BLOCK","RED_MUSHROOM_BLOCK"],["RED SANDSTONE","RED_SANDSTONE"],["RED TULIP","RED_TULIP"],["REINFORCED DEEPSLATE","REINFORCED_DEEPSLATE"],["REPEATING COMMAND BLOCK","REPEATING_COMMAND_BLOCK"],["RESIN BLOCK","RESIN_BLOCK"],["RESIN BRICK","RESIN_BRICK"],["RESIN BRICKS","RESIN_BRICKS"],["RESIN CLUMP","RESIN_CLUMP"],["RESPAWN ANCHOR","RESPAWN_ANCHOR"],["RIB ARMOR TRIM SMITHING TEMPLATE","RIB_ARMOR_TRIM_SMITHING_TEMPLATE"],["ROSE BUSH","ROSE_BUSH"],["ROTTEN FLESH","ROTTEN_FLESH"],["SADDLE","SADDLE"],["SALMON","SALMON"],["SALMON BUCKET","SALMON_BUCKET"],["SALMON SPAWN EGG","SALMON_SPAWN_EGG"],["SANDSTONE","SANDSTONE"],["SCAFFOLDING","SCAFFOLDING"],["SCRAPE POTTERY SHERD","SCRAPE_POTTERY_SHERD"],["SCULK","SCULK"],["SCULK CATALYST","SCULK_CATALYST"],["SCULK SENSOR","SCULK_SENSOR"],["SCULK SHRIEKER","SCULK_SHRIEKER"],["SCULK VEIN","SCULK_VEIN"],["SEAGRASS","SEAGRASS"],["SEA LANTERN","SEA_LANTERN"],["SEA PICKLE","SEA_PICKLE"],["SENTRY ARMOR TRIM SMITHING TEMPLATE","SENTRY_ARMOR_TRIM_SMITHING_TEMPLATE"],["SHAPER ARMOR TRIM SMITHING TEMPLATE","SHAPER_ARMOR_TRIM_SMITHING_TEMPLATE"],["SHEAF POTTERY SHERD","SHEAF_POTTERY_SHERD"],["SHEARS","SHEARS"],["SHEEP SPAWN EGG","SHEEP_SPAWN_EGG"],["SHELTER POTTERY SHERD","SHELTER_POTTERY_SHERD"],["SHIELD","SHIELD"],["SHORT DRY GRASS","SHORT_DRY_GRASS"],["SHORT GRASS","SHORT_GRASS"],["SHROOMLIGHT","SHROOMLIGHT"],["SHULKER BOX","SHULKER_BOX"],["SHULKER SHELL","SHULKER_SHELL"],["SHULKER SPAWN EGG","SHULKER_SPAWN_EGG"],["SILENCE ARMOR TRIM SMITHING TEMPLATE","SILENCE_ARMOR_TRIM_SMITHING_TEMPLATE"],["SILVERFISH SPAWN EGG","SILVERFISH_SPAWN_EGG"],["SKELETON HORSE SPAWN EGG","SKELETON_HORSE_SPAWN_EGG"],["SKELETON SKULL","SKELETON_SKULL"],["SKELETON SPAWN EGG","SKELETON_SPAWN_EGG"],["SKELETON WALL SKULL","SKELETON_WALL_SKULL"],["SKULL BANNER PATTERN","SKULL_BANNER_PATTERN"],["SKULL POTTERY SHERD","SKULL_POTTERY_SHERD"],["SLIME BALL","SLIME_BALL"],["SLIME SPAWN EGG","SLIME_SPAWN_EGG"],["SMALL AMETHYST BUD","SMALL_AMETHYST_BUD"],["SMALL DRIPLEAF","SMALL_DRIPLEAF"],["SMITHING TABLE","SMITHING_TABLE"],["SMOKER","SMOKER"],["SMOOTH BASALT","SMOOTH_BASALT"],["SMOOTH QUARTZ","SMOOTH_QUARTZ"],["SMOOTH RED SANDSTONE","SMOOTH_RED_SANDSTONE"],["SMOOTH SANDSTONE","SMOOTH_SANDSTONE"],["SMOOTH STONE","SMOOTH_STONE"],["SNIFFER EGG","SNIFFER_EGG"],["SNIFFER SPAWN EGG","SNIFFER_SPAWN_EGG"],["SNORT POTTERY SHERD","SNORT_POTTERY_SHERD"],["SNOUT ARMOR TRIM SMITHING TEMPLATE","SNOUT_ARMOR_TRIM_SMITHING_TEMPLATE"],["SNOWBALL","SNOWBALL"],["SNOW GOLEM SPAWN EGG","SNOW_GOLEM_SPAWN_EGG"],["SOUL CAMPFIRE","SOUL_CAMPFIRE"],["SOUL FIRE","SOUL_FIRE"],["SOUL LANTERN","SOUL_LANTERN"],["SOUL SAND","SOUL_SAND"],["SOUL SOIL","SOUL_SOIL"],["SOUL TORCH","SOUL_TORCH"],["SOUL WALL TORCH","SOUL_WALL_TORCH"],["SPAWNER","SPAWNER"],["SPECTRAL ARROW","SPECTRAL_ARROW"],["SPIDER EYE","SPIDER_EYE"],["SPIDER SPAWN EGG","SPIDER_SPAWN_EGG"],["SPIRE ARMOR TRIM SMITHING TEMPLATE","SPIRE_ARMOR_TRIM_SMITHING_TEMPLATE"],["SPLASH POTION","SPLASH_POTION"],["SPONGE","SPONGE"],["SPORE BLOSSOM","SPORE_BLOSSOM"],["SPRUCE BOAT","SPRUCE_BOAT"],["SPRUCE BUTTON","SPRUCE_BUTTON"],["SPRUCE CHEST BOAT","SPRUCE_CHEST_BOAT"],["SPRUCE HANGING SIGN","SPRUCE_HANGING_SIGN"],["SPRUCE LEAVES","SPRUCE_LEAVES"],["SPRUCE PRESSURE PLATE","SPRUCE_PRESSURE_PLATE"],["SPRUCE SAPLING","SPRUCE_SAPLING"],["SPRUCE SIGN","SPRUCE_SIGN"],["SPRUCE WALL HANGING SIGN","SPRUCE_WALL_HANGING_SIGN"],["SPRUCE WALL SIGN","SPRUCE_WALL_SIGN"],["SPYGLASS","SPYGLASS"],["SQUID SPAWN EGG","SQUID_SPAWN_EGG"],["STICK","STICK"],["STONECUTTER","STONECUTTER"],["STONE AXE","STONE_AXE"],["STONE BUTTON","STONE_BUTTON"],["STONE HOE","STONE_HOE"],["STONE PICKAXE","STONE_PICKAXE"],["STONE PRESSURE PLATE","STONE_PRESSURE_PLATE"],["STONE SHOVEL","STONE_SHOVEL"],["STONE SWORD","STONE_SWORD"],["STRAY SPAWN EGG","STRAY_SPAWN_EGG"],["STRIDER SPAWN EGG","STRIDER_SPAWN_EGG"],["STRING","STRING"],["STRIPPED PALE OAK LOG","STRIPPED_PALE_OAK_LOG"],["STRIPPED PALE OAK WOOD","STRIPPED_PALE_OAK_WOOD"],["STRUCTURE BLOCK","STRUCTURE_BLOCK"],["STRUCTURE VOID","STRUCTURE_VOID"],["SUGAR","SUGAR"],["SUGAR CANE","SUGAR_CANE"],["SUNFLOWER","SUNFLOWER"],["SUSPICIOUS GRAVEL","SUSPICIOUS_GRAVEL"],["SUSPICIOUS SAND","SUSPICIOUS_SAND"],["SUSPICIOUS STEW","SUSPICIOUS_STEW"],["SWEET BERRIES","SWEET_BERRIES"],["SWEET BERRY BUSH","SWEET_BERRY_BUSH"],["TADPOLE BUCKET","TADPOLE_BUCKET"],["TADPOLE SPAWN EGG","TADPOLE_SPAWN_EGG"],["TALL DRY GRASS","TALL_DRY_GRASS"],["TALL GRASS","TALL_GRASS"],["TALL SEAGRASS","TALL_SEAGRASS"],["TERRACOTTA","TERRACOTTA"],["TEST BLOCK","TEST_BLOCK"],["TEST INSTANCE BLOCK","TEST_INSTANCE_BLOCK"],["TIDE ARMOR TRIM SMITHING TEMPLATE","TIDE_ARMOR_TRIM_SMITHING_TEMPLATE"],["TIPPED ARROW","TIPPED_ARROW"],["TNT","TNT"],["TNT MINECART","TNT_MINECART"],["TORCH","TORCH"],["TORCHFLOWER","TORCHFLOWER"],["TORCHFLOWER CROP","TORCHFLOWER_CROP"],["TORCHFLOWER SEEDS","TORCHFLOWER_SEEDS"],["TOTEM OF UNDYING","TOTEM_OF_UNDYING"],["TRADER LLAMA SPAWN EGG","TRADER_LLAMA_SPAWN_EGG"],["TRAPPED CHEST","TRAPPED_CHEST"],["TRIAL KEY","TRIAL_KEY"],["TRIAL SPAWNER","TRIAL_SPAWNER"],["TRIDENT","TRIDENT"],["TRIPWIRE","TRIPWIRE"],["TROPICAL FISH","TROPICAL_FISH"],["TROPICAL FISH BUCKET","TROPICAL_FISH_BUCKET"],["TROPICAL FISH SPAWN EGG","TROPICAL_FISH_SPAWN_EGG"],["TUBE CORAL","TUBE_CORAL"],["TUBE CORAL BLOCK","TUBE_CORAL_BLOCK"],["TUBE CORAL FAN","TUBE_CORAL_FAN"],["TUBE CORAL WALL FAN","TUBE_CORAL_WALL_FAN"],["TUFF BRICKS","TUFF_BRICKS"],["TURTLE EGG","TURTLE_EGG"],["TURTLE HELMET","TURTLE_HELMET"],["TURTLE SCUTE","TURTLE_SCUTE"],["TURTLE SPAWN EGG","TURTLE_SPAWN_EGG"],["TWISTING VINES","TWISTING_VINES"],["TWISTING VINES PLANT","TWISTING_VINES_PLANT"],["VAULT","VAULT"],["VERDANT FROGLIGHT","VERDANT_FROGLIGHT"],["VEX ARMOR TRIM SMITHING TEMPLATE","VEX_ARMOR_TRIM_SMITHING_TEMPLATE"],["VEX SPAWN EGG","VEX_SPAWN_EGG"],["VILLAGER SPAWN EGG","VILLAGER_SPAWN_EGG"],["VINDICATOR SPAWN EGG","VINDICATOR_SPAWN_EGG"],["VINE","VINE"],["VOID AIR","VOID_AIR"],["WALL TORCH","WALL_TORCH"],["WANDERING TRADER SPAWN EGG","WANDERING_TRADER_SPAWN_EGG"],["WARDEN SPAWN EGG","WARDEN_SPAWN_EGG"],["WARD ARMOR TRIM SMITHING TEMPLATE","WARD_ARMOR_TRIM_SMITHING_TEMPLATE"],["WARPED BUTTON","WARPED_BUTTON"],["WARPED FUNGUS","WARPED_FUNGUS"],["WARPED FUNGUS ON A STICK","WARPED_FUNGUS_ON_A_STICK"],["WARPED HANGING SIGN","WARPED_HANGING_SIGN"],["WARPED NYLIUM","WARPED_NYLIUM"],["WARPED PRESSURE PLATE","WARPED_PRESSURE_PLATE"],["WARPED ROOTS","WARPED_ROOTS"],["WARPED SIGN","WARPED_SIGN"],["WARPED WALL HANGING SIGN","WARPED_WALL_HANGING_SIGN"],["WARPED WALL SIGN","WARPED_WALL_SIGN"],["WARPED WART BLOCK","WARPED_WART_BLOCK"],["WATER BUCKET","WATER_BUCKET"],["WATER CAULDRON","WATER_CAULDRON"],["WAXED CHISELED COPPER","WAXED_CHISELED_COPPER"],["WAXED COPPER BLOCK","WAXED_COPPER_BLOCK"],["WAXED COPPER BULB","WAXED_COPPER_BULB"],["WAXED COPPER GRATE","WAXED_COPPER_GRATE"],["WAXED CUT COPPER","WAXED_CUT_COPPER"],["WAXED EXPOSED CHISELED COPPER","WAXED_EXPOSED_CHISELED_COPPER"],["WAXED EXPOSED COPPER","WAXED_EXPOSED_COPPER"],["WAXED EXPOSED COPPER BULB","WAXED_EXPOSED_COPPER_BULB"],["WAXED EXPOSED COPPER GRATE","WAXED_EXPOSED_COPPER_GRATE"],["WAXED EXPOSED CUT COPPER","WAXED_EXPOSED_CUT_COPPER"],["WAXED OXIDIZED CHISELED COPPER","WAXED_OXIDIZED_CHISELED_COPPER"],["WAXED OXIDIZED COPPER","WAXED_OXIDIZED_COPPER"],["WAXED OXIDIZED COPPER BULB","WAXED_OXIDIZED_COPPER_BULB"],["WAXED OXIDIZED COPPER GRATE","WAXED_OXIDIZED_COPPER_GRATE"],["WAXED OXIDIZED CUT COPPER","WAXED_OXIDIZED_CUT_COPPER"],["WAXED WEATHERED CHISELED COPPER","WAXED_WEATHERED_CHISELED_COPPER"],["WAXED WEATHERED COPPER","WAXED_WEATHERED_COPPER"],["WAXED WEATHERED COPPER BULB","WAXED_WEATHERED_COPPER_BULB"],["WAXED WEATHERED COPPER GRATE","WAXED_WEATHERED_COPPER_GRATE"],["WAXED WEATHERED CUT COPPER","WAXED_WEATHERED_CUT_COPPER"],["WAYFINDER ARMOR TRIM SMITHING TEMPLATE","WAYFINDER_ARMOR_TRIM_SMITHING_TEMPLATE"],["WEATHERED CHISELED COPPER","WEATHERED_CHISELED_COPPER"],["WEATHERED COPPER","WEATHERED_COPPER"],["WEATHERED COPPER BULB","WEATHERED_COPPER_BULB"],["WEATHERED COPPER GRATE","WEATHERED_COPPER_GRATE"],["WEATHERED CUT COPPER","WEATHERED_CUT_COPPER"],["WEEPING VINES","WEEPING_VINES"],["WEEPING VINES PLANT","WEEPING_VINES_PLANT"],["WET SPONGE","WET_SPONGE"],["WHEAT","WHEAT"],["WHEAT SEEDS","WHEAT_SEEDS"],["WHITE BUNDLE","WHITE_BUNDLE"],["WHITE CANDLE CAKE","WHITE_CANDLE_CAKE"],["WHITE DYE","WHITE_DYE"],["WHITE TULIP","WHITE_TULIP"],["WILDFLOWERS","WILDFLOWERS"],["WILD ARMOR TRIM SMITHING TEMPLATE","WILD_ARMOR_TRIM_SMITHING_TEMPLATE"],["WIND CHARGE","WIND_CHARGE"],["WITCH SPAWN EGG","WITCH_SPAWN_EGG"],["WITHER ROSE","WITHER_ROSE"],["WITHER SKELETON SKULL","WITHER_SKELETON_SKULL"],["WITHER SKELETON SPAWN EGG","WITHER_SKELETON_SPAWN_EGG"],["WITHER SKELETON WALL SKULL","WITHER_SKELETON_WALL_SKULL"],["WITHER SPAWN EGG","WITHER_SPAWN_EGG"],["WOLF ARMOR","WOLF_ARMOR"],["WOLF SPAWN EGG","WOLF_SPAWN_EGG"],["WOODEN AXE","WOODEN_AXE"],["WOODEN HOE","WOODEN_HOE"],["WOODEN PICKAXE","WOODEN_PICKAXE"],["WOODEN SHOVEL","WOODEN_SHOVEL"],["WOODEN SWORD","WOODEN_SWORD"],["WRITABLE BOOK","WRITABLE_BOOK"],["WRITTEN BOOK","WRITTEN_BOOK"],["YELLOW BUNDLE","YELLOW_BUNDLE"],["YELLOW CANDLE CAKE","YELLOW_CANDLE_CAKE"],["YELLOW DYE","YELLOW_DYE"],["ZOGLIN SPAWN EGG","ZOGLIN_SPAWN_EGG"],["ZOMBIE HEAD","ZOMBIE_HEAD"],["ZOMBIE HORSE SPAWN EGG","ZOMBIE_HORSE_SPAWN_EGG"],["ZOMBIE SPAWN EGG","ZOMBIE_SPAWN_EGG"],["ZOMBIE VILLAGER SPAWN EGG","ZOMBIE_VILLAGER_SPAWN_EGG"],["ZOMBIE WALL HEAD","ZOMBIE_WALL_HEAD"],["ZOMBIFIED PIGLIN SPAWN EGG","ZOMBIFIED_PIGLIN_SPAWN_EGG"]]),"MATERIAL_ID"),this.setOutput(!0,"Block"),this.setColour(200),this.setTooltip("Select a miscellaneous Minecraft block or item.")}},(d=T).Blocks.minecraft_picker_entity_hostile_mobs={init:function(){this.appendDummyInput().appendField("Hostile Mobs").appendField(new d.FieldDropdown([["BLAZE","BLAZE"],["CAVE SPIDER","CAVE_SPIDER"],["CREEPER","CREEPER"],["ELDER GUARDIAN","ELDER_GUARDIAN"],["ENDERMAN","ENDERMAN"],["ENDERMITE","ENDERMITE"],["EVOKER","EVOKER"],["GHAST","GHAST"],["GUARDIAN","GUARDIAN"],["HUSK","HUSK"],["ILLUSIONER","ILLUSIONER"],["MAGMA CUBE","MAGMA_CUBE"],["SHULKER","SHULKER"],["SILVERFISH","SILVERFISH"],["SKELETON","SKELETON"],["SLIME","SLIME"],["SPIDER","SPIDER"],["STRAY","STRAY"],["VEX","VEX"],["VINDICATOR","VINDICATOR"],["WITCH","WITCH"],["WITHER","WITHER"],["WITHER SKELETON","WITHER_SKELETON"],["ZOMBIE","ZOMBIE"],["ZOMBIE VILLAGER","ZOMBIE_VILLAGER"],["ZOMBIFIED PIGLIN","ZOMBIFIED_PIGLIN"]]),"ENTITY_ID"),this.setOutput(!0,"Entity"),this.setColour(260),this.setTooltip("Select a Hostile Mobs.")}},d.Blocks.minecraft_picker_entity_minecarts={init:function(){this.appendDummyInput().appendField("Minecarts").appendField(new d.FieldDropdown([["MINECART","MINECART"],["CHEST MINECART","CHEST_MINECART"],["COMMAND BLOCK MINECART","COMMAND_BLOCK_MINECART"],["FURNACE MINECART","FURNACE_MINECART"],["HOPPER MINECART","HOPPER_MINECART"],["SPAWNER MINECART","SPAWNER_MINECART"],["TNT MINECART","TNT_MINECART"]]),"ENTITY_ID"),this.setOutput(!0,"Entity"),this.setColour(260),this.setTooltip("Select a Minecarts.")}},d.Blocks.minecraft_picker_entity_miscellaneous_entities={init:function(){this.appendDummyInput().appendField("Miscellaneous Entities").appendField(new d.FieldDropdown([["ENDER DRAGON","ENDER_DRAGON"],["EVOKER FANGS","EVOKER_FANGS"],["GIANT","GIANT"],["IRON GOLEM","IRON_GOLEM"],["LLAMA","LLAMA"],["SKELETON HORSE","SKELETON_HORSE"],["SNOW GOLEM","SNOW_GOLEM"],["TNT","TNT"],["ZOMBIE HORSE","ZOMBIE_HORSE"]]),"ENTITY_ID"),this.setOutput(!0,"Entity"),this.setColour(260),this.setTooltip("Select a Miscellaneous Entities.")}},d.Blocks.minecraft_picker_entity_passive_mobs={init:function(){this.appendDummyInput().appendField("Passive Mobs").appendField(new d.FieldDropdown([["BAT","BAT"],["CHICKEN","CHICKEN"],["COW","COW"],["DONKEY","DONKEY"],["HORSE","HORSE"],["MOOSHROOM","MOOSHROOM"],["MULE","MULE"],["OCELOT","OCELOT"],["PARROT","PARROT"],["PIG","PIG"],["POLAR BEAR","POLAR_BEAR"],["RABBIT","RABBIT"],["SHEEP","SHEEP"],["SQUID","SQUID"],["VILLAGER","VILLAGER"],["WOLF","WOLF"]]),"ENTITY_ID"),this.setOutput(!0,"Entity"),this.setColour(260),this.setTooltip("Select a Passive Mobs.")}},d.Blocks.minecraft_picker_entity_projectiles={init:function(){this.appendDummyInput().appendField("Projectiles").appendField(new d.FieldDropdown([["ARROW","ARROW"],["DRAGON FIREBALL","DRAGON_FIREBALL"],["EGG","EGG"],["ENDER PEARL","ENDER_PEARL"],["EXPERIENCE BOTTLE","EXPERIENCE_BOTTLE"],["FIREBALL","FIREBALL"],["FIREWORK ROCKET","FIREWORK_ROCKET"],["LLAMA SPIT","LLAMA_SPIT"],["SHULKER BULLET","SHULKER_BULLET"],["SMALL FIREBALL","SMALL_FIREBALL"],["SNOWBALL","SNOWBALL"],["SPECTRAL ARROW","SPECTRAL_ARROW"],["SPLASH POTION","SPLASH_POTION"],["WITHER SKULL","WITHER_SKULL"]]),"ENTITY_ID"),this.setOutput(!0,"Entity"),this.setColour(260),this.setTooltip("Select a Projectiles.")}},d.Blocks.minecraft_picker_entity_utility_and_special={init:function(){this.appendDummyInput().appendField("Utility And Special").appendField(new d.FieldDropdown([["AREA EFFECT CLOUD","AREA_EFFECT_CLOUD"],["ARMOR STAND","ARMOR_STAND"],["END CRYSTAL","END_CRYSTAL"],["EXPERIENCE ORB","EXPERIENCE_ORB"],["EYE OF ENDER","EYE_OF_ENDER"],["FALLING BLOCK","FALLING_BLOCK"],["ITEM","ITEM"],["ITEM FRAME","ITEM_FRAME"],["LEASH KNOT","LEASH_KNOT"],["PAINTING","PAINTING"]]),"ENTITY_ID"),this.setOutput(!0,"Entity"),this.setColour(260),this.setTooltip("Select a Utility And Special.")}},function(t){t.INDENT="    ";let i=t.init;t.init=function(e){i.call(this,e),this.methods_=Object.create(null)},t.finish=function(e){let i=Object.values(t.methods_||{}),s=t.INDENT,o=i.length>0?"\n"+i.map(e=>t.prefixLines(e,s)).join("\n\n"):"",n=s+s,r=t.prefixLines(e,n)||n+"pass",l=new Date().toISOString();return`
    from mcshell.constants import *

# Generated by Blockly MC-ED on ${l}

class BlocklyProgramRunner:
    def __init__(self, action_implementer_instance, cancel_event=None, runtime_params={}):
        self.action_implementer = action_implementer_instance
        self.cancel_event = cancel_event
        self.runtime_params = runtime_params
${o}

    def run_program(self):
        if self.cancel_event and self.cancel_event.is_set(): return
${r}
`.trim()+"\n"};let s="if self.cancel_event and self.cancel_event.is_set(): break\n",o="if self.cancel_event and self.cancel_event.is_set(): return\n";t.forBlock.controls_repeat_ext=function(t,i){let o=i.valueToCode(t,"TIMES",i.ORDER_NONE)||"0",n=i.statementToCode(t,"DO"),r=i.nameDB_.getDistinctName("count",e.BlocklyNameTypes.VARIABLE);return`for ${r} in range(int(${o})):
${i.prefixLines(s,i.INDENT)}${n}`},t.forBlock.controls_whileUntil=function(e,t){let i="UNTIL"===e.getFieldValue("MODE");var o=t.valueToCode(e,"BOOL",i?t.ORDER_LOGICAL_NOT:t.ORDER_NONE)||"False";let n=t.statementToCode(e,"DO");return n=`${t.prefixLines(s,t.INDENT)}${n}`,i&&(o="not "+o),"while "+o+":\n"+n},t.forBlock.controls_for=function(t,i){let o=i.nameDB_.getDistinctName(t.getFieldValue("VAR"),e.BlocklyNameTypes.VARIABLE),n=i.valueToCode(t,"FROM",i.ORDER_NONE)||"0",r=i.valueToCode(t,"TO",i.ORDER_NONE)||"0",l=i.valueToCode(t,"BY",i.ORDER_NONE)||"1",a=i.statementToCode(t,"DO");return a=`${i.prefixLines(s,i.INDENT)}${a}`,`for ${o} in range(${n}, ${r} + 1, ${l}):
${a}`},t.forBlock.controls_forEach=function(t,i){let o=i.nameDB_.getDistinctName(t.getFieldValue("VAR"),e.BlocklyNameTypes.VARIABLE),n=i.valueToCode(t,"LIST",i.ORDER_NONE)||"[]",r=i.statementToCode(t,"DO");return r=`${i.prefixLines(s,i.INDENT)}${r}`,`for ${o} in ${n}:
${r}`},t.forBlock.procedures_defnoreturn=function(t,i){let s=i.nameDB_.getName(t.getFieldValue("NAME"),e.BlocklyNameTypes.PROCEDURE),n=i.statementToCode(t,"STACK")||i.INDENT+"pass\n";n=`${i.prefixLines(o,i.INDENT)}${n}`;let r=t.getVars().map(t=>i.nameDB_.getName(t,e.BlocklyNameTypes.VARIABLE)),l=`def ${s}(self, ${r.join(", ")}):
${n}`;return i.methods_||(i.methods_={}),i.methods_["%"+s]=l,null},t.forBlock.procedures_defreturn=function(t,i){let s=i.nameDB_.getName(t.getFieldValue("NAME"),e.BlocklyNameTypes.PROCEDURE),n=i.statementToCode(t,"STACK"),r=i.valueToCode(t,"RETURN",i.ORDER_NONE)||"None";n=(n||"")+(i.INDENT+"return "+r)+"\n",n=`${i.prefixLines(o,i.INDENT)}${n}`;let l=t.getVars().map(t=>i.nameDB_.getName(t,e.BlocklyNameTypes.VARIABLE)),a=`def ${s}(self, ${l.join(", ")}):
${n}`;return i.methods_||(i.methods_={}),i.methods_["%"+s]=a,null},t.forBlock.procedures_callnoreturn=function(t,i){let s=i.nameDB_.getName(t.getFieldValue("NAME"),e.BlocklyNameTypes.PROCEDURE),o=t.getVars(),n=[];for(let s=0;s<o.length;s++){let r,l=i.nameDB_.getName(o[s],e.BlocklyNameTypes.VARIABLE);r=t.getInputTargetBlock("ARG"+s)?i.valueToCode(t,"ARG"+s,i.ORDER_NONE)||"None":`self.runtime_params.get('${l}', None)`,n.push(`${l}=${r}`)}return"self."+s+"("+n.join(", ")+")\n"},t.forBlock.procedures_callreturn=function(t,i){let s=i.nameDB_.getName(t.getFieldValue("NAME"),e.BlocklyNameTypes.PROCEDURE),o=t.getVars(),n=[];for(let s=0;s<o.length;s++){let r=i.nameDB_.getName(o[s],e.BlocklyNameTypes.VARIABLE),l=t.getInputTargetBlock("ARG"+s)?i.valueToCode(t,"ARG"+s,i.ORDER_NONE)||"None":`self.runtime_params.get('${r}', None)`;n.push(`${r}=${l}`)}return["self."+s+"("+n.join(", ")+")",i.ORDER_FUNCTION_CALL]},t.forBlock.procedures_ifreturn=function(e,t){let i="if "+(t.valueToCode(e,"CONDITION",t.ORDER_NONE)||"False")+":\n";if(e.hasReturnValue_){let s=t.valueToCode(e,"VALUE",t.ORDER_NONE)||"None";i+=t.INDENT+"return "+s+"\n"}else i+=t.INDENT+"return\n";return i},t.forBlock.minecraft_matrix_3d_elements=function(e,t){let i=t.valueToCode(e,"R00",t.ORDER_ATOMIC)||"1.0",s=t.valueToCode(e,"R01",t.ORDER_ATOMIC)||"0.0",o=t.valueToCode(e,"R02",t.ORDER_ATOMIC)||"0.0",n=t.valueToCode(e,"R10",t.ORDER_ATOMIC)||"0.0",r=t.valueToCode(e,"R11",t.ORDER_ATOMIC)||"1.0",l=t.valueToCode(e,"R12",t.ORDER_ATOMIC)||"0.0",a=t.valueToCode(e,"R20",t.ORDER_ATOMIC)||"0.0",c=t.valueToCode(e,"R21",t.ORDER_ATOMIC)||"0.0",h=t.valueToCode(e,"R22",t.ORDER_ATOMIC)||"1.0";return[`Matrix3([[${i}, ${s}, ${o}], [${n}, ${r}, ${l}], [${a}, ${c}, ${h}]])`,t.ORDER_FUNCTION_CALL]},t.forBlock.minecraft_matrix_3d_euler=function(e,t){let i=t.valueToCode(e,"YAW",t.ORDER_ATOMIC)||"0.0",s=t.valueToCode(e,"PITCH",t.ORDER_ATOMIC)||"0.0",o=t.valueToCode(e,"ROLL",t.ORDER_ATOMIC)||"0.0";return[`Matrix3.from_euler_angles(yaw_degrees=${i}, pitch_degrees=${s}, roll_degrees=${o})`,t.ORDER_FUNCTION_CALL]},t.forBlock.minecraft_vector_3d=function(e,t){let i=t.valueToCode(e,"X",t.ORDER_ATOMIC)||"0",s=t.valueToCode(e,"Y",t.ORDER_ATOMIC)||"0",o=t.valueToCode(e,"Z",t.ORDER_ATOMIC)||"0";return[`Vec3(${i}, ${s}, ${o})`,t.ORDER_FUNCTION_CALL]},t.forBlock.minecraft_vector_delta=function(e,t){let i=e.getFieldValue("X"),s=e.getFieldValue("Y"),o=e.getFieldValue("Z");return[`Vec3(${i},${s},${o})`,t.ORDER_ATOMIC]},t.forBlock.minecraft_position_get_direction=function(e,t){return["self.action_implementer.mcplayer.direction",t.ORDER_ATOMIC]},t.forBlock.minecraft_position_player=function(e,t){return["self.action_implementer.mcplayer.position",t.ORDER_ATOMIC]},t.forBlock.minecraft_position_here=function(e,t){return["self.action_implementer.mcplayer.here",t.ORDER_ATOMIC]},t.forBlock.minecraft_position_get_compass_direction=function(e,t){return["self.action_implementer.mcplayer.compass_direction",t.ORDER_FUNCTION_CALL]},t.forBlock.minecraft_vector_binary_op=function(e,t){let i,s={ADD:[" + ",t.ORDER_ADDITIVE],SUBTRACT:[" - ",t.ORDER_ADDITIVE],CROSS:[".cross(",t.ORDER_FUNCTION_CALL]},o=e.getFieldValue("OP"),n=s[o],r=n[0],l=n[1],a=t.valueToCode(e,"A",l)||"Vec3()",c=t.valueToCode(e,"B",l)||"Vec3()";return["CROSS"===o?`${a}${r}${c})`:`${a}${r}${c}`,l]},t.forBlock.minecraft_vector_scalar_multiply=function(e,t){let i=t.valueToCode(e,"A",t.ORDER_MULTIPLICATIVE)||"Vec3()",s=t.valueToCode(e,"B",t.ORDER_MULTIPLICATIVE)||"1";return[`${i} * ${s}`,t.ORDER_MULTIPLICATIVE]},t.forBlock.minecraft_vector_dot_product=function(e,t){let i=t.valueToCode(e,"A",t.ORDER_ATOMIC)||"Vec3()",s=t.valueToCode(e,"B",t.ORDER_ATOMIC)||"Vec3()";return[`${i}.dot(${s})`,t.ORDER_FUNCTION_CALL]},t.forBlock.minecraft_matrix_vector_multiply=function(e,t){let i=t.valueToCode(e,"A",t.ORDER_MULTIPLICATIVE)||"Matrix3.identity()",s=t.valueToCode(e,"B",t.ORDER_MULTIPLICATIVE)||"Vec3()";return[`${i} @ ${s}`,t.ORDER_MULTIPLICATIVE]},t.forBlock.minecraft_coloured_block_picker=function(e,t){let i=e.getFieldValue("MINECRAFT_COLOUR_ID");return[`'${i}'`,t.ORDER_ATOMIC]},t.forBlock.minecraft_action_create_digital_ball=function(e,t){let i=t.valueToCode(e,"CENTER",t.ORDER_ATOMIC)||"Vec3(0,0,0)",s=t.valueToCode(e,"RADIUS",t.ORDER_ATOMIC)||"5.0",o=t.valueToCode(e,"BLOCK_TYPE",t.ORDER_ATOMIC)||"'STONE'",n=t.valueToCode(e,"INNER_RADIUS",t.ORDER_ATOMIC)||"0.0";return`self.action_implementer.create_digital_ball(center_vec3=${i}, radius=${s}, block_type=${o}, inner_radius=${n})
`},t.forBlock.minecraft_action_create_digital_cube=function(e,t){let i=t.valueToCode(e,"CENTER",t.ORDER_ATOMIC)||"Vec3(0,0,0)",s=t.valueToCode(e,"SIDE_LENGTH",t.ORDER_ATOMIC)||"5.0",o=t.valueToCode(e,"ROTATION_MATRIX",t.ORDER_ATOMIC)||"Matrix3.identity()",n=t.valueToCode(e,"BLOCK_TYPE",t.ORDER_ATOMIC)||"'STONE'",r=t.valueToCode(e,"INNER_OFFSET_FACTOR",t.ORDER_ATOMIC)||"0.0";return`self.action_implementer.create_digital_cube(center_vec3=${i}, side_length=${s}, rotation_matrix3=${o}, block_type=${n}, inner_offset_factor=${r})
`},t.forBlock.minecraft_action_create_digital_plane=function(e,t){let i=t.valueToCode(e,"NORMAL",t.ORDER_ATOMIC)||"Vec3(0,1,0)",s=t.valueToCode(e,"POINT_ON_PLANE",t.ORDER_ATOMIC)||"Vec3(0,0,0)",o=t.valueToCode(e,"BLOCK_TYPE",t.ORDER_ATOMIC)||"'STONE'",n=t.valueToCode(e,"PLANE_THICKNESS",t.ORDER_ATOMIC)||"1.0",r=t.valueToCode(e,"OUTER_WIDTH",t.ORDER_ATOMIC)||"10",l=t.valueToCode(e,"OUTER_LENGTH",t.ORDER_ATOMIC)||"10";return`self.action_implementer.create_digital_plane(normal_vec3=${i}, point_on_plane_vec3=${s}, block_type=${o}, outer_width=${r}, outer_length=${l}, plane_thickness=${n})
`},t.forBlock.minecraft_action_create_digital_disc=function(e,t){let i=t.valueToCode(e,"NORMAL",t.ORDER_ATOMIC)||"Vec3(0,1,0)",s=t.valueToCode(e,"CENTER_POINT",t.ORDER_ATOMIC)||"Vec3(0,0,0)",o=t.valueToCode(e,"OUTER_RADIUS",t.ORDER_ATOMIC)||"10.0",n=t.valueToCode(e,"BLOCK_TYPE",t.ORDER_ATOMIC)||"'STONE'",r=t.valueToCode(e,"DISC_THICKNESS",t.ORDER_ATOMIC)||"1.0",l=t.valueToCode(e,"INNER_RADIUS",t.ORDER_ATOMIC)||"0.0";return`self.action_implementer.create_digital_disc(normal_vec3=${i}, center_point_vec3=${s}, outer_radius=${o}, block_type=${n}, disc_thickness=${r}, inner_radius=${l})
`},t.forBlock.minecraft_action_create_digital_tube=function(e,t){let i=t.valueToCode(e,"POINT1",t.ORDER_ATOMIC)||"Vec3(0,0,0)",s=t.valueToCode(e,"POINT2",t.ORDER_ATOMIC)||"Vec3(0,10,0)",o=t.valueToCode(e,"OUTER_THICKNESS",t.ORDER_ATOMIC)||"3.0",n=t.valueToCode(e,"BLOCK_TYPE",t.ORDER_ATOMIC)||"'STONE'",r=t.valueToCode(e,"INNER_THICKNESS",t.ORDER_ATOMIC)||"0.0";return`self.action_implementer.create_digital_tube(point1_vec3=${i}, point2_vec3=${s}, outer_thickness=${o}, block_type=${n}, inner_thickness=${r})
`},t.forBlock.minecraft_action_create_digital_line=function(e,t){let i=t.valueToCode(e,"POINT1",t.ORDER_ATOMIC)||"Vec3(0,0,0)",s=t.valueToCode(e,"POINT2",t.ORDER_ATOMIC)||"Vec3(10,10,10)",o=t.valueToCode(e,"BLOCK_TYPE",t.ORDER_ATOMIC)||"'STONE'";return`self.action_implementer.create_digital_line(point1_vec3=${i}, point2_vec3=${s}, block_type=${o})
`},t.forBlock.minecraft_action_spawn_entity=function(e,t){let i=t.valueToCode(e,"ENTITY_TYPE",t.ORDER_ATOMIC)||"'PIG'",s=t.valueToCode(e,"POSITION",t.ORDER_ATOMIC)||"Vec3(0, 0, 0)";return`self.action_implementer.spawn_entity(position_vec3=${s}, entity_type=${i})
`},t.forBlock.minecraft_action_set_block=function(e,t){let i=t.valueToCode(e,"BLOCK_TYPE",t.ORDER_ATOMIC)||"'STONE'",s=t.valueToCode(e,"POSITION",t.ORDER_ATOMIC)||"Vec3(0, 0, 0)";return`self.action_implementer.set_block(position_vec3=${s}, block_type=${i})
`},t.forBlock.minecraft_action_get_block=function(e,t){let i=t.valueToCode(e,"POSITION",t.ORDER_ATOMIC)||"Vec3(0, 0, 0)";return[`self.action_implementer.get_block(position_vec3=${i})`,t.ORDER_FUNCTION_CALL]},t.forBlock.minecraft_action_get_height=function(e,t){let i=t.valueToCode(e,"POSITION",t.ORDER_ATOMIC)||"Vec3(0, 0, 0)";return[`self.action_implementer.get_height(position_vec3=${i})`,t.ORDER_FUNCTION_CALL]},t.forBlock.minecraft_action_post_to_chat=function(e,t){let i=t.valueToCode(e,"MESSAGE",t.ORDER_ATOMIC)||"''";return`self.action_implementer.post_to_chat(message=${i})
`},t.forBlock.minecraft_action_create_explosion=function(e,t){let i=t.valueToCode(e,"POSITION",t.ORDER_ATOMIC)||"Vec3(0, 0, 0)",s=t.valueToCode(e,"POWER",t.ORDER_ATOMIC)||"4";return`self.action_implementer.create_explosion(position_vec3=${i}, power=${s})
`},t.forBlock.time_sleep=function(e,t){let i=t.valueToCode(e,"SECONDS",t.ORDER_ATOMIC)||"1";return`time.sleep(${i})
`}}(p.pythonGenerator),(_=p.pythonGenerator).forBlock.minecraft_material_banner=function(e,t){let i=t.valueToCode(e,"COLOUR",t.ORDER_ATOMIC)||"'WHITE'",s="WHITE";i&&i.length>2&&(s=i.substring(1,i.length-1));let o="";return o="TINTED_GLASS_BLOCK"===s?"TINTED_GLASS":"BANNER".includes("GLASS_PANE")?`${s}_STAINED_GLASS_PANE`:"BANNER".includes("GLASS")?`${s}_STAINED_GLASS`:`${s}_BANNER`,[`'${o}'`,t.ORDER_ATOMIC]},_.forBlock.minecraft_material_bed=function(e,t){let i=t.valueToCode(e,"COLOUR",t.ORDER_ATOMIC)||"'WHITE'",s="WHITE";i&&i.length>2&&(s=i.substring(1,i.length-1));let o="";return o="TINTED_GLASS_BLOCK"===s?"TINTED_GLASS":"BED".includes("GLASS_PANE")?`${s}_STAINED_GLASS_PANE`:"BED".includes("GLASS")?`${s}_STAINED_GLASS`:"BED".includes("BANNER")?`${s}_BANNER`:`${s}_BED`,[`'${o}'`,t.ORDER_ATOMIC]},_.forBlock.minecraft_material_candle=function(e,t){let i=t.valueToCode(e,"COLOUR",t.ORDER_ATOMIC)||"'WHITE'",s="WHITE";i&&i.length>2&&(s=i.substring(1,i.length-1));let o="";return o="TINTED_GLASS_BLOCK"===s?"TINTED_GLASS":"CANDLE".includes("GLASS_PANE")?`${s}_STAINED_GLASS_PANE`:"CANDLE".includes("GLASS")?`${s}_STAINED_GLASS`:"CANDLE".includes("BANNER")?`${s}_BANNER`:`${s}_CANDLE`,[`'${o}'`,t.ORDER_ATOMIC]},_.forBlock.minecraft_material_carpet=function(e,t){let i=t.valueToCode(e,"COLOUR",t.ORDER_ATOMIC)||"'WHITE'",s="WHITE";i&&i.length>2&&(s=i.substring(1,i.length-1));let o="";return o="TINTED_GLASS_BLOCK"===s?"TINTED_GLASS":"CARPET".includes("GLASS_PANE")?`${s}_STAINED_GLASS_PANE`:"CARPET".includes("GLASS")?`${s}_STAINED_GLASS`:"CARPET".includes("BANNER")?`${s}_BANNER`:`${s}_CARPET`,[`'${o}'`,t.ORDER_ATOMIC]},_.forBlock.minecraft_material_concrete=function(e,t){let i=t.valueToCode(e,"COLOUR",t.ORDER_ATOMIC)||"'WHITE'",s="WHITE";i&&i.length>2&&(s=i.substring(1,i.length-1));let o="";return o="TINTED_GLASS_BLOCK"===s?"TINTED_GLASS":"CONCRETE".includes("GLASS_PANE")?`${s}_STAINED_GLASS_PANE`:"CONCRETE".includes("GLASS")?`${s}_STAINED_GLASS`:"CONCRETE".includes("BANNER")?`${s}_BANNER`:`${s}_CONCRETE`,[`'${o}'`,t.ORDER_ATOMIC]},_.forBlock.minecraft_material_concrete_powder=function(e,t){let i=t.valueToCode(e,"COLOUR",t.ORDER_ATOMIC)||"'WHITE'",s="WHITE";i&&i.length>2&&(s=i.substring(1,i.length-1));let o="";return o="TINTED_GLASS_BLOCK"===s?"TINTED_GLASS":"CONCRETE_POWDER".includes("GLASS_PANE")?`${s}_STAINED_GLASS_PANE`:"CONCRETE_POWDER".includes("GLASS")?`${s}_STAINED_GLASS`:"CONCRETE_POWDER".includes("BANNER")?`${s}_BANNER`:`${s}_CONCRETE_POWDER`,[`'${o}'`,t.ORDER_ATOMIC]},_.forBlock.minecraft_material_glazed_terracotta=function(e,t){let i=t.valueToCode(e,"COLOUR",t.ORDER_ATOMIC)||"'WHITE'",s="WHITE";i&&i.length>2&&(s=i.substring(1,i.length-1));let o="";return o="TINTED_GLASS_BLOCK"===s?"TINTED_GLASS":"GLAZED_TERRACOTTA".includes("GLASS_PANE")?`${s}_STAINED_GLASS_PANE`:"GLAZED_TERRACOTTA".includes("GLASS")?`${s}_STAINED_GLASS`:"GLAZED_TERRACOTTA".includes("BANNER")?`${s}_BANNER`:`${s}_GLAZED_TERRACOTTA`,[`'${o}'`,t.ORDER_ATOMIC]},_.forBlock.minecraft_material_shulker_box=function(e,t){let i=t.valueToCode(e,"COLOUR",t.ORDER_ATOMIC)||"'WHITE'",s="WHITE";i&&i.length>2&&(s=i.substring(1,i.length-1));let o="";return o="TINTED_GLASS_BLOCK"===s?"TINTED_GLASS":"SHULKER_BOX".includes("GLASS_PANE")?`${s}_STAINED_GLASS_PANE`:"SHULKER_BOX".includes("GLASS")?`${s}_STAINED_GLASS`:"SHULKER_BOX".includes("BANNER")?`${s}_BANNER`:`${s}_SHULKER_BOX`,[`'${o}'`,t.ORDER_ATOMIC]},_.forBlock.minecraft_material_stained_glass=function(e,t){let i=t.valueToCode(e,"COLOUR",t.ORDER_ATOMIC)||"'WHITE'",s="WHITE";i&&i.length>2&&(s=i.substring(1,i.length-1));let o="";return o="TINTED_GLASS_BLOCK"===s?"TINTED_GLASS":"STAINED_GLASS".includes("GLASS_PANE")?`${s}_STAINED_GLASS_PANE`:"STAINED_GLASS".includes("GLASS")?`${s}_STAINED_GLASS`:"STAINED_GLASS".includes("BANNER")?`${s}_BANNER`:`${s}_STAINED_GLASS`,[`'${o}'`,t.ORDER_ATOMIC]},_.forBlock.minecraft_material_stained_glass_pane=function(e,t){let i=t.valueToCode(e,"COLOUR",t.ORDER_ATOMIC)||"'WHITE'",s="WHITE";i&&i.length>2&&(s=i.substring(1,i.length-1));let o="";return o="TINTED_GLASS_BLOCK"===s?"TINTED_GLASS":"STAINED_GLASS_PANE".includes("GLASS_PANE")?`${s}_STAINED_GLASS_PANE`:"STAINED_GLASS_PANE".includes("GLASS")?`${s}_STAINED_GLASS`:"STAINED_GLASS_PANE".includes("BANNER")?`${s}_BANNER`:`${s}_STAINED_GLASS_PANE`,[`'${o}'`,t.ORDER_ATOMIC]},_.forBlock.minecraft_material_terracotta=function(e,t){let i=t.valueToCode(e,"COLOUR",t.ORDER_ATOMIC)||"'WHITE'",s="WHITE";i&&i.length>2&&(s=i.substring(1,i.length-1));let o="";return o="TINTED_GLASS_BLOCK"===s?"TINTED_GLASS":"TERRACOTTA".includes("GLASS_PANE")?`${s}_STAINED_GLASS_PANE`:"TERRACOTTA".includes("GLASS")?`${s}_STAINED_GLASS`:"TERRACOTTA".includes("BANNER")?`${s}_BANNER`:`${s}_TERRACOTTA`,[`'${o}'`,t.ORDER_ATOMIC]},_.forBlock.minecraft_material_wool=function(e,t){let i=t.valueToCode(e,"COLOUR",t.ORDER_ATOMIC)||"'WHITE'",s="WHITE";i&&i.length>2&&(s=i.substring(1,i.length-1));let o="";return o="TINTED_GLASS_BLOCK"===s?"TINTED_GLASS":"WOOL".includes("GLASS_PANE")?`${s}_STAINED_GLASS_PANE`:"WOOL".includes("GLASS")?`${s}_STAINED_GLASS`:"WOOL".includes("BANNER")?`${s}_BANNER`:`${s}_WOOL`,[`'${o}'`,t.ORDER_ATOMIC]},_.forBlock.minecraft_picker_doors=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_fences=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_gates=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_glass=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_ores=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_redstone_components=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_slabs=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_stairs=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_stone_bricks=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_trapdoors=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_walls=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_wood_full=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_wood_logs=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_wood_planks=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_world=function(e,t){return g(e,t,"MATERIAL_ID")},_.forBlock.minecraft_picker_miscellaneous=function(e,t){return g(e,t,"MATERIAL_ID")},(O=p.pythonGenerator).forBlock.minecraft_picker_entity_hostile_mobs=function(e,t){return I(e,t,"ENTITY_ID")},O.forBlock.minecraft_picker_entity_minecarts=function(e,t){return I(e,t,"ENTITY_ID")},O.forBlock.minecraft_picker_entity_miscellaneous_entities=function(e,t){return I(e,t,"ENTITY_ID")},O.forBlock.minecraft_picker_entity_passive_mobs=function(e,t){return I(e,t,"ENTITY_ID")},O.forBlock.minecraft_picker_entity_projectiles=function(e,t){return I(e,t,"ENTITY_ID")},O.forBlock.minecraft_picker_entity_utility_and_special=function(e,t){return I(e,t,"ENTITY_ID")};let N=function(e){try{let e=localStorage.getItem(m);if(e){let t=JSON.parse(e);if(t&&t.blocks)return console.log("Found and loaded workspace from localStorage."),t}}catch(e){console.error("Error loading autosaved workspace:",e)}return console.log("No valid autosave found, loading default workspace."),null}(0);if(!N)try{let e=await fetch("./workspace.json");N=e.ok?await e.json():R}catch(e){N=R}console.log("Workspace will be initialized with this JSON:",N);let b=new URL(A);try{let e=await fetch(b);if(!e.ok)throw Error(`HTTP error! status: ${e.status}`);i=await e.text()}catch(e){console.error("Could not load toolbox.xml. Using empty toolbox.",e),i="<xml></xml>"}if(t=T.inject("blocklyDiv",{toolbox:i,grid:{spacing:20,length:3,colour:"#ccc",snap:!0},zoom:{controls:!0,wheel:!0,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2}}),console.log("Initializing global htmx event listeners..."),document.body.addEventListener("showError",function(e){console.error("Custom server error event received:",e.detail);let t=e.detail.errorMessage||"An unknown server error occurred.";alert(`Application Error: ${t}`)}),document.body.addEventListener("htmx:responseError",function(e){console.error("HTMX Response Error:",e.detail);let t=e.detail.xhr,i=`A server communication error occurred.

Status: ${t.status} - ${t.statusText}`;0===t.status&&(i="Network Error: Could not connect to the server. Is it running?"),alert(i)}),N&&N.blocks)try{T.serialization.workspaces.load(N,t),console.log("Successfully loaded initial workspace from JSON data.")}catch(e){console.error("Error loading workspace JSON data:",e)}console.log("Setting up autosave listeners."),window.addEventListener("beforeunload",n);let $=r(n,1e3);t.addChangeListener(e=>{e.isUiEvent||$()});let D=document.getElementById("clearWorkspaceButton");D&&D.addEventListener("click",()=>{confirm("Are you sure you want to clear the workspace? This cannot be undone.")&&(t.clear(),localStorage.removeItem(m),console.log("Workspace and autosave data cleared."))});let M=document.getElementById("pythonCodeDisplay"),P=r(()=>{if(!t||!p.pythonGenerator)return;let e=p.pythonGenerator.workspaceToCode(t);M&&(M.textContent=e,window.Prism&&l(E).highlightElement(M))});t.addChangeListener(e=>{e.isUiEvent||P()}),P();let y=document.getElementById("confirmSaveButton");y&&y.addEventListener("click",a);let k=document.getElementById("loadPowerFromFileButton");k&&k.addEventListener("click",o);let w=document.getElementById("executePowerButton");w&&w.addEventListener("click",async()=>{console.log("Execute (Debug) button clicked.");let i=function(t){p.pythonGenerator.init(t);let i=t.getTopBlocks(!0),s=i.find(e=>"procedures_defnoreturn"===e.type||"procedures_defreturn"===e.type);if(s){let o=s.getFieldValue("NAME"),n=i.find(e=>("procedures_callnoreturn"===e.type||"procedures_callreturn"===e.type)&&e.getFieldValue("NAME")===o);if(!n)return alert(`Debug Error: To test the function '${o}', you must have a corresponding "call ${o}" block on the workspace with its arguments connected.`),null;console.log(`Building debug payload for functional power: '${o}'`);let r=p.pythonGenerator.nameDB_.getName(o,e.BlocklyNameTypes.PROCEDURE),l=s.getVars(),a=l.map(t=>p.pythonGenerator.nameDB_.getName(t,e.BlocklyNameTypes.VARIABLE)),c=p.pythonGenerator.statementToCode(s,"STACK")||p.pythonGenerator.INDENT+"pass\n";if("procedures_defreturn"===s.type){let e=p.pythonGenerator.valueToCode(s,"RETURN",p.pythonGenerator.ORDER_NONE)||"None";c+=p.pythonGenerator.INDENT+"return "+e+"\n"}let h=`def ${r}(self, ${a.join(", ")}):
${c}`,u=l.map((e,t)=>{let i="String",s=n.getInput("ARG"+t);if(s?.connection?.targetBlock()){let e=s.connection.targetBlock().outputConnection;if(e?.getCheck()){let t=e.getCheck();t?.length>0&&(i=t[0])}}return{name:e,type:i}});return{code:p.pythonGenerator.workspaceToCode(t),isFunctionalPower:!0,metadata:{function_name:o,parameters:u,python_code:h}}}{console.log("Building debug payload for a simple script power.");let e=p.pythonGenerator.workspaceToCode(t);return{code:e,isFunctionalPower:!1,metadata:{function_name:null,parameters:[],python_code:e}}}}(t);if(!i)return;let o=document.getElementById("pythonCodeDisplay");o&&(o.textContent=i.code,window.Prism&&l(E).highlightElement(o));let n=await s("%mc_debug_and_define",JSON.stringify(i));n&&alert("Debug Output:\n\n"+n)}),document.body.addEventListener("loadPower",function(e){if(!e.detail||!e.detail.powerData||!e.detail.powerData.blockly_json)return void alert("Error: Could not load power. Data is missing.");let i=e.detail.powerData,s=e.detail.mode;console.log(`Received power to load: '${i.name}' in '${s}' mode.`);try{if("replace"===s){if(t.getAllBlocks(!1).length>0&&!confirm(`This will replace your current workspace with the power '${i.name}'. Are you sure?`))return;T.serialization.workspaces.load(i.blockly_json,t),console.log("Workspace replaced successfully.")}else{console.log("Appending power to workspace...");let e=i.blockly_json,s=t.getVariableMap(),o={};if(e.variables)for(let i of e.variables){let e=s.getVariable(i.name);e&&e.getId()!==i.id?o[i.id]=e.getId():e||t.createVariable(i.name,i.type,i.id)}let n=e.blocks;if(Object.keys(o).length>0&&n){let e=JSON.stringify(n);for(let t in o){let i=o[t],s=RegExp(`"${t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}"`,"g");e=e.replace(s,`"${i}"`)}n=JSON.parse(e)}if(n&&Array.isArray(n.blocks)){T.Events.disable();try{let e=n.blocks;for(let i of e)T.serialization.blocks.append(i,t);console.log(`Appended ${e.length} new block stack(s).`)}finally{T.Events.enable()}t.getTopBlocks(!1).length>0&&(t.render(),t.cleanUp())}}n()}catch(e){console.error("Error deserializing or loading workspace:",e),alert("Could not load the power. The file may be corrupted.")}});let v=document.querySelector("#power-library-panel .toggle-btn"),B=document.querySelector("#editor-preview-pane .toggle-btn"),G=r(()=>{console.log("Resizing Blockly canvas..."),T.svgResize(t)},100);v&&v.addEventListener("click",G),B&&B.addEventListener("click",G),window.addEventListener("resize",G);let F=r(()=>{t&&(console.log("Triggering Blockly resize..."),T.svgResize(t))},100);window.triggerBlocklyResize=F,window.addEventListener("resize",F),document.body.addEventListener("library-changed",e=>{console.log("Event 'library-changed' was successfully dispatched!"),console.log("Event Detail (data passed with dispatch):",e.detail)})}A=import.meta.resolve("kWX1n"),document.addEventListener("DOMContentLoaded",()=>{console.log("DOM fully loaded and parsed."),d.default.start(),console.log("Alpine.js started."),S()});
//# sourceMappingURL=mced.ec80a7a3.js.map
